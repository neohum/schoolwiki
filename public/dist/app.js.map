{
  "version": 3,
  "sources": ["../../resources/js/services/events.js", "../../resources/js/services/http.js", "../../resources/js/services/translations.js", "../../resources/js/services/components.js", "../../resources/js/services/text.js", "../../resources/js/components/index.js", "../../resources/js/services/dom.js", "../../resources/js/services/util.js", "../../resources/js/components/component.js", "../../resources/js/components/add-remove-rows.js", "../../resources/js/components/ajax-delete-row.js", "../../resources/js/components/ajax-form.js", "../../resources/js/components/attachments.js", "../../resources/js/components/attachments-list.js", "../../resources/js/services/keyboard-navigation.js", "../../resources/js/components/auto-suggest.js", "../../resources/js/components/auto-submit.js", "../../resources/js/components/back-to-top.js", "../../node_modules/sortablejs/modular/sortable.esm.js", "../../resources/js/components/book-sort.js", "../../resources/js/services/animations.js", "../../resources/js/components/chapter-contents.js", "../../resources/js/components/code-editor.js", "../../resources/js/components/code-highlighter.js", "../../resources/js/components/code-textarea.js", "../../resources/js/components/collapsible.js", "../../resources/js/components/confirm-dialog.js", "../../resources/js/components/custom-checkbox.js", "../../resources/js/components/details-highlighter.js", "../../resources/js/components/dropdown.js", "../../resources/js/components/dropdown-search.js", "../../resources/js/services/clipboard.js", "../../resources/js/components/dropzone.js", "../../resources/js/components/editor-toolbox.js", "../../resources/js/components/entity-permissions.js", "../../resources/js/components/entity-search.js", "../../resources/js/components/entity-selector.js", "../../resources/js/components/entity-selector-popup.js", "../../resources/js/components/event-emit-select.js", "../../resources/js/components/expand-toggle.js", "../../resources/js/components/global-search.js", "../../resources/js/components/header-mobile-toggle.js", "../../resources/js/components/image-manager.js", "../../resources/js/components/image-picker.js", "../../resources/js/components/list-sort-control.js", "../../resources/js/components/markdown-editor.js", "../../resources/js/components/new-user-password.js", "../../resources/js/components/notification.js", "../../resources/js/components/optional-input.js", "../../resources/js/wysiwyg/shortcuts.js", "../../resources/js/wysiwyg/common-events.js", "../../resources/js/wysiwyg/scrolling.js", "../../resources/js/wysiwyg/drop-paste-handling.js", "../../resources/js/wysiwyg/toolbars.js", "../../resources/js/wysiwyg/icons.js", "../../resources/js/wysiwyg/filters.js", "../../resources/js/wysiwyg/plugin-codeeditor.js", "../../node_modules/idb-keyval/dist/index.js", "../../resources/js/services/drawio.js", "../../resources/js/wysiwyg/plugin-drawio.js", "../../resources/js/wysiwyg/plugins-customhr.js", "../../resources/js/wysiwyg/plugins-imagemanager.js", "../../resources/js/wysiwyg/plugins-about.js", "../../resources/js/wysiwyg/util.js", "../../resources/js/wysiwyg/plugins-details.js", "../../resources/js/wysiwyg/plugins-table-additions.js", "../../resources/js/wysiwyg/plugins-tasklist.js", "../../resources/js/wysiwyg/fixes.js", "../../resources/js/wysiwyg/config.js", "../../resources/js/components/page-comment.js", "../../resources/js/components/page-comments.js", "../../resources/js/components/page-display.js", "../../resources/js/services/dates.js", "../../resources/js/components/page-editor.js", "../../resources/js/components/page-picker.js", "../../resources/js/components/permissions-table.js", "../../resources/js/components/pointer.js", "../../resources/js/components/popup.js", "../../resources/js/components/setting-app-color-scheme.js", "../../resources/js/components/setting-color-picker.js", "../../resources/js/components/setting-homepage-control.js", "../../resources/js/components/shelf-sort.js", "../../resources/js/components/shortcuts.js", "../../resources/js/components/shortcut-input.js", "../../resources/js/components/sortable-list.js", "../../resources/js/components/submit-on-change.js", "../../resources/js/components/tabs.js", "../../resources/js/components/tag-manager.js", "../../resources/js/components/template-manager.js", "../../resources/js/components/toggle-switch.js", "../../resources/js/components/tri-layout.js", "../../resources/js/components/user-select.js", "../../resources/js/components/webhook-events.js", "../../resources/js/components/wysiwyg-editor.js", "../../resources/js/components/wysiwyg-input.js", "../../resources/js/app.js"],
  "sourcesContent": ["const listeners = {};\nconst stack = [];\n\n/**\n * Emit a custom event for any handlers to pick-up.\n * @param {String} eventName\n * @param {*} eventData\n */\nexport function emit(eventName, eventData) {\n    stack.push({name: eventName, data: eventData});\n\n    const listenersToRun = listeners[eventName] || [];\n    for (const listener of listenersToRun) {\n        listener(eventData);\n    }\n}\n\n/**\n * Listen to a custom event and run the given callback when that event occurs.\n * @param {String} eventName\n * @param {Function} callback\n * @returns {Events}\n */\nexport function listen(eventName, callback) {\n    if (typeof listeners[eventName] === 'undefined') listeners[eventName] = [];\n    listeners[eventName].push(callback);\n}\n\n/**\n * Emit an event for public use.\n * Sends the event via the native DOM event handling system.\n * @param {Element} targetElement\n * @param {String} eventName\n * @param {Object} eventData\n */\nexport function emitPublic(targetElement, eventName, eventData) {\n    const event = new CustomEvent(eventName, {\n        detail: eventData,\n        bubbles: true,\n    });\n    targetElement.dispatchEvent(event);\n}\n\n/**\n * Emit a success event with the provided message.\n * @param {String} message\n */\nexport function success(message) {\n    emit('success', message);\n}\n\n/**\n * Emit an error event with the provided message.\n * @param {String} message\n */\nexport function error(message) {\n    emit('error', message);\n}\n\n/**\n * Notify of standard server-provided validation errors.\n * @param {Object} responseErr\n */\nexport function showValidationErrors(responseErr) {\n    if (!responseErr.status) return;\n    if (responseErr.status === 422 && responseErr.data) {\n        const message = Object.values(responseErr.data).flat().join('\\n');\n        error(message);\n    }\n}\n\n/**\n * Notify standard server-provided error messages.\n * @param {Object} responseErr\n */\nexport function showResponseError(responseErr) {\n    if (!responseErr.status) return;\n    if (responseErr.status >= 400 && responseErr.data && responseErr.data.message) {\n        error(responseErr.data.message);\n    }\n}\n", "/**\n * @typedef FormattedResponse\n * @property {Headers} headers\n * @property {Response} original\n * @property {Object|String} data\n * @property {Boolean} redirected\n * @property {Number} status\n * @property {string} statusText\n * @property {string} url\n */\n\n/**\n * Get the content from a fetch response.\n * Checks the content-type header to determine the format.\n * @param {Response} response\n * @returns {Promise<Object|String>}\n */\nasync function getResponseContent(response) {\n    if (response.status === 204) {\n        return null;\n    }\n\n    const responseContentType = response.headers.get('Content-Type') || '';\n    const subType = responseContentType.split(';')[0].split('/').pop();\n\n    if (subType === 'javascript' || subType === 'json') {\n        return response.json();\n    }\n\n    return response.text();\n}\n\nexport class HttpError extends Error {\n\n    constructor(response, content) {\n        super(response.statusText);\n        this.data = content;\n        this.headers = response.headers;\n        this.redirected = response.redirected;\n        this.status = response.status;\n        this.statusText = response.statusText;\n        this.url = response.url;\n        this.original = response;\n    }\n\n}\n\n/**\n * @param {String} method\n * @param {String} url\n * @param {Object} events\n * @return {XMLHttpRequest}\n */\nexport function createXMLHttpRequest(method, url, events = {}) {\n    const csrfToken = document.querySelector('meta[name=token]').getAttribute('content');\n    const req = new XMLHttpRequest();\n\n    for (const [eventName, callback] of Object.entries(events)) {\n        req.addEventListener(eventName, callback.bind(req));\n    }\n\n    req.open(method, url);\n    req.withCredentials = true;\n    req.setRequestHeader('X-CSRF-TOKEN', csrfToken);\n\n    return req;\n}\n\n/**\n * Create a new HTTP request, setting the required CSRF information\n * to communicate with the back-end. Parses & formats the response.\n * @param {String} url\n * @param {Object} options\n * @returns {Promise<FormattedResponse>}\n */\nasync function request(url, options = {}) {\n    let requestUrl = url;\n\n    if (!requestUrl.startsWith('http')) {\n        requestUrl = window.baseUrl(requestUrl);\n    }\n\n    if (options.params) {\n        const urlObj = new URL(requestUrl);\n        for (const paramName of Object.keys(options.params)) {\n            const value = options.params[paramName];\n            if (typeof value !== 'undefined' && value !== null) {\n                urlObj.searchParams.set(paramName, value);\n            }\n        }\n        requestUrl = urlObj.toString();\n    }\n\n    const csrfToken = document.querySelector('meta[name=token]').getAttribute('content');\n    const requestOptions = {...options, credentials: 'same-origin'};\n    requestOptions.headers = {\n        ...requestOptions.headers || {},\n        baseURL: window.baseUrl(''),\n        'X-CSRF-TOKEN': csrfToken,\n    };\n\n    const response = await fetch(requestUrl, requestOptions);\n    const content = await getResponseContent(response);\n    const returnData = {\n        data: content,\n        headers: response.headers,\n        redirected: response.redirected,\n        status: response.status,\n        statusText: response.statusText,\n        url: response.url,\n        original: response,\n    };\n\n    if (!response.ok) {\n        throw new HttpError(response, content);\n    }\n\n    return returnData;\n}\n\n/**\n * Perform a HTTP request to the back-end that includes data in the body.\n * Parses the body to JSON if an object, setting the correct headers.\n * @param {String} method\n * @param {String} url\n * @param {Object} data\n * @returns {Promise<FormattedResponse>}\n */\nasync function dataRequest(method, url, data = null) {\n    const options = {\n        method,\n        body: data,\n    };\n\n    // Send data as JSON if a plain object\n    if (typeof data === 'object' && !(data instanceof FormData)) {\n        options.headers = {\n            'Content-Type': 'application/json',\n            'X-Requested-With': 'XMLHttpRequest',\n        };\n        options.body = JSON.stringify(data);\n    }\n\n    // Ensure FormData instances are sent over POST\n    // Since Laravel does not read multipart/form-data from other types\n    // of request. Hence the addition of the magic _method value.\n    if (data instanceof FormData && method !== 'post') {\n        data.append('_method', method);\n        options.method = 'post';\n    }\n\n    return request(url, options);\n}\n\n/**\n * Perform a HTTP GET request.\n * Can easily pass query parameters as the second parameter.\n * @param {String} url\n * @param {Object} params\n * @returns {Promise<FormattedResponse>}\n */\nexport async function get(url, params = {}) {\n    return request(url, {\n        method: 'GET',\n        params,\n    });\n}\n\n/**\n * Perform a HTTP POST request.\n * @param {String} url\n * @param {Object} data\n * @returns {Promise<FormattedResponse>}\n */\nexport async function post(url, data = null) {\n    return dataRequest('POST', url, data);\n}\n\n/**\n * Perform a HTTP PUT request.\n * @param {String} url\n * @param {Object} data\n * @returns {Promise<FormattedResponse>}\n */\nexport async function put(url, data = null) {\n    return dataRequest('PUT', url, data);\n}\n\n/**\n * Perform a HTTP PATCH request.\n * @param {String} url\n * @param {Object} data\n * @returns {Promise<FormattedResponse>}\n */\nexport async function patch(url, data = null) {\n    return dataRequest('PATCH', url, data);\n}\n\n/**\n * Perform a HTTP DELETE request.\n * @param {String} url\n * @param {Object} data\n * @returns {Promise<FormattedResponse>}\n */\nasync function performDelete(url, data = null) {\n    return dataRequest('DELETE', url, data);\n}\n\nexport {performDelete as delete};\n", "/**\n *  Translation Manager\n *  Handles the JavaScript side of translating strings\n *  in a way which fits with Laravel.\n */\nclass Translator {\n\n    constructor() {\n        this.store = new Map();\n        this.parseTranslations();\n    }\n\n    /**\n     * Parse translations out of the page and place into the store.\n     */\n    parseTranslations() {\n        const translationMetaTags = document.querySelectorAll('meta[name=\"translation\"]');\n        for (const tag of translationMetaTags) {\n            const key = tag.getAttribute('key');\n            const value = tag.getAttribute('value');\n            this.store.set(key, value);\n        }\n    }\n\n    /**\n     * Get a translation, Same format as Laravel's 'trans' helper\n     * @param key\n     * @param replacements\n     * @returns {*}\n     */\n    get(key, replacements) {\n        const text = this.getTransText(key);\n        return this.performReplacements(text, replacements);\n    }\n\n    /**\n     * Get pluralised text, Dependent on the given count.\n     * Same format at Laravel's 'trans_choice' helper.\n     * @param key\n     * @param count\n     * @param replacements\n     * @returns {*}\n     */\n    getPlural(key, count, replacements) {\n        const text = this.getTransText(key);\n        return this.parsePlural(text, count, replacements);\n    }\n\n    /**\n     * Parse the given translation and find the correct plural option\n     * to use. Similar format at Laravel's 'trans_choice' helper.\n     * @param {String} translation\n     * @param {Number} count\n     * @param {Object} replacements\n     * @returns {String}\n     */\n    parsePlural(translation, count, replacements) {\n        const splitText = translation.split('|');\n        const exactCountRegex = /^{([0-9]+)}/;\n        const rangeRegex = /^\\[([0-9]+),([0-9*]+)]/;\n        let result = null;\n\n        for (const t of splitText) {\n            // Parse exact matches\n            const exactMatches = t.match(exactCountRegex);\n            if (exactMatches !== null && Number(exactMatches[1]) === count) {\n                result = t.replace(exactCountRegex, '').trim();\n                break;\n            }\n\n            // Parse range matches\n            const rangeMatches = t.match(rangeRegex);\n            if (rangeMatches !== null) {\n                const rangeStart = Number(rangeMatches[1]);\n                if (rangeStart <= count && (rangeMatches[2] === '*' || Number(rangeMatches[2]) >= count)) {\n                    result = t.replace(rangeRegex, '').trim();\n                    break;\n                }\n            }\n        }\n\n        if (result === null && splitText.length > 1) {\n            result = (count === 1) ? splitText[0] : splitText[1];\n        }\n\n        if (result === null) {\n            result = splitText[0];\n        }\n\n        return this.performReplacements(result, replacements);\n    }\n\n    /**\n     * Fetched translation text from the store for the given key.\n     * @param key\n     * @returns {String|Object}\n     */\n    getTransText(key) {\n        const value = this.store.get(key);\n\n        if (value === undefined) {\n            console.warn(`Translation with key \"${key}\" does not exist`);\n        }\n\n        return value;\n    }\n\n    /**\n     * Perform replacements on a string.\n     * @param {String} string\n     * @param {Object} replacements\n     * @returns {*}\n     */\n    performReplacements(string, replacements) {\n        if (!replacements) return string;\n        const replaceMatches = string.match(/:(\\S+)/g);\n        if (replaceMatches === null) return string;\n        let updatedString = string;\n\n        replaceMatches.forEach(match => {\n            const key = match.substring(1);\n            if (typeof replacements[key] === 'undefined') return;\n            updatedString = updatedString.replace(match, replacements[key]);\n        });\n\n        return updatedString;\n    }\n\n}\n\nexport default Translator;\n", "import {kebabToCamel, camelToKebab} from './text';\n\n/**\n * A mapping of active components keyed by name, with values being arrays of component\n * instances since there can be multiple components of the same type.\n * @type {Object<String, Component[]>}\n */\nconst components = {};\n\n/**\n * A mapping of component class models, keyed by name.\n * @type {Object<String, Constructor<Component>>}\n */\nconst componentModelMap = {};\n\n/**\n * A mapping of active component maps, keyed by the element components are assigned to.\n * @type {WeakMap<Element, Object<String, Component>>}\n */\nconst elementComponentMap = new WeakMap();\n\n/**\n * Parse out the element references within the given element\n * for the given component name.\n * @param {String} name\n * @param {Element} element\n */\nfunction parseRefs(name, element) {\n    const refs = {};\n    const manyRefs = {};\n\n    const prefix = `${name}@`;\n    const selector = `[refs*=\"${prefix}\"]`;\n    const refElems = [...element.querySelectorAll(selector)];\n    if (element.matches(selector)) {\n        refElems.push(element);\n    }\n\n    for (const el of refElems) {\n        const refNames = el.getAttribute('refs')\n            .split(' ')\n            .filter(str => str.startsWith(prefix))\n            .map(str => str.replace(prefix, ''))\n            .map(kebabToCamel);\n        for (const ref of refNames) {\n            refs[ref] = el;\n            if (typeof manyRefs[ref] === 'undefined') {\n                manyRefs[ref] = [];\n            }\n            manyRefs[ref].push(el);\n        }\n    }\n    return {refs, manyRefs};\n}\n\n/**\n * Parse out the element component options.\n * @param {String} componentName\n * @param {Element} element\n * @return {Object<String, String>}\n */\nfunction parseOpts(componentName, element) {\n    const opts = {};\n    const prefix = `option:${componentName}:`;\n    for (const {name, value} of element.attributes) {\n        if (name.startsWith(prefix)) {\n            const optName = name.replace(prefix, '');\n            opts[kebabToCamel(optName)] = value || '';\n        }\n    }\n    return opts;\n}\n\n/**\n * Initialize a component instance on the given dom element.\n * @param {String} name\n * @param {Element} element\n */\nfunction initComponent(name, element) {\n    /** @type {Function<Component>|undefined} * */\n    const ComponentModel = componentModelMap[name];\n    if (ComponentModel === undefined) return;\n\n    // Create our component instance\n    /** @type {Component} * */\n    let instance;\n    try {\n        instance = new ComponentModel();\n        instance.$name = name;\n        instance.$el = element;\n        const allRefs = parseRefs(name, element);\n        instance.$refs = allRefs.refs;\n        instance.$manyRefs = allRefs.manyRefs;\n        instance.$opts = parseOpts(name, element);\n        instance.setup();\n    } catch (e) {\n        console.error('Failed to create component', e, name, element);\n    }\n\n    // Add to global listing\n    if (typeof components[name] === 'undefined') {\n        components[name] = [];\n    }\n    components[name].push(instance);\n\n    // Add to element mapping\n    const elComponents = elementComponentMap.get(element) || {};\n    elComponents[name] = instance;\n    elementComponentMap.set(element, elComponents);\n}\n\n/**\n * Initialize all components found within the given element.\n * @param {Element|Document} parentElement\n */\nexport function init(parentElement = document) {\n    const componentElems = parentElement.querySelectorAll('[component],[components]');\n\n    for (const el of componentElems) {\n        const componentNames = `${el.getAttribute('component') || ''} ${(el.getAttribute('components'))}`.toLowerCase().split(' ').filter(Boolean);\n        for (const name of componentNames) {\n            initComponent(name, el);\n        }\n    }\n}\n\n/**\n * Register the given component mapping into the component system.\n * @param {Object<String, ObjectConstructor<Component>>} mapping\n */\nexport function register(mapping) {\n    const keys = Object.keys(mapping);\n    for (const key of keys) {\n        componentModelMap[camelToKebab(key)] = mapping[key];\n    }\n}\n\n/**\n * Get the first component of the given name.\n * @param {String} name\n * @returns {Component|null}\n */\nexport function first(name) {\n    return (components[name] || [null])[0];\n}\n\n/**\n * Get all the components of the given name.\n * @param {String} name\n * @returns {Component[]}\n */\nexport function get(name) {\n    return components[name] || [];\n}\n\n/**\n * Get the first component, of the given name, that's assigned to the given element.\n * @param {Element} element\n * @param {String} name\n * @returns {Component|null}\n */\nexport function firstOnElement(element, name) {\n    const elComponents = elementComponentMap.get(element) || {};\n    return elComponents[name] || null;\n}\n", "/**\n * Convert a kebab-case string to camelCase\n * @param {String} kebab\n * @returns {string}\n */\nexport function kebabToCamel(kebab) {\n    const ucFirst = word => word.slice(0, 1).toUpperCase() + word.slice(1);\n    const words = kebab.split('-');\n    return words[0] + words.slice(1).map(ucFirst).join('');\n}\n\n/**\n * Convert a camelCase string to a kebab-case string.\n * @param {String} camelStr\n * @returns {String}\n */\nexport function camelToKebab(camelStr) {\n    return camelStr.replace(/[A-Z]/g, (str, offset) => (offset > 0 ? '-' : '') + str.toLowerCase());\n}\n", "export {AddRemoveRows} from './add-remove-rows';\nexport {AjaxDeleteRow} from './ajax-delete-row';\nexport {AjaxForm} from './ajax-form';\nexport {Attachments} from './attachments';\nexport {AttachmentsList} from './attachments-list';\nexport {AutoSuggest} from './auto-suggest';\nexport {AutoSubmit} from './auto-submit';\nexport {BackToTop} from './back-to-top';\nexport {BookSort} from './book-sort';\nexport {ChapterContents} from './chapter-contents';\nexport {CodeEditor} from './code-editor';\nexport {CodeHighlighter} from './code-highlighter';\nexport {CodeTextarea} from './code-textarea';\nexport {Collapsible} from './collapsible';\nexport {ConfirmDialog} from './confirm-dialog';\nexport {CustomCheckbox} from './custom-checkbox';\nexport {DetailsHighlighter} from './details-highlighter';\nexport {Dropdown} from './dropdown';\nexport {DropdownSearch} from './dropdown-search';\nexport {Dropzone} from './dropzone';\nexport {EditorToolbox} from './editor-toolbox';\nexport {EntityPermissions} from './entity-permissions';\nexport {EntitySearch} from './entity-search';\nexport {EntitySelector} from './entity-selector';\nexport {EntitySelectorPopup} from './entity-selector-popup';\nexport {EventEmitSelect} from './event-emit-select';\nexport {ExpandToggle} from './expand-toggle';\nexport {GlobalSearch} from './global-search';\nexport {HeaderMobileToggle} from './header-mobile-toggle';\nexport {ImageManager} from './image-manager';\nexport {ImagePicker} from './image-picker';\nexport {ListSortControl} from './list-sort-control';\nexport {MarkdownEditor} from './markdown-editor';\nexport {NewUserPassword} from './new-user-password';\nexport {Notification} from './notification';\nexport {OptionalInput} from './optional-input';\nexport {PageComment} from './page-comment';\nexport {PageComments} from './page-comments';\nexport {PageDisplay} from './page-display';\nexport {PageEditor} from './page-editor';\nexport {PagePicker} from './page-picker';\nexport {PermissionsTable} from './permissions-table';\nexport {Pointer} from './pointer';\nexport {Popup} from './popup';\nexport {SettingAppColorScheme} from './setting-app-color-scheme';\nexport {SettingColorPicker} from './setting-color-picker';\nexport {SettingHomepageControl} from './setting-homepage-control';\nexport {ShelfSort} from './shelf-sort';\nexport {Shortcuts} from './shortcuts';\nexport {ShortcutInput} from './shortcut-input';\nexport {SortableList} from './sortable-list';\nexport {SubmitOnChange} from './submit-on-change';\nexport {Tabs} from './tabs';\nexport {TagManager} from './tag-manager';\nexport {TemplateManager} from './template-manager';\nexport {ToggleSwitch} from './toggle-switch';\nexport {TriLayout} from './tri-layout';\nexport {UserSelect} from './user-select';\nexport {WebhookEvents} from './webhook-events';\nexport {WysiwygEditor} from './wysiwyg-editor';\nexport {WysiwygInput} from './wysiwyg-input';\n", "/**\n * Create a new element with the given attrs and children.\n * Children can be a string for text nodes or other elements.\n * @param {String} tagName\n * @param {Object<String, String>} attrs\n * @param {Element[]|String[]}children\n * @return {*}\n */\nexport function elem(tagName, attrs = {}, children = []) {\n    const el = document.createElement(tagName);\n\n    for (const [key, val] of Object.entries(attrs)) {\n        if (val === null) {\n            el.removeAttribute(key);\n        } else {\n            el.setAttribute(key, val);\n        }\n    }\n\n    for (const child of children) {\n        if (typeof child === 'string') {\n            el.append(document.createTextNode(child));\n        } else {\n            el.append(child);\n        }\n    }\n\n    return el;\n}\n\n/**\n * Run the given callback against each element that matches the given selector.\n * @param {String} selector\n * @param {Function<Element>} callback\n */\nexport function forEach(selector, callback) {\n    const elements = document.querySelectorAll(selector);\n    for (const element of elements) {\n        callback(element);\n    }\n}\n\n/**\n * Helper to listen to multiple DOM events\n * @param {Element} listenerElement\n * @param {Array<String>} events\n * @param {Function<Event>} callback\n */\nexport function onEvents(listenerElement, events, callback) {\n    for (const eventName of events) {\n        listenerElement.addEventListener(eventName, callback);\n    }\n}\n\n/**\n * Helper to run an action when an element is selected.\n * A \"select\" is made to be accessible, So can be a click, space-press or enter-press.\n * @param {HTMLElement|Array} elements\n * @param {function} callback\n */\nexport function onSelect(elements, callback) {\n    if (!Array.isArray(elements)) {\n        elements = [elements];\n    }\n\n    for (const listenerElement of elements) {\n        listenerElement.addEventListener('click', callback);\n        listenerElement.addEventListener('keydown', event => {\n            if (event.key === 'Enter' || event.key === ' ') {\n                event.preventDefault();\n                callback(event);\n            }\n        });\n    }\n}\n\n/**\n * Listen to key press on the given element(s).\n * @param {String} key\n * @param {HTMLElement|Array} elements\n * @param {function} callback\n */\nfunction onKeyPress(key, elements, callback) {\n    if (!Array.isArray(elements)) {\n        elements = [elements];\n    }\n\n    const listener = event => {\n        if (event.key === key) {\n            callback(event);\n        }\n    };\n\n    elements.forEach(e => e.addEventListener('keydown', listener));\n}\n\n/**\n * Listen to enter press on the given element(s).\n * @param {HTMLElement|Array} elements\n * @param {function} callback\n */\nexport function onEnterPress(elements, callback) {\n    onKeyPress('Enter', elements, callback);\n}\n\n/**\n * Listen to escape press on the given element(s).\n * @param {HTMLElement|Array} elements\n * @param {function} callback\n */\nexport function onEscapePress(elements, callback) {\n    onKeyPress('Escape', elements, callback);\n}\n\n/**\n * Set a listener on an element for an event emitted by a child\n * matching the given childSelector param.\n * Used in a similar fashion to jQuery's $('listener').on('eventName', 'childSelector', callback)\n * @param {Element} listenerElement\n * @param {String} childSelector\n * @param {String} eventName\n * @param {Function} callback\n */\nexport function onChildEvent(listenerElement, childSelector, eventName, callback) {\n    listenerElement.addEventListener(eventName, event => {\n        const matchingChild = event.target.closest(childSelector);\n        if (matchingChild) {\n            callback.call(matchingChild, event, matchingChild);\n        }\n    });\n}\n\n/**\n * Look for elements that match the given selector and contain the given text.\n * Is case insensitive and returns the first result or null if nothing is found.\n * @param {String} selector\n * @param {String} text\n * @returns {Element}\n */\nexport function findText(selector, text) {\n    const elements = document.querySelectorAll(selector);\n    text = text.toLowerCase();\n    for (const element of elements) {\n        if (element.textContent.toLowerCase().includes(text)) {\n            return element;\n        }\n    }\n    return null;\n}\n\n/**\n * Show a loading indicator in the given element.\n * This will effectively clear the element.\n * @param {Element} element\n */\nexport function showLoading(element) {\n    element.innerHTML = '<div class=\"loading-container\"><div></div><div></div><div></div></div>';\n}\n\n/**\n * Get a loading element indicator element.\n * @returns {Element}\n */\nexport function getLoading() {\n    const wrap = document.createElement('div');\n    wrap.classList.add('loading-container');\n    wrap.innerHTML = '<div></div><div></div><div></div>';\n    return wrap;\n}\n\n/**\n * Remove any loading indicators within the given element.\n * @param {Element} element\n */\nexport function removeLoading(element) {\n    const loadingEls = element.querySelectorAll('.loading-container');\n    for (const el of loadingEls) {\n        el.remove();\n    }\n}\n\n/**\n * Convert the given html data into a live DOM element.\n * Initiates any components defined in the data.\n * @param {String} html\n * @returns {Element}\n */\nexport function htmlToDom(html) {\n    const wrap = document.createElement('div');\n    wrap.innerHTML = html;\n    window.$components.init(wrap);\n    return wrap.children[0];\n}\n", "/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @attribution https://davidwalsh.name/javascript-debounce-function\n * @param {Function} func\n * @param {Number} waitMs\n * @param {Boolean} immediate\n * @returns {Function}\n */\nexport function debounce(func, waitMs, immediate) {\n    let timeout;\n    return function debouncedWrapper(...args) {\n        const context = this;\n        const later = function debouncedTimeout() {\n            timeout = null;\n            if (!immediate) func.apply(context, args);\n        };\n        const callNow = immediate && !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, waitMs);\n        if (callNow) func.apply(context, args);\n    };\n}\n\n/**\n * Scroll and highlight an element.\n * @param {HTMLElement} element\n */\nexport function scrollAndHighlightElement(element) {\n    if (!element) return;\n\n    let parent = element;\n    while (parent.parentElement) {\n        parent = parent.parentElement;\n        if (parent.nodeName === 'DETAILS' && !parent.open) {\n            parent.open = true;\n        }\n    }\n\n    element.scrollIntoView({behavior: 'smooth'});\n\n    const highlight = getComputedStyle(document.body).getPropertyValue('--color-link');\n    element.style.outline = `2px dashed ${highlight}`;\n    element.style.outlineOffset = '5px';\n    element.style.transition = null;\n    setTimeout(() => {\n        element.style.transition = 'outline linear 3s';\n        element.style.outline = '2px dashed rgba(0, 0, 0, 0)';\n        const listener = () => {\n            element.removeEventListener('transitionend', listener);\n            element.style.transition = null;\n            element.style.outline = null;\n            element.style.outlineOffset = null;\n        };\n        element.addEventListener('transitionend', listener);\n    }, 1000);\n}\n\n/**\n * Escape any HTML in the given 'unsafe' string.\n * Take from https://stackoverflow.com/a/6234804.\n * @param {String} unsafe\n * @returns {string}\n */\nexport function escapeHtml(unsafe) {\n    return unsafe\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#039;');\n}\n\n/**\n * Generate a random unique ID.\n *\n * @returns {string}\n */\nexport function uniqueId() {\n    // eslint-disable-next-line no-bitwise\n    const S4 = () => (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n    return (`${S4() + S4()}-${S4()}-${S4()}-${S4()}-${S4()}${S4()}${S4()}`);\n}\n\n/**\n * Create a promise that resolves after the given time.\n * @param {int} timeMs\n * @returns {Promise}\n */\nexport function wait(timeMs) {\n    return new Promise(res => {\n        setTimeout(res, timeMs);\n    });\n}\n", "export class Component {\n\n    /**\n     * The registered name of the component.\n     * @type {string}\n     */\n    $name = '';\n\n    /**\n     * The element that the component is registered upon.\n     * @type {Element}\n     */\n    $el = null;\n\n    /**\n     * Mapping of referenced elements within the component.\n     * @type {Object<string, Element>}\n     */\n    $refs = {};\n\n    /**\n     * Mapping of arrays of referenced elements within the component so multiple\n     * references, sharing the same name, can be fetched.\n     * @type {Object<string, Element[]>}\n     */\n    $manyRefs = {};\n\n    /**\n     * Options passed into this component.\n     * @type {Object<String, String>}\n     */\n    $opts = {};\n\n    /**\n     * Component-specific setup methods.\n     * Use this to assign local variables and run any initial setup or actions.\n     */\n    setup() {\n        //\n    }\n\n    /**\n     * Emit an event from this component.\n     * Will be bubbled up from the dom element this is registered on, as a custom event\n     * with the name `<elementName>-<eventName>`, with the provided data in the event detail.\n     * @param {String} eventName\n     * @param {Object} data\n     */\n    $emit(eventName, data = {}) {\n        data.from = this;\n        const componentName = this.$name;\n        const event = new CustomEvent(`${componentName}-${eventName}`, {\n            bubbles: true,\n            detail: data,\n        });\n        this.$el.dispatchEvent(event);\n    }\n\n}\n", "import {onChildEvent} from '../services/dom';\nimport {uniqueId} from '../services/util';\nimport {Component} from './component';\n\n/**\n * AddRemoveRows\n * Allows easy row add/remove controls onto a table.\n * Needs a model row to use when adding a new row.\n */\nexport class AddRemoveRows extends Component {\n\n    setup() {\n        this.modelRow = this.$refs.model;\n        this.addButton = this.$refs.add;\n        this.removeSelector = this.$opts.removeSelector;\n        this.rowSelector = this.$opts.rowSelector;\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        this.addButton.addEventListener('click', this.add.bind(this));\n\n        onChildEvent(this.$el, this.removeSelector, 'click', e => {\n            const row = e.target.closest(this.rowSelector);\n            row.remove();\n        });\n    }\n\n    // For external use\n    add() {\n        const clone = this.modelRow.cloneNode(true);\n        clone.classList.remove('hidden');\n        this.setClonedInputNames(clone);\n        this.modelRow.parentNode.insertBefore(clone, this.modelRow);\n        window.$components.init(clone);\n    }\n\n    /**\n     * Update the HTML names of a clone to be unique if required.\n     * Names can use placeholder values. For exmaple, a model row\n     * may have name=\"tags[randrowid][name]\".\n     * These are the available placeholder values:\n     * - randrowid - An random string ID, applied the same across the row.\n     * @param {HTMLElement} clone\n     */\n    setClonedInputNames(clone) {\n        const rowId = uniqueId();\n        const randRowIdElems = clone.querySelectorAll('[name*=\"randrowid\"]');\n        for (const elem of randRowIdElems) {\n            elem.name = elem.name.split('randrowid').join(rowId);\n        }\n    }\n\n}\n", "import {onSelect} from '../services/dom';\nimport {Component} from './component';\n\nexport class AjaxDeleteRow extends Component {\n\n    setup() {\n        this.row = this.$el;\n        this.url = this.$opts.url;\n        this.deleteButtons = this.$manyRefs.delete;\n\n        onSelect(this.deleteButtons, this.runDelete.bind(this));\n    }\n\n    runDelete() {\n        this.row.style.opacity = '0.7';\n        this.row.style.pointerEvents = 'none';\n\n        window.$http.delete(this.url).then(resp => {\n            if (typeof resp.data === 'object' && resp.data.message) {\n                window.$events.emit('success', resp.data.message);\n            }\n            this.row.remove();\n        }).catch(() => {\n            this.row.style.opacity = null;\n            this.row.style.pointerEvents = null;\n        });\n    }\n\n}\n", "import {onEnterPress, onSelect} from '../services/dom';\nimport {Component} from './component';\n\n/**\n * Ajax Form\n * Will handle button clicks or input enter press events and submit\n * the data over ajax. Will always expect a partial HTML view to be returned.\n * Fires an 'ajax-form-success' event when submitted successfully.\n *\n * Will handle a real form if that's what the component is added to\n * otherwise will act as a fake form element.\n */\nexport class AjaxForm extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.responseContainer = this.container;\n        this.url = this.$opts.url;\n        this.method = this.$opts.method || 'post';\n        this.successMessage = this.$opts.successMessage;\n        this.submitButtons = this.$manyRefs.submit || [];\n\n        if (this.$opts.responseContainer) {\n            this.responseContainer = this.container.closest(this.$opts.responseContainer);\n        }\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        if (this.container.tagName === 'FORM') {\n            this.container.addEventListener('submit', this.submitRealForm.bind(this));\n            return;\n        }\n\n        onEnterPress(this.container, event => {\n            this.submitFakeForm();\n            event.preventDefault();\n        });\n\n        this.submitButtons.forEach(button => onSelect(button, this.submitFakeForm.bind(this)));\n    }\n\n    submitFakeForm() {\n        const fd = new FormData();\n        const inputs = this.container.querySelectorAll('[name]');\n        for (const input of inputs) {\n            fd.append(input.getAttribute('name'), input.value);\n        }\n        this.submit(fd);\n    }\n\n    submitRealForm(event) {\n        event.preventDefault();\n        const fd = new FormData(this.container);\n        this.submit(fd);\n    }\n\n    async submit(formData) {\n        this.responseContainer.style.opacity = '0.7';\n        this.responseContainer.style.pointerEvents = 'none';\n\n        try {\n            const resp = await window.$http[this.method.toLowerCase()](this.url, formData);\n            this.$emit('success', {formData});\n            this.responseContainer.innerHTML = resp.data;\n            if (this.successMessage) {\n                window.$events.emit('success', this.successMessage);\n            }\n        } catch (err) {\n            this.responseContainer.innerHTML = err.data;\n        }\n\n        window.$components.init(this.responseContainer);\n        this.responseContainer.style.opacity = null;\n        this.responseContainer.style.pointerEvents = null;\n    }\n\n}\n", "import {showLoading} from '../services/dom';\nimport {Component} from './component';\n\nexport class Attachments extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.pageId = this.$opts.pageId;\n        this.editContainer = this.$refs.editContainer;\n        this.listContainer = this.$refs.listContainer;\n        this.linksContainer = this.$refs.linksContainer;\n        this.listPanel = this.$refs.listPanel;\n        this.attachLinkButton = this.$refs.attachLinkButton;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        const reloadListBound = this.reloadList.bind(this);\n        this.container.addEventListener('dropzone-upload-success', reloadListBound);\n        this.container.addEventListener('ajax-form-success', reloadListBound);\n\n        this.container.addEventListener('sortable-list-sort', event => {\n            this.updateOrder(event.detail.ids);\n        });\n\n        this.container.addEventListener('event-emit-select-edit', event => {\n            this.startEdit(event.detail.id);\n        });\n\n        this.container.addEventListener('event-emit-select-edit-back', () => {\n            this.stopEdit();\n        });\n\n        this.container.addEventListener('event-emit-select-insert', event => {\n            const insertContent = event.target.closest('[data-drag-content]').getAttribute('data-drag-content');\n            const contentTypes = JSON.parse(insertContent);\n            window.$events.emit('editor::insert', {\n                html: contentTypes['text/html'],\n                markdown: contentTypes['text/plain'],\n            });\n        });\n\n        this.attachLinkButton.addEventListener('click', () => {\n            this.showSection('links');\n        });\n    }\n\n    showSection(section) {\n        const sectionMap = {\n            links: this.linksContainer,\n            edit: this.editContainer,\n            list: this.listContainer,\n        };\n\n        for (const [name, elem] of Object.entries(sectionMap)) {\n            elem.toggleAttribute('hidden', name !== section);\n        }\n    }\n\n    reloadList() {\n        this.stopEdit();\n        window.$http.get(`/attachments/get/page/${this.pageId}`).then(resp => {\n            this.listPanel.innerHTML = resp.data;\n            window.$components.init(this.listPanel);\n        });\n    }\n\n    updateOrder(idOrder) {\n        window.$http.put(`/attachments/sort/page/${this.pageId}`, {order: idOrder}).then(resp => {\n            window.$events.emit('success', resp.data.message);\n        });\n    }\n\n    async startEdit(id) {\n        this.showSection('edit');\n\n        showLoading(this.editContainer);\n        const resp = await window.$http.get(`/attachments/edit/${id}`);\n        this.editContainer.innerHTML = resp.data;\n        window.$components.init(this.editContainer);\n    }\n\n    stopEdit() {\n        this.showSection('list');\n    }\n\n}\n", "import {Component} from './component';\n\n/**\n * Attachments List\n * Adds '?open=true' query to file attachment links\n * when ctrl/cmd is pressed down.\n */\nexport class AttachmentsList extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.fileLinks = this.$manyRefs.linkTypeFile;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        const isExpectedKey = event => event.key === 'Control' || event.key === 'Meta';\n        window.addEventListener('keydown', event => {\n            if (isExpectedKey(event)) {\n                this.addOpenQueryToLinks();\n            }\n        }, {passive: true});\n        window.addEventListener('keyup', event => {\n            if (isExpectedKey(event)) {\n                this.removeOpenQueryFromLinks();\n            }\n        }, {passive: true});\n    }\n\n    addOpenQueryToLinks() {\n        for (const link of this.fileLinks) {\n            if (link.href.split('?')[1] !== 'open=true') {\n                link.href += '?open=true';\n                link.setAttribute('target', '_blank');\n            }\n        }\n    }\n\n    removeOpenQueryFromLinks() {\n        for (const link of this.fileLinks) {\n            link.href = link.href.split('?')[0];\n            link.removeAttribute('target');\n        }\n    }\n\n}\n", "/**\n * Handle common keyboard navigation events within a given container.\n */\nexport class KeyboardNavigationHandler {\n\n    /**\n     * @param {Element} container\n     * @param {Function|null} onEscape\n     * @param {Function|null} onEnter\n     */\n    constructor(container, onEscape = null, onEnter = null) {\n        this.containers = [container];\n        this.onEscape = onEscape;\n        this.onEnter = onEnter;\n        container.addEventListener('keydown', this.#keydownHandler.bind(this));\n    }\n\n    /**\n     * Also share the keyboard event handling to the given element.\n     * Only elements within the original container are considered focusable though.\n     * @param {Element} element\n     */\n    shareHandlingToEl(element) {\n        this.containers.push(element);\n        element.addEventListener('keydown', this.#keydownHandler.bind(this));\n    }\n\n    /**\n     * Focus on the next focusable element within the current containers.\n     */\n    focusNext() {\n        const focusable = this.#getFocusable();\n        const currentIndex = focusable.indexOf(document.activeElement);\n        let newIndex = currentIndex + 1;\n        if (newIndex >= focusable.length) {\n            newIndex = 0;\n        }\n\n        focusable[newIndex].focus();\n    }\n\n    /**\n     * Focus on the previous existing focusable element within the current containers.\n     */\n    focusPrevious() {\n        const focusable = this.#getFocusable();\n        const currentIndex = focusable.indexOf(document.activeElement);\n        let newIndex = currentIndex - 1;\n        if (newIndex < 0) {\n            newIndex = focusable.length - 1;\n        }\n\n        focusable[newIndex].focus();\n    }\n\n    /**\n     * @param {KeyboardEvent} event\n     */\n    #keydownHandler(event) {\n        // Ignore certain key events in inputs to allow text editing.\n        if (event.target.matches('input') && (event.key === 'ArrowRight' || event.key === 'ArrowLeft')) {\n            return;\n        }\n\n        if (event.key === 'ArrowDown' || event.key === 'ArrowRight') {\n            this.focusNext();\n            event.preventDefault();\n        } else if (event.key === 'ArrowUp' || event.key === 'ArrowLeft') {\n            this.focusPrevious();\n            event.preventDefault();\n        } else if (event.key === 'Escape') {\n            if (this.onEscape) {\n                this.onEscape(event);\n            } else if (document.activeElement) {\n                document.activeElement.blur();\n            }\n        } else if (event.key === 'Enter' && this.onEnter) {\n            this.onEnter(event);\n        }\n    }\n\n    /**\n     * Get an array of focusable elements within the current containers.\n     * @returns {Element[]}\n     */\n    #getFocusable() {\n        const focusable = [];\n        const selector = '[tabindex]:not([tabindex=\"-1\"]),[href],button:not([tabindex=\"-1\"],[disabled]),input:not([type=hidden])';\n        for (const container of this.containers) {\n            focusable.push(...container.querySelectorAll(selector));\n        }\n        return focusable;\n    }\n\n}\n", "import {escapeHtml} from '../services/util';\nimport {onChildEvent} from '../services/dom';\nimport {Component} from './component';\nimport {KeyboardNavigationHandler} from '../services/keyboard-navigation';\n\nconst ajaxCache = {};\n\n/**\n * AutoSuggest\n */\nexport class AutoSuggest extends Component {\n\n    setup() {\n        this.parent = this.$el.parentElement;\n        this.container = this.$el;\n        this.type = this.$opts.type;\n        this.url = this.$opts.url;\n        this.input = this.$refs.input;\n        this.list = this.$refs.list;\n\n        this.lastPopulated = 0;\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        const navHandler = new KeyboardNavigationHandler(\n            this.list,\n            () => {\n                this.input.focus();\n                setTimeout(() => this.hideSuggestions(), 1);\n            },\n            event => {\n                event.preventDefault();\n                const selectionValue = event.target.textContent;\n                if (selectionValue) {\n                    this.selectSuggestion(selectionValue);\n                }\n            },\n        );\n        navHandler.shareHandlingToEl(this.input);\n\n        onChildEvent(this.list, '.text-item', 'click', (event, el) => {\n            this.selectSuggestion(el.textContent);\n        });\n\n        this.input.addEventListener('input', this.requestSuggestions.bind(this));\n        this.input.addEventListener('focus', this.requestSuggestions.bind(this));\n        this.input.addEventListener('blur', this.hideSuggestionsIfFocusedLost.bind(this));\n        this.input.addEventListener('keydown', event => {\n            if (event.key === 'Tab') {\n                this.hideSuggestions();\n            }\n        });\n    }\n\n    selectSuggestion(value) {\n        this.input.value = value;\n        this.lastPopulated = Date.now();\n        this.input.focus();\n        this.input.dispatchEvent(new Event('input', {bubbles: true}));\n        this.input.dispatchEvent(new Event('change', {bubbles: true}));\n        this.hideSuggestions();\n    }\n\n    async requestSuggestions() {\n        if (Date.now() - this.lastPopulated < 50) {\n            return;\n        }\n\n        const nameFilter = this.getNameFilterIfNeeded();\n        const search = this.input.value.toLowerCase();\n        const suggestions = await this.loadSuggestions(search, nameFilter);\n\n        const toShow = suggestions.filter(val => search === '' || val.toLowerCase().startsWith(search)).slice(0, 10);\n\n        this.displaySuggestions(toShow);\n    }\n\n    getNameFilterIfNeeded() {\n        if (this.type !== 'value') return null;\n        return this.parent.querySelector('input').value;\n    }\n\n    /**\n     * @param {String} search\n     * @param {String|null} nameFilter\n     * @returns {Promise<Object|String|*>}\n     */\n    async loadSuggestions(search, nameFilter = null) {\n        // Truncate search to prevent over numerous lookups\n        search = search.slice(0, 4);\n\n        const params = {search, name: nameFilter};\n        const cacheKey = `${this.url}:${JSON.stringify(params)}`;\n\n        if (ajaxCache[cacheKey]) {\n            return ajaxCache[cacheKey];\n        }\n\n        const resp = await window.$http.get(this.url, params);\n        ajaxCache[cacheKey] = resp.data;\n        return resp.data;\n    }\n\n    /**\n     * @param {String[]} suggestions\n     */\n    displaySuggestions(suggestions) {\n        if (suggestions.length === 0) {\n            this.hideSuggestions();\n            return;\n        }\n\n        // This used to use <button>s but was changed to div elements since Safari would not focus on buttons\n        // on which causes a range of other complexities related to focus handling.\n        this.list.innerHTML = suggestions.map(value => `<li><div tabindex=\"0\" class=\"text-item\">${escapeHtml(value)}</div></li>`).join('');\n        this.list.style.display = 'block';\n        for (const button of this.list.querySelectorAll('.text-item')) {\n            button.addEventListener('blur', this.hideSuggestionsIfFocusedLost.bind(this));\n        }\n    }\n\n    hideSuggestions() {\n        this.list.style.display = 'none';\n    }\n\n    hideSuggestionsIfFocusedLost(event) {\n        if (!this.container.contains(event.relatedTarget)) {\n            this.hideSuggestions();\n        }\n    }\n\n}\n", "import {Component} from './component';\n\nexport class AutoSubmit extends Component {\n\n    setup() {\n        this.form = this.$el;\n\n        this.form.submit();\n    }\n\n}\n", "import {Component} from './component';\n\nexport class BackToTop extends Component {\n\n    setup() {\n        this.button = this.$el;\n        this.targetElem = document.getElementById('header');\n        this.showing = false;\n        this.breakPoint = 1200;\n\n        if (document.body.classList.contains('flexbox')) {\n            this.button.style.display = 'none';\n            return;\n        }\n\n        this.button.addEventListener('click', this.scrollToTop.bind(this));\n        window.addEventListener('scroll', this.onPageScroll.bind(this));\n    }\n\n    onPageScroll() {\n        const scrollTopPos = document.documentElement.scrollTop || document.body.scrollTop || 0;\n        if (!this.showing && scrollTopPos > this.breakPoint) {\n            this.button.style.display = 'block';\n            this.showing = true;\n            setTimeout(() => {\n                this.button.style.opacity = 0.4;\n            }, 1);\n        } else if (this.showing && scrollTopPos < this.breakPoint) {\n            this.button.style.opacity = 0;\n            this.showing = false;\n            setTimeout(() => {\n                this.button.style.display = 'none';\n            }, 500);\n        }\n    }\n\n    scrollToTop() {\n        const targetTop = this.targetElem.getBoundingClientRect().top;\n        const scrollElem = document.documentElement.scrollTop ? document.documentElement : document.body;\n        const duration = 300;\n        const start = Date.now();\n        const scrollStart = this.targetElem.getBoundingClientRect().top;\n\n        function setPos() {\n            const percentComplete = (1 - ((Date.now() - start) / duration));\n            const target = Math.abs(percentComplete * scrollStart);\n            if (percentComplete > 0) {\n                scrollElem.scrollTop = target;\n                requestAnimationFrame(setPos.bind(this));\n            } else {\n                scrollElem.scrollTop = targetTop;\n            }\n        }\n\n        requestAnimationFrame(setPos.bind(this));\n    }\n\n}\n", "/**!\n * Sortable 1.15.2\n * @author\tRubaXa   <trash@rubaxa.org>\n * @author\towenm    <owen23355@gmail.com>\n * @license MIT\n */\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) {\n      symbols = symbols.filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n      });\n    }\n    keys.push.apply(keys, symbols);\n  }\n  return keys;\n}\nfunction _objectSpread2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n  return target;\n}\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function (obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function (obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n  return obj;\n}\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n  return target;\n}\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n  var key, i;\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n  return target;\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar version = \"1.15.2\";\n\nfunction userAgent(pattern) {\n  if (typeof window !== 'undefined' && window.navigator) {\n    return !! /*@__PURE__*/navigator.userAgent.match(pattern);\n  }\n}\nvar IE11OrLess = userAgent(/(?:Trident.*rv[ :]?11\\.|msie|iemobile|Windows Phone)/i);\nvar Edge = userAgent(/Edge/i);\nvar FireFox = userAgent(/firefox/i);\nvar Safari = userAgent(/safari/i) && !userAgent(/chrome/i) && !userAgent(/android/i);\nvar IOS = userAgent(/iP(ad|od|hone)/i);\nvar ChromeForAndroid = userAgent(/chrome/i) && userAgent(/android/i);\n\nvar captureMode = {\n  capture: false,\n  passive: false\n};\nfunction on(el, event, fn) {\n  el.addEventListener(event, fn, !IE11OrLess && captureMode);\n}\nfunction off(el, event, fn) {\n  el.removeEventListener(event, fn, !IE11OrLess && captureMode);\n}\nfunction matches( /**HTMLElement*/el, /**String*/selector) {\n  if (!selector) return;\n  selector[0] === '>' && (selector = selector.substring(1));\n  if (el) {\n    try {\n      if (el.matches) {\n        return el.matches(selector);\n      } else if (el.msMatchesSelector) {\n        return el.msMatchesSelector(selector);\n      } else if (el.webkitMatchesSelector) {\n        return el.webkitMatchesSelector(selector);\n      }\n    } catch (_) {\n      return false;\n    }\n  }\n  return false;\n}\nfunction getParentOrHost(el) {\n  return el.host && el !== document && el.host.nodeType ? el.host : el.parentNode;\n}\nfunction closest( /**HTMLElement*/el, /**String*/selector, /**HTMLElement*/ctx, includeCTX) {\n  if (el) {\n    ctx = ctx || document;\n    do {\n      if (selector != null && (selector[0] === '>' ? el.parentNode === ctx && matches(el, selector) : matches(el, selector)) || includeCTX && el === ctx) {\n        return el;\n      }\n      if (el === ctx) break;\n      /* jshint boss:true */\n    } while (el = getParentOrHost(el));\n  }\n  return null;\n}\nvar R_SPACE = /\\s+/g;\nfunction toggleClass(el, name, state) {\n  if (el && name) {\n    if (el.classList) {\n      el.classList[state ? 'add' : 'remove'](name);\n    } else {\n      var className = (' ' + el.className + ' ').replace(R_SPACE, ' ').replace(' ' + name + ' ', ' ');\n      el.className = (className + (state ? ' ' + name : '')).replace(R_SPACE, ' ');\n    }\n  }\n}\nfunction css(el, prop, val) {\n  var style = el && el.style;\n  if (style) {\n    if (val === void 0) {\n      if (document.defaultView && document.defaultView.getComputedStyle) {\n        val = document.defaultView.getComputedStyle(el, '');\n      } else if (el.currentStyle) {\n        val = el.currentStyle;\n      }\n      return prop === void 0 ? val : val[prop];\n    } else {\n      if (!(prop in style) && prop.indexOf('webkit') === -1) {\n        prop = '-webkit-' + prop;\n      }\n      style[prop] = val + (typeof val === 'string' ? '' : 'px');\n    }\n  }\n}\nfunction matrix(el, selfOnly) {\n  var appliedTransforms = '';\n  if (typeof el === 'string') {\n    appliedTransforms = el;\n  } else {\n    do {\n      var transform = css(el, 'transform');\n      if (transform && transform !== 'none') {\n        appliedTransforms = transform + ' ' + appliedTransforms;\n      }\n      /* jshint boss:true */\n    } while (!selfOnly && (el = el.parentNode));\n  }\n  var matrixFn = window.DOMMatrix || window.WebKitCSSMatrix || window.CSSMatrix || window.MSCSSMatrix;\n  /*jshint -W056 */\n  return matrixFn && new matrixFn(appliedTransforms);\n}\nfunction find(ctx, tagName, iterator) {\n  if (ctx) {\n    var list = ctx.getElementsByTagName(tagName),\n      i = 0,\n      n = list.length;\n    if (iterator) {\n      for (; i < n; i++) {\n        iterator(list[i], i);\n      }\n    }\n    return list;\n  }\n  return [];\n}\nfunction getWindowScrollingElement() {\n  var scrollingElement = document.scrollingElement;\n  if (scrollingElement) {\n    return scrollingElement;\n  } else {\n    return document.documentElement;\n  }\n}\n\n/**\r\n * Returns the \"bounding client rect\" of given element\r\n * @param  {HTMLElement} el                       The element whose boundingClientRect is wanted\r\n * @param  {[Boolean]} relativeToContainingBlock  Whether the rect should be relative to the containing block of (including) the container\r\n * @param  {[Boolean]} relativeToNonStaticParent  Whether the rect should be relative to the relative parent of (including) the contaienr\r\n * @param  {[Boolean]} undoScale                  Whether the container's scale() should be undone\r\n * @param  {[HTMLElement]} container              The parent the element will be placed in\r\n * @return {Object}                               The boundingClientRect of el, with specified adjustments\r\n */\nfunction getRect(el, relativeToContainingBlock, relativeToNonStaticParent, undoScale, container) {\n  if (!el.getBoundingClientRect && el !== window) return;\n  var elRect, top, left, bottom, right, height, width;\n  if (el !== window && el.parentNode && el !== getWindowScrollingElement()) {\n    elRect = el.getBoundingClientRect();\n    top = elRect.top;\n    left = elRect.left;\n    bottom = elRect.bottom;\n    right = elRect.right;\n    height = elRect.height;\n    width = elRect.width;\n  } else {\n    top = 0;\n    left = 0;\n    bottom = window.innerHeight;\n    right = window.innerWidth;\n    height = window.innerHeight;\n    width = window.innerWidth;\n  }\n  if ((relativeToContainingBlock || relativeToNonStaticParent) && el !== window) {\n    // Adjust for translate()\n    container = container || el.parentNode;\n\n    // solves #1123 (see: https://stackoverflow.com/a/37953806/6088312)\n    // Not needed on <= IE11\n    if (!IE11OrLess) {\n      do {\n        if (container && container.getBoundingClientRect && (css(container, 'transform') !== 'none' || relativeToNonStaticParent && css(container, 'position') !== 'static')) {\n          var containerRect = container.getBoundingClientRect();\n\n          // Set relative to edges of padding box of container\n          top -= containerRect.top + parseInt(css(container, 'border-top-width'));\n          left -= containerRect.left + parseInt(css(container, 'border-left-width'));\n          bottom = top + elRect.height;\n          right = left + elRect.width;\n          break;\n        }\n        /* jshint boss:true */\n      } while (container = container.parentNode);\n    }\n  }\n  if (undoScale && el !== window) {\n    // Adjust for scale()\n    var elMatrix = matrix(container || el),\n      scaleX = elMatrix && elMatrix.a,\n      scaleY = elMatrix && elMatrix.d;\n    if (elMatrix) {\n      top /= scaleY;\n      left /= scaleX;\n      width /= scaleX;\n      height /= scaleY;\n      bottom = top + height;\n      right = left + width;\n    }\n  }\n  return {\n    top: top,\n    left: left,\n    bottom: bottom,\n    right: right,\n    width: width,\n    height: height\n  };\n}\n\n/**\r\n * Checks if a side of an element is scrolled past a side of its parents\r\n * @param  {HTMLElement}  el           The element who's side being scrolled out of view is in question\r\n * @param  {String}       elSide       Side of the element in question ('top', 'left', 'right', 'bottom')\r\n * @param  {String}       parentSide   Side of the parent in question ('top', 'left', 'right', 'bottom')\r\n * @return {HTMLElement}               The parent scroll element that the el's side is scrolled past, or null if there is no such element\r\n */\nfunction isScrolledPast(el, elSide, parentSide) {\n  var parent = getParentAutoScrollElement(el, true),\n    elSideVal = getRect(el)[elSide];\n\n  /* jshint boss:true */\n  while (parent) {\n    var parentSideVal = getRect(parent)[parentSide],\n      visible = void 0;\n    if (parentSide === 'top' || parentSide === 'left') {\n      visible = elSideVal >= parentSideVal;\n    } else {\n      visible = elSideVal <= parentSideVal;\n    }\n    if (!visible) return parent;\n    if (parent === getWindowScrollingElement()) break;\n    parent = getParentAutoScrollElement(parent, false);\n  }\n  return false;\n}\n\n/**\r\n * Gets nth child of el, ignoring hidden children, sortable's elements (does not ignore clone if it's visible)\r\n * and non-draggable elements\r\n * @param  {HTMLElement} el       The parent element\r\n * @param  {Number} childNum      The index of the child\r\n * @param  {Object} options       Parent Sortable's options\r\n * @return {HTMLElement}          The child at index childNum, or null if not found\r\n */\nfunction getChild(el, childNum, options, includeDragEl) {\n  var currentChild = 0,\n    i = 0,\n    children = el.children;\n  while (i < children.length) {\n    if (children[i].style.display !== 'none' && children[i] !== Sortable.ghost && (includeDragEl || children[i] !== Sortable.dragged) && closest(children[i], options.draggable, el, false)) {\n      if (currentChild === childNum) {\n        return children[i];\n      }\n      currentChild++;\n    }\n    i++;\n  }\n  return null;\n}\n\n/**\r\n * Gets the last child in the el, ignoring ghostEl or invisible elements (clones)\r\n * @param  {HTMLElement} el       Parent element\r\n * @param  {selector} selector    Any other elements that should be ignored\r\n * @return {HTMLElement}          The last child, ignoring ghostEl\r\n */\nfunction lastChild(el, selector) {\n  var last = el.lastElementChild;\n  while (last && (last === Sortable.ghost || css(last, 'display') === 'none' || selector && !matches(last, selector))) {\n    last = last.previousElementSibling;\n  }\n  return last || null;\n}\n\n/**\r\n * Returns the index of an element within its parent for a selected set of\r\n * elements\r\n * @param  {HTMLElement} el\r\n * @param  {selector} selector\r\n * @return {number}\r\n */\nfunction index(el, selector) {\n  var index = 0;\n  if (!el || !el.parentNode) {\n    return -1;\n  }\n\n  /* jshint boss:true */\n  while (el = el.previousElementSibling) {\n    if (el.nodeName.toUpperCase() !== 'TEMPLATE' && el !== Sortable.clone && (!selector || matches(el, selector))) {\n      index++;\n    }\n  }\n  return index;\n}\n\n/**\r\n * Returns the scroll offset of the given element, added with all the scroll offsets of parent elements.\r\n * The value is returned in real pixels.\r\n * @param  {HTMLElement} el\r\n * @return {Array}             Offsets in the format of [left, top]\r\n */\nfunction getRelativeScrollOffset(el) {\n  var offsetLeft = 0,\n    offsetTop = 0,\n    winScroller = getWindowScrollingElement();\n  if (el) {\n    do {\n      var elMatrix = matrix(el),\n        scaleX = elMatrix.a,\n        scaleY = elMatrix.d;\n      offsetLeft += el.scrollLeft * scaleX;\n      offsetTop += el.scrollTop * scaleY;\n    } while (el !== winScroller && (el = el.parentNode));\n  }\n  return [offsetLeft, offsetTop];\n}\n\n/**\r\n * Returns the index of the object within the given array\r\n * @param  {Array} arr   Array that may or may not hold the object\r\n * @param  {Object} obj  An object that has a key-value pair unique to and identical to a key-value pair in the object you want to find\r\n * @return {Number}      The index of the object in the array, or -1\r\n */\nfunction indexOfObject(arr, obj) {\n  for (var i in arr) {\n    if (!arr.hasOwnProperty(i)) continue;\n    for (var key in obj) {\n      if (obj.hasOwnProperty(key) && obj[key] === arr[i][key]) return Number(i);\n    }\n  }\n  return -1;\n}\nfunction getParentAutoScrollElement(el, includeSelf) {\n  // skip to window\n  if (!el || !el.getBoundingClientRect) return getWindowScrollingElement();\n  var elem = el;\n  var gotSelf = false;\n  do {\n    // we don't need to get elem css if it isn't even overflowing in the first place (performance)\n    if (elem.clientWidth < elem.scrollWidth || elem.clientHeight < elem.scrollHeight) {\n      var elemCSS = css(elem);\n      if (elem.clientWidth < elem.scrollWidth && (elemCSS.overflowX == 'auto' || elemCSS.overflowX == 'scroll') || elem.clientHeight < elem.scrollHeight && (elemCSS.overflowY == 'auto' || elemCSS.overflowY == 'scroll')) {\n        if (!elem.getBoundingClientRect || elem === document.body) return getWindowScrollingElement();\n        if (gotSelf || includeSelf) return elem;\n        gotSelf = true;\n      }\n    }\n    /* jshint boss:true */\n  } while (elem = elem.parentNode);\n  return getWindowScrollingElement();\n}\nfunction extend(dst, src) {\n  if (dst && src) {\n    for (var key in src) {\n      if (src.hasOwnProperty(key)) {\n        dst[key] = src[key];\n      }\n    }\n  }\n  return dst;\n}\nfunction isRectEqual(rect1, rect2) {\n  return Math.round(rect1.top) === Math.round(rect2.top) && Math.round(rect1.left) === Math.round(rect2.left) && Math.round(rect1.height) === Math.round(rect2.height) && Math.round(rect1.width) === Math.round(rect2.width);\n}\nvar _throttleTimeout;\nfunction throttle(callback, ms) {\n  return function () {\n    if (!_throttleTimeout) {\n      var args = arguments,\n        _this = this;\n      if (args.length === 1) {\n        callback.call(_this, args[0]);\n      } else {\n        callback.apply(_this, args);\n      }\n      _throttleTimeout = setTimeout(function () {\n        _throttleTimeout = void 0;\n      }, ms);\n    }\n  };\n}\nfunction cancelThrottle() {\n  clearTimeout(_throttleTimeout);\n  _throttleTimeout = void 0;\n}\nfunction scrollBy(el, x, y) {\n  el.scrollLeft += x;\n  el.scrollTop += y;\n}\nfunction clone(el) {\n  var Polymer = window.Polymer;\n  var $ = window.jQuery || window.Zepto;\n  if (Polymer && Polymer.dom) {\n    return Polymer.dom(el).cloneNode(true);\n  } else if ($) {\n    return $(el).clone(true)[0];\n  } else {\n    return el.cloneNode(true);\n  }\n}\nfunction setRect(el, rect) {\n  css(el, 'position', 'absolute');\n  css(el, 'top', rect.top);\n  css(el, 'left', rect.left);\n  css(el, 'width', rect.width);\n  css(el, 'height', rect.height);\n}\nfunction unsetRect(el) {\n  css(el, 'position', '');\n  css(el, 'top', '');\n  css(el, 'left', '');\n  css(el, 'width', '');\n  css(el, 'height', '');\n}\nfunction getChildContainingRectFromElement(container, options, ghostEl) {\n  var rect = {};\n  Array.from(container.children).forEach(function (child) {\n    var _rect$left, _rect$top, _rect$right, _rect$bottom;\n    if (!closest(child, options.draggable, container, false) || child.animated || child === ghostEl) return;\n    var childRect = getRect(child);\n    rect.left = Math.min((_rect$left = rect.left) !== null && _rect$left !== void 0 ? _rect$left : Infinity, childRect.left);\n    rect.top = Math.min((_rect$top = rect.top) !== null && _rect$top !== void 0 ? _rect$top : Infinity, childRect.top);\n    rect.right = Math.max((_rect$right = rect.right) !== null && _rect$right !== void 0 ? _rect$right : -Infinity, childRect.right);\n    rect.bottom = Math.max((_rect$bottom = rect.bottom) !== null && _rect$bottom !== void 0 ? _rect$bottom : -Infinity, childRect.bottom);\n  });\n  rect.width = rect.right - rect.left;\n  rect.height = rect.bottom - rect.top;\n  rect.x = rect.left;\n  rect.y = rect.top;\n  return rect;\n}\nvar expando = 'Sortable' + new Date().getTime();\n\nfunction AnimationStateManager() {\n  var animationStates = [],\n    animationCallbackId;\n  return {\n    captureAnimationState: function captureAnimationState() {\n      animationStates = [];\n      if (!this.options.animation) return;\n      var children = [].slice.call(this.el.children);\n      children.forEach(function (child) {\n        if (css(child, 'display') === 'none' || child === Sortable.ghost) return;\n        animationStates.push({\n          target: child,\n          rect: getRect(child)\n        });\n        var fromRect = _objectSpread2({}, animationStates[animationStates.length - 1].rect);\n\n        // If animating: compensate for current animation\n        if (child.thisAnimationDuration) {\n          var childMatrix = matrix(child, true);\n          if (childMatrix) {\n            fromRect.top -= childMatrix.f;\n            fromRect.left -= childMatrix.e;\n          }\n        }\n        child.fromRect = fromRect;\n      });\n    },\n    addAnimationState: function addAnimationState(state) {\n      animationStates.push(state);\n    },\n    removeAnimationState: function removeAnimationState(target) {\n      animationStates.splice(indexOfObject(animationStates, {\n        target: target\n      }), 1);\n    },\n    animateAll: function animateAll(callback) {\n      var _this = this;\n      if (!this.options.animation) {\n        clearTimeout(animationCallbackId);\n        if (typeof callback === 'function') callback();\n        return;\n      }\n      var animating = false,\n        animationTime = 0;\n      animationStates.forEach(function (state) {\n        var time = 0,\n          target = state.target,\n          fromRect = target.fromRect,\n          toRect = getRect(target),\n          prevFromRect = target.prevFromRect,\n          prevToRect = target.prevToRect,\n          animatingRect = state.rect,\n          targetMatrix = matrix(target, true);\n        if (targetMatrix) {\n          // Compensate for current animation\n          toRect.top -= targetMatrix.f;\n          toRect.left -= targetMatrix.e;\n        }\n        target.toRect = toRect;\n        if (target.thisAnimationDuration) {\n          // Could also check if animatingRect is between fromRect and toRect\n          if (isRectEqual(prevFromRect, toRect) && !isRectEqual(fromRect, toRect) &&\n          // Make sure animatingRect is on line between toRect & fromRect\n          (animatingRect.top - toRect.top) / (animatingRect.left - toRect.left) === (fromRect.top - toRect.top) / (fromRect.left - toRect.left)) {\n            // If returning to same place as started from animation and on same axis\n            time = calculateRealTime(animatingRect, prevFromRect, prevToRect, _this.options);\n          }\n        }\n\n        // if fromRect != toRect: animate\n        if (!isRectEqual(toRect, fromRect)) {\n          target.prevFromRect = fromRect;\n          target.prevToRect = toRect;\n          if (!time) {\n            time = _this.options.animation;\n          }\n          _this.animate(target, animatingRect, toRect, time);\n        }\n        if (time) {\n          animating = true;\n          animationTime = Math.max(animationTime, time);\n          clearTimeout(target.animationResetTimer);\n          target.animationResetTimer = setTimeout(function () {\n            target.animationTime = 0;\n            target.prevFromRect = null;\n            target.fromRect = null;\n            target.prevToRect = null;\n            target.thisAnimationDuration = null;\n          }, time);\n          target.thisAnimationDuration = time;\n        }\n      });\n      clearTimeout(animationCallbackId);\n      if (!animating) {\n        if (typeof callback === 'function') callback();\n      } else {\n        animationCallbackId = setTimeout(function () {\n          if (typeof callback === 'function') callback();\n        }, animationTime);\n      }\n      animationStates = [];\n    },\n    animate: function animate(target, currentRect, toRect, duration) {\n      if (duration) {\n        css(target, 'transition', '');\n        css(target, 'transform', '');\n        var elMatrix = matrix(this.el),\n          scaleX = elMatrix && elMatrix.a,\n          scaleY = elMatrix && elMatrix.d,\n          translateX = (currentRect.left - toRect.left) / (scaleX || 1),\n          translateY = (currentRect.top - toRect.top) / (scaleY || 1);\n        target.animatingX = !!translateX;\n        target.animatingY = !!translateY;\n        css(target, 'transform', 'translate3d(' + translateX + 'px,' + translateY + 'px,0)');\n        this.forRepaintDummy = repaint(target); // repaint\n\n        css(target, 'transition', 'transform ' + duration + 'ms' + (this.options.easing ? ' ' + this.options.easing : ''));\n        css(target, 'transform', 'translate3d(0,0,0)');\n        typeof target.animated === 'number' && clearTimeout(target.animated);\n        target.animated = setTimeout(function () {\n          css(target, 'transition', '');\n          css(target, 'transform', '');\n          target.animated = false;\n          target.animatingX = false;\n          target.animatingY = false;\n        }, duration);\n      }\n    }\n  };\n}\nfunction repaint(target) {\n  return target.offsetWidth;\n}\nfunction calculateRealTime(animatingRect, fromRect, toRect, options) {\n  return Math.sqrt(Math.pow(fromRect.top - animatingRect.top, 2) + Math.pow(fromRect.left - animatingRect.left, 2)) / Math.sqrt(Math.pow(fromRect.top - toRect.top, 2) + Math.pow(fromRect.left - toRect.left, 2)) * options.animation;\n}\n\nvar plugins = [];\nvar defaults = {\n  initializeByDefault: true\n};\nvar PluginManager = {\n  mount: function mount(plugin) {\n    // Set default static properties\n    for (var option in defaults) {\n      if (defaults.hasOwnProperty(option) && !(option in plugin)) {\n        plugin[option] = defaults[option];\n      }\n    }\n    plugins.forEach(function (p) {\n      if (p.pluginName === plugin.pluginName) {\n        throw \"Sortable: Cannot mount plugin \".concat(plugin.pluginName, \" more than once\");\n      }\n    });\n    plugins.push(plugin);\n  },\n  pluginEvent: function pluginEvent(eventName, sortable, evt) {\n    var _this = this;\n    this.eventCanceled = false;\n    evt.cancel = function () {\n      _this.eventCanceled = true;\n    };\n    var eventNameGlobal = eventName + 'Global';\n    plugins.forEach(function (plugin) {\n      if (!sortable[plugin.pluginName]) return;\n      // Fire global events if it exists in this sortable\n      if (sortable[plugin.pluginName][eventNameGlobal]) {\n        sortable[plugin.pluginName][eventNameGlobal](_objectSpread2({\n          sortable: sortable\n        }, evt));\n      }\n\n      // Only fire plugin event if plugin is enabled in this sortable,\n      // and plugin has event defined\n      if (sortable.options[plugin.pluginName] && sortable[plugin.pluginName][eventName]) {\n        sortable[plugin.pluginName][eventName](_objectSpread2({\n          sortable: sortable\n        }, evt));\n      }\n    });\n  },\n  initializePlugins: function initializePlugins(sortable, el, defaults, options) {\n    plugins.forEach(function (plugin) {\n      var pluginName = plugin.pluginName;\n      if (!sortable.options[pluginName] && !plugin.initializeByDefault) return;\n      var initialized = new plugin(sortable, el, sortable.options);\n      initialized.sortable = sortable;\n      initialized.options = sortable.options;\n      sortable[pluginName] = initialized;\n\n      // Add default options from plugin\n      _extends(defaults, initialized.defaults);\n    });\n    for (var option in sortable.options) {\n      if (!sortable.options.hasOwnProperty(option)) continue;\n      var modified = this.modifyOption(sortable, option, sortable.options[option]);\n      if (typeof modified !== 'undefined') {\n        sortable.options[option] = modified;\n      }\n    }\n  },\n  getEventProperties: function getEventProperties(name, sortable) {\n    var eventProperties = {};\n    plugins.forEach(function (plugin) {\n      if (typeof plugin.eventProperties !== 'function') return;\n      _extends(eventProperties, plugin.eventProperties.call(sortable[plugin.pluginName], name));\n    });\n    return eventProperties;\n  },\n  modifyOption: function modifyOption(sortable, name, value) {\n    var modifiedValue;\n    plugins.forEach(function (plugin) {\n      // Plugin must exist on the Sortable\n      if (!sortable[plugin.pluginName]) return;\n\n      // If static option listener exists for this option, call in the context of the Sortable's instance of this plugin\n      if (plugin.optionListeners && typeof plugin.optionListeners[name] === 'function') {\n        modifiedValue = plugin.optionListeners[name].call(sortable[plugin.pluginName], value);\n      }\n    });\n    return modifiedValue;\n  }\n};\n\nfunction dispatchEvent(_ref) {\n  var sortable = _ref.sortable,\n    rootEl = _ref.rootEl,\n    name = _ref.name,\n    targetEl = _ref.targetEl,\n    cloneEl = _ref.cloneEl,\n    toEl = _ref.toEl,\n    fromEl = _ref.fromEl,\n    oldIndex = _ref.oldIndex,\n    newIndex = _ref.newIndex,\n    oldDraggableIndex = _ref.oldDraggableIndex,\n    newDraggableIndex = _ref.newDraggableIndex,\n    originalEvent = _ref.originalEvent,\n    putSortable = _ref.putSortable,\n    extraEventProperties = _ref.extraEventProperties;\n  sortable = sortable || rootEl && rootEl[expando];\n  if (!sortable) return;\n  var evt,\n    options = sortable.options,\n    onName = 'on' + name.charAt(0).toUpperCase() + name.substr(1);\n  // Support for new CustomEvent feature\n  if (window.CustomEvent && !IE11OrLess && !Edge) {\n    evt = new CustomEvent(name, {\n      bubbles: true,\n      cancelable: true\n    });\n  } else {\n    evt = document.createEvent('Event');\n    evt.initEvent(name, true, true);\n  }\n  evt.to = toEl || rootEl;\n  evt.from = fromEl || rootEl;\n  evt.item = targetEl || rootEl;\n  evt.clone = cloneEl;\n  evt.oldIndex = oldIndex;\n  evt.newIndex = newIndex;\n  evt.oldDraggableIndex = oldDraggableIndex;\n  evt.newDraggableIndex = newDraggableIndex;\n  evt.originalEvent = originalEvent;\n  evt.pullMode = putSortable ? putSortable.lastPutMode : undefined;\n  var allEventProperties = _objectSpread2(_objectSpread2({}, extraEventProperties), PluginManager.getEventProperties(name, sortable));\n  for (var option in allEventProperties) {\n    evt[option] = allEventProperties[option];\n  }\n  if (rootEl) {\n    rootEl.dispatchEvent(evt);\n  }\n  if (options[onName]) {\n    options[onName].call(sortable, evt);\n  }\n}\n\nvar _excluded = [\"evt\"];\nvar pluginEvent = function pluginEvent(eventName, sortable) {\n  var _ref = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n    originalEvent = _ref.evt,\n    data = _objectWithoutProperties(_ref, _excluded);\n  PluginManager.pluginEvent.bind(Sortable)(eventName, sortable, _objectSpread2({\n    dragEl: dragEl,\n    parentEl: parentEl,\n    ghostEl: ghostEl,\n    rootEl: rootEl,\n    nextEl: nextEl,\n    lastDownEl: lastDownEl,\n    cloneEl: cloneEl,\n    cloneHidden: cloneHidden,\n    dragStarted: moved,\n    putSortable: putSortable,\n    activeSortable: Sortable.active,\n    originalEvent: originalEvent,\n    oldIndex: oldIndex,\n    oldDraggableIndex: oldDraggableIndex,\n    newIndex: newIndex,\n    newDraggableIndex: newDraggableIndex,\n    hideGhostForTarget: _hideGhostForTarget,\n    unhideGhostForTarget: _unhideGhostForTarget,\n    cloneNowHidden: function cloneNowHidden() {\n      cloneHidden = true;\n    },\n    cloneNowShown: function cloneNowShown() {\n      cloneHidden = false;\n    },\n    dispatchSortableEvent: function dispatchSortableEvent(name) {\n      _dispatchEvent({\n        sortable: sortable,\n        name: name,\n        originalEvent: originalEvent\n      });\n    }\n  }, data));\n};\nfunction _dispatchEvent(info) {\n  dispatchEvent(_objectSpread2({\n    putSortable: putSortable,\n    cloneEl: cloneEl,\n    targetEl: dragEl,\n    rootEl: rootEl,\n    oldIndex: oldIndex,\n    oldDraggableIndex: oldDraggableIndex,\n    newIndex: newIndex,\n    newDraggableIndex: newDraggableIndex\n  }, info));\n}\nvar dragEl,\n  parentEl,\n  ghostEl,\n  rootEl,\n  nextEl,\n  lastDownEl,\n  cloneEl,\n  cloneHidden,\n  oldIndex,\n  newIndex,\n  oldDraggableIndex,\n  newDraggableIndex,\n  activeGroup,\n  putSortable,\n  awaitingDragStarted = false,\n  ignoreNextClick = false,\n  sortables = [],\n  tapEvt,\n  touchEvt,\n  lastDx,\n  lastDy,\n  tapDistanceLeft,\n  tapDistanceTop,\n  moved,\n  lastTarget,\n  lastDirection,\n  pastFirstInvertThresh = false,\n  isCircumstantialInvert = false,\n  targetMoveDistance,\n  // For positioning ghost absolutely\n  ghostRelativeParent,\n  ghostRelativeParentInitialScroll = [],\n  // (left, top)\n\n  _silent = false,\n  savedInputChecked = [];\n\n/** @const */\nvar documentExists = typeof document !== 'undefined',\n  PositionGhostAbsolutely = IOS,\n  CSSFloatProperty = Edge || IE11OrLess ? 'cssFloat' : 'float',\n  // This will not pass for IE9, because IE9 DnD only works on anchors\n  supportDraggable = documentExists && !ChromeForAndroid && !IOS && 'draggable' in document.createElement('div'),\n  supportCssPointerEvents = function () {\n    if (!documentExists) return;\n    // false when <= IE11\n    if (IE11OrLess) {\n      return false;\n    }\n    var el = document.createElement('x');\n    el.style.cssText = 'pointer-events:auto';\n    return el.style.pointerEvents === 'auto';\n  }(),\n  _detectDirection = function _detectDirection(el, options) {\n    var elCSS = css(el),\n      elWidth = parseInt(elCSS.width) - parseInt(elCSS.paddingLeft) - parseInt(elCSS.paddingRight) - parseInt(elCSS.borderLeftWidth) - parseInt(elCSS.borderRightWidth),\n      child1 = getChild(el, 0, options),\n      child2 = getChild(el, 1, options),\n      firstChildCSS = child1 && css(child1),\n      secondChildCSS = child2 && css(child2),\n      firstChildWidth = firstChildCSS && parseInt(firstChildCSS.marginLeft) + parseInt(firstChildCSS.marginRight) + getRect(child1).width,\n      secondChildWidth = secondChildCSS && parseInt(secondChildCSS.marginLeft) + parseInt(secondChildCSS.marginRight) + getRect(child2).width;\n    if (elCSS.display === 'flex') {\n      return elCSS.flexDirection === 'column' || elCSS.flexDirection === 'column-reverse' ? 'vertical' : 'horizontal';\n    }\n    if (elCSS.display === 'grid') {\n      return elCSS.gridTemplateColumns.split(' ').length <= 1 ? 'vertical' : 'horizontal';\n    }\n    if (child1 && firstChildCSS[\"float\"] && firstChildCSS[\"float\"] !== 'none') {\n      var touchingSideChild2 = firstChildCSS[\"float\"] === 'left' ? 'left' : 'right';\n      return child2 && (secondChildCSS.clear === 'both' || secondChildCSS.clear === touchingSideChild2) ? 'vertical' : 'horizontal';\n    }\n    return child1 && (firstChildCSS.display === 'block' || firstChildCSS.display === 'flex' || firstChildCSS.display === 'table' || firstChildCSS.display === 'grid' || firstChildWidth >= elWidth && elCSS[CSSFloatProperty] === 'none' || child2 && elCSS[CSSFloatProperty] === 'none' && firstChildWidth + secondChildWidth > elWidth) ? 'vertical' : 'horizontal';\n  },\n  _dragElInRowColumn = function _dragElInRowColumn(dragRect, targetRect, vertical) {\n    var dragElS1Opp = vertical ? dragRect.left : dragRect.top,\n      dragElS2Opp = vertical ? dragRect.right : dragRect.bottom,\n      dragElOppLength = vertical ? dragRect.width : dragRect.height,\n      targetS1Opp = vertical ? targetRect.left : targetRect.top,\n      targetS2Opp = vertical ? targetRect.right : targetRect.bottom,\n      targetOppLength = vertical ? targetRect.width : targetRect.height;\n    return dragElS1Opp === targetS1Opp || dragElS2Opp === targetS2Opp || dragElS1Opp + dragElOppLength / 2 === targetS1Opp + targetOppLength / 2;\n  },\n  /**\r\n   * Detects first nearest empty sortable to X and Y position using emptyInsertThreshold.\r\n   * @param  {Number} x      X position\r\n   * @param  {Number} y      Y position\r\n   * @return {HTMLElement}   Element of the first found nearest Sortable\r\n   */\n  _detectNearestEmptySortable = function _detectNearestEmptySortable(x, y) {\n    var ret;\n    sortables.some(function (sortable) {\n      var threshold = sortable[expando].options.emptyInsertThreshold;\n      if (!threshold || lastChild(sortable)) return;\n      var rect = getRect(sortable),\n        insideHorizontally = x >= rect.left - threshold && x <= rect.right + threshold,\n        insideVertically = y >= rect.top - threshold && y <= rect.bottom + threshold;\n      if (insideHorizontally && insideVertically) {\n        return ret = sortable;\n      }\n    });\n    return ret;\n  },\n  _prepareGroup = function _prepareGroup(options) {\n    function toFn(value, pull) {\n      return function (to, from, dragEl, evt) {\n        var sameGroup = to.options.group.name && from.options.group.name && to.options.group.name === from.options.group.name;\n        if (value == null && (pull || sameGroup)) {\n          // Default pull value\n          // Default pull and put value if same group\n          return true;\n        } else if (value == null || value === false) {\n          return false;\n        } else if (pull && value === 'clone') {\n          return value;\n        } else if (typeof value === 'function') {\n          return toFn(value(to, from, dragEl, evt), pull)(to, from, dragEl, evt);\n        } else {\n          var otherGroup = (pull ? to : from).options.group.name;\n          return value === true || typeof value === 'string' && value === otherGroup || value.join && value.indexOf(otherGroup) > -1;\n        }\n      };\n    }\n    var group = {};\n    var originalGroup = options.group;\n    if (!originalGroup || _typeof(originalGroup) != 'object') {\n      originalGroup = {\n        name: originalGroup\n      };\n    }\n    group.name = originalGroup.name;\n    group.checkPull = toFn(originalGroup.pull, true);\n    group.checkPut = toFn(originalGroup.put);\n    group.revertClone = originalGroup.revertClone;\n    options.group = group;\n  },\n  _hideGhostForTarget = function _hideGhostForTarget() {\n    if (!supportCssPointerEvents && ghostEl) {\n      css(ghostEl, 'display', 'none');\n    }\n  },\n  _unhideGhostForTarget = function _unhideGhostForTarget() {\n    if (!supportCssPointerEvents && ghostEl) {\n      css(ghostEl, 'display', '');\n    }\n  };\n\n// #1184 fix - Prevent click event on fallback if dragged but item not changed position\nif (documentExists && !ChromeForAndroid) {\n  document.addEventListener('click', function (evt) {\n    if (ignoreNextClick) {\n      evt.preventDefault();\n      evt.stopPropagation && evt.stopPropagation();\n      evt.stopImmediatePropagation && evt.stopImmediatePropagation();\n      ignoreNextClick = false;\n      return false;\n    }\n  }, true);\n}\nvar nearestEmptyInsertDetectEvent = function nearestEmptyInsertDetectEvent(evt) {\n  if (dragEl) {\n    evt = evt.touches ? evt.touches[0] : evt;\n    var nearest = _detectNearestEmptySortable(evt.clientX, evt.clientY);\n    if (nearest) {\n      // Create imitation event\n      var event = {};\n      for (var i in evt) {\n        if (evt.hasOwnProperty(i)) {\n          event[i] = evt[i];\n        }\n      }\n      event.target = event.rootEl = nearest;\n      event.preventDefault = void 0;\n      event.stopPropagation = void 0;\n      nearest[expando]._onDragOver(event);\n    }\n  }\n};\nvar _checkOutsideTargetEl = function _checkOutsideTargetEl(evt) {\n  if (dragEl) {\n    dragEl.parentNode[expando]._isOutsideThisEl(evt.target);\n  }\n};\n\n/**\r\n * @class  Sortable\r\n * @param  {HTMLElement}  el\r\n * @param  {Object}       [options]\r\n */\nfunction Sortable(el, options) {\n  if (!(el && el.nodeType && el.nodeType === 1)) {\n    throw \"Sortable: `el` must be an HTMLElement, not \".concat({}.toString.call(el));\n  }\n  this.el = el; // root element\n  this.options = options = _extends({}, options);\n\n  // Export instance\n  el[expando] = this;\n  var defaults = {\n    group: null,\n    sort: true,\n    disabled: false,\n    store: null,\n    handle: null,\n    draggable: /^[uo]l$/i.test(el.nodeName) ? '>li' : '>*',\n    swapThreshold: 1,\n    // percentage; 0 <= x <= 1\n    invertSwap: false,\n    // invert always\n    invertedSwapThreshold: null,\n    // will be set to same as swapThreshold if default\n    removeCloneOnHide: true,\n    direction: function direction() {\n      return _detectDirection(el, this.options);\n    },\n    ghostClass: 'sortable-ghost',\n    chosenClass: 'sortable-chosen',\n    dragClass: 'sortable-drag',\n    ignore: 'a, img',\n    filter: null,\n    preventOnFilter: true,\n    animation: 0,\n    easing: null,\n    setData: function setData(dataTransfer, dragEl) {\n      dataTransfer.setData('Text', dragEl.textContent);\n    },\n    dropBubble: false,\n    dragoverBubble: false,\n    dataIdAttr: 'data-id',\n    delay: 0,\n    delayOnTouchOnly: false,\n    touchStartThreshold: (Number.parseInt ? Number : window).parseInt(window.devicePixelRatio, 10) || 1,\n    forceFallback: false,\n    fallbackClass: 'sortable-fallback',\n    fallbackOnBody: false,\n    fallbackTolerance: 0,\n    fallbackOffset: {\n      x: 0,\n      y: 0\n    },\n    supportPointer: Sortable.supportPointer !== false && 'PointerEvent' in window && !Safari,\n    emptyInsertThreshold: 5\n  };\n  PluginManager.initializePlugins(this, el, defaults);\n\n  // Set default options\n  for (var name in defaults) {\n    !(name in options) && (options[name] = defaults[name]);\n  }\n  _prepareGroup(options);\n\n  // Bind all private methods\n  for (var fn in this) {\n    if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n      this[fn] = this[fn].bind(this);\n    }\n  }\n\n  // Setup drag mode\n  this.nativeDraggable = options.forceFallback ? false : supportDraggable;\n  if (this.nativeDraggable) {\n    // Touch start threshold cannot be greater than the native dragstart threshold\n    this.options.touchStartThreshold = 1;\n  }\n\n  // Bind events\n  if (options.supportPointer) {\n    on(el, 'pointerdown', this._onTapStart);\n  } else {\n    on(el, 'mousedown', this._onTapStart);\n    on(el, 'touchstart', this._onTapStart);\n  }\n  if (this.nativeDraggable) {\n    on(el, 'dragover', this);\n    on(el, 'dragenter', this);\n  }\n  sortables.push(this.el);\n\n  // Restore sorting\n  options.store && options.store.get && this.sort(options.store.get(this) || []);\n\n  // Add animation state manager\n  _extends(this, AnimationStateManager());\n}\nSortable.prototype = /** @lends Sortable.prototype */{\n  constructor: Sortable,\n  _isOutsideThisEl: function _isOutsideThisEl(target) {\n    if (!this.el.contains(target) && target !== this.el) {\n      lastTarget = null;\n    }\n  },\n  _getDirection: function _getDirection(evt, target) {\n    return typeof this.options.direction === 'function' ? this.options.direction.call(this, evt, target, dragEl) : this.options.direction;\n  },\n  _onTapStart: function _onTapStart( /** Event|TouchEvent */evt) {\n    if (!evt.cancelable) return;\n    var _this = this,\n      el = this.el,\n      options = this.options,\n      preventOnFilter = options.preventOnFilter,\n      type = evt.type,\n      touch = evt.touches && evt.touches[0] || evt.pointerType && evt.pointerType === 'touch' && evt,\n      target = (touch || evt).target,\n      originalTarget = evt.target.shadowRoot && (evt.path && evt.path[0] || evt.composedPath && evt.composedPath()[0]) || target,\n      filter = options.filter;\n    _saveInputCheckedState(el);\n\n    // Don't trigger start event when an element is been dragged, otherwise the evt.oldindex always wrong when set option.group.\n    if (dragEl) {\n      return;\n    }\n    if (/mousedown|pointerdown/.test(type) && evt.button !== 0 || options.disabled) {\n      return; // only left button and enabled\n    }\n\n    // cancel dnd if original target is content editable\n    if (originalTarget.isContentEditable) {\n      return;\n    }\n\n    // Safari ignores further event handling after mousedown\n    if (!this.nativeDraggable && Safari && target && target.tagName.toUpperCase() === 'SELECT') {\n      return;\n    }\n    target = closest(target, options.draggable, el, false);\n    if (target && target.animated) {\n      return;\n    }\n    if (lastDownEl === target) {\n      // Ignoring duplicate `down`\n      return;\n    }\n\n    // Get the index of the dragged element within its parent\n    oldIndex = index(target);\n    oldDraggableIndex = index(target, options.draggable);\n\n    // Check filter\n    if (typeof filter === 'function') {\n      if (filter.call(this, evt, target, this)) {\n        _dispatchEvent({\n          sortable: _this,\n          rootEl: originalTarget,\n          name: 'filter',\n          targetEl: target,\n          toEl: el,\n          fromEl: el\n        });\n        pluginEvent('filter', _this, {\n          evt: evt\n        });\n        preventOnFilter && evt.cancelable && evt.preventDefault();\n        return; // cancel dnd\n      }\n    } else if (filter) {\n      filter = filter.split(',').some(function (criteria) {\n        criteria = closest(originalTarget, criteria.trim(), el, false);\n        if (criteria) {\n          _dispatchEvent({\n            sortable: _this,\n            rootEl: criteria,\n            name: 'filter',\n            targetEl: target,\n            fromEl: el,\n            toEl: el\n          });\n          pluginEvent('filter', _this, {\n            evt: evt\n          });\n          return true;\n        }\n      });\n      if (filter) {\n        preventOnFilter && evt.cancelable && evt.preventDefault();\n        return; // cancel dnd\n      }\n    }\n    if (options.handle && !closest(originalTarget, options.handle, el, false)) {\n      return;\n    }\n\n    // Prepare `dragstart`\n    this._prepareDragStart(evt, touch, target);\n  },\n  _prepareDragStart: function _prepareDragStart( /** Event */evt, /** Touch */touch, /** HTMLElement */target) {\n    var _this = this,\n      el = _this.el,\n      options = _this.options,\n      ownerDocument = el.ownerDocument,\n      dragStartFn;\n    if (target && !dragEl && target.parentNode === el) {\n      var dragRect = getRect(target);\n      rootEl = el;\n      dragEl = target;\n      parentEl = dragEl.parentNode;\n      nextEl = dragEl.nextSibling;\n      lastDownEl = target;\n      activeGroup = options.group;\n      Sortable.dragged = dragEl;\n      tapEvt = {\n        target: dragEl,\n        clientX: (touch || evt).clientX,\n        clientY: (touch || evt).clientY\n      };\n      tapDistanceLeft = tapEvt.clientX - dragRect.left;\n      tapDistanceTop = tapEvt.clientY - dragRect.top;\n      this._lastX = (touch || evt).clientX;\n      this._lastY = (touch || evt).clientY;\n      dragEl.style['will-change'] = 'all';\n      dragStartFn = function dragStartFn() {\n        pluginEvent('delayEnded', _this, {\n          evt: evt\n        });\n        if (Sortable.eventCanceled) {\n          _this._onDrop();\n          return;\n        }\n        // Delayed drag has been triggered\n        // we can re-enable the events: touchmove/mousemove\n        _this._disableDelayedDragEvents();\n        if (!FireFox && _this.nativeDraggable) {\n          dragEl.draggable = true;\n        }\n\n        // Bind the events: dragstart/dragend\n        _this._triggerDragStart(evt, touch);\n\n        // Drag start event\n        _dispatchEvent({\n          sortable: _this,\n          name: 'choose',\n          originalEvent: evt\n        });\n\n        // Chosen item\n        toggleClass(dragEl, options.chosenClass, true);\n      };\n\n      // Disable \"draggable\"\n      options.ignore.split(',').forEach(function (criteria) {\n        find(dragEl, criteria.trim(), _disableDraggable);\n      });\n      on(ownerDocument, 'dragover', nearestEmptyInsertDetectEvent);\n      on(ownerDocument, 'mousemove', nearestEmptyInsertDetectEvent);\n      on(ownerDocument, 'touchmove', nearestEmptyInsertDetectEvent);\n      on(ownerDocument, 'mouseup', _this._onDrop);\n      on(ownerDocument, 'touchend', _this._onDrop);\n      on(ownerDocument, 'touchcancel', _this._onDrop);\n\n      // Make dragEl draggable (must be before delay for FireFox)\n      if (FireFox && this.nativeDraggable) {\n        this.options.touchStartThreshold = 4;\n        dragEl.draggable = true;\n      }\n      pluginEvent('delayStart', this, {\n        evt: evt\n      });\n\n      // Delay is impossible for native DnD in Edge or IE\n      if (options.delay && (!options.delayOnTouchOnly || touch) && (!this.nativeDraggable || !(Edge || IE11OrLess))) {\n        if (Sortable.eventCanceled) {\n          this._onDrop();\n          return;\n        }\n        // If the user moves the pointer or let go the click or touch\n        // before the delay has been reached:\n        // disable the delayed drag\n        on(ownerDocument, 'mouseup', _this._disableDelayedDrag);\n        on(ownerDocument, 'touchend', _this._disableDelayedDrag);\n        on(ownerDocument, 'touchcancel', _this._disableDelayedDrag);\n        on(ownerDocument, 'mousemove', _this._delayedDragTouchMoveHandler);\n        on(ownerDocument, 'touchmove', _this._delayedDragTouchMoveHandler);\n        options.supportPointer && on(ownerDocument, 'pointermove', _this._delayedDragTouchMoveHandler);\n        _this._dragStartTimer = setTimeout(dragStartFn, options.delay);\n      } else {\n        dragStartFn();\n      }\n    }\n  },\n  _delayedDragTouchMoveHandler: function _delayedDragTouchMoveHandler( /** TouchEvent|PointerEvent **/e) {\n    var touch = e.touches ? e.touches[0] : e;\n    if (Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) >= Math.floor(this.options.touchStartThreshold / (this.nativeDraggable && window.devicePixelRatio || 1))) {\n      this._disableDelayedDrag();\n    }\n  },\n  _disableDelayedDrag: function _disableDelayedDrag() {\n    dragEl && _disableDraggable(dragEl);\n    clearTimeout(this._dragStartTimer);\n    this._disableDelayedDragEvents();\n  },\n  _disableDelayedDragEvents: function _disableDelayedDragEvents() {\n    var ownerDocument = this.el.ownerDocument;\n    off(ownerDocument, 'mouseup', this._disableDelayedDrag);\n    off(ownerDocument, 'touchend', this._disableDelayedDrag);\n    off(ownerDocument, 'touchcancel', this._disableDelayedDrag);\n    off(ownerDocument, 'mousemove', this._delayedDragTouchMoveHandler);\n    off(ownerDocument, 'touchmove', this._delayedDragTouchMoveHandler);\n    off(ownerDocument, 'pointermove', this._delayedDragTouchMoveHandler);\n  },\n  _triggerDragStart: function _triggerDragStart( /** Event */evt, /** Touch */touch) {\n    touch = touch || evt.pointerType == 'touch' && evt;\n    if (!this.nativeDraggable || touch) {\n      if (this.options.supportPointer) {\n        on(document, 'pointermove', this._onTouchMove);\n      } else if (touch) {\n        on(document, 'touchmove', this._onTouchMove);\n      } else {\n        on(document, 'mousemove', this._onTouchMove);\n      }\n    } else {\n      on(dragEl, 'dragend', this);\n      on(rootEl, 'dragstart', this._onDragStart);\n    }\n    try {\n      if (document.selection) {\n        // Timeout neccessary for IE9\n        _nextTick(function () {\n          document.selection.empty();\n        });\n      } else {\n        window.getSelection().removeAllRanges();\n      }\n    } catch (err) {}\n  },\n  _dragStarted: function _dragStarted(fallback, evt) {\n    awaitingDragStarted = false;\n    if (rootEl && dragEl) {\n      pluginEvent('dragStarted', this, {\n        evt: evt\n      });\n      if (this.nativeDraggable) {\n        on(document, 'dragover', _checkOutsideTargetEl);\n      }\n      var options = this.options;\n\n      // Apply effect\n      !fallback && toggleClass(dragEl, options.dragClass, false);\n      toggleClass(dragEl, options.ghostClass, true);\n      Sortable.active = this;\n      fallback && this._appendGhost();\n\n      // Drag start event\n      _dispatchEvent({\n        sortable: this,\n        name: 'start',\n        originalEvent: evt\n      });\n    } else {\n      this._nulling();\n    }\n  },\n  _emulateDragOver: function _emulateDragOver() {\n    if (touchEvt) {\n      this._lastX = touchEvt.clientX;\n      this._lastY = touchEvt.clientY;\n      _hideGhostForTarget();\n      var target = document.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n      var parent = target;\n      while (target && target.shadowRoot) {\n        target = target.shadowRoot.elementFromPoint(touchEvt.clientX, touchEvt.clientY);\n        if (target === parent) break;\n        parent = target;\n      }\n      dragEl.parentNode[expando]._isOutsideThisEl(target);\n      if (parent) {\n        do {\n          if (parent[expando]) {\n            var inserted = void 0;\n            inserted = parent[expando]._onDragOver({\n              clientX: touchEvt.clientX,\n              clientY: touchEvt.clientY,\n              target: target,\n              rootEl: parent\n            });\n            if (inserted && !this.options.dragoverBubble) {\n              break;\n            }\n          }\n          target = parent; // store last element\n        }\n        /* jshint boss:true */ while (parent = parent.parentNode);\n      }\n      _unhideGhostForTarget();\n    }\n  },\n  _onTouchMove: function _onTouchMove( /**TouchEvent*/evt) {\n    if (tapEvt) {\n      var options = this.options,\n        fallbackTolerance = options.fallbackTolerance,\n        fallbackOffset = options.fallbackOffset,\n        touch = evt.touches ? evt.touches[0] : evt,\n        ghostMatrix = ghostEl && matrix(ghostEl, true),\n        scaleX = ghostEl && ghostMatrix && ghostMatrix.a,\n        scaleY = ghostEl && ghostMatrix && ghostMatrix.d,\n        relativeScrollOffset = PositionGhostAbsolutely && ghostRelativeParent && getRelativeScrollOffset(ghostRelativeParent),\n        dx = (touch.clientX - tapEvt.clientX + fallbackOffset.x) / (scaleX || 1) + (relativeScrollOffset ? relativeScrollOffset[0] - ghostRelativeParentInitialScroll[0] : 0) / (scaleX || 1),\n        dy = (touch.clientY - tapEvt.clientY + fallbackOffset.y) / (scaleY || 1) + (relativeScrollOffset ? relativeScrollOffset[1] - ghostRelativeParentInitialScroll[1] : 0) / (scaleY || 1);\n\n      // only set the status to dragging, when we are actually dragging\n      if (!Sortable.active && !awaitingDragStarted) {\n        if (fallbackTolerance && Math.max(Math.abs(touch.clientX - this._lastX), Math.abs(touch.clientY - this._lastY)) < fallbackTolerance) {\n          return;\n        }\n        this._onDragStart(evt, true);\n      }\n      if (ghostEl) {\n        if (ghostMatrix) {\n          ghostMatrix.e += dx - (lastDx || 0);\n          ghostMatrix.f += dy - (lastDy || 0);\n        } else {\n          ghostMatrix = {\n            a: 1,\n            b: 0,\n            c: 0,\n            d: 1,\n            e: dx,\n            f: dy\n          };\n        }\n        var cssMatrix = \"matrix(\".concat(ghostMatrix.a, \",\").concat(ghostMatrix.b, \",\").concat(ghostMatrix.c, \",\").concat(ghostMatrix.d, \",\").concat(ghostMatrix.e, \",\").concat(ghostMatrix.f, \")\");\n        css(ghostEl, 'webkitTransform', cssMatrix);\n        css(ghostEl, 'mozTransform', cssMatrix);\n        css(ghostEl, 'msTransform', cssMatrix);\n        css(ghostEl, 'transform', cssMatrix);\n        lastDx = dx;\n        lastDy = dy;\n        touchEvt = touch;\n      }\n      evt.cancelable && evt.preventDefault();\n    }\n  },\n  _appendGhost: function _appendGhost() {\n    // Bug if using scale(): https://stackoverflow.com/questions/2637058\n    // Not being adjusted for\n    if (!ghostEl) {\n      var container = this.options.fallbackOnBody ? document.body : rootEl,\n        rect = getRect(dragEl, true, PositionGhostAbsolutely, true, container),\n        options = this.options;\n\n      // Position absolutely\n      if (PositionGhostAbsolutely) {\n        // Get relatively positioned parent\n        ghostRelativeParent = container;\n        while (css(ghostRelativeParent, 'position') === 'static' && css(ghostRelativeParent, 'transform') === 'none' && ghostRelativeParent !== document) {\n          ghostRelativeParent = ghostRelativeParent.parentNode;\n        }\n        if (ghostRelativeParent !== document.body && ghostRelativeParent !== document.documentElement) {\n          if (ghostRelativeParent === document) ghostRelativeParent = getWindowScrollingElement();\n          rect.top += ghostRelativeParent.scrollTop;\n          rect.left += ghostRelativeParent.scrollLeft;\n        } else {\n          ghostRelativeParent = getWindowScrollingElement();\n        }\n        ghostRelativeParentInitialScroll = getRelativeScrollOffset(ghostRelativeParent);\n      }\n      ghostEl = dragEl.cloneNode(true);\n      toggleClass(ghostEl, options.ghostClass, false);\n      toggleClass(ghostEl, options.fallbackClass, true);\n      toggleClass(ghostEl, options.dragClass, true);\n      css(ghostEl, 'transition', '');\n      css(ghostEl, 'transform', '');\n      css(ghostEl, 'box-sizing', 'border-box');\n      css(ghostEl, 'margin', 0);\n      css(ghostEl, 'top', rect.top);\n      css(ghostEl, 'left', rect.left);\n      css(ghostEl, 'width', rect.width);\n      css(ghostEl, 'height', rect.height);\n      css(ghostEl, 'opacity', '0.8');\n      css(ghostEl, 'position', PositionGhostAbsolutely ? 'absolute' : 'fixed');\n      css(ghostEl, 'zIndex', '100000');\n      css(ghostEl, 'pointerEvents', 'none');\n      Sortable.ghost = ghostEl;\n      container.appendChild(ghostEl);\n\n      // Set transform-origin\n      css(ghostEl, 'transform-origin', tapDistanceLeft / parseInt(ghostEl.style.width) * 100 + '% ' + tapDistanceTop / parseInt(ghostEl.style.height) * 100 + '%');\n    }\n  },\n  _onDragStart: function _onDragStart( /**Event*/evt, /**boolean*/fallback) {\n    var _this = this;\n    var dataTransfer = evt.dataTransfer;\n    var options = _this.options;\n    pluginEvent('dragStart', this, {\n      evt: evt\n    });\n    if (Sortable.eventCanceled) {\n      this._onDrop();\n      return;\n    }\n    pluginEvent('setupClone', this);\n    if (!Sortable.eventCanceled) {\n      cloneEl = clone(dragEl);\n      cloneEl.removeAttribute(\"id\");\n      cloneEl.draggable = false;\n      cloneEl.style['will-change'] = '';\n      this._hideClone();\n      toggleClass(cloneEl, this.options.chosenClass, false);\n      Sortable.clone = cloneEl;\n    }\n\n    // #1143: IFrame support workaround\n    _this.cloneId = _nextTick(function () {\n      pluginEvent('clone', _this);\n      if (Sortable.eventCanceled) return;\n      if (!_this.options.removeCloneOnHide) {\n        rootEl.insertBefore(cloneEl, dragEl);\n      }\n      _this._hideClone();\n      _dispatchEvent({\n        sortable: _this,\n        name: 'clone'\n      });\n    });\n    !fallback && toggleClass(dragEl, options.dragClass, true);\n\n    // Set proper drop events\n    if (fallback) {\n      ignoreNextClick = true;\n      _this._loopId = setInterval(_this._emulateDragOver, 50);\n    } else {\n      // Undo what was set in _prepareDragStart before drag started\n      off(document, 'mouseup', _this._onDrop);\n      off(document, 'touchend', _this._onDrop);\n      off(document, 'touchcancel', _this._onDrop);\n      if (dataTransfer) {\n        dataTransfer.effectAllowed = 'move';\n        options.setData && options.setData.call(_this, dataTransfer, dragEl);\n      }\n      on(document, 'drop', _this);\n\n      // #1276 fix:\n      css(dragEl, 'transform', 'translateZ(0)');\n    }\n    awaitingDragStarted = true;\n    _this._dragStartId = _nextTick(_this._dragStarted.bind(_this, fallback, evt));\n    on(document, 'selectstart', _this);\n    moved = true;\n    if (Safari) {\n      css(document.body, 'user-select', 'none');\n    }\n  },\n  // Returns true - if no further action is needed (either inserted or another condition)\n  _onDragOver: function _onDragOver( /**Event*/evt) {\n    var el = this.el,\n      target = evt.target,\n      dragRect,\n      targetRect,\n      revert,\n      options = this.options,\n      group = options.group,\n      activeSortable = Sortable.active,\n      isOwner = activeGroup === group,\n      canSort = options.sort,\n      fromSortable = putSortable || activeSortable,\n      vertical,\n      _this = this,\n      completedFired = false;\n    if (_silent) return;\n    function dragOverEvent(name, extra) {\n      pluginEvent(name, _this, _objectSpread2({\n        evt: evt,\n        isOwner: isOwner,\n        axis: vertical ? 'vertical' : 'horizontal',\n        revert: revert,\n        dragRect: dragRect,\n        targetRect: targetRect,\n        canSort: canSort,\n        fromSortable: fromSortable,\n        target: target,\n        completed: completed,\n        onMove: function onMove(target, after) {\n          return _onMove(rootEl, el, dragEl, dragRect, target, getRect(target), evt, after);\n        },\n        changed: changed\n      }, extra));\n    }\n\n    // Capture animation state\n    function capture() {\n      dragOverEvent('dragOverAnimationCapture');\n      _this.captureAnimationState();\n      if (_this !== fromSortable) {\n        fromSortable.captureAnimationState();\n      }\n    }\n\n    // Return invocation when dragEl is inserted (or completed)\n    function completed(insertion) {\n      dragOverEvent('dragOverCompleted', {\n        insertion: insertion\n      });\n      if (insertion) {\n        // Clones must be hidden before folding animation to capture dragRectAbsolute properly\n        if (isOwner) {\n          activeSortable._hideClone();\n        } else {\n          activeSortable._showClone(_this);\n        }\n        if (_this !== fromSortable) {\n          // Set ghost class to new sortable's ghost class\n          toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : activeSortable.options.ghostClass, false);\n          toggleClass(dragEl, options.ghostClass, true);\n        }\n        if (putSortable !== _this && _this !== Sortable.active) {\n          putSortable = _this;\n        } else if (_this === Sortable.active && putSortable) {\n          putSortable = null;\n        }\n\n        // Animation\n        if (fromSortable === _this) {\n          _this._ignoreWhileAnimating = target;\n        }\n        _this.animateAll(function () {\n          dragOverEvent('dragOverAnimationComplete');\n          _this._ignoreWhileAnimating = null;\n        });\n        if (_this !== fromSortable) {\n          fromSortable.animateAll();\n          fromSortable._ignoreWhileAnimating = null;\n        }\n      }\n\n      // Null lastTarget if it is not inside a previously swapped element\n      if (target === dragEl && !dragEl.animated || target === el && !target.animated) {\n        lastTarget = null;\n      }\n\n      // no bubbling and not fallback\n      if (!options.dragoverBubble && !evt.rootEl && target !== document) {\n        dragEl.parentNode[expando]._isOutsideThisEl(evt.target);\n\n        // Do not detect for empty insert if already inserted\n        !insertion && nearestEmptyInsertDetectEvent(evt);\n      }\n      !options.dragoverBubble && evt.stopPropagation && evt.stopPropagation();\n      return completedFired = true;\n    }\n\n    // Call when dragEl has been inserted\n    function changed() {\n      newIndex = index(dragEl);\n      newDraggableIndex = index(dragEl, options.draggable);\n      _dispatchEvent({\n        sortable: _this,\n        name: 'change',\n        toEl: el,\n        newIndex: newIndex,\n        newDraggableIndex: newDraggableIndex,\n        originalEvent: evt\n      });\n    }\n    if (evt.preventDefault !== void 0) {\n      evt.cancelable && evt.preventDefault();\n    }\n    target = closest(target, options.draggable, el, true);\n    dragOverEvent('dragOver');\n    if (Sortable.eventCanceled) return completedFired;\n    if (dragEl.contains(evt.target) || target.animated && target.animatingX && target.animatingY || _this._ignoreWhileAnimating === target) {\n      return completed(false);\n    }\n    ignoreNextClick = false;\n    if (activeSortable && !options.disabled && (isOwner ? canSort || (revert = parentEl !== rootEl) // Reverting item into the original list\n    : putSortable === this || (this.lastPutMode = activeGroup.checkPull(this, activeSortable, dragEl, evt)) && group.checkPut(this, activeSortable, dragEl, evt))) {\n      vertical = this._getDirection(evt, target) === 'vertical';\n      dragRect = getRect(dragEl);\n      dragOverEvent('dragOverValid');\n      if (Sortable.eventCanceled) return completedFired;\n      if (revert) {\n        parentEl = rootEl; // actualization\n        capture();\n        this._hideClone();\n        dragOverEvent('revert');\n        if (!Sortable.eventCanceled) {\n          if (nextEl) {\n            rootEl.insertBefore(dragEl, nextEl);\n          } else {\n            rootEl.appendChild(dragEl);\n          }\n        }\n        return completed(true);\n      }\n      var elLastChild = lastChild(el, options.draggable);\n      if (!elLastChild || _ghostIsLast(evt, vertical, this) && !elLastChild.animated) {\n        // Insert to end of list\n\n        // If already at end of list: Do not insert\n        if (elLastChild === dragEl) {\n          return completed(false);\n        }\n\n        // if there is a last element, it is the target\n        if (elLastChild && el === evt.target) {\n          target = elLastChild;\n        }\n        if (target) {\n          targetRect = getRect(target);\n        }\n        if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, !!target) !== false) {\n          capture();\n          if (elLastChild && elLastChild.nextSibling) {\n            // the last draggable element is not the last node\n            el.insertBefore(dragEl, elLastChild.nextSibling);\n          } else {\n            el.appendChild(dragEl);\n          }\n          parentEl = el; // actualization\n\n          changed();\n          return completed(true);\n        }\n      } else if (elLastChild && _ghostIsFirst(evt, vertical, this)) {\n        // Insert to start of list\n        var firstChild = getChild(el, 0, options, true);\n        if (firstChild === dragEl) {\n          return completed(false);\n        }\n        target = firstChild;\n        targetRect = getRect(target);\n        if (_onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, false) !== false) {\n          capture();\n          el.insertBefore(dragEl, firstChild);\n          parentEl = el; // actualization\n\n          changed();\n          return completed(true);\n        }\n      } else if (target.parentNode === el) {\n        targetRect = getRect(target);\n        var direction = 0,\n          targetBeforeFirstSwap,\n          differentLevel = dragEl.parentNode !== el,\n          differentRowCol = !_dragElInRowColumn(dragEl.animated && dragEl.toRect || dragRect, target.animated && target.toRect || targetRect, vertical),\n          side1 = vertical ? 'top' : 'left',\n          scrolledPastTop = isScrolledPast(target, 'top', 'top') || isScrolledPast(dragEl, 'top', 'top'),\n          scrollBefore = scrolledPastTop ? scrolledPastTop.scrollTop : void 0;\n        if (lastTarget !== target) {\n          targetBeforeFirstSwap = targetRect[side1];\n          pastFirstInvertThresh = false;\n          isCircumstantialInvert = !differentRowCol && options.invertSwap || differentLevel;\n        }\n        direction = _getSwapDirection(evt, target, targetRect, vertical, differentRowCol ? 1 : options.swapThreshold, options.invertedSwapThreshold == null ? options.swapThreshold : options.invertedSwapThreshold, isCircumstantialInvert, lastTarget === target);\n        var sibling;\n        if (direction !== 0) {\n          // Check if target is beside dragEl in respective direction (ignoring hidden elements)\n          var dragIndex = index(dragEl);\n          do {\n            dragIndex -= direction;\n            sibling = parentEl.children[dragIndex];\n          } while (sibling && (css(sibling, 'display') === 'none' || sibling === ghostEl));\n        }\n        // If dragEl is already beside target: Do not insert\n        if (direction === 0 || sibling === target) {\n          return completed(false);\n        }\n        lastTarget = target;\n        lastDirection = direction;\n        var nextSibling = target.nextElementSibling,\n          after = false;\n        after = direction === 1;\n        var moveVector = _onMove(rootEl, el, dragEl, dragRect, target, targetRect, evt, after);\n        if (moveVector !== false) {\n          if (moveVector === 1 || moveVector === -1) {\n            after = moveVector === 1;\n          }\n          _silent = true;\n          setTimeout(_unsilent, 30);\n          capture();\n          if (after && !nextSibling) {\n            el.appendChild(dragEl);\n          } else {\n            target.parentNode.insertBefore(dragEl, after ? nextSibling : target);\n          }\n\n          // Undo chrome's scroll adjustment (has no effect on other browsers)\n          if (scrolledPastTop) {\n            scrollBy(scrolledPastTop, 0, scrollBefore - scrolledPastTop.scrollTop);\n          }\n          parentEl = dragEl.parentNode; // actualization\n\n          // must be done before animation\n          if (targetBeforeFirstSwap !== undefined && !isCircumstantialInvert) {\n            targetMoveDistance = Math.abs(targetBeforeFirstSwap - getRect(target)[side1]);\n          }\n          changed();\n          return completed(true);\n        }\n      }\n      if (el.contains(dragEl)) {\n        return completed(false);\n      }\n    }\n    return false;\n  },\n  _ignoreWhileAnimating: null,\n  _offMoveEvents: function _offMoveEvents() {\n    off(document, 'mousemove', this._onTouchMove);\n    off(document, 'touchmove', this._onTouchMove);\n    off(document, 'pointermove', this._onTouchMove);\n    off(document, 'dragover', nearestEmptyInsertDetectEvent);\n    off(document, 'mousemove', nearestEmptyInsertDetectEvent);\n    off(document, 'touchmove', nearestEmptyInsertDetectEvent);\n  },\n  _offUpEvents: function _offUpEvents() {\n    var ownerDocument = this.el.ownerDocument;\n    off(ownerDocument, 'mouseup', this._onDrop);\n    off(ownerDocument, 'touchend', this._onDrop);\n    off(ownerDocument, 'pointerup', this._onDrop);\n    off(ownerDocument, 'touchcancel', this._onDrop);\n    off(document, 'selectstart', this);\n  },\n  _onDrop: function _onDrop( /**Event*/evt) {\n    var el = this.el,\n      options = this.options;\n\n    // Get the index of the dragged element within its parent\n    newIndex = index(dragEl);\n    newDraggableIndex = index(dragEl, options.draggable);\n    pluginEvent('drop', this, {\n      evt: evt\n    });\n    parentEl = dragEl && dragEl.parentNode;\n\n    // Get again after plugin event\n    newIndex = index(dragEl);\n    newDraggableIndex = index(dragEl, options.draggable);\n    if (Sortable.eventCanceled) {\n      this._nulling();\n      return;\n    }\n    awaitingDragStarted = false;\n    isCircumstantialInvert = false;\n    pastFirstInvertThresh = false;\n    clearInterval(this._loopId);\n    clearTimeout(this._dragStartTimer);\n    _cancelNextTick(this.cloneId);\n    _cancelNextTick(this._dragStartId);\n\n    // Unbind events\n    if (this.nativeDraggable) {\n      off(document, 'drop', this);\n      off(el, 'dragstart', this._onDragStart);\n    }\n    this._offMoveEvents();\n    this._offUpEvents();\n    if (Safari) {\n      css(document.body, 'user-select', '');\n    }\n    css(dragEl, 'transform', '');\n    if (evt) {\n      if (moved) {\n        evt.cancelable && evt.preventDefault();\n        !options.dropBubble && evt.stopPropagation();\n      }\n      ghostEl && ghostEl.parentNode && ghostEl.parentNode.removeChild(ghostEl);\n      if (rootEl === parentEl || putSortable && putSortable.lastPutMode !== 'clone') {\n        // Remove clone(s)\n        cloneEl && cloneEl.parentNode && cloneEl.parentNode.removeChild(cloneEl);\n      }\n      if (dragEl) {\n        if (this.nativeDraggable) {\n          off(dragEl, 'dragend', this);\n        }\n        _disableDraggable(dragEl);\n        dragEl.style['will-change'] = '';\n\n        // Remove classes\n        // ghostClass is added in dragStarted\n        if (moved && !awaitingDragStarted) {\n          toggleClass(dragEl, putSortable ? putSortable.options.ghostClass : this.options.ghostClass, false);\n        }\n        toggleClass(dragEl, this.options.chosenClass, false);\n\n        // Drag stop event\n        _dispatchEvent({\n          sortable: this,\n          name: 'unchoose',\n          toEl: parentEl,\n          newIndex: null,\n          newDraggableIndex: null,\n          originalEvent: evt\n        });\n        if (rootEl !== parentEl) {\n          if (newIndex >= 0) {\n            // Add event\n            _dispatchEvent({\n              rootEl: parentEl,\n              name: 'add',\n              toEl: parentEl,\n              fromEl: rootEl,\n              originalEvent: evt\n            });\n\n            // Remove event\n            _dispatchEvent({\n              sortable: this,\n              name: 'remove',\n              toEl: parentEl,\n              originalEvent: evt\n            });\n\n            // drag from one list and drop into another\n            _dispatchEvent({\n              rootEl: parentEl,\n              name: 'sort',\n              toEl: parentEl,\n              fromEl: rootEl,\n              originalEvent: evt\n            });\n            _dispatchEvent({\n              sortable: this,\n              name: 'sort',\n              toEl: parentEl,\n              originalEvent: evt\n            });\n          }\n          putSortable && putSortable.save();\n        } else {\n          if (newIndex !== oldIndex) {\n            if (newIndex >= 0) {\n              // drag & drop within the same list\n              _dispatchEvent({\n                sortable: this,\n                name: 'update',\n                toEl: parentEl,\n                originalEvent: evt\n              });\n              _dispatchEvent({\n                sortable: this,\n                name: 'sort',\n                toEl: parentEl,\n                originalEvent: evt\n              });\n            }\n          }\n        }\n        if (Sortable.active) {\n          /* jshint eqnull:true */\n          if (newIndex == null || newIndex === -1) {\n            newIndex = oldIndex;\n            newDraggableIndex = oldDraggableIndex;\n          }\n          _dispatchEvent({\n            sortable: this,\n            name: 'end',\n            toEl: parentEl,\n            originalEvent: evt\n          });\n\n          // Save sorting\n          this.save();\n        }\n      }\n    }\n    this._nulling();\n  },\n  _nulling: function _nulling() {\n    pluginEvent('nulling', this);\n    rootEl = dragEl = parentEl = ghostEl = nextEl = cloneEl = lastDownEl = cloneHidden = tapEvt = touchEvt = moved = newIndex = newDraggableIndex = oldIndex = oldDraggableIndex = lastTarget = lastDirection = putSortable = activeGroup = Sortable.dragged = Sortable.ghost = Sortable.clone = Sortable.active = null;\n    savedInputChecked.forEach(function (el) {\n      el.checked = true;\n    });\n    savedInputChecked.length = lastDx = lastDy = 0;\n  },\n  handleEvent: function handleEvent( /**Event*/evt) {\n    switch (evt.type) {\n      case 'drop':\n      case 'dragend':\n        this._onDrop(evt);\n        break;\n      case 'dragenter':\n      case 'dragover':\n        if (dragEl) {\n          this._onDragOver(evt);\n          _globalDragOver(evt);\n        }\n        break;\n      case 'selectstart':\n        evt.preventDefault();\n        break;\n    }\n  },\n  /**\r\n   * Serializes the item into an array of string.\r\n   * @returns {String[]}\r\n   */\n  toArray: function toArray() {\n    var order = [],\n      el,\n      children = this.el.children,\n      i = 0,\n      n = children.length,\n      options = this.options;\n    for (; i < n; i++) {\n      el = children[i];\n      if (closest(el, options.draggable, this.el, false)) {\n        order.push(el.getAttribute(options.dataIdAttr) || _generateId(el));\n      }\n    }\n    return order;\n  },\n  /**\r\n   * Sorts the elements according to the array.\r\n   * @param  {String[]}  order  order of the items\r\n   */\n  sort: function sort(order, useAnimation) {\n    var items = {},\n      rootEl = this.el;\n    this.toArray().forEach(function (id, i) {\n      var el = rootEl.children[i];\n      if (closest(el, this.options.draggable, rootEl, false)) {\n        items[id] = el;\n      }\n    }, this);\n    useAnimation && this.captureAnimationState();\n    order.forEach(function (id) {\n      if (items[id]) {\n        rootEl.removeChild(items[id]);\n        rootEl.appendChild(items[id]);\n      }\n    });\n    useAnimation && this.animateAll();\n  },\n  /**\r\n   * Save the current sorting\r\n   */\n  save: function save() {\n    var store = this.options.store;\n    store && store.set && store.set(this);\n  },\n  /**\r\n   * For each element in the set, get the first element that matches the selector by testing the element itself and traversing up through its ancestors in the DOM tree.\r\n   * @param   {HTMLElement}  el\r\n   * @param   {String}       [selector]  default: `options.draggable`\r\n   * @returns {HTMLElement|null}\r\n   */\n  closest: function closest$1(el, selector) {\n    return closest(el, selector || this.options.draggable, this.el, false);\n  },\n  /**\r\n   * Set/get option\r\n   * @param   {string} name\r\n   * @param   {*}      [value]\r\n   * @returns {*}\r\n   */\n  option: function option(name, value) {\n    var options = this.options;\n    if (value === void 0) {\n      return options[name];\n    } else {\n      var modifiedValue = PluginManager.modifyOption(this, name, value);\n      if (typeof modifiedValue !== 'undefined') {\n        options[name] = modifiedValue;\n      } else {\n        options[name] = value;\n      }\n      if (name === 'group') {\n        _prepareGroup(options);\n      }\n    }\n  },\n  /**\r\n   * Destroy\r\n   */\n  destroy: function destroy() {\n    pluginEvent('destroy', this);\n    var el = this.el;\n    el[expando] = null;\n    off(el, 'mousedown', this._onTapStart);\n    off(el, 'touchstart', this._onTapStart);\n    off(el, 'pointerdown', this._onTapStart);\n    if (this.nativeDraggable) {\n      off(el, 'dragover', this);\n      off(el, 'dragenter', this);\n    }\n    // Remove draggable attributes\n    Array.prototype.forEach.call(el.querySelectorAll('[draggable]'), function (el) {\n      el.removeAttribute('draggable');\n    });\n    this._onDrop();\n    this._disableDelayedDragEvents();\n    sortables.splice(sortables.indexOf(this.el), 1);\n    this.el = el = null;\n  },\n  _hideClone: function _hideClone() {\n    if (!cloneHidden) {\n      pluginEvent('hideClone', this);\n      if (Sortable.eventCanceled) return;\n      css(cloneEl, 'display', 'none');\n      if (this.options.removeCloneOnHide && cloneEl.parentNode) {\n        cloneEl.parentNode.removeChild(cloneEl);\n      }\n      cloneHidden = true;\n    }\n  },\n  _showClone: function _showClone(putSortable) {\n    if (putSortable.lastPutMode !== 'clone') {\n      this._hideClone();\n      return;\n    }\n    if (cloneHidden) {\n      pluginEvent('showClone', this);\n      if (Sortable.eventCanceled) return;\n\n      // show clone at dragEl or original position\n      if (dragEl.parentNode == rootEl && !this.options.group.revertClone) {\n        rootEl.insertBefore(cloneEl, dragEl);\n      } else if (nextEl) {\n        rootEl.insertBefore(cloneEl, nextEl);\n      } else {\n        rootEl.appendChild(cloneEl);\n      }\n      if (this.options.group.revertClone) {\n        this.animate(dragEl, cloneEl);\n      }\n      css(cloneEl, 'display', '');\n      cloneHidden = false;\n    }\n  }\n};\nfunction _globalDragOver( /**Event*/evt) {\n  if (evt.dataTransfer) {\n    evt.dataTransfer.dropEffect = 'move';\n  }\n  evt.cancelable && evt.preventDefault();\n}\nfunction _onMove(fromEl, toEl, dragEl, dragRect, targetEl, targetRect, originalEvent, willInsertAfter) {\n  var evt,\n    sortable = fromEl[expando],\n    onMoveFn = sortable.options.onMove,\n    retVal;\n  // Support for new CustomEvent feature\n  if (window.CustomEvent && !IE11OrLess && !Edge) {\n    evt = new CustomEvent('move', {\n      bubbles: true,\n      cancelable: true\n    });\n  } else {\n    evt = document.createEvent('Event');\n    evt.initEvent('move', true, true);\n  }\n  evt.to = toEl;\n  evt.from = fromEl;\n  evt.dragged = dragEl;\n  evt.draggedRect = dragRect;\n  evt.related = targetEl || toEl;\n  evt.relatedRect = targetRect || getRect(toEl);\n  evt.willInsertAfter = willInsertAfter;\n  evt.originalEvent = originalEvent;\n  fromEl.dispatchEvent(evt);\n  if (onMoveFn) {\n    retVal = onMoveFn.call(sortable, evt, originalEvent);\n  }\n  return retVal;\n}\nfunction _disableDraggable(el) {\n  el.draggable = false;\n}\nfunction _unsilent() {\n  _silent = false;\n}\nfunction _ghostIsFirst(evt, vertical, sortable) {\n  var firstElRect = getRect(getChild(sortable.el, 0, sortable.options, true));\n  var childContainingRect = getChildContainingRectFromElement(sortable.el, sortable.options, ghostEl);\n  var spacer = 10;\n  return vertical ? evt.clientX < childContainingRect.left - spacer || evt.clientY < firstElRect.top && evt.clientX < firstElRect.right : evt.clientY < childContainingRect.top - spacer || evt.clientY < firstElRect.bottom && evt.clientX < firstElRect.left;\n}\nfunction _ghostIsLast(evt, vertical, sortable) {\n  var lastElRect = getRect(lastChild(sortable.el, sortable.options.draggable));\n  var childContainingRect = getChildContainingRectFromElement(sortable.el, sortable.options, ghostEl);\n  var spacer = 10;\n  return vertical ? evt.clientX > childContainingRect.right + spacer || evt.clientY > lastElRect.bottom && evt.clientX > lastElRect.left : evt.clientY > childContainingRect.bottom + spacer || evt.clientX > lastElRect.right && evt.clientY > lastElRect.top;\n}\nfunction _getSwapDirection(evt, target, targetRect, vertical, swapThreshold, invertedSwapThreshold, invertSwap, isLastTarget) {\n  var mouseOnAxis = vertical ? evt.clientY : evt.clientX,\n    targetLength = vertical ? targetRect.height : targetRect.width,\n    targetS1 = vertical ? targetRect.top : targetRect.left,\n    targetS2 = vertical ? targetRect.bottom : targetRect.right,\n    invert = false;\n  if (!invertSwap) {\n    // Never invert or create dragEl shadow when target movemenet causes mouse to move past the end of regular swapThreshold\n    if (isLastTarget && targetMoveDistance < targetLength * swapThreshold) {\n      // multiplied only by swapThreshold because mouse will already be inside target by (1 - threshold) * targetLength / 2\n      // check if past first invert threshold on side opposite of lastDirection\n      if (!pastFirstInvertThresh && (lastDirection === 1 ? mouseOnAxis > targetS1 + targetLength * invertedSwapThreshold / 2 : mouseOnAxis < targetS2 - targetLength * invertedSwapThreshold / 2)) {\n        // past first invert threshold, do not restrict inverted threshold to dragEl shadow\n        pastFirstInvertThresh = true;\n      }\n      if (!pastFirstInvertThresh) {\n        // dragEl shadow (target move distance shadow)\n        if (lastDirection === 1 ? mouseOnAxis < targetS1 + targetMoveDistance // over dragEl shadow\n        : mouseOnAxis > targetS2 - targetMoveDistance) {\n          return -lastDirection;\n        }\n      } else {\n        invert = true;\n      }\n    } else {\n      // Regular\n      if (mouseOnAxis > targetS1 + targetLength * (1 - swapThreshold) / 2 && mouseOnAxis < targetS2 - targetLength * (1 - swapThreshold) / 2) {\n        return _getInsertDirection(target);\n      }\n    }\n  }\n  invert = invert || invertSwap;\n  if (invert) {\n    // Invert of regular\n    if (mouseOnAxis < targetS1 + targetLength * invertedSwapThreshold / 2 || mouseOnAxis > targetS2 - targetLength * invertedSwapThreshold / 2) {\n      return mouseOnAxis > targetS1 + targetLength / 2 ? 1 : -1;\n    }\n  }\n  return 0;\n}\n\n/**\r\n * Gets the direction dragEl must be swapped relative to target in order to make it\r\n * seem that dragEl has been \"inserted\" into that element's position\r\n * @param  {HTMLElement} target       The target whose position dragEl is being inserted at\r\n * @return {Number}                   Direction dragEl must be swapped\r\n */\nfunction _getInsertDirection(target) {\n  if (index(dragEl) < index(target)) {\n    return 1;\n  } else {\n    return -1;\n  }\n}\n\n/**\r\n * Generate id\r\n * @param   {HTMLElement} el\r\n * @returns {String}\r\n * @private\r\n */\nfunction _generateId(el) {\n  var str = el.tagName + el.className + el.src + el.href + el.textContent,\n    i = str.length,\n    sum = 0;\n  while (i--) {\n    sum += str.charCodeAt(i);\n  }\n  return sum.toString(36);\n}\nfunction _saveInputCheckedState(root) {\n  savedInputChecked.length = 0;\n  var inputs = root.getElementsByTagName('input');\n  var idx = inputs.length;\n  while (idx--) {\n    var el = inputs[idx];\n    el.checked && savedInputChecked.push(el);\n  }\n}\nfunction _nextTick(fn) {\n  return setTimeout(fn, 0);\n}\nfunction _cancelNextTick(id) {\n  return clearTimeout(id);\n}\n\n// Fixed #973:\nif (documentExists) {\n  on(document, 'touchmove', function (evt) {\n    if ((Sortable.active || awaitingDragStarted) && evt.cancelable) {\n      evt.preventDefault();\n    }\n  });\n}\n\n// Export utils\nSortable.utils = {\n  on: on,\n  off: off,\n  css: css,\n  find: find,\n  is: function is(el, selector) {\n    return !!closest(el, selector, el, false);\n  },\n  extend: extend,\n  throttle: throttle,\n  closest: closest,\n  toggleClass: toggleClass,\n  clone: clone,\n  index: index,\n  nextTick: _nextTick,\n  cancelNextTick: _cancelNextTick,\n  detectDirection: _detectDirection,\n  getChild: getChild\n};\n\n/**\r\n * Get the Sortable instance of an element\r\n * @param  {HTMLElement} element The element\r\n * @return {Sortable|undefined}         The instance of Sortable\r\n */\nSortable.get = function (element) {\n  return element[expando];\n};\n\n/**\r\n * Mount a plugin to Sortable\r\n * @param  {...SortablePlugin|SortablePlugin[]} plugins       Plugins being mounted\r\n */\nSortable.mount = function () {\n  for (var _len = arguments.length, plugins = new Array(_len), _key = 0; _key < _len; _key++) {\n    plugins[_key] = arguments[_key];\n  }\n  if (plugins[0].constructor === Array) plugins = plugins[0];\n  plugins.forEach(function (plugin) {\n    if (!plugin.prototype || !plugin.prototype.constructor) {\n      throw \"Sortable: Mounted plugin must be a constructor function, not \".concat({}.toString.call(plugin));\n    }\n    if (plugin.utils) Sortable.utils = _objectSpread2(_objectSpread2({}, Sortable.utils), plugin.utils);\n    PluginManager.mount(plugin);\n  });\n};\n\n/**\r\n * Create sortable instance\r\n * @param {HTMLElement}  el\r\n * @param {Object}      [options]\r\n */\nSortable.create = function (el, options) {\n  return new Sortable(el, options);\n};\n\n// Export\nSortable.version = version;\n\nvar autoScrolls = [],\n  scrollEl,\n  scrollRootEl,\n  scrolling = false,\n  lastAutoScrollX,\n  lastAutoScrollY,\n  touchEvt$1,\n  pointerElemChangedInterval;\nfunction AutoScrollPlugin() {\n  function AutoScroll() {\n    this.defaults = {\n      scroll: true,\n      forceAutoScrollFallback: false,\n      scrollSensitivity: 30,\n      scrollSpeed: 10,\n      bubbleScroll: true\n    };\n\n    // Bind all private methods\n    for (var fn in this) {\n      if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n        this[fn] = this[fn].bind(this);\n      }\n    }\n  }\n  AutoScroll.prototype = {\n    dragStarted: function dragStarted(_ref) {\n      var originalEvent = _ref.originalEvent;\n      if (this.sortable.nativeDraggable) {\n        on(document, 'dragover', this._handleAutoScroll);\n      } else {\n        if (this.options.supportPointer) {\n          on(document, 'pointermove', this._handleFallbackAutoScroll);\n        } else if (originalEvent.touches) {\n          on(document, 'touchmove', this._handleFallbackAutoScroll);\n        } else {\n          on(document, 'mousemove', this._handleFallbackAutoScroll);\n        }\n      }\n    },\n    dragOverCompleted: function dragOverCompleted(_ref2) {\n      var originalEvent = _ref2.originalEvent;\n      // For when bubbling is canceled and using fallback (fallback 'touchmove' always reached)\n      if (!this.options.dragOverBubble && !originalEvent.rootEl) {\n        this._handleAutoScroll(originalEvent);\n      }\n    },\n    drop: function drop() {\n      if (this.sortable.nativeDraggable) {\n        off(document, 'dragover', this._handleAutoScroll);\n      } else {\n        off(document, 'pointermove', this._handleFallbackAutoScroll);\n        off(document, 'touchmove', this._handleFallbackAutoScroll);\n        off(document, 'mousemove', this._handleFallbackAutoScroll);\n      }\n      clearPointerElemChangedInterval();\n      clearAutoScrolls();\n      cancelThrottle();\n    },\n    nulling: function nulling() {\n      touchEvt$1 = scrollRootEl = scrollEl = scrolling = pointerElemChangedInterval = lastAutoScrollX = lastAutoScrollY = null;\n      autoScrolls.length = 0;\n    },\n    _handleFallbackAutoScroll: function _handleFallbackAutoScroll(evt) {\n      this._handleAutoScroll(evt, true);\n    },\n    _handleAutoScroll: function _handleAutoScroll(evt, fallback) {\n      var _this = this;\n      var x = (evt.touches ? evt.touches[0] : evt).clientX,\n        y = (evt.touches ? evt.touches[0] : evt).clientY,\n        elem = document.elementFromPoint(x, y);\n      touchEvt$1 = evt;\n\n      // IE does not seem to have native autoscroll,\n      // Edge's autoscroll seems too conditional,\n      // MACOS Safari does not have autoscroll,\n      // Firefox and Chrome are good\n      if (fallback || this.options.forceAutoScrollFallback || Edge || IE11OrLess || Safari) {\n        autoScroll(evt, this.options, elem, fallback);\n\n        // Listener for pointer element change\n        var ogElemScroller = getParentAutoScrollElement(elem, true);\n        if (scrolling && (!pointerElemChangedInterval || x !== lastAutoScrollX || y !== lastAutoScrollY)) {\n          pointerElemChangedInterval && clearPointerElemChangedInterval();\n          // Detect for pointer elem change, emulating native DnD behaviour\n          pointerElemChangedInterval = setInterval(function () {\n            var newElem = getParentAutoScrollElement(document.elementFromPoint(x, y), true);\n            if (newElem !== ogElemScroller) {\n              ogElemScroller = newElem;\n              clearAutoScrolls();\n            }\n            autoScroll(evt, _this.options, newElem, fallback);\n          }, 10);\n          lastAutoScrollX = x;\n          lastAutoScrollY = y;\n        }\n      } else {\n        // if DnD is enabled (and browser has good autoscrolling), first autoscroll will already scroll, so get parent autoscroll of first autoscroll\n        if (!this.options.bubbleScroll || getParentAutoScrollElement(elem, true) === getWindowScrollingElement()) {\n          clearAutoScrolls();\n          return;\n        }\n        autoScroll(evt, this.options, getParentAutoScrollElement(elem, false), false);\n      }\n    }\n  };\n  return _extends(AutoScroll, {\n    pluginName: 'scroll',\n    initializeByDefault: true\n  });\n}\nfunction clearAutoScrolls() {\n  autoScrolls.forEach(function (autoScroll) {\n    clearInterval(autoScroll.pid);\n  });\n  autoScrolls = [];\n}\nfunction clearPointerElemChangedInterval() {\n  clearInterval(pointerElemChangedInterval);\n}\nvar autoScroll = throttle(function (evt, options, rootEl, isFallback) {\n  // Bug: https://bugzilla.mozilla.org/show_bug.cgi?id=505521\n  if (!options.scroll) return;\n  var x = (evt.touches ? evt.touches[0] : evt).clientX,\n    y = (evt.touches ? evt.touches[0] : evt).clientY,\n    sens = options.scrollSensitivity,\n    speed = options.scrollSpeed,\n    winScroller = getWindowScrollingElement();\n  var scrollThisInstance = false,\n    scrollCustomFn;\n\n  // New scroll root, set scrollEl\n  if (scrollRootEl !== rootEl) {\n    scrollRootEl = rootEl;\n    clearAutoScrolls();\n    scrollEl = options.scroll;\n    scrollCustomFn = options.scrollFn;\n    if (scrollEl === true) {\n      scrollEl = getParentAutoScrollElement(rootEl, true);\n    }\n  }\n  var layersOut = 0;\n  var currentParent = scrollEl;\n  do {\n    var el = currentParent,\n      rect = getRect(el),\n      top = rect.top,\n      bottom = rect.bottom,\n      left = rect.left,\n      right = rect.right,\n      width = rect.width,\n      height = rect.height,\n      canScrollX = void 0,\n      canScrollY = void 0,\n      scrollWidth = el.scrollWidth,\n      scrollHeight = el.scrollHeight,\n      elCSS = css(el),\n      scrollPosX = el.scrollLeft,\n      scrollPosY = el.scrollTop;\n    if (el === winScroller) {\n      canScrollX = width < scrollWidth && (elCSS.overflowX === 'auto' || elCSS.overflowX === 'scroll' || elCSS.overflowX === 'visible');\n      canScrollY = height < scrollHeight && (elCSS.overflowY === 'auto' || elCSS.overflowY === 'scroll' || elCSS.overflowY === 'visible');\n    } else {\n      canScrollX = width < scrollWidth && (elCSS.overflowX === 'auto' || elCSS.overflowX === 'scroll');\n      canScrollY = height < scrollHeight && (elCSS.overflowY === 'auto' || elCSS.overflowY === 'scroll');\n    }\n    var vx = canScrollX && (Math.abs(right - x) <= sens && scrollPosX + width < scrollWidth) - (Math.abs(left - x) <= sens && !!scrollPosX);\n    var vy = canScrollY && (Math.abs(bottom - y) <= sens && scrollPosY + height < scrollHeight) - (Math.abs(top - y) <= sens && !!scrollPosY);\n    if (!autoScrolls[layersOut]) {\n      for (var i = 0; i <= layersOut; i++) {\n        if (!autoScrolls[i]) {\n          autoScrolls[i] = {};\n        }\n      }\n    }\n    if (autoScrolls[layersOut].vx != vx || autoScrolls[layersOut].vy != vy || autoScrolls[layersOut].el !== el) {\n      autoScrolls[layersOut].el = el;\n      autoScrolls[layersOut].vx = vx;\n      autoScrolls[layersOut].vy = vy;\n      clearInterval(autoScrolls[layersOut].pid);\n      if (vx != 0 || vy != 0) {\n        scrollThisInstance = true;\n        /* jshint loopfunc:true */\n        autoScrolls[layersOut].pid = setInterval(function () {\n          // emulate drag over during autoscroll (fallback), emulating native DnD behaviour\n          if (isFallback && this.layer === 0) {\n            Sortable.active._onTouchMove(touchEvt$1); // To move ghost if it is positioned absolutely\n          }\n          var scrollOffsetY = autoScrolls[this.layer].vy ? autoScrolls[this.layer].vy * speed : 0;\n          var scrollOffsetX = autoScrolls[this.layer].vx ? autoScrolls[this.layer].vx * speed : 0;\n          if (typeof scrollCustomFn === 'function') {\n            if (scrollCustomFn.call(Sortable.dragged.parentNode[expando], scrollOffsetX, scrollOffsetY, evt, touchEvt$1, autoScrolls[this.layer].el) !== 'continue') {\n              return;\n            }\n          }\n          scrollBy(autoScrolls[this.layer].el, scrollOffsetX, scrollOffsetY);\n        }.bind({\n          layer: layersOut\n        }), 24);\n      }\n    }\n    layersOut++;\n  } while (options.bubbleScroll && currentParent !== winScroller && (currentParent = getParentAutoScrollElement(currentParent, false)));\n  scrolling = scrollThisInstance; // in case another function catches scrolling as false in between when it is not\n}, 30);\n\nvar drop = function drop(_ref) {\n  var originalEvent = _ref.originalEvent,\n    putSortable = _ref.putSortable,\n    dragEl = _ref.dragEl,\n    activeSortable = _ref.activeSortable,\n    dispatchSortableEvent = _ref.dispatchSortableEvent,\n    hideGhostForTarget = _ref.hideGhostForTarget,\n    unhideGhostForTarget = _ref.unhideGhostForTarget;\n  if (!originalEvent) return;\n  var toSortable = putSortable || activeSortable;\n  hideGhostForTarget();\n  var touch = originalEvent.changedTouches && originalEvent.changedTouches.length ? originalEvent.changedTouches[0] : originalEvent;\n  var target = document.elementFromPoint(touch.clientX, touch.clientY);\n  unhideGhostForTarget();\n  if (toSortable && !toSortable.el.contains(target)) {\n    dispatchSortableEvent('spill');\n    this.onSpill({\n      dragEl: dragEl,\n      putSortable: putSortable\n    });\n  }\n};\nfunction Revert() {}\nRevert.prototype = {\n  startIndex: null,\n  dragStart: function dragStart(_ref2) {\n    var oldDraggableIndex = _ref2.oldDraggableIndex;\n    this.startIndex = oldDraggableIndex;\n  },\n  onSpill: function onSpill(_ref3) {\n    var dragEl = _ref3.dragEl,\n      putSortable = _ref3.putSortable;\n    this.sortable.captureAnimationState();\n    if (putSortable) {\n      putSortable.captureAnimationState();\n    }\n    var nextSibling = getChild(this.sortable.el, this.startIndex, this.options);\n    if (nextSibling) {\n      this.sortable.el.insertBefore(dragEl, nextSibling);\n    } else {\n      this.sortable.el.appendChild(dragEl);\n    }\n    this.sortable.animateAll();\n    if (putSortable) {\n      putSortable.animateAll();\n    }\n  },\n  drop: drop\n};\n_extends(Revert, {\n  pluginName: 'revertOnSpill'\n});\nfunction Remove() {}\nRemove.prototype = {\n  onSpill: function onSpill(_ref4) {\n    var dragEl = _ref4.dragEl,\n      putSortable = _ref4.putSortable;\n    var parentSortable = putSortable || this.sortable;\n    parentSortable.captureAnimationState();\n    dragEl.parentNode && dragEl.parentNode.removeChild(dragEl);\n    parentSortable.animateAll();\n  },\n  drop: drop\n};\n_extends(Remove, {\n  pluginName: 'removeOnSpill'\n});\n\nvar lastSwapEl;\nfunction SwapPlugin() {\n  function Swap() {\n    this.defaults = {\n      swapClass: 'sortable-swap-highlight'\n    };\n  }\n  Swap.prototype = {\n    dragStart: function dragStart(_ref) {\n      var dragEl = _ref.dragEl;\n      lastSwapEl = dragEl;\n    },\n    dragOverValid: function dragOverValid(_ref2) {\n      var completed = _ref2.completed,\n        target = _ref2.target,\n        onMove = _ref2.onMove,\n        activeSortable = _ref2.activeSortable,\n        changed = _ref2.changed,\n        cancel = _ref2.cancel;\n      if (!activeSortable.options.swap) return;\n      var el = this.sortable.el,\n        options = this.options;\n      if (target && target !== el) {\n        var prevSwapEl = lastSwapEl;\n        if (onMove(target) !== false) {\n          toggleClass(target, options.swapClass, true);\n          lastSwapEl = target;\n        } else {\n          lastSwapEl = null;\n        }\n        if (prevSwapEl && prevSwapEl !== lastSwapEl) {\n          toggleClass(prevSwapEl, options.swapClass, false);\n        }\n      }\n      changed();\n      completed(true);\n      cancel();\n    },\n    drop: function drop(_ref3) {\n      var activeSortable = _ref3.activeSortable,\n        putSortable = _ref3.putSortable,\n        dragEl = _ref3.dragEl;\n      var toSortable = putSortable || this.sortable;\n      var options = this.options;\n      lastSwapEl && toggleClass(lastSwapEl, options.swapClass, false);\n      if (lastSwapEl && (options.swap || putSortable && putSortable.options.swap)) {\n        if (dragEl !== lastSwapEl) {\n          toSortable.captureAnimationState();\n          if (toSortable !== activeSortable) activeSortable.captureAnimationState();\n          swapNodes(dragEl, lastSwapEl);\n          toSortable.animateAll();\n          if (toSortable !== activeSortable) activeSortable.animateAll();\n        }\n      }\n    },\n    nulling: function nulling() {\n      lastSwapEl = null;\n    }\n  };\n  return _extends(Swap, {\n    pluginName: 'swap',\n    eventProperties: function eventProperties() {\n      return {\n        swapItem: lastSwapEl\n      };\n    }\n  });\n}\nfunction swapNodes(n1, n2) {\n  var p1 = n1.parentNode,\n    p2 = n2.parentNode,\n    i1,\n    i2;\n  if (!p1 || !p2 || p1.isEqualNode(n2) || p2.isEqualNode(n1)) return;\n  i1 = index(n1);\n  i2 = index(n2);\n  if (p1.isEqualNode(p2) && i1 < i2) {\n    i2++;\n  }\n  p1.insertBefore(n2, p1.children[i1]);\n  p2.insertBefore(n1, p2.children[i2]);\n}\n\nvar multiDragElements = [],\n  multiDragClones = [],\n  lastMultiDragSelect,\n  // for selection with modifier key down (SHIFT)\n  multiDragSortable,\n  initialFolding = false,\n  // Initial multi-drag fold when drag started\n  folding = false,\n  // Folding any other time\n  dragStarted = false,\n  dragEl$1,\n  clonesFromRect,\n  clonesHidden;\nfunction MultiDragPlugin() {\n  function MultiDrag(sortable) {\n    // Bind all private methods\n    for (var fn in this) {\n      if (fn.charAt(0) === '_' && typeof this[fn] === 'function') {\n        this[fn] = this[fn].bind(this);\n      }\n    }\n    if (!sortable.options.avoidImplicitDeselect) {\n      if (sortable.options.supportPointer) {\n        on(document, 'pointerup', this._deselectMultiDrag);\n      } else {\n        on(document, 'mouseup', this._deselectMultiDrag);\n        on(document, 'touchend', this._deselectMultiDrag);\n      }\n    }\n    on(document, 'keydown', this._checkKeyDown);\n    on(document, 'keyup', this._checkKeyUp);\n    this.defaults = {\n      selectedClass: 'sortable-selected',\n      multiDragKey: null,\n      avoidImplicitDeselect: false,\n      setData: function setData(dataTransfer, dragEl) {\n        var data = '';\n        if (multiDragElements.length && multiDragSortable === sortable) {\n          multiDragElements.forEach(function (multiDragElement, i) {\n            data += (!i ? '' : ', ') + multiDragElement.textContent;\n          });\n        } else {\n          data = dragEl.textContent;\n        }\n        dataTransfer.setData('Text', data);\n      }\n    };\n  }\n  MultiDrag.prototype = {\n    multiDragKeyDown: false,\n    isMultiDrag: false,\n    delayStartGlobal: function delayStartGlobal(_ref) {\n      var dragged = _ref.dragEl;\n      dragEl$1 = dragged;\n    },\n    delayEnded: function delayEnded() {\n      this.isMultiDrag = ~multiDragElements.indexOf(dragEl$1);\n    },\n    setupClone: function setupClone(_ref2) {\n      var sortable = _ref2.sortable,\n        cancel = _ref2.cancel;\n      if (!this.isMultiDrag) return;\n      for (var i = 0; i < multiDragElements.length; i++) {\n        multiDragClones.push(clone(multiDragElements[i]));\n        multiDragClones[i].sortableIndex = multiDragElements[i].sortableIndex;\n        multiDragClones[i].draggable = false;\n        multiDragClones[i].style['will-change'] = '';\n        toggleClass(multiDragClones[i], this.options.selectedClass, false);\n        multiDragElements[i] === dragEl$1 && toggleClass(multiDragClones[i], this.options.chosenClass, false);\n      }\n      sortable._hideClone();\n      cancel();\n    },\n    clone: function clone(_ref3) {\n      var sortable = _ref3.sortable,\n        rootEl = _ref3.rootEl,\n        dispatchSortableEvent = _ref3.dispatchSortableEvent,\n        cancel = _ref3.cancel;\n      if (!this.isMultiDrag) return;\n      if (!this.options.removeCloneOnHide) {\n        if (multiDragElements.length && multiDragSortable === sortable) {\n          insertMultiDragClones(true, rootEl);\n          dispatchSortableEvent('clone');\n          cancel();\n        }\n      }\n    },\n    showClone: function showClone(_ref4) {\n      var cloneNowShown = _ref4.cloneNowShown,\n        rootEl = _ref4.rootEl,\n        cancel = _ref4.cancel;\n      if (!this.isMultiDrag) return;\n      insertMultiDragClones(false, rootEl);\n      multiDragClones.forEach(function (clone) {\n        css(clone, 'display', '');\n      });\n      cloneNowShown();\n      clonesHidden = false;\n      cancel();\n    },\n    hideClone: function hideClone(_ref5) {\n      var _this = this;\n      var sortable = _ref5.sortable,\n        cloneNowHidden = _ref5.cloneNowHidden,\n        cancel = _ref5.cancel;\n      if (!this.isMultiDrag) return;\n      multiDragClones.forEach(function (clone) {\n        css(clone, 'display', 'none');\n        if (_this.options.removeCloneOnHide && clone.parentNode) {\n          clone.parentNode.removeChild(clone);\n        }\n      });\n      cloneNowHidden();\n      clonesHidden = true;\n      cancel();\n    },\n    dragStartGlobal: function dragStartGlobal(_ref6) {\n      var sortable = _ref6.sortable;\n      if (!this.isMultiDrag && multiDragSortable) {\n        multiDragSortable.multiDrag._deselectMultiDrag();\n      }\n      multiDragElements.forEach(function (multiDragElement) {\n        multiDragElement.sortableIndex = index(multiDragElement);\n      });\n\n      // Sort multi-drag elements\n      multiDragElements = multiDragElements.sort(function (a, b) {\n        return a.sortableIndex - b.sortableIndex;\n      });\n      dragStarted = true;\n    },\n    dragStarted: function dragStarted(_ref7) {\n      var _this2 = this;\n      var sortable = _ref7.sortable;\n      if (!this.isMultiDrag) return;\n      if (this.options.sort) {\n        // Capture rects,\n        // hide multi drag elements (by positioning them absolute),\n        // set multi drag elements rects to dragRect,\n        // show multi drag elements,\n        // animate to rects,\n        // unset rects & remove from DOM\n\n        sortable.captureAnimationState();\n        if (this.options.animation) {\n          multiDragElements.forEach(function (multiDragElement) {\n            if (multiDragElement === dragEl$1) return;\n            css(multiDragElement, 'position', 'absolute');\n          });\n          var dragRect = getRect(dragEl$1, false, true, true);\n          multiDragElements.forEach(function (multiDragElement) {\n            if (multiDragElement === dragEl$1) return;\n            setRect(multiDragElement, dragRect);\n          });\n          folding = true;\n          initialFolding = true;\n        }\n      }\n      sortable.animateAll(function () {\n        folding = false;\n        initialFolding = false;\n        if (_this2.options.animation) {\n          multiDragElements.forEach(function (multiDragElement) {\n            unsetRect(multiDragElement);\n          });\n        }\n\n        // Remove all auxiliary multidrag items from el, if sorting enabled\n        if (_this2.options.sort) {\n          removeMultiDragElements();\n        }\n      });\n    },\n    dragOver: function dragOver(_ref8) {\n      var target = _ref8.target,\n        completed = _ref8.completed,\n        cancel = _ref8.cancel;\n      if (folding && ~multiDragElements.indexOf(target)) {\n        completed(false);\n        cancel();\n      }\n    },\n    revert: function revert(_ref9) {\n      var fromSortable = _ref9.fromSortable,\n        rootEl = _ref9.rootEl,\n        sortable = _ref9.sortable,\n        dragRect = _ref9.dragRect;\n      if (multiDragElements.length > 1) {\n        // Setup unfold animation\n        multiDragElements.forEach(function (multiDragElement) {\n          sortable.addAnimationState({\n            target: multiDragElement,\n            rect: folding ? getRect(multiDragElement) : dragRect\n          });\n          unsetRect(multiDragElement);\n          multiDragElement.fromRect = dragRect;\n          fromSortable.removeAnimationState(multiDragElement);\n        });\n        folding = false;\n        insertMultiDragElements(!this.options.removeCloneOnHide, rootEl);\n      }\n    },\n    dragOverCompleted: function dragOverCompleted(_ref10) {\n      var sortable = _ref10.sortable,\n        isOwner = _ref10.isOwner,\n        insertion = _ref10.insertion,\n        activeSortable = _ref10.activeSortable,\n        parentEl = _ref10.parentEl,\n        putSortable = _ref10.putSortable;\n      var options = this.options;\n      if (insertion) {\n        // Clones must be hidden before folding animation to capture dragRectAbsolute properly\n        if (isOwner) {\n          activeSortable._hideClone();\n        }\n        initialFolding = false;\n        // If leaving sort:false root, or already folding - Fold to new location\n        if (options.animation && multiDragElements.length > 1 && (folding || !isOwner && !activeSortable.options.sort && !putSortable)) {\n          // Fold: Set all multi drag elements's rects to dragEl's rect when multi-drag elements are invisible\n          var dragRectAbsolute = getRect(dragEl$1, false, true, true);\n          multiDragElements.forEach(function (multiDragElement) {\n            if (multiDragElement === dragEl$1) return;\n            setRect(multiDragElement, dragRectAbsolute);\n\n            // Move element(s) to end of parentEl so that it does not interfere with multi-drag clones insertion if they are inserted\n            // while folding, and so that we can capture them again because old sortable will no longer be fromSortable\n            parentEl.appendChild(multiDragElement);\n          });\n          folding = true;\n        }\n\n        // Clones must be shown (and check to remove multi drags) after folding when interfering multiDragElements are moved out\n        if (!isOwner) {\n          // Only remove if not folding (folding will remove them anyways)\n          if (!folding) {\n            removeMultiDragElements();\n          }\n          if (multiDragElements.length > 1) {\n            var clonesHiddenBefore = clonesHidden;\n            activeSortable._showClone(sortable);\n\n            // Unfold animation for clones if showing from hidden\n            if (activeSortable.options.animation && !clonesHidden && clonesHiddenBefore) {\n              multiDragClones.forEach(function (clone) {\n                activeSortable.addAnimationState({\n                  target: clone,\n                  rect: clonesFromRect\n                });\n                clone.fromRect = clonesFromRect;\n                clone.thisAnimationDuration = null;\n              });\n            }\n          } else {\n            activeSortable._showClone(sortable);\n          }\n        }\n      }\n    },\n    dragOverAnimationCapture: function dragOverAnimationCapture(_ref11) {\n      var dragRect = _ref11.dragRect,\n        isOwner = _ref11.isOwner,\n        activeSortable = _ref11.activeSortable;\n      multiDragElements.forEach(function (multiDragElement) {\n        multiDragElement.thisAnimationDuration = null;\n      });\n      if (activeSortable.options.animation && !isOwner && activeSortable.multiDrag.isMultiDrag) {\n        clonesFromRect = _extends({}, dragRect);\n        var dragMatrix = matrix(dragEl$1, true);\n        clonesFromRect.top -= dragMatrix.f;\n        clonesFromRect.left -= dragMatrix.e;\n      }\n    },\n    dragOverAnimationComplete: function dragOverAnimationComplete() {\n      if (folding) {\n        folding = false;\n        removeMultiDragElements();\n      }\n    },\n    drop: function drop(_ref12) {\n      var evt = _ref12.originalEvent,\n        rootEl = _ref12.rootEl,\n        parentEl = _ref12.parentEl,\n        sortable = _ref12.sortable,\n        dispatchSortableEvent = _ref12.dispatchSortableEvent,\n        oldIndex = _ref12.oldIndex,\n        putSortable = _ref12.putSortable;\n      var toSortable = putSortable || this.sortable;\n      if (!evt) return;\n      var options = this.options,\n        children = parentEl.children;\n\n      // Multi-drag selection\n      if (!dragStarted) {\n        if (options.multiDragKey && !this.multiDragKeyDown) {\n          this._deselectMultiDrag();\n        }\n        toggleClass(dragEl$1, options.selectedClass, !~multiDragElements.indexOf(dragEl$1));\n        if (!~multiDragElements.indexOf(dragEl$1)) {\n          multiDragElements.push(dragEl$1);\n          dispatchEvent({\n            sortable: sortable,\n            rootEl: rootEl,\n            name: 'select',\n            targetEl: dragEl$1,\n            originalEvent: evt\n          });\n\n          // Modifier activated, select from last to dragEl\n          if (evt.shiftKey && lastMultiDragSelect && sortable.el.contains(lastMultiDragSelect)) {\n            var lastIndex = index(lastMultiDragSelect),\n              currentIndex = index(dragEl$1);\n            if (~lastIndex && ~currentIndex && lastIndex !== currentIndex) {\n              // Must include lastMultiDragSelect (select it), in case modified selection from no selection\n              // (but previous selection existed)\n              var n, i;\n              if (currentIndex > lastIndex) {\n                i = lastIndex;\n                n = currentIndex;\n              } else {\n                i = currentIndex;\n                n = lastIndex + 1;\n              }\n              for (; i < n; i++) {\n                if (~multiDragElements.indexOf(children[i])) continue;\n                toggleClass(children[i], options.selectedClass, true);\n                multiDragElements.push(children[i]);\n                dispatchEvent({\n                  sortable: sortable,\n                  rootEl: rootEl,\n                  name: 'select',\n                  targetEl: children[i],\n                  originalEvent: evt\n                });\n              }\n            }\n          } else {\n            lastMultiDragSelect = dragEl$1;\n          }\n          multiDragSortable = toSortable;\n        } else {\n          multiDragElements.splice(multiDragElements.indexOf(dragEl$1), 1);\n          lastMultiDragSelect = null;\n          dispatchEvent({\n            sortable: sortable,\n            rootEl: rootEl,\n            name: 'deselect',\n            targetEl: dragEl$1,\n            originalEvent: evt\n          });\n        }\n      }\n\n      // Multi-drag drop\n      if (dragStarted && this.isMultiDrag) {\n        folding = false;\n        // Do not \"unfold\" after around dragEl if reverted\n        if ((parentEl[expando].options.sort || parentEl !== rootEl) && multiDragElements.length > 1) {\n          var dragRect = getRect(dragEl$1),\n            multiDragIndex = index(dragEl$1, ':not(.' + this.options.selectedClass + ')');\n          if (!initialFolding && options.animation) dragEl$1.thisAnimationDuration = null;\n          toSortable.captureAnimationState();\n          if (!initialFolding) {\n            if (options.animation) {\n              dragEl$1.fromRect = dragRect;\n              multiDragElements.forEach(function (multiDragElement) {\n                multiDragElement.thisAnimationDuration = null;\n                if (multiDragElement !== dragEl$1) {\n                  var rect = folding ? getRect(multiDragElement) : dragRect;\n                  multiDragElement.fromRect = rect;\n\n                  // Prepare unfold animation\n                  toSortable.addAnimationState({\n                    target: multiDragElement,\n                    rect: rect\n                  });\n                }\n              });\n            }\n\n            // Multi drag elements are not necessarily removed from the DOM on drop, so to reinsert\n            // properly they must all be removed\n            removeMultiDragElements();\n            multiDragElements.forEach(function (multiDragElement) {\n              if (children[multiDragIndex]) {\n                parentEl.insertBefore(multiDragElement, children[multiDragIndex]);\n              } else {\n                parentEl.appendChild(multiDragElement);\n              }\n              multiDragIndex++;\n            });\n\n            // If initial folding is done, the elements may have changed position because they are now\n            // unfolding around dragEl, even though dragEl may not have his index changed, so update event\n            // must be fired here as Sortable will not.\n            if (oldIndex === index(dragEl$1)) {\n              var update = false;\n              multiDragElements.forEach(function (multiDragElement) {\n                if (multiDragElement.sortableIndex !== index(multiDragElement)) {\n                  update = true;\n                  return;\n                }\n              });\n              if (update) {\n                dispatchSortableEvent('update');\n                dispatchSortableEvent('sort');\n              }\n            }\n          }\n\n          // Must be done after capturing individual rects (scroll bar)\n          multiDragElements.forEach(function (multiDragElement) {\n            unsetRect(multiDragElement);\n          });\n          toSortable.animateAll();\n        }\n        multiDragSortable = toSortable;\n      }\n\n      // Remove clones if necessary\n      if (rootEl === parentEl || putSortable && putSortable.lastPutMode !== 'clone') {\n        multiDragClones.forEach(function (clone) {\n          clone.parentNode && clone.parentNode.removeChild(clone);\n        });\n      }\n    },\n    nullingGlobal: function nullingGlobal() {\n      this.isMultiDrag = dragStarted = false;\n      multiDragClones.length = 0;\n    },\n    destroyGlobal: function destroyGlobal() {\n      this._deselectMultiDrag();\n      off(document, 'pointerup', this._deselectMultiDrag);\n      off(document, 'mouseup', this._deselectMultiDrag);\n      off(document, 'touchend', this._deselectMultiDrag);\n      off(document, 'keydown', this._checkKeyDown);\n      off(document, 'keyup', this._checkKeyUp);\n    },\n    _deselectMultiDrag: function _deselectMultiDrag(evt) {\n      if (typeof dragStarted !== \"undefined\" && dragStarted) return;\n\n      // Only deselect if selection is in this sortable\n      if (multiDragSortable !== this.sortable) return;\n\n      // Only deselect if target is not item in this sortable\n      if (evt && closest(evt.target, this.options.draggable, this.sortable.el, false)) return;\n\n      // Only deselect if left click\n      if (evt && evt.button !== 0) return;\n      while (multiDragElements.length) {\n        var el = multiDragElements[0];\n        toggleClass(el, this.options.selectedClass, false);\n        multiDragElements.shift();\n        dispatchEvent({\n          sortable: this.sortable,\n          rootEl: this.sortable.el,\n          name: 'deselect',\n          targetEl: el,\n          originalEvent: evt\n        });\n      }\n    },\n    _checkKeyDown: function _checkKeyDown(evt) {\n      if (evt.key === this.options.multiDragKey) {\n        this.multiDragKeyDown = true;\n      }\n    },\n    _checkKeyUp: function _checkKeyUp(evt) {\n      if (evt.key === this.options.multiDragKey) {\n        this.multiDragKeyDown = false;\n      }\n    }\n  };\n  return _extends(MultiDrag, {\n    // Static methods & properties\n    pluginName: 'multiDrag',\n    utils: {\n      /**\r\n       * Selects the provided multi-drag item\r\n       * @param  {HTMLElement} el    The element to be selected\r\n       */\n      select: function select(el) {\n        var sortable = el.parentNode[expando];\n        if (!sortable || !sortable.options.multiDrag || ~multiDragElements.indexOf(el)) return;\n        if (multiDragSortable && multiDragSortable !== sortable) {\n          multiDragSortable.multiDrag._deselectMultiDrag();\n          multiDragSortable = sortable;\n        }\n        toggleClass(el, sortable.options.selectedClass, true);\n        multiDragElements.push(el);\n      },\n      /**\r\n       * Deselects the provided multi-drag item\r\n       * @param  {HTMLElement} el    The element to be deselected\r\n       */\n      deselect: function deselect(el) {\n        var sortable = el.parentNode[expando],\n          index = multiDragElements.indexOf(el);\n        if (!sortable || !sortable.options.multiDrag || !~index) return;\n        toggleClass(el, sortable.options.selectedClass, false);\n        multiDragElements.splice(index, 1);\n      }\n    },\n    eventProperties: function eventProperties() {\n      var _this3 = this;\n      var oldIndicies = [],\n        newIndicies = [];\n      multiDragElements.forEach(function (multiDragElement) {\n        oldIndicies.push({\n          multiDragElement: multiDragElement,\n          index: multiDragElement.sortableIndex\n        });\n\n        // multiDragElements will already be sorted if folding\n        var newIndex;\n        if (folding && multiDragElement !== dragEl$1) {\n          newIndex = -1;\n        } else if (folding) {\n          newIndex = index(multiDragElement, ':not(.' + _this3.options.selectedClass + ')');\n        } else {\n          newIndex = index(multiDragElement);\n        }\n        newIndicies.push({\n          multiDragElement: multiDragElement,\n          index: newIndex\n        });\n      });\n      return {\n        items: _toConsumableArray(multiDragElements),\n        clones: [].concat(multiDragClones),\n        oldIndicies: oldIndicies,\n        newIndicies: newIndicies\n      };\n    },\n    optionListeners: {\n      multiDragKey: function multiDragKey(key) {\n        key = key.toLowerCase();\n        if (key === 'ctrl') {\n          key = 'Control';\n        } else if (key.length > 1) {\n          key = key.charAt(0).toUpperCase() + key.substr(1);\n        }\n        return key;\n      }\n    }\n  });\n}\nfunction insertMultiDragElements(clonesInserted, rootEl) {\n  multiDragElements.forEach(function (multiDragElement, i) {\n    var target = rootEl.children[multiDragElement.sortableIndex + (clonesInserted ? Number(i) : 0)];\n    if (target) {\n      rootEl.insertBefore(multiDragElement, target);\n    } else {\n      rootEl.appendChild(multiDragElement);\n    }\n  });\n}\n\n/**\r\n * Insert multi-drag clones\r\n * @param  {[Boolean]} elementsInserted  Whether the multi-drag elements are inserted\r\n * @param  {HTMLElement} rootEl\r\n */\nfunction insertMultiDragClones(elementsInserted, rootEl) {\n  multiDragClones.forEach(function (clone, i) {\n    var target = rootEl.children[clone.sortableIndex + (elementsInserted ? Number(i) : 0)];\n    if (target) {\n      rootEl.insertBefore(clone, target);\n    } else {\n      rootEl.appendChild(clone);\n    }\n  });\n}\nfunction removeMultiDragElements() {\n  multiDragElements.forEach(function (multiDragElement) {\n    if (multiDragElement === dragEl$1) return;\n    multiDragElement.parentNode && multiDragElement.parentNode.removeChild(multiDragElement);\n  });\n}\n\nSortable.mount(new AutoScrollPlugin());\nSortable.mount(Remove, Revert);\n\nexport default Sortable;\nexport { MultiDragPlugin as MultiDrag, Sortable, SwapPlugin as Swap };\n", "import Sortable, {MultiDrag} from 'sortablejs';\nimport {Component} from './component';\nimport {htmlToDom} from '../services/dom';\n\n// Auto sort control\nconst sortOperations = {\n    name(a, b) {\n        const aName = a.getAttribute('data-name').trim().toLowerCase();\n        const bName = b.getAttribute('data-name').trim().toLowerCase();\n        return aName.localeCompare(bName);\n    },\n    created(a, b) {\n        const aTime = Number(a.getAttribute('data-created'));\n        const bTime = Number(b.getAttribute('data-created'));\n        return bTime - aTime;\n    },\n    updated(a, b) {\n        const aTime = Number(a.getAttribute('data-updated'));\n        const bTime = Number(b.getAttribute('data-updated'));\n        return bTime - aTime;\n    },\n    chaptersFirst(a, b) {\n        const aType = a.getAttribute('data-type');\n        const bType = b.getAttribute('data-type');\n        if (aType === bType) {\n            return 0;\n        }\n        return (aType === 'chapter' ? -1 : 1);\n    },\n    chaptersLast(a, b) {\n        const aType = a.getAttribute('data-type');\n        const bType = b.getAttribute('data-type');\n        if (aType === bType) {\n            return 0;\n        }\n        return (aType === 'chapter' ? 1 : -1);\n    },\n};\n\n/**\n * The available move actions.\n * The active function indicates if the action is possible for the given item.\n * The run function performs the move.\n * @type {{up: {active(Element, ?Element, Element): boolean, run(Element, ?Element, Element)}}}\n */\nconst moveActions = {\n    up: {\n        active(elem, parent) {\n            return !(elem.previousElementSibling === null && !parent);\n        },\n        run(elem, parent) {\n            const newSibling = elem.previousElementSibling || parent;\n            newSibling.insertAdjacentElement('beforebegin', elem);\n        },\n    },\n    down: {\n        active(elem, parent) {\n            return !(elem.nextElementSibling === null && !parent);\n        },\n        run(elem, parent) {\n            const newSibling = elem.nextElementSibling || parent;\n            newSibling.insertAdjacentElement('afterend', elem);\n        },\n    },\n    next_book: {\n        active(elem, parent, book) {\n            return book.nextElementSibling !== null;\n        },\n        run(elem, parent, book) {\n            const newList = book.nextElementSibling.querySelector('ul');\n            newList.prepend(elem);\n        },\n    },\n    prev_book: {\n        active(elem, parent, book) {\n            return book.previousElementSibling !== null;\n        },\n        run(elem, parent, book) {\n            const newList = book.previousElementSibling.querySelector('ul');\n            newList.appendChild(elem);\n        },\n    },\n    next_chapter: {\n        active(elem, parent) {\n            return elem.dataset.type === 'page' && this.getNextChapter(elem, parent);\n        },\n        run(elem, parent) {\n            const nextChapter = this.getNextChapter(elem, parent);\n            nextChapter.querySelector('ul').prepend(elem);\n        },\n        getNextChapter(elem, parent) {\n            const topLevel = (parent || elem);\n            const topItems = Array.from(topLevel.parentElement.children);\n            const index = topItems.indexOf(topLevel);\n            return topItems.slice(index + 1).find(item => item.dataset.type === 'chapter');\n        },\n    },\n    prev_chapter: {\n        active(elem, parent) {\n            return elem.dataset.type === 'page' && this.getPrevChapter(elem, parent);\n        },\n        run(elem, parent) {\n            const prevChapter = this.getPrevChapter(elem, parent);\n            prevChapter.querySelector('ul').append(elem);\n        },\n        getPrevChapter(elem, parent) {\n            const topLevel = (parent || elem);\n            const topItems = Array.from(topLevel.parentElement.children);\n            const index = topItems.indexOf(topLevel);\n            return topItems.slice(0, index).reverse().find(item => item.dataset.type === 'chapter');\n        },\n    },\n    book_end: {\n        active(elem, parent) {\n            return parent || (parent === null && elem.nextElementSibling);\n        },\n        run(elem, parent, book) {\n            book.querySelector('ul').append(elem);\n        },\n    },\n    book_start: {\n        active(elem, parent) {\n            return parent || (parent === null && elem.previousElementSibling);\n        },\n        run(elem, parent, book) {\n            book.querySelector('ul').prepend(elem);\n        },\n    },\n    before_chapter: {\n        active(elem, parent) {\n            return parent;\n        },\n        run(elem, parent) {\n            parent.insertAdjacentElement('beforebegin', elem);\n        },\n    },\n    after_chapter: {\n        active(elem, parent) {\n            return parent;\n        },\n        run(elem, parent) {\n            parent.insertAdjacentElement('afterend', elem);\n        },\n    },\n};\n\nexport class BookSort extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.sortContainer = this.$refs.sortContainer;\n        this.input = this.$refs.input;\n\n        Sortable.mount(new MultiDrag());\n\n        const initialSortBox = this.container.querySelector('.sort-box');\n        this.setupBookSortable(initialSortBox);\n        this.setupSortPresets();\n        this.setupMoveActions();\n\n        window.$events.listen('entity-select-change', this.bookSelect.bind(this));\n    }\n\n    /**\n     * Set up the handlers for the item-level move buttons.\n     */\n    setupMoveActions() {\n        // Handle move button click\n        this.container.addEventListener('click', event => {\n            if (event.target.matches('[data-move]')) {\n                const action = event.target.getAttribute('data-move');\n                const sortItem = event.target.closest('[data-id]');\n                this.runSortAction(sortItem, action);\n            }\n        });\n\n        this.updateMoveActionStateForAll();\n    }\n\n    /**\n     * Set up the handlers for the preset sort type buttons.\n     */\n    setupSortPresets() {\n        let lastSort = '';\n        let reverse = false;\n        const reversibleTypes = ['name', 'created', 'updated'];\n\n        this.sortContainer.addEventListener('click', event => {\n            const sortButton = event.target.closest('.sort-box-options [data-sort]');\n            if (!sortButton) return;\n\n            event.preventDefault();\n            const sortLists = sortButton.closest('.sort-box').querySelectorAll('ul');\n            const sort = sortButton.getAttribute('data-sort');\n\n            reverse = (lastSort === sort) ? !reverse : false;\n            let sortFunction = sortOperations[sort];\n            if (reverse && reversibleTypes.includes(sort)) {\n                sortFunction = function reverseSortOperation(a, b) {\n                    return 0 - sortOperations[sort](a, b);\n                };\n            }\n\n            for (const list of sortLists) {\n                const directItems = Array.from(list.children).filter(child => child.matches('li'));\n                directItems.sort(sortFunction).forEach(sortedItem => {\n                    list.appendChild(sortedItem);\n                });\n            }\n\n            lastSort = sort;\n            this.updateMapInput();\n        });\n    }\n\n    /**\n     * Handle book selection from the entity selector.\n     * @param {Object} entityInfo\n     */\n    bookSelect(entityInfo) {\n        const alreadyAdded = this.container.querySelector(`[data-type=\"book\"][data-id=\"${entityInfo.id}\"]`) !== null;\n        if (alreadyAdded) return;\n\n        const entitySortItemUrl = `${entityInfo.link}/sort-item`;\n        window.$http.get(entitySortItemUrl).then(resp => {\n            const newBookContainer = htmlToDom(resp.data);\n            this.sortContainer.append(newBookContainer);\n            this.setupBookSortable(newBookContainer);\n            this.updateMoveActionStateForAll();\n\n            const summary = newBookContainer.querySelector('summary');\n            summary.focus();\n        });\n    }\n\n    /**\n     * Set up the given book container element to have sortable items.\n     * @param {Element} bookContainer\n     */\n    setupBookSortable(bookContainer) {\n        const sortElems = Array.from(bookContainer.querySelectorAll('.sort-list, .sortable-page-sublist'));\n\n        const bookGroupConfig = {\n            name: 'book',\n            pull: ['book', 'chapter'],\n            put: ['book', 'chapter'],\n        };\n\n        const chapterGroupConfig = {\n            name: 'chapter',\n            pull: ['book', 'chapter'],\n            put(toList, fromList, draggedElem) {\n                return draggedElem.getAttribute('data-type') === 'page';\n            },\n        };\n\n        for (const sortElem of sortElems) {\n            Sortable.create(sortElem, {\n                group: sortElem.classList.contains('sort-list') ? bookGroupConfig : chapterGroupConfig,\n                animation: 150,\n                fallbackOnBody: true,\n                swapThreshold: 0.65,\n                onSort: () => {\n                    this.ensureNoNestedChapters();\n                    this.updateMapInput();\n                    this.updateMoveActionStateForAll();\n                },\n                dragClass: 'bg-white',\n                ghostClass: 'primary-background-light',\n                multiDrag: true,\n                multiDragKey: 'Control',\n                selectedClass: 'sortable-selected',\n            });\n        }\n    }\n\n    /**\n     * Handle nested chapters by moving them to the parent book.\n     * Needed since sorting with multi-sort only checks group rules based on the active item,\n     * not all in group, therefore need to manually check after a sort.\n     * Must be done before updating the map input.\n     */\n    ensureNoNestedChapters() {\n        const nestedChapters = this.container.querySelectorAll('[data-type=\"chapter\"] [data-type=\"chapter\"]');\n        for (const chapter of nestedChapters) {\n            const parentChapter = chapter.parentElement.closest('[data-type=\"chapter\"]');\n            parentChapter.insertAdjacentElement('afterend', chapter);\n        }\n    }\n\n    /**\n     * Update the input with our sort data.\n     */\n    updateMapInput() {\n        const pageMap = this.buildEntityMap();\n        this.input.value = JSON.stringify(pageMap);\n    }\n\n    /**\n     * Build up a mapping of entities with their ordering and nesting.\n     * @returns {Array}\n     */\n    buildEntityMap() {\n        const entityMap = [];\n        const lists = this.container.querySelectorAll('.sort-list');\n\n        for (const list of lists) {\n            const bookId = list.closest('[data-type=\"book\"]').getAttribute('data-id');\n            const directChildren = Array.from(list.children)\n                .filter(elem => elem.matches('[data-type=\"page\"], [data-type=\"chapter\"]'));\n            for (let i = 0; i < directChildren.length; i++) {\n                this.addBookChildToMap(directChildren[i], i, bookId, entityMap);\n            }\n        }\n\n        return entityMap;\n    }\n\n    /**\n     * Parse a sort item and add it to a data-map array.\n     * Parses sub0items if existing also.\n     * @param {Element} childElem\n     * @param {Number} index\n     * @param {Number} bookId\n     * @param {Array} entityMap\n     */\n    addBookChildToMap(childElem, index, bookId, entityMap) {\n        const type = childElem.getAttribute('data-type');\n        const parentChapter = false;\n        const childId = childElem.getAttribute('data-id');\n\n        entityMap.push({\n            id: childId,\n            sort: index,\n            parentChapter,\n            type,\n            book: bookId,\n        });\n\n        const subPages = childElem.querySelectorAll('[data-type=\"page\"]');\n        for (let i = 0; i < subPages.length; i++) {\n            entityMap.push({\n                id: subPages[i].getAttribute('data-id'),\n                sort: i,\n                parentChapter: childId,\n                type: 'page',\n                book: bookId,\n            });\n        }\n    }\n\n    /**\n     * Run the given sort action up the provided sort item.\n     * @param {Element} item\n     * @param {String} action\n     */\n    runSortAction(item, action) {\n        const parentItem = item.parentElement.closest('li[data-id]');\n        const parentBook = item.parentElement.closest('[data-type=\"book\"]');\n        moveActions[action].run(item, parentItem, parentBook);\n        this.updateMapInput();\n        this.updateMoveActionStateForAll();\n        item.scrollIntoView({behavior: 'smooth', block: 'nearest'});\n        item.focus();\n    }\n\n    /**\n     * Update the state of the available move actions on this item.\n     * @param {Element} item\n     */\n    updateMoveActionState(item) {\n        const parentItem = item.parentElement.closest('li[data-id]');\n        const parentBook = item.parentElement.closest('[data-type=\"book\"]');\n        for (const [action, functions] of Object.entries(moveActions)) {\n            const moveButton = item.querySelector(`[data-move=\"${action}\"]`);\n            moveButton.disabled = !functions.active(item, parentItem, parentBook);\n        }\n    }\n\n    updateMoveActionStateForAll() {\n        const items = this.container.querySelectorAll('[data-type=\"chapter\"],[data-type=\"page\"]');\n        for (const item of items) {\n            this.updateMoveActionState(item);\n        }\n    }\n\n}\n", "/**\n * Used in the function below to store references of clean-up functions.\n * Used to ensure only one transitionend function exists at any time.\n * @type {WeakMap<object, any>}\n */\nconst animateStylesCleanupMap = new WeakMap();\n\n/**\n * Animate the css styles of an element using FLIP animation techniques.\n * Styles must be an object where the keys are style properties, camelcase, and the values\n * are an array of two items in the format [initialValue, finalValue]\n * @param {Element} element\n * @param {Object} styles\n * @param {Number} animTime\n * @param {Function} onComplete\n */\nfunction animateStyles(element, styles, animTime = 400, onComplete = null) {\n    const styleNames = Object.keys(styles);\n    for (const style of styleNames) {\n        element.style[style] = styles[style][0];\n    }\n\n    const cleanup = () => {\n        for (const style of styleNames) {\n            element.style[style] = null;\n        }\n        element.style.transition = null;\n        element.removeEventListener('transitionend', cleanup);\n        animateStylesCleanupMap.delete(element);\n        if (onComplete) onComplete();\n    };\n\n    setTimeout(() => {\n        element.style.transition = `all ease-in-out ${animTime}ms`;\n        for (const style of styleNames) {\n            element.style[style] = styles[style][1];\n        }\n\n        element.addEventListener('transitionend', cleanup);\n        animateStylesCleanupMap.set(element, cleanup);\n    }, 15);\n}\n\n/**\n * Run the active cleanup action for the given element.\n * @param {Element} element\n */\nfunction cleanupExistingElementAnimation(element) {\n    if (animateStylesCleanupMap.has(element)) {\n        const oldCleanup = animateStylesCleanupMap.get(element);\n        oldCleanup();\n    }\n}\n\n/**\n * Fade in the given element.\n * @param {Element} element\n * @param {Number} animTime\n * @param {Function|null} onComplete\n */\nexport function fadeIn(element, animTime = 400, onComplete = null) {\n    cleanupExistingElementAnimation(element);\n    element.style.display = 'block';\n    animateStyles(element, {\n        opacity: ['0', '1'],\n    }, animTime, () => {\n        if (onComplete) onComplete();\n    });\n}\n\n/**\n * Fade out the given element.\n * @param {Element} element\n * @param {Number} animTime\n * @param {Function|null} onComplete\n */\nexport function fadeOut(element, animTime = 400, onComplete = null) {\n    cleanupExistingElementAnimation(element);\n    animateStyles(element, {\n        opacity: ['1', '0'],\n    }, animTime, () => {\n        element.style.display = 'none';\n        if (onComplete) onComplete();\n    });\n}\n\n/**\n * Hide the element by sliding the contents upwards.\n * @param {Element} element\n * @param {Number} animTime\n */\nexport function slideUp(element, animTime = 400) {\n    cleanupExistingElementAnimation(element);\n    const currentHeight = element.getBoundingClientRect().height;\n    const computedStyles = getComputedStyle(element);\n    const currentPaddingTop = computedStyles.getPropertyValue('padding-top');\n    const currentPaddingBottom = computedStyles.getPropertyValue('padding-bottom');\n    const animStyles = {\n        maxHeight: [`${currentHeight}px`, '0px'],\n        overflow: ['hidden', 'hidden'],\n        paddingTop: [currentPaddingTop, '0px'],\n        paddingBottom: [currentPaddingBottom, '0px'],\n    };\n\n    animateStyles(element, animStyles, animTime, () => {\n        element.style.display = 'none';\n    });\n}\n\n/**\n * Show the given element by expanding the contents.\n * @param {Element} element - Element to animate\n * @param {Number} animTime - Animation time in ms\n */\nexport function slideDown(element, animTime = 400) {\n    cleanupExistingElementAnimation(element);\n    element.style.display = 'block';\n    const targetHeight = element.getBoundingClientRect().height;\n    const computedStyles = getComputedStyle(element);\n    const targetPaddingTop = computedStyles.getPropertyValue('padding-top');\n    const targetPaddingBottom = computedStyles.getPropertyValue('padding-bottom');\n    const animStyles = {\n        maxHeight: ['0px', `${targetHeight}px`],\n        overflow: ['hidden', 'hidden'],\n        paddingTop: ['0px', targetPaddingTop],\n        paddingBottom: ['0px', targetPaddingBottom],\n    };\n\n    animateStyles(element, animStyles, animTime);\n}\n\n/**\n * Transition the height of the given element between two states.\n * Call with first state, and you'll receive a function in return.\n * Call the returned function in the second state to animate between those two states.\n * If animating to/from 0-height use the slide-up/slide down as easier alternatives.\n * @param {Element} element - Element to animate\n * @param {Number} animTime - Animation time in ms\n * @returns {function} - Function to run in second state to trigger animation.\n */\nexport function transitionHeight(element, animTime = 400) {\n    const startHeight = element.getBoundingClientRect().height;\n    const initialComputedStyles = getComputedStyle(element);\n    const startPaddingTop = initialComputedStyles.getPropertyValue('padding-top');\n    const startPaddingBottom = initialComputedStyles.getPropertyValue('padding-bottom');\n\n    return () => {\n        cleanupExistingElementAnimation(element);\n        const targetHeight = element.getBoundingClientRect().height;\n        const computedStyles = getComputedStyle(element);\n        const targetPaddingTop = computedStyles.getPropertyValue('padding-top');\n        const targetPaddingBottom = computedStyles.getPropertyValue('padding-bottom');\n        const animStyles = {\n            height: [`${startHeight}px`, `${targetHeight}px`],\n            overflow: ['hidden', 'hidden'],\n            paddingTop: [startPaddingTop, targetPaddingTop],\n            paddingBottom: [startPaddingBottom, targetPaddingBottom],\n        };\n\n        animateStyles(element, animStyles, animTime);\n    };\n}\n", "import {slideUp, slideDown} from '../services/animations';\nimport {Component} from './component';\n\nexport class ChapterContents extends Component {\n\n    setup() {\n        this.list = this.$refs.list;\n        this.toggle = this.$refs.toggle;\n\n        this.isOpen = this.toggle.classList.contains('open');\n        this.toggle.addEventListener('click', this.click.bind(this));\n    }\n\n    open() {\n        this.toggle.classList.add('open');\n        this.toggle.setAttribute('aria-expanded', 'true');\n        slideDown(this.list, 180);\n        this.isOpen = true;\n    }\n\n    close() {\n        this.toggle.classList.remove('open');\n        this.toggle.setAttribute('aria-expanded', 'false');\n        slideUp(this.list, 180);\n        this.isOpen = false;\n    }\n\n    click(event) {\n        event.preventDefault();\n        if (this.isOpen) {\n            this.close();\n        } else {\n            this.open();\n        }\n    }\n\n}\n", "import {onChildEvent, onEnterPress, onSelect} from '../services/dom';\nimport {Component} from './component';\n\nexport class CodeEditor extends Component {\n\n    /**\n     * @type {null|SimpleEditorInterface}\n     */\n    editor = null;\n\n    /**\n     * @type {?Function}\n     */\n    saveCallback = null;\n\n    /**\n     * @type {?Function}\n     */\n    cancelCallback = null;\n\n    history = {};\n\n    historyKey = 'code_history';\n\n    setup() {\n        this.container = this.$refs.container;\n        this.popup = this.$el;\n        this.editorInput = this.$refs.editor;\n        this.languageButtons = this.$manyRefs.languageButton;\n        this.languageOptionsContainer = this.$refs.languageOptionsContainer;\n        this.saveButton = this.$refs.saveButton;\n        this.languageInput = this.$refs.languageInput;\n        this.historyDropDown = this.$refs.historyDropDown;\n        this.historyList = this.$refs.historyList;\n        this.favourites = new Set(this.$opts.favourites.split(','));\n\n        this.setupListeners();\n        this.setupFavourites();\n    }\n\n    setupListeners() {\n        this.container.addEventListener('keydown', event => {\n            if (event.ctrlKey && event.key === 'Enter') {\n                this.save();\n            }\n        });\n\n        onSelect(this.languageButtons, event => {\n            const language = event.target.dataset.lang;\n            this.languageInput.value = language;\n            this.languageInputChange(language);\n        });\n\n        onEnterPress(this.languageInput, () => this.save());\n        this.languageInput.addEventListener('input', () => this.languageInputChange(this.languageInput.value));\n        onSelect(this.saveButton, () => this.save());\n\n        onChildEvent(this.historyList, 'button', 'click', (event, elem) => {\n            event.preventDefault();\n            const historyTime = elem.dataset.time;\n            if (this.editor) {\n                this.editor.setContent(this.history[historyTime]);\n            }\n        });\n    }\n\n    setupFavourites() {\n        for (const button of this.languageButtons) {\n            this.setupFavouritesForButton(button);\n        }\n\n        this.sortLanguageList();\n    }\n\n    /**\n     * @param {HTMLButtonElement} button\n     */\n    setupFavouritesForButton(button) {\n        const language = button.dataset.lang;\n        let isFavorite = this.favourites.has(language);\n        button.setAttribute('data-favourite', isFavorite ? 'true' : 'false');\n\n        onChildEvent(button.parentElement, '.lang-option-favorite-toggle', 'click', () => {\n            isFavorite = !isFavorite;\n\n            if (isFavorite) {\n                this.favourites.add(language);\n            } else {\n                this.favourites.delete(language);\n            }\n\n            button.setAttribute('data-favourite', isFavorite ? 'true' : 'false');\n\n            window.$http.patch('/preferences/update-code-language-favourite', {\n                language,\n                active: isFavorite,\n            });\n\n            this.sortLanguageList();\n            if (isFavorite) {\n                button.scrollIntoView({block: 'center', behavior: 'smooth'});\n            }\n        });\n    }\n\n    sortLanguageList() {\n        const sortedParents = this.languageButtons.sort((a, b) => {\n            const aFav = a.dataset.favourite === 'true';\n            const bFav = b.dataset.favourite === 'true';\n\n            if (aFav && !bFav) {\n                return -1;\n            } if (bFav && !aFav) {\n                return 1;\n            }\n\n            return a.dataset.lang > b.dataset.lang ? 1 : -1;\n        }).map(button => button.parentElement);\n\n        for (const parent of sortedParents) {\n            this.languageOptionsContainer.append(parent);\n        }\n    }\n\n    save() {\n        if (this.saveCallback) {\n            this.saveCallback(this.editor.getContent(), this.languageInput.value);\n        }\n        this.hide();\n    }\n\n    async open(code, language, saveCallback, cancelCallback) {\n        this.languageInput.value = language;\n        this.saveCallback = saveCallback;\n        this.cancelCallback = cancelCallback;\n\n        await this.show();\n        this.languageInputChange(language);\n        this.editor.setContent(code);\n    }\n\n    async show() {\n        const Code = await window.importVersioned('code');\n        if (!this.editor) {\n            this.editor = Code.popupEditor(this.editorInput, this.languageInput.value);\n        }\n\n        this.loadHistory();\n        this.getPopup().show(() => {\n            this.editor.focus();\n        }, () => {\n            this.addHistory();\n            if (this.cancelCallback) {\n                this.cancelCallback();\n            }\n        });\n    }\n\n    hide() {\n        this.getPopup().hide();\n        this.addHistory();\n    }\n\n    /**\n     * @returns {Popup}\n     */\n    getPopup() {\n        return window.$components.firstOnElement(this.popup, 'popup');\n    }\n\n    async updateEditorMode(language) {\n        this.editor.setMode(language, this.editor.getContent());\n    }\n\n    languageInputChange(language) {\n        this.updateEditorMode(language);\n        const inputLang = language.toLowerCase();\n\n        for (const link of this.languageButtons) {\n            const lang = link.dataset.lang.toLowerCase().trim();\n            const isMatch = inputLang === lang;\n            link.classList.toggle('active', isMatch);\n            if (isMatch) {\n                link.scrollIntoView({block: 'center', behavior: 'smooth'});\n            }\n        }\n    }\n\n    loadHistory() {\n        this.history = JSON.parse(window.sessionStorage.getItem(this.historyKey) || '{}');\n        const historyKeys = Object.keys(this.history).reverse();\n        this.historyDropDown.classList.toggle('hidden', historyKeys.length === 0);\n        this.historyList.innerHTML = historyKeys.map(key => {\n            const localTime = (new Date(parseInt(key, 10))).toLocaleTimeString();\n            return `<li><button type=\"button\" data-time=\"${key}\" class=\"text-item\">${localTime}</button></li>`;\n        }).join('');\n    }\n\n    addHistory() {\n        if (!this.editor) return;\n        const code = this.editor.getContent();\n        if (!code) return;\n\n        // Stop if we'd be storing the same as the last item\n        const lastHistoryKey = Object.keys(this.history).pop();\n        if (this.history[lastHistoryKey] === code) return;\n\n        this.history[String(Date.now())] = code;\n        const historyString = JSON.stringify(this.history);\n        window.sessionStorage.setItem(this.historyKey, historyString);\n    }\n\n}\n", "import {Component} from './component';\n\nexport class CodeHighlighter extends Component {\n\n    setup() {\n        const container = this.$el;\n\n        const codeBlocks = container.querySelectorAll('pre');\n        if (codeBlocks.length > 0) {\n            window.importVersioned('code').then(Code => {\n                Code.highlightWithin(container);\n            });\n        }\n    }\n\n}\n", "/**\n * A simple component to render a code editor within the textarea\n * this exists upon.\n */\nimport {Component} from './component';\n\nexport class CodeTextarea extends Component {\n\n    async setup() {\n        const {mode} = this.$opts;\n        const Code = await window.importVersioned('code');\n        Code.inlineEditor(this.$el, mode);\n    }\n\n}\n", "import {slideDown, slideUp} from '../services/animations';\nimport {Component} from './component';\n\n/**\n * Collapsible\n * Provides some simple logic to allow collapsible sections.\n */\nexport class Collapsible extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.trigger = this.$refs.trigger;\n        this.content = this.$refs.content;\n\n        if (this.trigger) {\n            this.trigger.addEventListener('click', this.toggle.bind(this));\n            this.openIfContainsError();\n        }\n    }\n\n    open() {\n        this.container.classList.add('open');\n        this.trigger.setAttribute('aria-expanded', 'true');\n        slideDown(this.content, 300);\n    }\n\n    close() {\n        this.container.classList.remove('open');\n        this.trigger.setAttribute('aria-expanded', 'false');\n        slideUp(this.content, 300);\n    }\n\n    toggle() {\n        if (this.container.classList.contains('open')) {\n            this.close();\n        } else {\n            this.open();\n        }\n    }\n\n    openIfContainsError() {\n        const error = this.content.querySelector('.text-neg.text-small');\n        if (error) {\n            this.open();\n        }\n    }\n\n}\n", "import {onSelect} from '../services/dom';\nimport {Component} from './component';\n\n/**\n * Custom equivalent of window.confirm() using our popup component.\n * Is promise based so can be used like so:\n * `const result = await dialog.show()`\n */\nexport class ConfirmDialog extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.confirmButton = this.$refs.confirm;\n\n        this.res = null;\n\n        onSelect(this.confirmButton, () => {\n            this.sendResult(true);\n            this.getPopup().hide();\n        });\n    }\n\n    show() {\n        this.getPopup().show(null, () => {\n            this.sendResult(false);\n        });\n\n        return new Promise(res => {\n            this.res = res;\n        });\n    }\n\n    /**\n     * @returns {Popup}\n     */\n    getPopup() {\n        return window.$components.firstOnElement(this.container, 'popup');\n    }\n\n    /**\n     * @param {Boolean} result\n     */\n    sendResult(result) {\n        if (this.res) {\n            this.res(result);\n            this.res = null;\n        }\n    }\n\n}\n", "import {Component} from './component';\n\nexport class CustomCheckbox extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.checkbox = this.container.querySelector('input[type=checkbox]');\n        this.display = this.container.querySelector('[role=\"checkbox\"]');\n\n        this.checkbox.addEventListener('change', this.stateChange.bind(this));\n        this.container.addEventListener('keydown', this.onKeyDown.bind(this));\n    }\n\n    onKeyDown(event) {\n        const isEnterOrSpace = event.key === ' ' || event.key === 'Enter';\n        if (isEnterOrSpace) {\n            event.preventDefault();\n            this.toggle();\n        }\n    }\n\n    toggle() {\n        this.checkbox.checked = !this.checkbox.checked;\n        this.checkbox.dispatchEvent(new Event('change'));\n        this.stateChange();\n    }\n\n    stateChange() {\n        const checked = this.checkbox.checked ? 'true' : 'false';\n        this.display.setAttribute('aria-checked', checked);\n    }\n\n}\n", "import {Component} from './component';\n\nexport class DetailsHighlighter extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.dealtWith = false;\n\n        this.container.addEventListener('toggle', this.onToggle.bind(this));\n    }\n\n    onToggle() {\n        if (this.dealtWith) return;\n\n        if (this.container.querySelector('pre')) {\n            window.importVersioned('code').then(Code => {\n                Code.highlightWithin(this.container);\n            });\n        }\n        this.dealtWith = true;\n    }\n\n}\n", "import {onSelect} from '../services/dom';\nimport {KeyboardNavigationHandler} from '../services/keyboard-navigation';\nimport {Component} from './component';\n\n/**\n * Dropdown\n * Provides some simple logic to create simple dropdown menus.\n */\nexport class Dropdown extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.menu = this.$refs.menu;\n        this.toggle = this.$refs.toggle;\n        this.moveMenu = this.$opts.moveMenu;\n        this.bubbleEscapes = this.$opts.bubbleEscapes === 'true';\n\n        this.direction = (document.dir === 'rtl') ? 'right' : 'left';\n        this.body = document.body;\n        this.showing = false;\n\n        this.hide = this.hide.bind(this);\n        this.setupListeners();\n    }\n\n    show(event = null) {\n        this.hideAll();\n\n        this.menu.style.display = 'block';\n        this.menu.classList.add('anim', 'menuIn');\n        this.toggle.setAttribute('aria-expanded', 'true');\n\n        const menuOriginalRect = this.menu.getBoundingClientRect();\n        let heightOffset = 0;\n        const toggleHeight = this.toggle.getBoundingClientRect().height;\n        const dropUpwards = menuOriginalRect.bottom > window.innerHeight;\n        const containerRect = this.container.getBoundingClientRect();\n\n        // If enabled, Move to body to prevent being trapped within scrollable sections\n        if (this.moveMenu) {\n            this.body.appendChild(this.menu);\n            this.menu.style.position = 'fixed';\n            this.menu.style.width = `${menuOriginalRect.width}px`;\n            this.menu.style.left = `${menuOriginalRect.left}px`;\n            if (dropUpwards) {\n                heightOffset = (window.innerHeight - menuOriginalRect.top - toggleHeight / 2);\n            } else {\n                heightOffset = menuOriginalRect.top;\n            }\n        }\n\n        // Adjust menu to display upwards if near the bottom of the screen\n        if (dropUpwards) {\n            this.menu.style.top = 'initial';\n            this.menu.style.bottom = `${heightOffset}px`;\n            const maxHeight = (window.innerHeight - 40) - (window.innerHeight - containerRect.bottom);\n            this.menu.style.maxHeight = `${Math.floor(maxHeight)}px`;\n        } else {\n            this.menu.style.top = `${heightOffset}px`;\n            this.menu.style.bottom = 'initial';\n            const maxHeight = (window.innerHeight - 40) - containerRect.top;\n            this.menu.style.maxHeight = `${Math.floor(maxHeight)}px`;\n        }\n\n        // Set listener to hide on mouse leave or window click\n        this.menu.addEventListener('mouseleave', this.hide);\n        window.addEventListener('click', clickEvent => {\n            if (!this.menu.contains(clickEvent.target)) {\n                this.hide();\n            }\n        });\n\n        // Focus on first input if existing\n        const input = this.menu.querySelector('input');\n        if (input !== null) input.focus();\n\n        this.showing = true;\n\n        const showEvent = new Event('show');\n        this.container.dispatchEvent(showEvent);\n\n        if (event) {\n            event.stopPropagation();\n        }\n    }\n\n    hideAll() {\n        for (const dropdown of window.$components.get('dropdown')) {\n            dropdown.hide();\n        }\n    }\n\n    hide() {\n        this.menu.style.display = 'none';\n        this.menu.classList.remove('anim', 'menuIn');\n        this.toggle.setAttribute('aria-expanded', 'false');\n        this.menu.style.top = '';\n        this.menu.style.bottom = '';\n        this.menu.style.maxHeight = '';\n\n        if (this.moveMenu) {\n            this.menu.style.position = '';\n            this.menu.style[this.direction] = '';\n            this.menu.style.width = '';\n            this.menu.style.left = '';\n            this.container.appendChild(this.menu);\n        }\n\n        this.showing = false;\n    }\n\n    setupListeners() {\n        const keyboardNavHandler = new KeyboardNavigationHandler(this.container, event => {\n            this.hide();\n            this.toggle.focus();\n            if (!this.bubbleEscapes) {\n                event.stopPropagation();\n            }\n        }, event => {\n            if (event.target.nodeName === 'INPUT') {\n                event.preventDefault();\n                event.stopPropagation();\n            }\n            this.hide();\n        });\n\n        if (this.moveMenu) {\n            keyboardNavHandler.shareHandlingToEl(this.menu);\n        }\n\n        // Hide menu on option click\n        this.container.addEventListener('click', event => {\n            const possibleChildren = Array.from(this.menu.querySelectorAll('a'));\n            if (possibleChildren.includes(event.target)) {\n                this.hide();\n            }\n        });\n\n        onSelect(this.toggle, event => {\n            event.stopPropagation();\n            event.preventDefault();\n            this.show(event);\n            if (event instanceof KeyboardEvent) {\n                keyboardNavHandler.focusNext();\n            }\n        });\n    }\n\n}\n", "import {debounce} from '../services/util';\nimport {transitionHeight} from '../services/animations';\nimport {Component} from './component';\n\nexport class DropdownSearch extends Component {\n\n    setup() {\n        this.elem = this.$el;\n        this.searchInput = this.$refs.searchInput;\n        this.loadingElem = this.$refs.loading;\n        this.listContainerElem = this.$refs.listContainer;\n\n        this.localSearchSelector = this.$opts.localSearchSelector;\n        this.url = this.$opts.url;\n\n        this.elem.addEventListener('show', this.onShow.bind(this));\n        this.searchInput.addEventListener('input', this.onSearch.bind(this));\n\n        this.runAjaxSearch = debounce(this.runAjaxSearch, 300, false);\n    }\n\n    onShow() {\n        this.loadList();\n    }\n\n    onSearch() {\n        const input = this.searchInput.value.toLowerCase().trim();\n        if (this.localSearchSelector) {\n            this.runLocalSearch(input);\n        } else {\n            this.toggleLoading(true);\n            this.listContainerElem.innerHTML = '';\n            this.runAjaxSearch(input);\n        }\n    }\n\n    runAjaxSearch(searchTerm) {\n        this.loadList(searchTerm);\n    }\n\n    runLocalSearch(searchTerm) {\n        const listItems = this.listContainerElem.querySelectorAll(this.localSearchSelector);\n        for (const listItem of listItems) {\n            const match = !searchTerm || listItem.textContent.toLowerCase().includes(searchTerm);\n            listItem.style.display = match ? 'flex' : 'none';\n            listItem.classList.toggle('hidden', !match);\n        }\n    }\n\n    async loadList(searchTerm = '') {\n        this.listContainerElem.innerHTML = '';\n        this.toggleLoading(true);\n\n        try {\n            const resp = await window.$http.get(this.getAjaxUrl(searchTerm));\n            const animate = transitionHeight(this.listContainerElem, 80);\n            this.listContainerElem.innerHTML = resp.data;\n            animate();\n        } catch (err) {\n            console.error(err);\n        }\n\n        this.toggleLoading(false);\n        if (this.localSearchSelector) {\n            this.onSearch();\n        }\n    }\n\n    getAjaxUrl(searchTerm = null) {\n        if (!searchTerm) {\n            return this.url;\n        }\n\n        const joiner = this.url.includes('?') ? '&' : '?';\n        return `${this.url}${joiner}search=${encodeURIComponent(searchTerm)}`;\n    }\n\n    toggleLoading(show = false) {\n        this.loadingElem.style.display = show ? 'block' : 'none';\n    }\n\n}\n", "export class Clipboard {\n\n    /**\n     * Constructor\n     * @param {DataTransfer} clipboardData\n     */\n    constructor(clipboardData) {\n        this.data = clipboardData;\n    }\n\n    /**\n     * Check if the clipboard has any items.\n     */\n    hasItems() {\n        return Boolean(this.data) && Boolean(this.data.types) && this.data.types.length > 0;\n    }\n\n    /**\n     * Check if the given event has tabular-looking data in the clipboard.\n     * @return {boolean}\n     */\n    containsTabularData() {\n        const rtfData = this.data.getData('text/rtf');\n        return rtfData && rtfData.includes('\\\\trowd');\n    }\n\n    /**\n     * Get the images that are in the clipboard data.\n     * @return {Array<File>}\n     */\n    getImages() {\n        const {types} = this.data;\n        const images = [];\n\n        for (const type of types) {\n            if (type.includes('image')) {\n                const item = this.data.getData(type);\n                images.push(item.getAsFile());\n            }\n        }\n\n        const imageFiles = this.getFiles().filter(f => f.type.includes('image'));\n        images.push(...imageFiles);\n\n        return images;\n    }\n\n    /**\n     * Get the files included in the clipboard data.\n     * @return {File[]}\n     */\n    getFiles() {\n        const {files} = this.data;\n        return [...files];\n    }\n\n}\n\nexport async function copyTextToClipboard(text) {\n    if (window.isSecureContext && navigator.clipboard) {\n        await navigator.clipboard.writeText(text);\n        return;\n    }\n\n    // Backup option where we can't use the navigator.clipboard API\n    const tempInput = document.createElement('textarea');\n    tempInput.style = 'position: absolute; left: -1000px; top: -1000px;';\n    tempInput.value = text;\n    document.body.appendChild(tempInput);\n    tempInput.select();\n    document.execCommand('copy');\n    document.body.removeChild(tempInput);\n}\n", "import {Component} from './component';\nimport {Clipboard} from '../services/clipboard';\nimport {\n    elem, getLoading, onSelect, removeLoading,\n} from '../services/dom';\n\nexport class Dropzone extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.statusArea = this.$refs.statusArea;\n        this.dropTarget = this.$refs.dropTarget;\n        this.selectButtons = this.$manyRefs.selectButton || [];\n\n        this.isActive = true;\n\n        this.url = this.$opts.url;\n        this.method = (this.$opts.method || 'post').toUpperCase();\n        this.successMessage = this.$opts.successMessage;\n        this.errorMessage = this.$opts.errorMessage;\n        this.uploadLimitMb = Number(this.$opts.uploadLimit);\n        this.uploadLimitMessage = this.$opts.uploadLimitMessage;\n        this.zoneText = this.$opts.zoneText;\n        this.fileAcceptTypes = this.$opts.fileAccept;\n        this.allowMultiple = this.$opts.allowMultiple === 'true';\n\n        this.setupListeners();\n    }\n\n    /**\n     * Public method to allow external disabling/enabling of this drag+drop dropzone.\n     * @param {Boolean} active\n     */\n    toggleActive(active) {\n        this.isActive = active;\n    }\n\n    setupListeners() {\n        onSelect(this.selectButtons, this.manualSelectHandler.bind(this));\n        this.setupDropTargetHandlers();\n    }\n\n    setupDropTargetHandlers() {\n        let depth = 0;\n\n        const reset = () => {\n            this.hideOverlay();\n            depth = 0;\n        };\n\n        this.dropTarget.addEventListener('dragenter', event => {\n            event.preventDefault();\n            depth += 1;\n\n            if (depth === 1 && this.isActive) {\n                this.showOverlay();\n            }\n        });\n\n        this.dropTarget.addEventListener('dragover', event => {\n            event.preventDefault();\n        });\n\n        this.dropTarget.addEventListener('dragend', reset);\n        this.dropTarget.addEventListener('dragleave', () => {\n            depth -= 1;\n            if (depth === 0) {\n                reset();\n            }\n        });\n        this.dropTarget.addEventListener('drop', event => {\n            event.preventDefault();\n            reset();\n\n            if (!this.isActive) {\n                return;\n            }\n\n            const clipboard = new Clipboard(event.dataTransfer);\n            const files = clipboard.getFiles();\n            for (const file of files) {\n                this.createUploadFromFile(file);\n            }\n        });\n    }\n\n    manualSelectHandler() {\n        const input = elem('input', {\n            type: 'file',\n            style: 'left: -400px; visibility: hidden; position: fixed;',\n            accept: this.fileAcceptTypes,\n            multiple: this.allowMultiple ? '' : null,\n        });\n        this.container.append(input);\n        input.click();\n        input.addEventListener('change', () => {\n            for (const file of input.files) {\n                this.createUploadFromFile(file);\n            }\n            input.remove();\n        });\n    }\n\n    showOverlay() {\n        const overlay = this.dropTarget.querySelector('.dropzone-overlay');\n        if (!overlay) {\n            const zoneElem = elem('div', {class: 'dropzone-overlay'}, [this.zoneText]);\n            this.dropTarget.append(zoneElem);\n        }\n    }\n\n    hideOverlay() {\n        const overlay = this.dropTarget.querySelector('.dropzone-overlay');\n        if (overlay) {\n            overlay.remove();\n        }\n    }\n\n    /**\n     * @param {File} file\n     * @return {Upload}\n     */\n    createUploadFromFile(file) {\n        const {\n            dom, status, progress, dismiss,\n        } = this.createDomForFile(file);\n        this.statusArea.append(dom);\n        const component = this;\n\n        const upload = {\n            file,\n            dom,\n            updateProgress(percentComplete) {\n                progress.textContent = `${percentComplete}%`;\n                progress.style.width = `${percentComplete}%`;\n            },\n            markError(message) {\n                status.setAttribute('data-status', 'error');\n                status.textContent = message;\n                removeLoading(dom);\n                this.updateProgress(100);\n            },\n            markSuccess(message) {\n                status.setAttribute('data-status', 'success');\n                status.textContent = message;\n                removeLoading(dom);\n                setTimeout(dismiss, 2400);\n                component.$emit('upload-success', {\n                    name: file.name,\n                });\n            },\n        };\n\n        // Enforce early upload filesize limit\n        if (file.size > (this.uploadLimitMb * 1000000)) {\n            upload.markError(this.uploadLimitMessage);\n            return upload;\n        }\n\n        this.startXhrForUpload(upload);\n\n        return upload;\n    }\n\n    /**\n     * @param {Upload} upload\n     */\n    startXhrForUpload(upload) {\n        const formData = new FormData();\n        formData.append('file', upload.file, upload.file.name);\n        if (this.method !== 'POST') {\n            formData.append('_method', this.method);\n        }\n        const component = this;\n\n        const req = window.$http.createXMLHttpRequest('POST', this.url, {\n            error() {\n                upload.markError(component.errorMessage);\n            },\n            readystatechange() {\n                if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\n                    upload.markSuccess(component.successMessage);\n                } else if (this.readyState === XMLHttpRequest.DONE && this.status >= 400) {\n                    const content = this.responseText;\n                    const data = content.startsWith('{') ? JSON.parse(content) : {message: content};\n                    const message = data?.message || data?.error || content;\n                    upload.markError(message);\n                }\n            },\n        });\n\n        req.upload.addEventListener('progress', evt => {\n            const percent = Math.min(Math.ceil((evt.loaded / evt.total) * 100), 100);\n            upload.updateProgress(percent);\n        });\n\n        req.setRequestHeader('Accept', 'application/json');\n        req.send(formData);\n    }\n\n    /**\n     * @param {File} file\n     * @return {{image: Element, dom: Element, progress: Element, status: Element, dismiss: function}}\n     */\n    createDomForFile(file) {\n        const image = elem('img', {src: \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath d='M9.224 7.373a.924.924 0 0 0-.92.925l-.006 7.404c0 .509.412.925.921.925h5.557a.928.928 0 0 0 .926-.925v-5.553l-2.777-2.776Zm3.239 3.239V8.067l2.545 2.545z' style='fill:%23000;fill-opacity:.75'/%3E%3C/svg%3E\"});\n        const status = elem('div', {class: 'dropzone-file-item-status'}, []);\n        const progress = elem('div', {class: 'dropzone-file-item-progress'});\n        const imageWrap = elem('div', {class: 'dropzone-file-item-image-wrap'}, [image]);\n\n        const dom = elem('div', {class: 'dropzone-file-item'}, [\n            imageWrap,\n            elem('div', {class: 'dropzone-file-item-text-wrap'}, [\n                elem('div', {class: 'dropzone-file-item-label'}, [file.name]),\n                getLoading(),\n                status,\n            ]),\n            progress,\n        ]);\n\n        if (file.type.startsWith('image/')) {\n            image.src = URL.createObjectURL(file);\n        }\n\n        const dismiss = () => {\n            dom.classList.add('dismiss');\n            dom.addEventListener('animationend', () => {\n                dom.remove();\n            });\n        };\n\n        dom.addEventListener('click', dismiss);\n\n        return {\n            dom, progress, status, dismiss,\n        };\n    }\n\n}\n\n/**\n * @typedef Upload\n * @property {File} file\n * @property {Element} dom\n * @property {function(Number)} updateProgress\n * @property {function(String)} markError\n * @property {function(String)} markSuccess\n */\n", "import {Component} from './component';\n\nexport class EditorToolbox extends Component {\n\n    setup() {\n        // Elements\n        this.container = this.$el;\n        this.buttons = this.$manyRefs.tabButton;\n        this.contentElements = this.$manyRefs.tabContent;\n        this.toggleButton = this.$refs.toggle;\n        this.editorWrapEl = this.container.closest('.page-editor');\n\n        this.setupListeners();\n\n        // Set the first tab as active on load\n        this.setActiveTab(this.contentElements[0].dataset.tabContent);\n    }\n\n    setupListeners() {\n        // Toolbox toggle button click\n        this.toggleButton.addEventListener('click', () => this.toggle());\n        // Tab button click\n        this.container.addEventListener('click', event => {\n            const button = event.target.closest('button');\n            if (this.buttons.includes(button)) {\n                const name = button.dataset.tab;\n                this.setActiveTab(name, true);\n            }\n        });\n    }\n\n    toggle() {\n        this.container.classList.toggle('open');\n        const isOpen = this.container.classList.contains('open');\n        this.toggleButton.setAttribute('aria-expanded', isOpen ? 'true' : 'false');\n        this.editorWrapEl.classList.toggle('toolbox-open', isOpen);\n    }\n\n    setActiveTab(tabName, openToolbox = false) {\n        // Set button visibility\n        for (const button of this.buttons) {\n            button.classList.remove('active');\n            const bName = button.dataset.tab;\n            if (bName === tabName) button.classList.add('active');\n        }\n\n        // Set content visibility\n        for (const contentEl of this.contentElements) {\n            contentEl.style.display = 'none';\n            const cName = contentEl.dataset.tabContent;\n            if (cName === tabName) contentEl.style.display = 'block';\n        }\n\n        if (openToolbox && !this.container.classList.contains('open')) {\n            this.toggle();\n        }\n    }\n\n}\n", "import {htmlToDom} from '../services/dom';\nimport {Component} from './component';\n\nexport class EntityPermissions extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.entityType = this.$opts.entityType;\n\n        this.everyoneInheritToggle = this.$refs.everyoneInherit;\n        this.roleSelect = this.$refs.roleSelect;\n        this.roleContainer = this.$refs.roleContainer;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        // \"Everyone Else\" inherit toggle\n        this.everyoneInheritToggle.addEventListener('change', event => {\n            const inherit = event.target.checked;\n            const permissions = document.querySelectorAll('input[name^=\"permissions[0][\"]');\n            for (const permission of permissions) {\n                permission.disabled = inherit;\n                permission.checked = false;\n            }\n        });\n\n        // Remove role row button click\n        this.container.addEventListener('click', event => {\n            const button = event.target.closest('button');\n            if (button && button.dataset.roleId) {\n                this.removeRowOnButtonClick(button);\n            }\n        });\n\n        // Role select change\n        this.roleSelect.addEventListener('change', () => {\n            const roleId = this.roleSelect.value;\n            if (roleId) {\n                this.addRoleRow(roleId);\n            }\n        });\n    }\n\n    async addRoleRow(roleId) {\n        this.roleSelect.disabled = true;\n\n        // Remove option from select\n        const option = this.roleSelect.querySelector(`option[value=\"${roleId}\"]`);\n        if (option) {\n            option.remove();\n        }\n\n        // Get and insert new row\n        const resp = await window.$http.get(`/permissions/form-row/${this.entityType}/${roleId}`);\n        const row = htmlToDom(resp.data);\n        this.roleContainer.append(row);\n\n        this.roleSelect.disabled = false;\n    }\n\n    removeRowOnButtonClick(button) {\n        const row = button.closest('.item-list-row');\n        const {roleId} = button.dataset;\n        const {roleName} = button.dataset;\n\n        const option = document.createElement('option');\n        option.value = roleId;\n        option.textContent = roleName;\n\n        this.roleSelect.append(option);\n        row.remove();\n    }\n\n}\n", "import {onSelect} from '../services/dom';\nimport {Component} from './component';\n\nexport class EntitySearch extends Component {\n\n    setup() {\n        this.entityId = this.$opts.entityId;\n        this.entityType = this.$opts.entityType;\n\n        this.contentView = this.$refs.contentView;\n        this.searchView = this.$refs.searchView;\n        this.searchResults = this.$refs.searchResults;\n        this.searchInput = this.$refs.searchInput;\n        this.searchForm = this.$refs.searchForm;\n        this.clearButton = this.$refs.clearButton;\n        this.loadingBlock = this.$refs.loadingBlock;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        this.searchInput.addEventListener('change', this.runSearch.bind(this));\n        this.searchForm.addEventListener('submit', e => {\n            e.preventDefault();\n            this.runSearch();\n        });\n\n        onSelect(this.clearButton, this.clearSearch.bind(this));\n    }\n\n    runSearch() {\n        const term = this.searchInput.value.trim();\n        if (term.length === 0) {\n            this.clearSearch();\n            return;\n        }\n\n        this.searchView.classList.remove('hidden');\n        this.contentView.classList.add('hidden');\n        this.loadingBlock.classList.remove('hidden');\n\n        const url = window.baseUrl(`/search/${this.entityType}/${this.entityId}`);\n        window.$http.get(url, {term}).then(resp => {\n            this.searchResults.innerHTML = resp.data;\n        }).catch(console.error).then(() => {\n            this.loadingBlock.classList.add('hidden');\n        });\n    }\n\n    clearSearch() {\n        this.searchView.classList.add('hidden');\n        this.contentView.classList.remove('hidden');\n        this.loadingBlock.classList.add('hidden');\n        this.searchInput.value = '';\n    }\n\n}\n", "import {onChildEvent} from '../services/dom';\nimport {Component} from './component';\n\n/**\n * @typedef EntitySelectorSearchOptions\n * @property entityTypes string\n * @property entityPermission string\n * @property searchEndpoint string\n * @property initialValue string\n */\n\n/**\n * Entity Selector\n */\nexport class EntitySelector extends Component {\n\n    setup() {\n        this.elem = this.$el;\n\n        this.input = this.$refs.input;\n        this.searchInput = this.$refs.search;\n        this.loading = this.$refs.loading;\n        this.resultsContainer = this.$refs.results;\n\n        this.searchOptions = {\n            entityTypes: this.$opts.entityTypes || 'page,book,chapter',\n            entityPermission: this.$opts.entityPermission || 'view',\n            searchEndpoint: this.$opts.searchEndpoint || '',\n            initialValue: this.searchInput.value || '',\n        };\n\n        this.search = '';\n        this.lastClick = 0;\n\n        this.setupListeners();\n        this.showLoading();\n\n        if (this.searchOptions.searchEndpoint) {\n            this.initialLoad();\n        }\n    }\n\n    /**\n     * @param {EntitySelectorSearchOptions} options\n     */\n    configureSearchOptions(options) {\n        Object.assign(this.searchOptions, options);\n        this.reset();\n        this.searchInput.value = this.searchOptions.initialValue;\n    }\n\n    setupListeners() {\n        this.elem.addEventListener('click', this.onClick.bind(this));\n\n        let lastSearch = 0;\n        this.searchInput.addEventListener('input', () => {\n            lastSearch = Date.now();\n            this.showLoading();\n            setTimeout(() => {\n                if (Date.now() - lastSearch < 199) return;\n                this.searchEntities(this.searchInput.value);\n            }, 200);\n        });\n\n        this.searchInput.addEventListener('keydown', event => {\n            if (event.keyCode === 13) event.preventDefault();\n        });\n\n        // Keyboard navigation\n        onChildEvent(this.$el, '[data-entity-type]', 'keydown', event => {\n            if (event.ctrlKey && event.code === 'Enter') {\n                const form = this.$el.closest('form');\n                if (form) {\n                    form.submit();\n                    event.preventDefault();\n                    return;\n                }\n            }\n\n            if (event.code === 'ArrowDown') {\n                this.focusAdjacent(true);\n            }\n            if (event.code === 'ArrowUp') {\n                this.focusAdjacent(false);\n            }\n        });\n\n        this.searchInput.addEventListener('keydown', event => {\n            if (event.code === 'ArrowDown') {\n                this.focusAdjacent(true);\n            }\n        });\n    }\n\n    focusAdjacent(forward = true) {\n        const items = Array.from(this.resultsContainer.querySelectorAll('[data-entity-type]'));\n        const selectedIndex = items.indexOf(document.activeElement);\n        const newItem = items[selectedIndex + (forward ? 1 : -1)] || items[0];\n        if (newItem) {\n            newItem.focus();\n        }\n    }\n\n    reset() {\n        this.searchInput.value = '';\n        this.showLoading();\n        this.initialLoad();\n    }\n\n    focusSearch() {\n        this.searchInput.focus();\n    }\n\n    showLoading() {\n        this.loading.style.display = 'block';\n        this.resultsContainer.style.display = 'none';\n    }\n\n    hideLoading() {\n        this.loading.style.display = 'none';\n        this.resultsContainer.style.display = 'block';\n    }\n\n    initialLoad() {\n        if (!this.searchOptions.searchEndpoint) {\n            throw new Error('Search endpoint not set for entity-selector load');\n        }\n\n        if (this.searchOptions.initialValue) {\n            this.searchEntities(this.searchOptions.initialValue);\n            return;\n        }\n\n        window.$http.get(this.searchUrl()).then(resp => {\n            this.resultsContainer.innerHTML = resp.data;\n            this.hideLoading();\n        });\n    }\n\n    searchUrl() {\n        const query = `types=${encodeURIComponent(this.searchOptions.entityTypes)}&permission=${encodeURIComponent(this.searchOptions.entityPermission)}`;\n        return `${this.searchOptions.searchEndpoint}?${query}`;\n    }\n\n    searchEntities(searchTerm) {\n        if (!this.searchOptions.searchEndpoint) {\n            throw new Error('Search endpoint not set for entity-selector load');\n        }\n\n        this.input.value = '';\n        const url = `${this.searchUrl()}&term=${encodeURIComponent(searchTerm)}`;\n        window.$http.get(url).then(resp => {\n            this.resultsContainer.innerHTML = resp.data;\n            this.hideLoading();\n        });\n    }\n\n    isDoubleClick() {\n        const now = Date.now();\n        const answer = now - this.lastClick < 300;\n        this.lastClick = now;\n        return answer;\n    }\n\n    onClick(event) {\n        const listItem = event.target.closest('[data-entity-type]');\n        if (listItem) {\n            event.preventDefault();\n            event.stopPropagation();\n            this.selectItem(listItem);\n        }\n    }\n\n    selectItem(item) {\n        const isDblClick = this.isDoubleClick();\n        const type = item.getAttribute('data-entity-type');\n        const id = item.getAttribute('data-entity-id');\n        const isSelected = (!item.classList.contains('selected') || isDblClick);\n\n        this.unselectAll();\n        this.input.value = isSelected ? `${type}:${id}` : '';\n\n        const link = item.getAttribute('href');\n        const name = item.querySelector('.entity-list-item-name').textContent;\n        const data = {id: Number(id), name, link};\n\n        if (isSelected) {\n            item.classList.add('selected');\n        } else {\n            window.$events.emit('entity-select-change', null);\n        }\n\n        if (!isDblClick && !isSelected) return;\n\n        if (isDblClick) {\n            this.confirmSelection(data);\n        }\n        if (isSelected) {\n            window.$events.emit('entity-select-change', data);\n        }\n    }\n\n    confirmSelection(data) {\n        window.$events.emit('entity-select-confirm', data);\n    }\n\n    unselectAll() {\n        const selected = this.elem.querySelectorAll('.selected');\n        for (const selectedElem of selected) {\n            selectedElem.classList.remove('selected', 'primary-background');\n        }\n    }\n\n}\n", "import {Component} from './component';\n\nexport class EntitySelectorPopup extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.selectButton = this.$refs.select;\n        this.selectorEl = this.$refs.selector;\n\n        this.callback = null;\n        this.selection = null;\n\n        this.selectButton.addEventListener('click', this.onSelectButtonClick.bind(this));\n        window.$events.listen('entity-select-change', this.onSelectionChange.bind(this));\n        window.$events.listen('entity-select-confirm', this.handleConfirmedSelection.bind(this));\n    }\n\n    /**\n     * Show the selector popup.\n     * @param {Function} callback\n     * @param {EntitySelectorSearchOptions} searchOptions\n     */\n    show(callback, searchOptions = {}) {\n        this.callback = callback;\n        this.getSelector().configureSearchOptions(searchOptions);\n        this.getPopup().show();\n\n        this.getSelector().focusSearch();\n    }\n\n    hide() {\n        this.getPopup().hide();\n    }\n\n    /**\n     * @returns {Popup}\n     */\n    getPopup() {\n        return window.$components.firstOnElement(this.container, 'popup');\n    }\n\n    /**\n     * @returns {EntitySelector}\n     */\n    getSelector() {\n        return window.$components.firstOnElement(this.selectorEl, 'entity-selector');\n    }\n\n    onSelectButtonClick() {\n        this.handleConfirmedSelection(this.selection);\n    }\n\n    onSelectionChange(entity) {\n        this.selection = entity;\n        if (entity === null) {\n            this.selectButton.setAttribute('disabled', 'true');\n        } else {\n            this.selectButton.removeAttribute('disabled');\n        }\n    }\n\n    handleConfirmedSelection(entity) {\n        this.hide();\n        this.getSelector().reset();\n        if (this.callback && entity) this.callback(entity);\n    }\n\n}\n", "import {onSelect} from '../services/dom';\nimport {Component} from './component';\n\n/**\n * EventEmitSelect\n * Component will simply emit an event when selected.\n *\n * Has one required option: \"name\".\n * A name of \"hello\" will emit a component DOM event of\n * \"event-emit-select-name\"\n *\n * All options will be set as the \"detail\" of the event with\n * their values included.\n */\nexport class EventEmitSelect extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.name = this.$opts.name;\n\n        onSelect(this.$el, () => {\n            this.$emit(this.name, this.$opts);\n        });\n    }\n\n}\n", "import {slideUp, slideDown} from '../services/animations';\nimport {Component} from './component';\n\nexport class ExpandToggle extends Component {\n\n    setup() {\n        this.targetSelector = this.$opts.targetSelector;\n        this.isOpen = this.$opts.isOpen === 'true';\n        this.updateEndpoint = this.$opts.updateEndpoint;\n\n        // Listener setup\n        this.$el.addEventListener('click', this.click.bind(this));\n    }\n\n    open(elemToToggle) {\n        slideDown(elemToToggle, 200);\n    }\n\n    close(elemToToggle) {\n        slideUp(elemToToggle, 200);\n    }\n\n    click(event) {\n        event.preventDefault();\n\n        const matchingElems = document.querySelectorAll(this.targetSelector);\n        for (const match of matchingElems) {\n            const action = this.isOpen ? this.close : this.open;\n            action(match);\n        }\n\n        this.isOpen = !this.isOpen;\n        this.updateSystemAjax(this.isOpen);\n    }\n\n    updateSystemAjax(isOpen) {\n        window.$http.patch(this.updateEndpoint, {\n            expand: isOpen ? 'true' : 'false',\n        });\n    }\n\n}\n", "import {htmlToDom} from '../services/dom';\nimport {debounce} from '../services/util';\nimport {KeyboardNavigationHandler} from '../services/keyboard-navigation';\nimport {Component} from './component';\n\n/**\n * Global (header) search box handling.\n * Mainly to show live results preview.\n */\nexport class GlobalSearch extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.input = this.$refs.input;\n        this.suggestions = this.$refs.suggestions;\n        this.suggestionResultsWrap = this.$refs.suggestionResults;\n        this.loadingWrap = this.$refs.loading;\n        this.button = this.$refs.button;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        const updateSuggestionsDebounced = debounce(this.updateSuggestions.bind(this), 200, false);\n\n        // Handle search input changes\n        this.input.addEventListener('input', () => {\n            const {value} = this.input;\n            if (value.length > 0) {\n                this.loadingWrap.style.display = 'block';\n                this.suggestionResultsWrap.style.opacity = '0.5';\n                updateSuggestionsDebounced(value);\n            } else {\n                this.hideSuggestions();\n            }\n        });\n\n        // Allow double click to show auto-click suggestions\n        this.input.addEventListener('dblclick', () => {\n            this.input.setAttribute('autocomplete', 'on');\n            this.button.focus();\n            this.input.focus();\n        });\n\n        new KeyboardNavigationHandler(this.container, () => {\n            this.hideSuggestions();\n        });\n    }\n\n    /**\n     * @param {String} search\n     */\n    async updateSuggestions(search) {\n        const {data: results} = await window.$http.get('/search/suggest', {term: search});\n        if (!this.input.value) {\n            return;\n        }\n\n        const resultDom = htmlToDom(results);\n\n        this.suggestionResultsWrap.innerHTML = '';\n        this.suggestionResultsWrap.style.opacity = '1';\n        this.loadingWrap.style.display = 'none';\n        this.suggestionResultsWrap.append(resultDom);\n        if (!this.container.classList.contains('search-active')) {\n            this.showSuggestions();\n        }\n    }\n\n    showSuggestions() {\n        this.container.classList.add('search-active');\n        window.requestAnimationFrame(() => {\n            this.suggestions.classList.add('search-suggestions-animation');\n        });\n    }\n\n    hideSuggestions() {\n        this.container.classList.remove('search-active');\n        this.suggestions.classList.remove('search-suggestions-animation');\n        this.suggestionResultsWrap.innerHTML = '';\n    }\n\n}\n", "import {Component} from './component';\n\nexport class HeaderMobileToggle extends Component {\n\n    setup() {\n        this.elem = this.$el;\n        this.toggleButton = this.$refs.toggle;\n        this.menu = this.$refs.menu;\n\n        this.open = false;\n        this.toggleButton.addEventListener('click', this.onToggle.bind(this));\n        this.onWindowClick = this.onWindowClick.bind(this);\n        this.onKeyDown = this.onKeyDown.bind(this);\n    }\n\n    onToggle(event) {\n        this.open = !this.open;\n        this.menu.classList.toggle('show', this.open);\n        this.toggleButton.setAttribute('aria-expanded', this.open ? 'true' : 'false');\n        if (this.open) {\n            this.elem.addEventListener('keydown', this.onKeyDown);\n            window.addEventListener('click', this.onWindowClick);\n        } else {\n            this.elem.removeEventListener('keydown', this.onKeyDown);\n            window.removeEventListener('click', this.onWindowClick);\n        }\n        event.stopPropagation();\n    }\n\n    onKeyDown(event) {\n        if (event.code === 'Escape') {\n            this.onToggle(event);\n        }\n    }\n\n    onWindowClick(event) {\n        this.onToggle(event);\n    }\n\n}\n", "import {\n    onChildEvent, onSelect, removeLoading, showLoading,\n} from '../services/dom';\nimport {Component} from './component';\n\nexport class ImageManager extends Component {\n\n    setup() {\n        // Options\n        this.uploadedTo = this.$opts.uploadedTo;\n\n        // Element References\n        this.container = this.$el;\n        this.popupEl = this.$refs.popup;\n        this.searchForm = this.$refs.searchForm;\n        this.searchInput = this.$refs.searchInput;\n        this.cancelSearch = this.$refs.cancelSearch;\n        this.listContainer = this.$refs.listContainer;\n        this.filterTabs = this.$manyRefs.filterTabs;\n        this.selectButton = this.$refs.selectButton;\n        this.uploadButton = this.$refs.uploadButton;\n        this.uploadHint = this.$refs.uploadHint;\n        this.formContainer = this.$refs.formContainer;\n        this.formContainerPlaceholder = this.$refs.formContainerPlaceholder;\n        this.dropzoneContainer = this.$refs.dropzoneContainer;\n        this.loadMore = this.$refs.loadMore;\n\n        // Instance data\n        this.type = 'gallery';\n        this.lastSelected = {};\n        this.lastSelectedTime = 0;\n        this.callback = null;\n        this.resetState = () => {\n            this.hasData = false;\n            this.page = 1;\n            this.filter = 'all';\n        };\n        this.resetState();\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        // Filter tab click\n        onSelect(this.filterTabs, e => {\n            this.resetAll();\n            this.filter = e.target.dataset.filter;\n            this.setActiveFilterTab(this.filter);\n            this.loadGallery();\n        });\n\n        // Search submit\n        this.searchForm.addEventListener('submit', event => {\n            this.resetListView();\n            this.loadGallery();\n            this.cancelSearch.toggleAttribute('hidden', !this.searchInput.value);\n            event.preventDefault();\n        });\n\n        // Cancel search button\n        onSelect(this.cancelSearch, () => {\n            this.resetListView();\n            this.resetSearchView();\n            this.loadGallery();\n        });\n\n        // Load more button click\n        onChildEvent(this.container, '.load-more button', 'click', this.runLoadMore.bind(this));\n\n        // Select image event\n        this.listContainer.addEventListener('event-emit-select-image', this.onImageSelectEvent.bind(this));\n\n        // Image load error handling\n        this.listContainer.addEventListener('error', event => {\n            event.target.src = window.baseUrl('loading_error.png');\n        }, true);\n\n        // Footer select button click\n        onSelect(this.selectButton, () => {\n            if (this.callback) {\n                this.callback(this.lastSelected);\n            }\n            this.hide();\n        });\n\n        // Delete button click\n        onChildEvent(this.formContainer, '#image-manager-delete', 'click', () => {\n            if (this.lastSelected) {\n                this.loadImageEditForm(this.lastSelected.id, true);\n            }\n        });\n\n        // Rebuild thumbs click\n        onChildEvent(this.formContainer, '#image-manager-rebuild-thumbs', 'click', async (_, button) => {\n            button.disabled = true;\n            if (this.lastSelected) {\n                await this.rebuildThumbnails(this.lastSelected.id);\n            }\n            button.disabled = false;\n        });\n\n        // Edit form submit\n        this.formContainer.addEventListener('ajax-form-success', () => {\n            this.refreshGallery();\n            this.resetEditForm();\n        });\n\n        // Image upload success\n        this.container.addEventListener('dropzone-upload-success', this.refreshGallery.bind(this));\n\n        // Auto load-more on scroll\n        const scrollZone = this.listContainer.parentElement;\n        let scrollEvents = [];\n        scrollZone.addEventListener('wheel', event => {\n            const scrollOffset = Math.ceil(scrollZone.scrollHeight - scrollZone.scrollTop);\n            const bottomedOut = scrollOffset === scrollZone.clientHeight;\n            if (!bottomedOut || event.deltaY < 1) {\n                return;\n            }\n\n            const secondAgo = Date.now() - 1000;\n            scrollEvents.push(Date.now());\n            scrollEvents = scrollEvents.filter(d => d >= secondAgo);\n            if (scrollEvents.length > 5 && this.canLoadMore()) {\n                this.runLoadMore();\n            }\n        });\n    }\n\n    show(callback, type = 'gallery') {\n        this.resetAll();\n\n        this.callback = callback;\n        this.type = type;\n        this.getPopup().show();\n\n        const hideUploads = type !== 'gallery';\n        this.dropzoneContainer.classList.toggle('hidden', hideUploads);\n        this.uploadButton.classList.toggle('hidden', hideUploads);\n        this.uploadHint.classList.toggle('hidden', hideUploads);\n\n        /** @var {Dropzone} * */\n        const dropzone = window.$components.firstOnElement(this.container, 'dropzone');\n        dropzone.toggleActive(!hideUploads);\n\n        if (!this.hasData) {\n            this.loadGallery();\n            this.hasData = true;\n        }\n    }\n\n    hide() {\n        this.getPopup().hide();\n    }\n\n    /**\n     * @returns {Popup}\n     */\n    getPopup() {\n        return window.$components.firstOnElement(this.popupEl, 'popup');\n    }\n\n    async loadGallery() {\n        const params = {\n            page: this.page,\n            search: this.searchInput.value || null,\n            uploaded_to: this.uploadedTo,\n            filter_type: this.filter === 'all' ? null : this.filter,\n        };\n\n        const {data: html} = await window.$http.get(`images/${this.type}`, params);\n        if (params.page === 1) {\n            this.listContainer.innerHTML = '';\n        }\n        this.addReturnedHtmlElementsToList(html);\n        removeLoading(this.listContainer);\n    }\n\n    addReturnedHtmlElementsToList(html) {\n        const el = document.createElement('div');\n        el.innerHTML = html;\n\n        const loadMore = el.querySelector('.load-more');\n        if (loadMore) {\n            loadMore.remove();\n            this.loadMore.innerHTML = loadMore.innerHTML;\n        }\n        this.loadMore.toggleAttribute('hidden', !loadMore);\n\n        window.$components.init(el);\n        for (const child of [...el.children]) {\n            this.listContainer.appendChild(child);\n        }\n    }\n\n    setActiveFilterTab(filterName) {\n        for (const tab of this.filterTabs) {\n            const selected = tab.dataset.filter === filterName;\n            tab.setAttribute('aria-selected', selected ? 'true' : 'false');\n        }\n    }\n\n    resetAll() {\n        this.resetState();\n        this.resetListView();\n        this.resetSearchView();\n        this.resetEditForm();\n        this.setActiveFilterTab('all');\n        this.selectButton.classList.add('hidden');\n    }\n\n    resetSearchView() {\n        this.searchInput.value = '';\n        this.cancelSearch.toggleAttribute('hidden', true);\n    }\n\n    resetEditForm() {\n        this.formContainer.innerHTML = '';\n        this.formContainerPlaceholder.removeAttribute('hidden');\n    }\n\n    resetListView() {\n        showLoading(this.listContainer);\n        this.page = 1;\n    }\n\n    refreshGallery() {\n        this.resetListView();\n        this.loadGallery();\n    }\n\n    async onImageSelectEvent(event) {\n        let image = JSON.parse(event.detail.data);\n        const isDblClick = ((image && image.id === this.lastSelected.id)\n            && Date.now() - this.lastSelectedTime < 400);\n        const alreadySelected = event.target.classList.contains('selected');\n        [...this.listContainer.querySelectorAll('.selected')].forEach(el => {\n            el.classList.remove('selected');\n        });\n\n        if (!alreadySelected && !isDblClick) {\n            event.target.classList.add('selected');\n            image = await this.loadImageEditForm(image.id);\n        } else if (!isDblClick) {\n            this.resetEditForm();\n        } else if (isDblClick) {\n            image = this.lastSelected;\n        }\n\n        this.selectButton.classList.toggle('hidden', alreadySelected);\n\n        if (isDblClick && this.callback) {\n            this.callback(image);\n            this.hide();\n        }\n\n        this.lastSelected = image;\n        this.lastSelectedTime = Date.now();\n    }\n\n    async loadImageEditForm(imageId, requestDelete = false) {\n        if (!requestDelete) {\n            this.formContainer.innerHTML = '';\n        }\n\n        const params = requestDelete ? {delete: true} : {};\n        const {data: formHtml} = await window.$http.get(`/images/edit/${imageId}`, params);\n        this.formContainer.innerHTML = formHtml;\n        this.formContainerPlaceholder.setAttribute('hidden', '');\n        window.$components.init(this.formContainer);\n\n        const imageDataEl = this.formContainer.querySelector('#image-manager-form-image-data');\n        return JSON.parse(imageDataEl.text);\n    }\n\n    runLoadMore() {\n        showLoading(this.loadMore);\n        this.page += 1;\n        this.loadGallery();\n    }\n\n    canLoadMore() {\n        return this.loadMore.querySelector('button') && !this.loadMore.hasAttribute('hidden');\n    }\n\n    async rebuildThumbnails(imageId) {\n        try {\n            const response = await window.$http.put(`/images/${imageId}/rebuild-thumbnails`);\n            window.$events.success(response.data);\n            this.refreshGallery();\n        } catch (err) {\n            window.$events.showResponseError(err);\n        }\n    }\n\n}\n", "import {Component} from './component';\n\nexport class ImagePicker extends Component {\n\n    setup() {\n        this.imageElem = this.$refs.image;\n        this.imageInput = this.$refs.imageInput;\n        this.resetInput = this.$refs.resetInput;\n        this.removeInput = this.$refs.removeInput;\n        this.resetButton = this.$refs.resetButton;\n        this.removeButton = this.$refs.removeButton || null;\n\n        this.defaultImage = this.$opts.defaultImage;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        this.resetButton.addEventListener('click', this.reset.bind(this));\n\n        if (this.removeButton) {\n            this.removeButton.addEventListener('click', this.removeImage.bind(this));\n        }\n\n        this.imageInput.addEventListener('change', this.fileInputChange.bind(this));\n    }\n\n    fileInputChange() {\n        this.resetInput.setAttribute('disabled', 'disabled');\n        if (this.removeInput) {\n            this.removeInput.setAttribute('disabled', 'disabled');\n        }\n\n        for (const file of this.imageInput.files) {\n            this.imageElem.src = window.URL.createObjectURL(file);\n        }\n        this.imageElem.classList.remove('none');\n    }\n\n    reset() {\n        this.imageInput.value = '';\n        this.imageElem.src = this.defaultImage;\n        this.resetInput.removeAttribute('disabled');\n        if (this.removeInput) {\n            this.removeInput.setAttribute('disabled', 'disabled');\n        }\n        this.imageElem.classList.remove('none');\n    }\n\n    removeImage() {\n        this.imageInput.value = '';\n        this.imageElem.classList.add('none');\n        this.removeInput.removeAttribute('disabled');\n        this.resetInput.setAttribute('disabled', 'disabled');\n    }\n\n}\n", "/**\n * ListSortControl\n * Manages the logic for the control which provides list sorting options.\n */\nimport {Component} from './component';\n\nexport class ListSortControl extends Component {\n\n    setup() {\n        this.elem = this.$el;\n        this.menu = this.$refs.menu;\n\n        this.sortInput = this.$refs.sort;\n        this.orderInput = this.$refs.order;\n        this.form = this.$refs.form;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        this.menu.addEventListener('click', event => {\n            if (event.target.closest('[data-sort-value]') !== null) {\n                this.sortOptionClick(event);\n            }\n        });\n\n        this.elem.addEventListener('click', event => {\n            if (event.target.closest('[data-sort-dir]') !== null) {\n                this.sortDirectionClick(event);\n            }\n        });\n    }\n\n    sortOptionClick(event) {\n        const sortOption = event.target.closest('[data-sort-value]');\n        this.sortInput.value = sortOption.getAttribute('data-sort-value');\n        event.preventDefault();\n        this.form.submit();\n    }\n\n    sortDirectionClick(event) {\n        const currentDir = this.orderInput.value;\n        this.orderInput.value = (currentDir === 'asc') ? 'desc' : 'asc';\n        event.preventDefault();\n        this.form.submit();\n    }\n\n}\n", "import {Component} from './component';\n\nexport class MarkdownEditor extends Component {\n\n    setup() {\n        this.elem = this.$el;\n\n        this.pageId = this.$opts.pageId;\n        this.textDirection = this.$opts.textDirection;\n        this.imageUploadErrorText = this.$opts.imageUploadErrorText;\n        this.serverUploadLimitText = this.$opts.serverUploadLimitText;\n\n        this.display = this.$refs.display;\n        this.input = this.$refs.input;\n        this.divider = this.$refs.divider;\n        this.displayWrap = this.$refs.displayWrap;\n\n        const {settingContainer} = this.$refs;\n        const settingInputs = settingContainer.querySelectorAll('input[type=\"checkbox\"]');\n\n        this.editor = null;\n        window.importVersioned('markdown').then(markdown => {\n            return markdown.init({\n                pageId: this.pageId,\n                container: this.elem,\n                displayEl: this.display,\n                inputEl: this.input,\n                drawioUrl: this.getDrawioUrl(),\n                settingInputs: Array.from(settingInputs),\n                text: {\n                    serverUploadLimit: this.serverUploadLimitText,\n                    imageUploadError: this.imageUploadErrorText,\n                },\n            });\n        }).then(editor => {\n            this.editor = editor;\n            this.setupListeners();\n            this.emitEditorEvents();\n            this.scrollToTextIfNeeded();\n            this.editor.actions.updateAndRender();\n        });\n    }\n\n    emitEditorEvents() {\n        window.$events.emitPublic(this.elem, 'editor-markdown::setup', {\n            markdownIt: this.editor.markdown.getRenderer(),\n            displayEl: this.display,\n            cmEditorView: this.editor.cm,\n        });\n    }\n\n    setupListeners() {\n        // Button actions\n        this.elem.addEventListener('click', event => {\n            const button = event.target.closest('button[data-action]');\n            if (button === null) return;\n\n            const action = button.getAttribute('data-action');\n            if (action === 'insertImage') this.editor.actions.showImageInsert();\n            if (action === 'insertLink') this.editor.actions.showLinkSelector();\n            if (action === 'insertDrawing' && (event.ctrlKey || event.metaKey)) {\n                this.editor.actions.showImageManager();\n                return;\n            }\n            if (action === 'insertDrawing') this.editor.actions.startDrawing();\n            if (action === 'fullscreen') this.editor.actions.fullScreen();\n        });\n\n        // Mobile section toggling\n        this.elem.addEventListener('click', event => {\n            const toolbarLabel = event.target.closest('.editor-toolbar-label');\n            if (!toolbarLabel) return;\n\n            const currentActiveSections = this.elem.querySelectorAll('.markdown-editor-wrap');\n            for (const activeElem of currentActiveSections) {\n                activeElem.classList.remove('active');\n            }\n\n            toolbarLabel.closest('.markdown-editor-wrap').classList.add('active');\n        });\n\n        this.handleDividerDrag();\n    }\n\n    handleDividerDrag() {\n        this.divider.addEventListener('pointerdown', () => {\n            const wrapRect = this.elem.getBoundingClientRect();\n            const moveListener = event => {\n                const xRel = event.pageX - wrapRect.left;\n                const xPct = Math.min(Math.max(20, Math.floor((xRel / wrapRect.width) * 100)), 80);\n                this.displayWrap.style.flexBasis = `${100 - xPct}%`;\n                this.editor.settings.set('editorWidth', xPct);\n            };\n            const upListener = () => {\n                window.removeEventListener('pointermove', moveListener);\n                window.removeEventListener('pointerup', upListener);\n                this.display.style.pointerEvents = null;\n                document.body.style.userSelect = null;\n            };\n\n            this.display.style.pointerEvents = 'none';\n            document.body.style.userSelect = 'none';\n            window.addEventListener('pointermove', moveListener);\n            window.addEventListener('pointerup', upListener);\n        });\n        const widthSetting = this.editor.settings.get('editorWidth');\n        if (widthSetting) {\n            this.displayWrap.style.flexBasis = `${100 - widthSetting}%`;\n        }\n    }\n\n    scrollToTextIfNeeded() {\n        const queryParams = (new URL(window.location)).searchParams;\n        const scrollText = queryParams.get('content-text');\n        if (scrollText) {\n            this.editor.actions.scrollToText(scrollText);\n        }\n    }\n\n    /**\n     * Get the URL for the configured drawio instance.\n     * @returns {String}\n     */\n    getDrawioUrl() {\n        const drawioAttrEl = document.querySelector('[drawio-url]');\n        if (!drawioAttrEl) {\n            return '';\n        }\n\n        return drawioAttrEl.getAttribute('drawio-url') || '';\n    }\n\n    /**\n     * Get the content of this editor.\n     * Used by the parent page editor component.\n     * @return {{html: String, markdown: String}}\n     */\n    getContent() {\n        return this.editor.actions.getContent();\n    }\n\n}\n", "import {Component} from './component';\n\nexport class NewUserPassword extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.inputContainer = this.$refs.inputContainer;\n        this.inviteOption = this.container.querySelector('input[name=send_invite]');\n\n        if (this.inviteOption) {\n            this.inviteOption.addEventListener('change', this.inviteOptionChange.bind(this));\n            this.inviteOptionChange();\n        }\n    }\n\n    inviteOptionChange() {\n        const inviting = (this.inviteOption.value === 'true');\n        const passwordBoxes = this.container.querySelectorAll('input[type=password]');\n        for (const input of passwordBoxes) {\n            input.disabled = inviting;\n        }\n\n        this.inputContainer.style.display = inviting ? 'none' : 'block';\n    }\n\n}\n", "import {Component} from './component';\n\nexport class Notification extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.type = this.$opts.type;\n        this.textElem = this.container.querySelector('span');\n        this.autoHide = this.$opts.autoHide === 'true';\n        this.initialShow = this.$opts.show === 'true';\n        this.container.style.display = 'grid';\n\n        window.$events.listen(this.type, text => {\n            this.show(text);\n        });\n        this.container.addEventListener('click', this.hide.bind(this));\n\n        if (this.initialShow) {\n            setTimeout(() => this.show(this.textElem.textContent), 100);\n        }\n\n        this.hideCleanup = this.hideCleanup.bind(this);\n    }\n\n    show(textToShow = '') {\n        this.container.removeEventListener('transitionend', this.hideCleanup);\n        this.textElem.textContent = textToShow;\n        this.container.style.display = 'grid';\n        setTimeout(() => {\n            this.container.classList.add('showing');\n        }, 1);\n\n        if (this.autoHide) {\n            const words = textToShow.split(' ').length;\n            const timeToShow = Math.max(2000, 1000 + (250 * words));\n            setTimeout(this.hide.bind(this), timeToShow);\n        }\n    }\n\n    hide() {\n        this.container.classList.remove('showing');\n        this.container.addEventListener('transitionend', this.hideCleanup);\n    }\n\n    hideCleanup() {\n        this.container.style.display = 'none';\n        this.container.removeEventListener('transitionend', this.hideCleanup);\n    }\n\n}\n", "import {onSelect} from '../services/dom';\nimport {Component} from './component';\n\nexport class OptionalInput extends Component {\n\n    setup() {\n        this.removeButton = this.$refs.remove;\n        this.showButton = this.$refs.show;\n        this.input = this.$refs.input;\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        onSelect(this.removeButton, () => {\n            this.input.value = '';\n            this.input.classList.add('hidden');\n            this.removeButton.classList.add('hidden');\n            this.showButton.classList.remove('hidden');\n        });\n\n        onSelect(this.showButton, () => {\n            this.input.classList.remove('hidden');\n            this.removeButton.classList.remove('hidden');\n            this.showButton.classList.add('hidden');\n        });\n    }\n\n}\n", "/**\n * @param {Editor} editor\n */\nexport function register(editor) {\n    // Headers\n    for (let i = 1; i < 5; i++) {\n        editor.shortcuts.add(`meta+${i}`, '', ['FormatBlock', false, `h${i + 1}`]);\n    }\n\n    // Other block shortcuts\n    editor.shortcuts.add('meta+5', '', ['FormatBlock', false, 'p']);\n    editor.shortcuts.add('meta+d', '', ['FormatBlock', false, 'p']);\n    editor.shortcuts.add('meta+6', '', ['FormatBlock', false, 'blockquote']);\n    editor.shortcuts.add('meta+q', '', ['FormatBlock', false, 'blockquote']);\n    editor.shortcuts.add('meta+7', '', ['codeeditor', false, 'pre']);\n    editor.shortcuts.add('meta+e', '', ['codeeditor', false, 'pre']);\n    editor.shortcuts.add('meta+8', '', ['FormatBlock', false, 'code']);\n    editor.shortcuts.add('meta+shift+E', '', ['FormatBlock', false, 'code']);\n    editor.shortcuts.add('meta+o', '', 'InsertOrderedList');\n    editor.shortcuts.add('meta+p', '', 'InsertUnorderedList');\n\n    // Save draft shortcut\n    editor.shortcuts.add('meta+S', '', () => {\n        window.$events.emit('editor-save-draft');\n    });\n\n    // Save page shortcut\n    editor.shortcuts.add('meta+13', '', () => {\n        window.$events.emit('editor-save-page');\n    });\n\n    // Loop through callout styles\n    editor.shortcuts.add('meta+9', '', () => {\n        const selectedNode = editor.selection.getNode();\n        const callout = selectedNode ? selectedNode.closest('.callout') : null;\n\n        const formats = ['info', 'success', 'warning', 'danger'];\n        const currentFormatIndex = formats.findIndex(format => {\n            return callout && callout.classList.contains(format);\n        });\n        const newFormatIndex = (currentFormatIndex + 1) % formats.length;\n        const newFormat = formats[newFormatIndex];\n\n        editor.formatter.apply(`callout${newFormat}`);\n    });\n\n    // Link selector shortcut\n    editor.shortcuts.add('meta+shift+K', '', () => {\n        /** @var {EntitySelectorPopup} * */\n        const selectorPopup = window.$components.first('entity-selector-popup');\n        const selectionText = editor.selection.getContent({format: 'text'}).trim();\n        selectorPopup.show(entity => {\n            if (editor.selection.isCollapsed()) {\n                editor.insertContent(editor.dom.createHTML('a', {href: entity.link}, editor.dom.encode(entity.name)));\n            } else {\n                editor.formatter.apply('link', {href: entity.link});\n            }\n\n            editor.selection.collapse(false);\n            editor.focus();\n        }, {\n            initialValue: selectionText,\n            searchEndpoint: '/search/entity-selector',\n            entityTypes: 'page,book,chapter,bookshelf',\n            entityPermission: 'view',\n        });\n    });\n}\n", "/**\n * @param {Editor} editor\n */\nexport function listen(editor) {\n    // Replace editor content\n    window.$events.listen('editor::replace', ({html}) => {\n        editor.setContent(html);\n    });\n\n    // Append editor content\n    window.$events.listen('editor::append', ({html}) => {\n        const content = editor.getContent() + html;\n        editor.setContent(content);\n    });\n\n    // Prepend editor content\n    window.$events.listen('editor::prepend', ({html}) => {\n        const content = html + editor.getContent();\n        editor.setContent(content);\n    });\n\n    // Insert editor content at the current location\n    window.$events.listen('editor::insert', ({html}) => {\n        editor.insertContent(html);\n    });\n\n    // Focus on the editor\n    window.$events.listen('editor::focus', () => {\n        if (editor.initialized) {\n            editor.focus();\n        }\n    });\n}\n", "/**\n * @param {Editor} editor\n * @param {String} scrollId\n */\nfunction scrollToText(editor, scrollId) {\n    const element = editor.dom.get(encodeURIComponent(scrollId).replace(/!/g, '%21'));\n    if (!element) {\n        return;\n    }\n\n    // scroll the element into the view and put the cursor at the end.\n    element.scrollIntoView();\n    editor.selection.select(element, true);\n    editor.selection.collapse(false);\n    editor.focus();\n}\n\n/**\n * Scroll to a section dictated by the current URL query string, if present.\n * Used when directly editing a specific section of the page.\n * @param {Editor} editor\n */\nexport function scrollToQueryString(editor) {\n    const queryParams = (new URL(window.location)).searchParams;\n    const scrollId = queryParams.get('content-id');\n    if (scrollId) {\n        scrollToText(editor, scrollId);\n    }\n}\n", "import {Clipboard} from '../services/clipboard';\n\nlet wrap;\nlet draggedContentEditable;\n\nfunction hasTextContent(node) {\n    return node && !!(node.textContent || node.innerText);\n}\n\n/**\n * Upload an image file to the server\n * @param {File} file\n * @param {int} pageId\n */\nasync function uploadImageFile(file, pageId) {\n    if (file === null || file.type.indexOf('image') !== 0) {\n        throw new Error('Not an image file');\n    }\n\n    const remoteFilename = file.name || `image-${Date.now()}.png`;\n    const formData = new FormData();\n    formData.append('file', file, remoteFilename);\n    formData.append('uploaded_to', pageId);\n\n    const resp = await window.$http.post(window.baseUrl('/images/gallery'), formData);\n    return resp.data;\n}\n\n/**\n * Handle pasting images from clipboard.\n * @param {Editor} editor\n * @param {WysiwygConfigOptions} options\n * @param {ClipboardEvent|DragEvent} event\n */\nfunction paste(editor, options, event) {\n    const clipboard = new Clipboard(event.clipboardData || event.dataTransfer);\n\n    // Don't handle the event ourselves if no items exist of contains table-looking data\n    if (!clipboard.hasItems() || clipboard.containsTabularData()) {\n        return;\n    }\n\n    const images = clipboard.getImages();\n    for (const imageFile of images) {\n        const id = `image-${Math.random().toString(16).slice(2)}`;\n        const loadingImage = window.baseUrl('/loading.gif');\n        event.preventDefault();\n\n        setTimeout(() => {\n            editor.insertContent(`<p><img src=\"${loadingImage}\" id=\"${id}\"></p>`);\n\n            uploadImageFile(imageFile, options.pageId).then(resp => {\n                const safeName = resp.name.replace(/\"/g, '');\n                const newImageHtml = `<img src=\"${resp.thumbs.display}\" alt=\"${safeName}\" />`;\n\n                const newEl = editor.dom.create('a', {\n                    target: '_blank',\n                    href: resp.url,\n                }, newImageHtml);\n\n                editor.dom.replace(newEl, id);\n            }).catch(err => {\n                editor.dom.remove(id);\n                window.$events.error(err?.data?.message || options.translations.imageUploadErrorText);\n                console.error(err);\n            });\n        }, 10);\n    }\n}\n\n/**\n * @param {Editor} editor\n */\nfunction dragStart(editor) {\n    const node = editor.selection.getNode();\n\n    if (node.nodeName === 'IMG') {\n        wrap = editor.dom.getParent(node, '.mceTemp');\n\n        if (!wrap && node.parentNode.nodeName === 'A' && !hasTextContent(node.parentNode)) {\n            wrap = node.parentNode;\n        }\n    }\n\n    // Track dragged contenteditable blocks\n    if (node.hasAttribute('contenteditable') && node.getAttribute('contenteditable') === 'false') {\n        draggedContentEditable = node;\n    }\n}\n\n/**\n * @param {Editor} editor\n * @param {WysiwygConfigOptions} options\n * @param {DragEvent} event\n */\nfunction drop(editor, options, event) {\n    const {dom} = editor;\n    const rng = window.tinymce.dom.RangeUtils.getCaretRangeFromPoint(\n        event.clientX,\n        event.clientY,\n        editor.getDoc(),\n    );\n\n    // Template insertion\n    const templateId = event.dataTransfer && event.dataTransfer.getData('bookstack/template');\n    if (templateId) {\n        event.preventDefault();\n        window.$http.get(`/templates/${templateId}`).then(resp => {\n            editor.selection.setRng(rng);\n            editor.undoManager.transact(() => {\n                editor.execCommand('mceInsertContent', false, resp.data.html);\n            });\n        });\n    }\n\n    // Don't allow anything to be dropped in a captioned image.\n    if (dom.getParent(rng.startContainer, '.mceTemp')) {\n        event.preventDefault();\n    } else if (wrap) {\n        event.preventDefault();\n\n        editor.undoManager.transact(() => {\n            editor.selection.setRng(rng);\n            editor.selection.setNode(wrap);\n            dom.remove(wrap);\n        });\n    }\n\n    // Handle contenteditable section drop\n    if (!event.isDefaultPrevented() && draggedContentEditable) {\n        event.preventDefault();\n        editor.undoManager.transact(() => {\n            const selectedNode = editor.selection.getNode();\n            const range = editor.selection.getRng();\n            const selectedNodeRoot = selectedNode.closest('body > *');\n            if (range.startOffset > (range.startContainer.length / 2)) {\n                selectedNodeRoot.after(draggedContentEditable);\n            } else {\n                selectedNodeRoot.before(draggedContentEditable);\n            }\n        });\n    }\n\n    // Handle image insert\n    if (!event.isDefaultPrevented()) {\n        paste(editor, options, event);\n    }\n\n    wrap = null;\n}\n\n/**\n * @param {Editor} editor\n * @param {WysiwygConfigOptions} options\n */\nexport function listenForDragAndPaste(editor, options) {\n    editor.on('dragstart', () => dragStart(editor));\n    editor.on('drop', event => drop(editor, options, event));\n    editor.on('paste', event => paste(editor, options, event));\n}\n", "/**\n * @param {WysiwygConfigOptions} options\n * @return {String}\n */\nexport function getPrimaryToolbar(options) {\n    const textDirPlugins = options.textDirection === 'rtl' ? 'ltr rtl' : '';\n\n    const toolbar = [\n        'undo redo',\n        'styles',\n        'bold italic underline forecolor backcolor formatoverflow',\n        'alignleft aligncenter alignright alignjustify',\n        'bullist numlist listoverflow',\n        textDirPlugins,\n        'link customtable imagemanager-insert insertoverflow',\n        'code about fullscreen',\n    ];\n\n    return toolbar.filter(row => Boolean(row)).join(' | ');\n}\n\n/**\n * @param {Editor} editor\n */\nfunction registerPrimaryToolbarGroups(editor) {\n    editor.ui.registry.addGroupToolbarButton('formatoverflow', {\n        icon: 'more-drawer',\n        tooltip: 'More',\n        items: 'strikethrough superscript subscript inlinecode removeformat',\n    });\n    editor.ui.registry.addGroupToolbarButton('listoverflow', {\n        icon: 'more-drawer',\n        tooltip: 'More',\n        items: 'tasklist outdent indent',\n    });\n    editor.ui.registry.addGroupToolbarButton('insertoverflow', {\n        icon: 'more-drawer',\n        tooltip: 'More',\n        items: 'customhr codeeditor drawio media details',\n    });\n}\n\n/**\n * @param {Editor} editor\n */\nfunction registerLinkContextToolbar(editor) {\n    editor.ui.registry.addContextToolbar('linkcontexttoolbar', {\n        predicate(node) {\n            return node.closest('a') !== null;\n        },\n        position: 'node',\n        scope: 'node',\n        items: 'link unlink openlink',\n    });\n}\n\n/**\n * @param {Editor} editor\n */\nfunction registerImageContextToolbar(editor) {\n    editor.ui.registry.addContextToolbar('imagecontexttoolbar', {\n        predicate(node) {\n            return node.closest('img') !== null;\n        },\n        position: 'node',\n        scope: 'node',\n        items: 'image',\n    });\n}\n\n/**\n * @param {Editor} editor\n */\nexport function registerAdditionalToolbars(editor) {\n    registerPrimaryToolbarGroups(editor);\n    registerLinkContextToolbar(editor);\n    registerImageContextToolbar(editor);\n}\n", "const icons = {\n    'table-delete-column': '<svg width=\"24\" height=\"24\"><path d=\"M21 19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14c1.1 0 2 .9 2 2zm-2 0V5h-4v2.2h-2V5h-2v2.2H9V5H5v14h4v-2.1h2V19h2v-2.1h2V19Z\"/><path d=\"M14.829 10.585 13.415 12l1.414 1.414c.943.943-.472 2.357-1.414 1.414L12 13.414l-1.414 1.414c-.944.944-2.358-.47-1.414-1.414L10.586 12l-1.414-1.415c-.943-.942.471-2.357 1.414-1.414L12 10.585l1.344-1.343c1.111-1.112 2.2.627 1.485 1.343z\" style=\"fill-rule:nonzero\"/></svg>',\n    'table-delete-row': '<svg width=\"24\" height=\"24\"><path d=\"M5 21a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14c0 1.1-.9 2-2 2zm0-2h14v-4h-2.2v-2H19v-2h-2.2V9H19V5H5v4h2.1v2H5v2h2.1v2H5Z\"/><path d=\"M13.415 14.829 12 13.415l-1.414 1.414c-.943.943-2.357-.472-1.414-1.414L10.586 12l-1.414-1.414c-.944-.944.47-2.358 1.414-1.414L12 10.586l1.415-1.414c.942-.943 2.357.471 1.414 1.414L13.415 12l1.343 1.344c1.112 1.111-.627 2.2-1.343 1.485z\" style=\"fill-rule:nonzero\"/></svg>',\n    'table-insert-column-after': '<svg width=\"24\" height=\"24\"><path d=\"M16 5h-5v14h5c1.235 0 1.234 2 0 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11c1.229 0 1.236 2 0 2zm-7 6V5H5v6zm0 8v-6H5v6zm11.076-6h-2v2c0 1.333-2 1.333-2 0v-2h-2c-1.335 0-1.335-2 0-2h2V9c0-1.333 2-1.333 2 0v2h1.9c1.572 0 1.113 2 .1 2z\"/></svg>',\n    'table-insert-column-before': '<svg width=\"24\" height=\"24\"><path d=\"M8 19h5V5H8C6.764 5 6.766 3 8 3h11a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H8c-1.229 0-1.236-2 0-2zm7-6v6h4v-6zm0-8v6h4V5ZM3.924 11h2V9c0-1.333 2-1.333 2 0v2h2c1.335 0 1.335 2 0 2h-2v2c0 1.333-2 1.333-2 0v-2h-1.9c-1.572 0-1.113-2-.1-2z\"/></svg>',\n    'table-insert-row-above': '<svg width=\"24\" height=\"24\"><path d=\"M5 8v5h14V8c0-1.235 2-1.234 2 0v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8C3 6.77 5 6.764 5 8zm6 7H5v4h6zm8 0h-6v4h6zM13 3.924v2h2c1.333 0 1.333 2 0 2h-2v2c0 1.335-2 1.335-2 0v-2H9c-1.333 0-1.333-2 0-2h2v-1.9c0-1.572 2-1.113 2-.1z\"/></svg>',\n    'table-insert-row-after': '<svg width=\"24\" height=\"24\"><path d=\"M19 16v-5H5v5c0 1.235-2 1.234-2 0V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v11c0 1.229-2 1.236-2 0zm-6-7h6V5h-6zM5 9h6V5H5Zm6 11.076v-2H9c-1.333 0-1.333-2 0-2h2v-2c0-1.335 2-1.335 2 0v2h2c1.333 0 1.333 2 0 2h-2v1.9c0 1.572-2 1.113-2 .1z\"/></svg>',\n    table: '<svg width=\"24\" height=\"24\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2ZM5 14v5h6v-5zm14 0h-6v5h6zm0-7h-6v5h6zM5 12h6V7H5Z\"/></svg>',\n    'table-delete-table': '<svg width=\"24\" height=\"24\"><path d=\"M5 21a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14c0 1.1-.9 2-2 2zm0-2h14V5H5v14z\"/><path d=\"m13.711 15.423-1.71-1.712-1.712 1.712c-1.14 1.14-2.852-.57-1.71-1.712l1.71-1.71-1.71-1.712c-1.143-1.142.568-2.853 1.71-1.71L12 10.288l1.711-1.71c1.141-1.142 2.852.57 1.712 1.71L13.71 12l1.626 1.626c1.345 1.345-.76 2.663-1.626 1.797z\" style=\"fill-rule:nonzero;stroke-width:1.20992\"/></svg>',\n};\n\n/**\n * @param {Editor} editor\n */\nexport function registerCustomIcons(editor) {\n    for (const [name, svg] of Object.entries(icons)) {\n        editor.ui.registry.addIcon(name, svg);\n    }\n}\n", "/**\n * Setup a serializer filter for <br> tags to ensure they're not rendered\n * within code blocks and that we use newlines there instead.\n * @param {Editor} editor\n */\nfunction setupBrFilter(editor) {\n    editor.serializer.addNodeFilter('br', nodes => {\n        for (const node of nodes) {\n            if (node.parent && node.parent.name === 'code') {\n                const newline = window.tinymce.html.Node.create('#text');\n                newline.value = '\\n';\n                node.replace(newline);\n            }\n        }\n    });\n}\n\n/**\n * Remove accidentally added pointer elements that are within the content.\n * These could have accidentally been added via getting caught in range\n * selection within page content.\n * @param {Editor} editor\n */\nfunction setupPointerFilter(editor) {\n    editor.parser.addNodeFilter('div', nodes => {\n        for (const node of nodes) {\n            const id = node.attr('id') || '';\n            const nodeClass = node.attr('class') || '';\n            if (id === 'pointer' || nodeClass.includes('pointer')) {\n                node.remove();\n            }\n        }\n    });\n}\n\n/**\n * Setup global default filters for the given editor instance.\n * @param {Editor} editor\n */\nexport function setupFilters(editor) {\n    setupBrFilter(editor);\n    setupPointerFilter(editor);\n}\n", "function elemIsCodeBlock(elem) {\n    return elem.tagName.toLowerCase() === 'code-block';\n}\n\n/**\n * @param {Editor} editor\n * @param {String} code\n * @param {String} language\n * @param {function(string, string)} callback (Receives (code: string,language: string)\n */\nfunction showPopup(editor, code, language, callback) {\n    /** @var {CodeEditor} codeEditor * */\n    const codeEditor = window.$components.first('code-editor');\n    const bookMark = editor.selection.getBookmark();\n    codeEditor.open(code, language, (newCode, newLang) => {\n        callback(newCode, newLang);\n        editor.focus();\n        editor.selection.moveToBookmark(bookMark);\n    }, () => {\n        editor.focus();\n        editor.selection.moveToBookmark(bookMark);\n    });\n}\n\n/**\n * @param {Editor} editor\n * @param {CodeBlockElement} codeBlock\n */\nfunction showPopupForCodeBlock(editor, codeBlock) {\n    showPopup(editor, codeBlock.getContent(), codeBlock.getLanguage(), (newCode, newLang) => {\n        codeBlock.setContent(newCode, newLang);\n    });\n}\n\n/**\n * Define our custom code-block HTML element that we use.\n * Needs to be delayed since it needs to be defined within the context of the\n * child editor window and document, hence its definition within a callback.\n * @param {Editor} editor\n */\nfunction defineCodeBlockCustomElement(editor) {\n    const doc = editor.getDoc();\n    const win = doc.defaultView;\n\n    class CodeBlockElement extends win.HTMLElement {\n\n        /**\n         * @type {?SimpleEditorInterface}\n         */\n        editor = null;\n\n        constructor() {\n            super();\n            this.attachShadow({mode: 'open'});\n\n            const stylesToCopy = document.head.querySelectorAll('link[rel=\"stylesheet\"]:not([media=\"print\"]),style');\n            const copiedStyles = Array.from(stylesToCopy).map(styleEl => styleEl.cloneNode(true));\n\n            const cmContainer = document.createElement('div');\n            cmContainer.style.pointerEvents = 'none';\n            cmContainer.contentEditable = 'false';\n            cmContainer.classList.add('CodeMirrorContainer');\n            cmContainer.classList.toggle('dark-mode', document.documentElement.classList.contains('dark-mode'));\n\n            this.shadowRoot.append(...copiedStyles, cmContainer);\n        }\n\n        getLanguage() {\n            const getLanguageFromClassList = classes => {\n                const langClasses = classes.split(' ').filter(cssClass => cssClass.startsWith('language-'));\n                return (langClasses[0] || '').replace('language-', '');\n            };\n\n            const code = this.querySelector('code');\n            const pre = this.querySelector('pre');\n            return getLanguageFromClassList(pre.className) || (code && getLanguageFromClassList(code.className)) || '';\n        }\n\n        setContent(content, language) {\n            if (this.editor) {\n                this.editor.setContent(content);\n                this.editor.setMode(language, content);\n            }\n\n            let pre = this.querySelector('pre');\n            if (!pre) {\n                pre = doc.createElement('pre');\n                this.append(pre);\n            }\n            pre.innerHTML = '';\n\n            const code = doc.createElement('code');\n            pre.append(code);\n            code.innerText = content;\n            code.className = `language-${language}`;\n        }\n\n        getContent() {\n            const code = this.querySelector('code') || this.querySelector('pre');\n            const tempEl = document.createElement('pre');\n            tempEl.innerHTML = code.innerHTML.replace(/\\ufeff/g, '');\n\n            const brs = tempEl.querySelectorAll('br');\n            for (const br of brs) {\n                br.replaceWith('\\n');\n            }\n\n            return tempEl.textContent;\n        }\n\n        connectedCallback() {\n            const connectedTime = Date.now();\n            if (this.editor) {\n                return;\n            }\n\n            this.cleanChildContent();\n            const content = this.getContent();\n            const lines = content.split('\\n').length;\n            const height = (lines * 19.2) + 18 + 24;\n            this.style.height = `${height}px`;\n\n            const container = this.shadowRoot.querySelector('.CodeMirrorContainer');\n            const renderEditor = Code => {\n                this.editor = Code.wysiwygView(container, this.shadowRoot, content, this.getLanguage());\n                setTimeout(() => {\n                    this.style.height = null;\n                }, 12);\n            };\n\n            window.importVersioned('code').then(Code => {\n                const timeout = (Date.now() - connectedTime < 20) ? 20 : 0;\n                setTimeout(() => renderEditor(Code), timeout);\n            });\n        }\n\n        cleanChildContent() {\n            const pre = this.querySelector('pre');\n            if (!pre) return;\n\n            for (const preChild of pre.childNodes) {\n                if (preChild.nodeName === '#text' && preChild.textContent === '\uFEFF') {\n                    preChild.remove();\n                }\n            }\n        }\n\n    }\n\n    win.customElements.define('code-block', CodeBlockElement);\n}\n\n/**\n * @param {Editor} editor\n */\nfunction register(editor) {\n    editor.ui.registry.addIcon('codeblock', '<svg width=\"24\" height=\"24\"><path d=\"M4 3h16c.6 0 1 .4 1 1v16c0 .6-.4 1-1 1H4a1 1 0 0 1-1-1V4c0-.6.4-1 1-1Zm1 2v14h14V5Z\"/><path d=\"M11.103 15.423c.277.277.277.738 0 .922a.692.692 0 0 1-1.106 0l-4.057-3.78a.738.738 0 0 1 0-1.107l4.057-3.872c.276-.277.83-.277 1.106 0a.724.724 0 0 1 0 1.014L7.6 12.012ZM12.897 8.577c-.245-.312-.2-.675.08-.955.28-.281.727-.27 1.027.033l4.057 3.78a.738.738 0 0 1 0 1.107l-4.057 3.872c-.277.277-.83.277-1.107 0a.724.724 0 0 1 0-1.014l3.504-3.412z\"/></svg>');\n\n    editor.ui.registry.addButton('codeeditor', {\n        tooltip: 'Insert code block',\n        icon: 'codeblock',\n        onAction() {\n            editor.execCommand('codeeditor');\n        },\n    });\n\n    editor.ui.registry.addButton('editcodeeditor', {\n        tooltip: 'Edit code block',\n        icon: 'edit-block',\n        onAction() {\n            editor.execCommand('codeeditor');\n        },\n    });\n\n    editor.addCommand('codeeditor', () => {\n        const selectedNode = editor.selection.getNode();\n        const doc = selectedNode.ownerDocument;\n        if (elemIsCodeBlock(selectedNode)) {\n            showPopupForCodeBlock(editor, selectedNode);\n        } else {\n            const textContent = editor.selection.getContent({format: 'text'});\n            showPopup(editor, textContent, '', (newCode, newLang) => {\n                const pre = doc.createElement('pre');\n                const code = doc.createElement('code');\n                code.classList.add(`language-${newLang}`);\n                code.innerText = newCode;\n                pre.append(code);\n\n                editor.insertContent(pre.outerHTML);\n            });\n        }\n    });\n\n    editor.on('dblclick', () => {\n        const selectedNode = editor.selection.getNode();\n        if (elemIsCodeBlock(selectedNode)) {\n            showPopupForCodeBlock(editor, selectedNode);\n        }\n    });\n\n    editor.on('PreInit', () => {\n        editor.parser.addNodeFilter('pre', elms => {\n            for (const el of elms) {\n                const wrapper = window.tinymce.html.Node.create('code-block', {\n                    contenteditable: 'false',\n                });\n\n                const direction = el.attr('dir');\n                if (direction) {\n                    wrapper.attr('dir', direction);\n                }\n\n                const spans = el.getAll('span');\n                for (const span of spans) {\n                    span.unwrap();\n                }\n                el.attr('style', null);\n                el.wrap(wrapper);\n            }\n        });\n\n        editor.parser.addNodeFilter('code-block', elms => {\n            for (const el of elms) {\n                el.attr('contenteditable', 'false');\n            }\n        });\n\n        editor.serializer.addNodeFilter('code-block', elms => {\n            for (const el of elms) {\n                const direction = el.attr('dir');\n                if (direction && el.firstChild) {\n                    el.firstChild.attr('dir', direction);\n                } else if (el.firstChild) {\n                    el.firstChild.attr('dir', null);\n                }\n\n                el.unwrap();\n            }\n        });\n    });\n\n    editor.ui.registry.addContextToolbar('codeeditor', {\n        predicate(node) {\n            return node.nodeName.toLowerCase() === 'code-block';\n        },\n        items: 'editcodeeditor',\n        position: 'node',\n        scope: 'node',\n    });\n\n    editor.on('PreInit', () => {\n        defineCodeBlockCustomElement(editor);\n    });\n}\n\n/**\n * @return {register}\n */\nexport function getPlugin() {\n    return register;\n}\n", "function promisifyRequest(request) {\n    return new Promise((resolve, reject) => {\n        // @ts-ignore - file size hacks\n        request.oncomplete = request.onsuccess = () => resolve(request.result);\n        // @ts-ignore - file size hacks\n        request.onabort = request.onerror = () => reject(request.error);\n    });\n}\nfunction createStore(dbName, storeName) {\n    const request = indexedDB.open(dbName);\n    request.onupgradeneeded = () => request.result.createObjectStore(storeName);\n    const dbp = promisifyRequest(request);\n    return (txMode, callback) => dbp.then((db) => callback(db.transaction(storeName, txMode).objectStore(storeName)));\n}\nlet defaultGetStoreFunc;\nfunction defaultGetStore() {\n    if (!defaultGetStoreFunc) {\n        defaultGetStoreFunc = createStore('keyval-store', 'keyval');\n    }\n    return defaultGetStoreFunc;\n}\n/**\n * Get a value by its key.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction get(key, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => promisifyRequest(store.get(key)));\n}\n/**\n * Set a value with a key.\n *\n * @param key\n * @param value\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction set(key, value, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.put(value, key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Set multiple values at once. This is faster than calling set() multiple times.\n * It's also atomic \u2013 if one of the pairs can't be added, none will be added.\n *\n * @param entries Array of entries, where each entry is an array of `[key, value]`.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction setMany(entries, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        entries.forEach((entry) => store.put(entry[1], entry[0]));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Get multiple values by their keys\n *\n * @param keys\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction getMany(keys, customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => Promise.all(keys.map((key) => promisifyRequest(store.get(key)))));\n}\n/**\n * Update a value. This lets you see the old value and update it as an atomic operation.\n *\n * @param key\n * @param updater A callback that takes the old value and returns a new value.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction update(key, updater, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => \n    // Need to create the promise manually.\n    // If I try to chain promises, the transaction closes in browsers\n    // that use a promise polyfill (IE10/11).\n    new Promise((resolve, reject) => {\n        store.get(key).onsuccess = function () {\n            try {\n                store.put(updater(this.result), key);\n                resolve(promisifyRequest(store.transaction));\n            }\n            catch (err) {\n                reject(err);\n            }\n        };\n    }));\n}\n/**\n * Delete a particular key from the store.\n *\n * @param key\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction del(key, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.delete(key);\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Delete multiple keys at once.\n *\n * @param keys List of keys to delete.\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction delMany(keys, customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        keys.forEach((key) => store.delete(key));\n        return promisifyRequest(store.transaction);\n    });\n}\n/**\n * Clear all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction clear(customStore = defaultGetStore()) {\n    return customStore('readwrite', (store) => {\n        store.clear();\n        return promisifyRequest(store.transaction);\n    });\n}\nfunction eachCursor(store, callback) {\n    store.openCursor().onsuccess = function () {\n        if (!this.result)\n            return;\n        callback(this.result);\n        this.result.continue();\n    };\n    return promisifyRequest(store.transaction);\n}\n/**\n * Get all keys in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction keys(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAllKeys) {\n            return promisifyRequest(store.getAllKeys());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.key)).then(() => items);\n    });\n}\n/**\n * Get all values in the store.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction values(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        if (store.getAll) {\n            return promisifyRequest(store.getAll());\n        }\n        const items = [];\n        return eachCursor(store, (cursor) => items.push(cursor.value)).then(() => items);\n    });\n}\n/**\n * Get all entries in the store. Each entry is an array of `[key, value]`.\n *\n * @param customStore Method to get a custom store. Use with caution (see the docs).\n */\nfunction entries(customStore = defaultGetStore()) {\n    return customStore('readonly', (store) => {\n        // Fast path for modern browsers\n        // (although, hopefully we'll get a simpler path some day)\n        if (store.getAll && store.getAllKeys) {\n            return Promise.all([\n                promisifyRequest(store.getAllKeys()),\n                promisifyRequest(store.getAll()),\n            ]).then(([keys, values]) => keys.map((key, i) => [key, values[i]]));\n        }\n        const items = [];\n        return customStore('readonly', (store) => eachCursor(store, (cursor) => items.push([cursor.key, cursor.value])).then(() => items));\n    });\n}\n\nexport { clear, createStore, del, delMany, entries, get, getMany, keys, promisifyRequest, set, setMany, update, values };\n", "// Docs: https://www.diagrams.net/doc/faq/embed-mode\nimport * as store from './store';\n\nlet iFrame = null;\nlet lastApprovedOrigin;\nlet onInit;\nlet onSave;\nconst saveBackupKey = 'last-drawing-save';\n\nfunction drawPostMessage(data) {\n    iFrame.contentWindow.postMessage(JSON.stringify(data), lastApprovedOrigin);\n}\n\nfunction drawEventExport(message) {\n    store.set(saveBackupKey, message.data);\n    if (onSave) {\n        onSave(message.data).then(() => {\n            store.del(saveBackupKey);\n        });\n    }\n}\n\nfunction drawEventSave(message) {\n    drawPostMessage({\n        action: 'export', format: 'xmlpng', xml: message.xml, spin: 'Updating drawing',\n    });\n}\n\nfunction drawEventInit() {\n    if (!onInit) return;\n    onInit().then(xml => {\n        drawPostMessage({action: 'load', autosave: 1, xml});\n    });\n}\n\nfunction drawEventConfigure() {\n    const config = {};\n    window.$events.emitPublic(iFrame, 'editor-drawio::configure', {config});\n    drawPostMessage({action: 'configure', config});\n}\n\nfunction drawEventClose() {\n    // eslint-disable-next-line no-use-before-define\n    window.removeEventListener('message', drawReceive);\n    if (iFrame) document.body.removeChild(iFrame);\n}\n\n/**\n * Receive and handle a message event from the draw.io window.\n * @param {MessageEvent} event\n */\nfunction drawReceive(event) {\n    if (!event.data || event.data.length < 1) return;\n    if (event.origin !== lastApprovedOrigin) return;\n\n    const message = JSON.parse(event.data);\n    if (message.event === 'init') {\n        drawEventInit();\n    } else if (message.event === 'exit') {\n        drawEventClose();\n    } else if (message.event === 'save') {\n        drawEventSave(message);\n    } else if (message.event === 'export') {\n        drawEventExport(message);\n    } else if (message.event === 'configure') {\n        drawEventConfigure();\n    }\n}\n\n/**\n * Attempt to prompt and restore unsaved drawing content if existing.\n * @returns {Promise<void>}\n */\nasync function attemptRestoreIfExists() {\n    const backupVal = await store.get(saveBackupKey);\n    const dialogEl = document.getElementById('unsaved-drawing-dialog');\n\n    if (!dialogEl) {\n        console.error('Missing expected unsaved-drawing dialog');\n    }\n\n    if (backupVal) {\n        /** @var {ConfirmDialog} */\n        const dialog = window.$components.firstOnElement(dialogEl, 'confirm-dialog');\n        const restore = await dialog.show();\n        if (restore) {\n            onInit = async () => backupVal;\n        }\n    }\n}\n\n/**\n * Show the draw.io editor.\n * onSaveCallback must return a promise that resolves on successful save and errors on failure.\n * onInitCallback must return a promise with the xml to load for the editor.\n * Will attempt to provide an option to restore unsaved changes if found to exist.\n * @param {String} drawioUrl\n * @param {Function<Promise<String>>} onInitCallback\n * @param {Function<Promise>} onSaveCallback - Is called with the drawing data on save.\n */\nexport async function show(drawioUrl, onInitCallback, onSaveCallback) {\n    onInit = onInitCallback;\n    onSave = onSaveCallback;\n\n    await attemptRestoreIfExists();\n\n    iFrame = document.createElement('iframe');\n    iFrame.setAttribute('frameborder', '0');\n    window.addEventListener('message', drawReceive);\n    iFrame.setAttribute('src', drawioUrl);\n    iFrame.setAttribute('class', 'fullscreen');\n    iFrame.style.backgroundColor = '#FFFFFF';\n    document.body.appendChild(iFrame);\n    lastApprovedOrigin = (new URL(drawioUrl)).origin;\n}\n\nexport async function upload(imageData, pageUploadedToId) {\n    const data = {\n        image: imageData,\n        uploaded_to: pageUploadedToId,\n    };\n    const resp = await window.$http.post(window.baseUrl('/images/drawio'), data);\n    return resp.data;\n}\n\nexport function close() {\n    drawEventClose();\n}\n\n/**\n * Load an existing image, by fetching it as Base64 from the system.\n * @param drawingId\n * @returns {Promise<string>}\n */\nexport async function load(drawingId) {\n    try {\n        const resp = await window.$http.get(window.baseUrl(`/images/drawio/base64/${drawingId}`));\n        return `data:image/png;base64,${resp.data.content}`;\n    } catch (error) {\n        if (error instanceof window.$http.HttpError) {\n            window.$events.showResponseError(error);\n        }\n        close();\n        throw error;\n    }\n}\n", "import * as DrawIO from '../services/drawio';\nimport {wait} from '../services/util';\n\nlet pageEditor = null;\nlet currentNode = null;\n\n/**\n * @type {WysiwygConfigOptions}\n */\nlet options = {};\n\nfunction isDrawing(node) {\n    return node.hasAttribute('drawio-diagram');\n}\n\nfunction showDrawingManager(mceEditor, selectedNode = null) {\n    pageEditor = mceEditor;\n    currentNode = selectedNode;\n\n    /** @type {ImageManager} * */\n    const imageManager = window.$components.first('image-manager');\n    imageManager.show(image => {\n        if (selectedNode) {\n            const imgElem = selectedNode.querySelector('img');\n            pageEditor.undoManager.transact(() => {\n                pageEditor.dom.setAttrib(imgElem, 'src', image.url);\n                pageEditor.dom.setAttrib(selectedNode, 'drawio-diagram', image.id);\n            });\n        } else {\n            const imgHTML = `<div drawio-diagram=\"${image.id}\" contenteditable=\"false\"><img src=\"${image.url}\"></div>`;\n            pageEditor.insertContent(imgHTML);\n        }\n    }, 'drawio');\n}\n\nasync function updateContent(pngData) {\n    const loadingImage = window.baseUrl('/loading.gif');\n\n    const handleUploadError = error => {\n        if (error.status === 413) {\n            window.$events.emit('error', options.translations.serverUploadLimitText);\n        } else {\n            window.$events.emit('error', options.translations.imageUploadErrorText);\n        }\n        console.error(error);\n    };\n\n    // Handle updating an existing image\n    if (currentNode) {\n        DrawIO.close();\n        const imgElem = currentNode.querySelector('img');\n        try {\n            const img = await DrawIO.upload(pngData, options.pageId);\n            pageEditor.undoManager.transact(() => {\n                pageEditor.dom.setAttrib(imgElem, 'src', img.url);\n                pageEditor.dom.setAttrib(currentNode, 'drawio-diagram', img.id);\n            });\n        } catch (err) {\n            handleUploadError(err);\n            throw new Error(`Failed to save image with error: ${err}`);\n        }\n        return;\n    }\n\n    await wait(5);\n\n    const id = `drawing-${Math.random().toString(16).slice(2)}`;\n    const wrapId = `drawing-wrap-${Math.random().toString(16).slice(2)}`;\n    pageEditor.insertContent(`<div drawio-diagram contenteditable=\"false\" id=\"${wrapId}\"><img src=\"${loadingImage}\" id=\"${id}\"></div>`);\n    DrawIO.close();\n\n    try {\n        const img = await DrawIO.upload(pngData, options.pageId);\n        pageEditor.undoManager.transact(() => {\n            pageEditor.dom.setAttrib(id, 'src', img.url);\n            pageEditor.dom.setAttrib(wrapId, 'drawio-diagram', img.id);\n        });\n    } catch (err) {\n        pageEditor.dom.remove(wrapId);\n        handleUploadError(err);\n        throw new Error(`Failed to save image with error: ${err}`);\n    }\n}\n\nfunction drawingInit() {\n    if (!currentNode) {\n        return Promise.resolve('');\n    }\n\n    const drawingId = currentNode.getAttribute('drawio-diagram');\n    return DrawIO.load(drawingId);\n}\n\nfunction showDrawingEditor(mceEditor, selectedNode = null) {\n    pageEditor = mceEditor;\n    currentNode = selectedNode;\n    DrawIO.show(options.drawioUrl, drawingInit, updateContent);\n}\n\n/**\n * @param {Editor} editor\n */\nfunction register(editor) {\n    editor.addCommand('drawio', () => {\n        const selectedNode = editor.selection.getNode();\n        showDrawingEditor(editor, isDrawing(selectedNode) ? selectedNode : null);\n    });\n\n    editor.ui.registry.addIcon('diagram', `<svg width=\"24\" height=\"24\" fill=\"${options.darkMode ? '#BBB' : '#000000'}\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M20.716 7.639V2.845h-4.794v1.598h-7.99V2.845H3.138v4.794h1.598v7.99H3.138v4.794h4.794v-1.598h7.99v1.598h4.794v-4.794h-1.598v-7.99zM4.736 4.443h1.598V6.04H4.736zm1.598 14.382H4.736v-1.598h1.598zm9.588-1.598h-7.99v-1.598H6.334v-7.99h1.598V6.04h7.99v1.598h1.598v7.99h-1.598zm3.196 1.598H17.52v-1.598h1.598zM17.52 6.04V4.443h1.598V6.04zm-4.21 7.19h-2.79l-.582 1.599H8.643l2.717-7.191h1.119l2.724 7.19h-1.302zm-2.43-1.006h2.086l-1.039-3.06z\"/></svg>`);\n\n    editor.ui.registry.addSplitButton('drawio', {\n        tooltip: 'Insert/edit drawing',\n        icon: 'diagram',\n        onAction() {\n            editor.execCommand('drawio');\n            // Hack to de-focus the tinymce editor toolbar\n            window.document.body.dispatchEvent(new Event('mousedown', {bubbles: true}));\n        },\n        fetch(callback) {\n            callback([\n                {\n                    type: 'choiceitem',\n                    text: 'Drawing manager',\n                    value: 'drawing-manager',\n                },\n            ]);\n        },\n        onItemAction(api, value) {\n            if (value === 'drawing-manager') {\n                const selectedNode = editor.selection.getNode();\n                showDrawingManager(editor, isDrawing(selectedNode) ? selectedNode : null);\n            }\n        },\n    });\n\n    editor.on('dblclick', () => {\n        const selectedNode = editor.selection.getNode();\n        if (!isDrawing(selectedNode)) return;\n        showDrawingEditor(editor, selectedNode);\n    });\n\n    editor.on('SetContent', () => {\n        const drawings = editor.dom.select('body > div[drawio-diagram]');\n        if (!drawings.length) return;\n\n        editor.undoManager.transact(() => {\n            for (const drawing of drawings) {\n                drawing.setAttribute('contenteditable', 'false');\n            }\n        });\n    });\n}\n\n/**\n *\n * @param {WysiwygConfigOptions} providedOptions\n * @return {function(Editor, string)}\n */\nexport function getPlugin(providedOptions) {\n    options = providedOptions;\n    return register;\n}\n", "/**\n * @param {Editor} editor\n */\nfunction register(editor) {\n    editor.addCommand('InsertHorizontalRule', () => {\n        const hrElem = document.createElement('hr');\n        const cNode = editor.selection.getNode();\n        const {parentNode} = cNode;\n        parentNode.insertBefore(hrElem, cNode);\n    });\n\n    editor.ui.registry.addButton('customhr', {\n        icon: 'horizontal-rule',\n        tooltip: 'Insert horizontal line',\n        onAction() {\n            editor.execCommand('InsertHorizontalRule');\n        },\n    });\n}\n\n/**\n * @return {register}\n */\nexport function getPlugin() {\n    return register;\n}\n", "/**\n * @param {Editor} editor\n */\nfunction register(editor) {\n    // Custom Image picker button\n    editor.ui.registry.addButton('imagemanager-insert', {\n        title: 'Insert image',\n        icon: 'image',\n        tooltip: 'Insert image',\n        onAction() {\n            /** @type {ImageManager} * */\n            const imageManager = window.$components.first('image-manager');\n            imageManager.show(image => {\n                const imageUrl = image.thumbs?.display || image.url;\n                let html = `<a href=\"${image.url}\" target=\"_blank\">`;\n                html += `<img src=\"${imageUrl}\" alt=\"${image.name}\">`;\n                html += '</a>';\n                editor.execCommand('mceInsertContent', false, html);\n            }, 'gallery');\n        },\n    });\n}\n\n/**\n * @return {register}\n */\nexport function getPlugin() {\n    return register;\n}\n", "/**\n * @param {Editor} editor\n */\nfunction register(editor) {\n    const aboutDialog = {\n        title: 'About the WYSIWYG Editor',\n        url: window.baseUrl('/help/wysiwyg'),\n    };\n\n    editor.ui.registry.addButton('about', {\n        icon: 'help',\n        tooltip: 'About the editor',\n        onAction() {\n            window.tinymce.activeEditor.windowManager.openUrl(aboutDialog);\n        },\n    });\n}\n\n/**\n * @return {register}\n */\nexport function getPlugin() {\n    return register;\n}\n", "export const blockElementTypes = [\n    'p',\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    'div',\n    'blockquote',\n    'pre',\n    'code-block',\n    'details',\n    'ul',\n    'ol',\n    'table',\n    'hr',\n];\n", "import {blockElementTypes} from './util';\n\n/**\n * @param {Editor} editor\n */\nfunction getSelectedDetailsBlock(editor) {\n    return editor.selection.getNode().closest('details');\n}\n\nfunction setSummary(editor, summaryContent) {\n    const details = getSelectedDetailsBlock(editor);\n    if (!details) return;\n\n    editor.undoManager.transact(() => {\n        let summary = details.querySelector('summary');\n        if (!summary) {\n            summary = document.createElement('summary');\n            details.prepend(summary);\n        }\n        summary.textContent = summaryContent;\n    });\n}\n\n/**\n * @param {Editor} editor\n */\nfunction detailsDialog(editor) {\n    return {\n        title: 'Edit collapsible block',\n        body: {\n            type: 'panel',\n            items: [\n                {\n                    type: 'input',\n                    name: 'summary',\n                    label: 'Toggle label',\n                },\n            ],\n        },\n        buttons: [\n            {\n                type: 'cancel',\n                text: 'Cancel',\n            },\n            {\n                type: 'submit',\n                text: 'Save',\n                primary: true,\n            },\n        ],\n        onSubmit(api) {\n            const {summary} = api.getData();\n            setSummary(editor, summary);\n            api.close();\n        },\n    };\n}\n\n/**\n * @param {Element} element\n */\nfunction getSummaryTextFromDetails(element) {\n    const summary = element.querySelector('summary');\n    if (!summary) {\n        return '';\n    }\n    return summary.textContent;\n}\n\n/**\n * @param {Editor} editor\n */\nfunction showDetailLabelEditWindow(editor) {\n    const details = getSelectedDetailsBlock(editor);\n    const dialog = editor.windowManager.open(detailsDialog(editor));\n    dialog.setData({summary: getSummaryTextFromDetails(details)});\n}\n\n/**\n * @param {Editor} editor\n */\nfunction unwrapDetailsInSelection(editor) {\n    const details = editor.selection.getNode().closest('details');\n    const selectionBm = editor.selection.getBookmark();\n\n    if (details) {\n        const elements = details.querySelectorAll('details > *:not(summary, doc-root), doc-root > *');\n\n        editor.undoManager.transact(() => {\n            for (const element of elements) {\n                details.parentNode.insertBefore(element, details);\n            }\n            details.remove();\n        });\n    }\n\n    editor.focus();\n    editor.selection.moveToBookmark(selectionBm);\n}\n\n/**\n * @param {tinymce.html.Node} detailsEl\n */\nfunction unwrapDetailsEditable(detailsEl) {\n    detailsEl.attr('contenteditable', null);\n    let madeUnwrap = false;\n    for (const child of detailsEl.children()) {\n        if (child.name === 'doc-root') {\n            child.unwrap();\n            madeUnwrap = true;\n        }\n    }\n\n    if (madeUnwrap) {\n        unwrapDetailsEditable(detailsEl);\n    }\n}\n\n/**\n * @param {tinymce.html.Node} detailsEl\n */\nfunction ensureDetailsWrappedInEditable(detailsEl) {\n    unwrapDetailsEditable(detailsEl);\n\n    detailsEl.attr('contenteditable', 'false');\n    const rootWrap = window.tinymce.html.Node.create('doc-root', {contenteditable: 'true'});\n    let previousBlockWrap = null;\n\n    for (const child of detailsEl.children()) {\n        if (child.name === 'summary') continue;\n        const isBlock = blockElementTypes.includes(child.name);\n\n        if (!isBlock) {\n            if (!previousBlockWrap) {\n                previousBlockWrap = window.tinymce.html.Node.create('p');\n                rootWrap.append(previousBlockWrap);\n            }\n            previousBlockWrap.append(child);\n        } else {\n            rootWrap.append(child);\n            previousBlockWrap = null;\n        }\n    }\n\n    detailsEl.append(rootWrap);\n}\n\n/**\n * @param {Editor} editor\n */\nfunction setupElementFilters(editor) {\n    editor.parser.addNodeFilter('details', elms => {\n        for (const el of elms) {\n            ensureDetailsWrappedInEditable(el);\n        }\n    });\n\n    editor.serializer.addNodeFilter('details', elms => {\n        for (const el of elms) {\n            unwrapDetailsEditable(el);\n            el.attr('open', null);\n        }\n    });\n\n    editor.serializer.addNodeFilter('doc-root', elms => {\n        for (const el of elms) {\n            el.unwrap();\n        }\n    });\n}\n\n/**\n * @param {Editor} editor\n */\nfunction register(editor) {\n    editor.ui.registry.addIcon('details', '<svg width=\"24\" height=\"24\"><path d=\"M8.2 9a.5.5 0 0 0-.4.8l4 5.6a.5.5 0 0 0 .8 0l4-5.6a.5.5 0 0 0-.4-.8ZM20.122 18.151h-16c-.964 0-.934 2.7 0 2.7h16c1.139 0 1.173-2.7 0-2.7zM20.122 3.042h-16c-.964 0-.934 2.7 0 2.7h16c1.139 0 1.173-2.7 0-2.7z\"/></svg>');\n    editor.ui.registry.addIcon('togglefold', '<svg height=\"24\"  width=\"24\"><path d=\"M8.12 19.3c.39.39 1.02.39 1.41 0L12 16.83l2.47 2.47c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41l-3.17-3.17c-.39-.39-1.02-.39-1.41 0l-3.17 3.17c-.4.38-.4 1.02-.01 1.41zm7.76-14.6c-.39-.39-1.02-.39-1.41 0L12 7.17 9.53 4.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.03 0 1.42l3.17 3.17c.39.39 1.02.39 1.41 0l3.17-3.17c.4-.39.4-1.03.01-1.42z\"/></svg>');\n    editor.ui.registry.addIcon('togglelabel', '<svg height=\"18\" width=\"18\" viewBox=\"0 0 24 24\"><path d=\"M21.41,11.41l-8.83-8.83C12.21,2.21,11.7,2,11.17,2H4C2.9,2,2,2.9,2,4v7.17c0,0.53,0.21,1.04,0.59,1.41l8.83,8.83 c0.78,0.78,2.05,0.78,2.83,0l7.17-7.17C22.2,13.46,22.2,12.2,21.41,11.41z M6.5,8C5.67,8,5,7.33,5,6.5S5.67,5,6.5,5S8,5.67,8,6.5 S7.33,8,6.5,8z\"/></svg>');\n\n    editor.ui.registry.addButton('details', {\n        icon: 'details',\n        tooltip: 'Insert collapsible block',\n        onAction() {\n            editor.execCommand('InsertDetailsBlock');\n        },\n    });\n\n    editor.ui.registry.addButton('removedetails', {\n        icon: 'table-delete-table',\n        tooltip: 'Unwrap',\n        onAction() {\n            unwrapDetailsInSelection(editor);\n        },\n    });\n\n    editor.ui.registry.addButton('editdetials', {\n        icon: 'togglelabel',\n        tooltip: 'Edit label',\n        onAction() {\n            showDetailLabelEditWindow(editor);\n        },\n    });\n\n    editor.on('dblclick', event => {\n        if (!getSelectedDetailsBlock(editor) || event.target.closest('doc-root')) return;\n        showDetailLabelEditWindow(editor);\n    });\n\n    editor.ui.registry.addButton('toggledetails', {\n        icon: 'togglefold',\n        tooltip: 'Toggle open/closed',\n        onAction() {\n            const details = getSelectedDetailsBlock(editor);\n            details.toggleAttribute('open');\n            editor.focus();\n        },\n    });\n\n    editor.addCommand('InsertDetailsBlock', () => {\n        let content = editor.selection.getContent({format: 'html'});\n        const details = document.createElement('details');\n        const summary = document.createElement('summary');\n        const id = `details-${Date.now()}`;\n        details.setAttribute('data-id', id);\n        details.appendChild(summary);\n\n        if (!content) {\n            content = '<p><br></p>';\n        }\n\n        details.innerHTML += content;\n        editor.insertContent(details.outerHTML);\n        editor.focus();\n\n        const domDetails = editor.dom.select(`[data-id=\"${id}\"]`)[0] || null;\n        if (domDetails) {\n            const firstChild = domDetails.querySelector('doc-root > *');\n            if (firstChild) {\n                firstChild.focus();\n            }\n            domDetails.removeAttribute('data-id');\n        }\n    });\n\n    editor.ui.registry.addContextToolbar('details', {\n        predicate(node) {\n            return node.nodeName.toLowerCase() === 'details';\n        },\n        items: 'editdetials toggledetails removedetails',\n        position: 'node',\n        scope: 'node',\n    });\n\n    editor.on('PreInit', () => {\n        setupElementFilters(editor);\n    });\n}\n\n/**\n * @return {register}\n */\nexport function getPlugin() {\n    return register;\n}\n", "/**\n * @param {Editor} editor\n */\nfunction register(editor) {\n    editor.ui.registry.addIcon('tableclearformatting', '<svg xmlns=\"http://www.w3.org/2000/svg\" xml:space=\"preserve\" viewBox=\"0 0 24 24\"><path d=\"M15.53088 4.64727v-.82364c0-.453-.37063-.82363-.82363-.82363H4.82363C4.37063 3 4 3.37064 4 3.82363v3.29454c0 .453.37064.82364.82363.82364h9.88362c.453 0 .82363-.37064.82363-.82364v-.82363h.82364v3.29454H8.11817v7.4127c0 .453.37064.82364.82364.82364h1.64727c.453 0 .82363-.37064.82363-.82364v-5.76544h6.58907V4.64727Z\"/><path d=\"m18.42672 19.51563-1.54687-1.54688-1.54688 1.54688c-.26751.2675-.70124.2675-.96875 0-.26751-.26752-.26751-.70124 0-.96876L15.9111 17l-1.54688-1.54688c-.26751-.2675-.26751-.70123 0-.96875.26751-.2675.70124-.2675.96875 0l1.54688 1.54688 1.54687-1.54688c.26751-.2675.70124-.2675.96875 0 .26751.26752.26751.70124 0 .96875L17.8486 17l1.54687 1.54688c.26751.2675.26751.70123 0 .96874-.26751.26752-.70124.26752-.96875 0z\"/></svg>');\n\n    const tableFirstRowContextSpec = {\n        items: ' | tablerowheader',\n        predicate(elem) {\n            const isTable = elem.nodeName.toLowerCase() === 'table';\n            const selectionNode = editor.selection.getNode();\n            const parentTable = selectionNode.closest('table');\n            if (!isTable || !parentTable) {\n                return false;\n            }\n\n            const firstRow = parentTable.querySelector('tr');\n            return firstRow.contains(selectionNode);\n        },\n        position: 'node',\n        scope: 'node',\n    };\n    editor.ui.registry.addContextToolbar('customtabletoolbarfirstrow', tableFirstRowContextSpec);\n\n    editor.addCommand('tableclearformatting', () => {\n        const table = editor.dom.getParent(editor.selection.getStart(), 'table');\n        if (!table) {\n            return;\n        }\n\n        const attrsToRemove = ['class', 'style', 'width', 'height'];\n        const styled = [table, ...table.querySelectorAll(attrsToRemove.map(a => `[${a}]`).join(','))];\n        for (const elem of styled) {\n            for (const attr of attrsToRemove) {\n                elem.removeAttribute(attr);\n            }\n        }\n    });\n\n    editor.addCommand('tableclearsizes', () => {\n        const table = editor.dom.getParent(editor.selection.getStart(), 'table');\n        if (!table) {\n            return;\n        }\n\n        const targets = [table, ...table.querySelectorAll('tr,td,th,tbody,thead,tfoot,th>*,td>*')];\n        for (const elem of targets) {\n            elem.removeAttribute('width');\n            elem.removeAttribute('height');\n            elem.style.height = null;\n            elem.style.width = null;\n        }\n    });\n\n    const onPreInit = () => {\n        const exitingButtons = editor.ui.registry.getAll().buttons;\n\n        editor.ui.registry.addMenuButton('customtable', {\n            ...exitingButtons.table,\n            fetch: callback => callback('inserttable | cell row column | advtablesort | tableprops tableclearformatting tableclearsizes deletetable'),\n        });\n\n        editor.ui.registry.addMenuItem('tableclearformatting', {\n            icon: 'tableclearformatting',\n            text: 'Clear table formatting',\n            onSetup: exitingButtons.tableprops.onSetup,\n            onAction() {\n                editor.execCommand('tableclearformatting');\n            },\n        });\n\n        editor.ui.registry.addMenuItem('tableclearsizes', {\n            icon: 'resize',\n            text: 'Resize to contents',\n            onSetup: exitingButtons.tableprops.onSetup,\n            onAction() {\n                editor.execCommand('tableclearsizes');\n            },\n        });\n\n        editor.off('PreInit', onPreInit);\n    };\n\n    editor.on('PreInit', onPreInit);\n}\n\n/**\n * @return {register}\n */\nexport function getPlugin() {\n    return register;\n}\n", "/**\n * @param {Element} element\n * @return {boolean}\n */\nfunction elementWithinTaskList(element) {\n    const listEl = element.closest('li');\n    return listEl && listEl.parentNode.nodeName === 'UL' && listEl.classList.contains('task-list-item');\n}\n\n/**\n * @param {MouseEvent} event\n * @param {Element} clickedEl\n * @param {Editor} editor\n */\nfunction handleTaskListItemClick(event, clickedEl, editor) {\n    const bounds = clickedEl.getBoundingClientRect();\n    const withinBounds = event.clientX <= bounds.right\n        && event.clientX >= bounds.left\n        && event.clientY >= bounds.top\n        && event.clientY <= bounds.bottom;\n\n    // Outside of the task list item bounds mean we're probably clicking the pseudo-element.\n    if (!withinBounds) {\n        editor.undoManager.transact(() => {\n            if (clickedEl.hasAttribute('checked')) {\n                clickedEl.removeAttribute('checked');\n            } else {\n                clickedEl.setAttribute('checked', 'checked');\n            }\n        });\n    }\n}\n\n/**\n * @param {AstNode} node\n */\nfunction parseTaskListNode(node) {\n    // Force task list item class\n    node.attr('class', 'task-list-item');\n\n    // Copy checkbox status and remove checkbox within editor\n    for (const child of node.children()) {\n        if (child.name === 'input') {\n            if (child.attr('checked') === 'checked') {\n                node.attr('checked', 'checked');\n            }\n            child.remove();\n        }\n    }\n}\n\n/**\n * @param {AstNode} node\n */\nfunction serializeTaskListNode(node) {\n    // Get checked status and clean it from list node\n    const isChecked = node.attr('checked') === 'checked';\n    node.attr('checked', null);\n\n    const inputAttrs = {type: 'checkbox', disabled: 'disabled'};\n    if (isChecked) {\n        inputAttrs.checked = 'checked';\n    }\n\n    // Create & insert checkbox input element\n    const checkbox = window.tinymce.html.Node.create('input', inputAttrs);\n    checkbox.shortEnded = true;\n\n    if (node.firstChild) {\n        node.insert(checkbox, node.firstChild, true);\n    } else {\n        node.append(checkbox);\n    }\n}\n\n/**\n * @param {Editor} editor\n */\nfunction register(editor) {\n    // Tasklist UI buttons\n    editor.ui.registry.addIcon('tasklist', '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M22,8c0-0.55-0.45-1-1-1h-7c-0.55,0-1,0.45-1,1s0.45,1,1,1h7C21.55,9,22,8.55,22,8z M13,16c0,0.55,0.45,1,1,1h7 c0.55,0,1-0.45,1-1c0-0.55-0.45-1-1-1h-7C13.45,15,13,15.45,13,16z M10.47,4.63c0.39,0.39,0.39,1.02,0,1.41l-4.23,4.25 c-0.39,0.39-1.02,0.39-1.42,0L2.7,8.16c-0.39-0.39-0.39-1.02,0-1.41c0.39-0.39,1.02-0.39,1.41,0l1.42,1.42l3.54-3.54 C9.45,4.25,10.09,4.25,10.47,4.63z M10.48,12.64c0.39,0.39,0.39,1.02,0,1.41l-4.23,4.25c-0.39,0.39-1.02,0.39-1.42,0L2.7,16.16 c-0.39-0.39-0.39-1.02,0-1.41s1.02-0.39,1.41,0l1.42,1.42l3.54-3.54C9.45,12.25,10.09,12.25,10.48,12.64L10.48,12.64z\"/></svg>');\n    editor.ui.registry.addToggleButton('tasklist', {\n        tooltip: 'Task list',\n        icon: 'tasklist',\n        active: false,\n        onAction(api) {\n            if (api.isActive()) {\n                editor.execCommand('RemoveList');\n            } else {\n                editor.execCommand('InsertUnorderedList', null, {\n                    'list-item-attributes': {\n                        class: 'task-list-item',\n                    },\n                    'list-style-type': 'tasklist',\n                });\n            }\n        },\n        onSetup(api) {\n            editor.on('NodeChange', event => {\n                const parentListEl = event.parents.find(el => el.nodeName === 'LI');\n                const inList = parentListEl && parentListEl.classList.contains('task-list-item');\n                api.setActive(Boolean(inList));\n            });\n        },\n    });\n\n    // Tweak existing bullet list button active state to not be active\n    // when we're in a task list.\n    const existingBullListButton = editor.ui.registry.getAll().buttons.bullist;\n    existingBullListButton.onSetup = function customBullListOnSetup(api) {\n        editor.on('NodeChange', event => {\n            const parentList = event.parents.find(el => el.nodeName === 'LI');\n            const inTaskList = parentList && parentList.classList.contains('task-list-item');\n            const inUlList = parentList && parentList.parentNode.nodeName === 'UL';\n            api.setActive(Boolean(inUlList && !inTaskList));\n        });\n    };\n    existingBullListButton.onAction = function customBullListOnAction() {\n        // Cheeky hack to prevent list toggle action treating tasklists as normal\n        // unordered lists which would unwrap the list on toggle from tasklist to bullet list.\n        // Instead we quickly jump through an ordered list first if we're within a tasklist.\n        if (elementWithinTaskList(editor.selection.getNode())) {\n            editor.execCommand('InsertOrderedList', null, {\n                'list-item-attributes': {class: null},\n            });\n        }\n\n        editor.execCommand('InsertUnorderedList', null, {\n            'list-item-attributes': {class: null},\n        });\n    };\n    // Tweak existing number list to not allow classes on child items\n    const existingNumListButton = editor.ui.registry.getAll().buttons.numlist;\n    existingNumListButton.onAction = function customNumListButtonOnAction() {\n        editor.execCommand('InsertOrderedList', null, {\n            'list-item-attributes': {class: null},\n        });\n    };\n\n    // Setup filters on pre-init\n    editor.on('PreInit', () => {\n        editor.parser.addNodeFilter('li', nodes => {\n            for (const node of nodes) {\n                if (node.attributes.map.class === 'task-list-item') {\n                    parseTaskListNode(node);\n                }\n            }\n        });\n        editor.serializer.addNodeFilter('li', nodes => {\n            for (const node of nodes) {\n                if (node.attributes.map.class === 'task-list-item') {\n                    serializeTaskListNode(node);\n                }\n            }\n        });\n    });\n\n    // Handle checkbox click in editor\n    editor.on('click', event => {\n        const clickedEl = event.target;\n        if (clickedEl.nodeName === 'LI' && clickedEl.classList.contains('task-list-item')) {\n            handleTaskListItemClick(event, clickedEl, editor);\n            event.preventDefault();\n        }\n    });\n}\n\n/**\n * @return {register}\n */\nexport function getPlugin() {\n    return register;\n}\n", "/**\n * Handle alignment for embed (iframe/video) content.\n * TinyMCE built-in handling doesn't work well for these when classes are used for\n * alignment, since the editor wraps these elements in a non-editable preview span\n * which looses tracking and setting of alignment options.\n * Here we manually manage these properties and formatting events, by effectively\n * syncing the alignment classes to the parent preview span.\n * @param {Editor} editor\n */\nexport function handleEmbedAlignmentChanges(editor) {\n    function updateClassesForPreview(previewElem) {\n        const mediaTarget = previewElem.querySelector('iframe, video');\n        if (!mediaTarget) {\n            return;\n        }\n\n        const alignmentClasses = [...mediaTarget.classList.values()].filter(c => c.startsWith('align-'));\n        const previewAlignClasses = [...previewElem.classList.values()].filter(c => c.startsWith('align-'));\n        previewElem.classList.remove(...previewAlignClasses);\n        previewElem.classList.add(...alignmentClasses);\n    }\n\n    editor.on('SetContent', () => {\n        const previewElems = editor.dom.select('span.mce-preview-object');\n        for (const previewElem of previewElems) {\n            updateClassesForPreview(previewElem);\n        }\n    });\n\n    editor.on('FormatApply', event => {\n        const isAlignment = event.format.startsWith('align');\n        if (!event.node || !event.node.matches('.mce-preview-object')) {\n            return;\n        }\n\n        const realTarget = event.node.querySelector('iframe, video');\n        if (isAlignment && realTarget) {\n            const className = (editor.formatter.get(event.format)[0]?.classes || [])[0];\n            const toAdd = !realTarget.classList.contains(className);\n\n            const wrapperClasses = (event.node.getAttribute('data-mce-p-class') || '').split(' ');\n            const wrapperClassesFiltered = wrapperClasses.filter(c => !c.startsWith('align-'));\n            if (toAdd) {\n                wrapperClassesFiltered.push(className);\n            }\n\n            const classesToApply = wrapperClassesFiltered.join(' ');\n            event.node.setAttribute('data-mce-p-class', classesToApply);\n\n            realTarget.setAttribute('class', classesToApply);\n            editor.formatter.apply(event.format, {}, realTarget);\n            updateClassesForPreview(event.node);\n        }\n    });\n}\n\n/**\n * Cleans up the direction property for an element.\n * Removes all inline direction control from child elements.\n * Removes non \"dir\" attribute direction control from provided element.\n * @param {HTMLElement} element\n */\nfunction cleanElementDirection(element) {\n    const directionChildren = element.querySelectorAll('[dir],[style*=\"direction\"],[style*=\"text-align\"]');\n    for (const child of directionChildren) {\n        child.removeAttribute('dir');\n        child.style.direction = null;\n        child.style.textAlign = null;\n    }\n    element.style.direction = null;\n    element.style.textAlign = null;\n}\n\n/**\n * This tracks table cell range selection, so we can apply custom handling where\n * required to actions applied to such selections.\n * The events used don't seem to be advertised by TinyMCE.\n * Found at https://github.com/tinymce/tinymce/blob/6.8.3/modules/tinymce/src/models/dom/main/ts/table/api/Events.ts\n * @param {Editor} editor\n */\nexport function handleTableCellRangeEvents(editor) {\n    /** @var {HTMLTableCellElement[]} * */\n    let selectedCells = [];\n\n    editor.on('TableSelectionChange', event => {\n        selectedCells = (event.cells || []).map(cell => cell.dom);\n    });\n    editor.on('TableSelectionClear', () => {\n        selectedCells = [];\n    });\n\n    // TinyMCE does not seem to do a great job on clearing styles in complex\n    // scenarios (like copied word content) when a range of table cells\n    // are selected. Here we watch for clear formatting events, so some manual\n    // cleanup can be performed.\n    const attrsToRemove = ['class', 'style', 'width', 'height'];\n    editor.on('FormatRemove', () => {\n        for (const cell of selectedCells) {\n            for (const attr of attrsToRemove) {\n                cell.removeAttribute(attr);\n            }\n        }\n    });\n\n    // TinyMCE does not apply direction events to table cell range selections\n    // so here we hastily patch in that ability by setting the direction ourselves\n    // when a direction event is fired.\n    editor.on('ExecCommand', event => {\n        const command = event.command;\n        if (command !== 'mceDirectionLTR' && command !== 'mceDirectionRTL') {\n            return;\n        }\n\n        const dir = command === 'mceDirectionLTR' ? 'ltr' : 'rtl';\n        for (const cell of selectedCells) {\n            cell.setAttribute('dir', dir);\n            cleanElementDirection(cell);\n        }\n    });\n}\n\n/**\n * Direction control might not work if there are other unexpected direction-handling styles\n * or attributes involved nearby. This watches for direction change events to clean\n * up direction controls, removing non-dir-attr direction controls, while removing\n * directions from child elements that may be involved.\n * @param {Editor} editor\n */\nexport function handleTextDirectionCleaning(editor) {\n    editor.on('ExecCommand', event => {\n        const command = event.command;\n        if (command !== 'mceDirectionLTR' && command !== 'mceDirectionRTL') {\n            return;\n        }\n\n        const blocks = editor.selection.getSelectedBlocks();\n        for (const block of blocks) {\n            cleanElementDirection(block);\n        }\n    });\n}\n", "import {register as registerShortcuts} from './shortcuts';\nimport {listen as listenForCommonEvents} from './common-events';\nimport {scrollToQueryString} from './scrolling';\nimport {listenForDragAndPaste} from './drop-paste-handling';\nimport {getPrimaryToolbar, registerAdditionalToolbars} from './toolbars';\nimport {registerCustomIcons} from './icons';\nimport {setupFilters} from './filters';\n\nimport {getPlugin as getCodeeditorPlugin} from './plugin-codeeditor';\nimport {getPlugin as getDrawioPlugin} from './plugin-drawio';\nimport {getPlugin as getCustomhrPlugin} from './plugins-customhr';\nimport {getPlugin as getImagemanagerPlugin} from './plugins-imagemanager';\nimport {getPlugin as getAboutPlugin} from './plugins-about';\nimport {getPlugin as getDetailsPlugin} from './plugins-details';\nimport {getPlugin as getTableAdditionsPlugin} from './plugins-table-additions';\nimport {getPlugin as getTasklistPlugin} from './plugins-tasklist';\nimport {\n    handleTableCellRangeEvents,\n    handleEmbedAlignmentChanges,\n    handleTextDirectionCleaning,\n} from './fixes';\n\nconst styleFormats = [\n    {title: 'Large Header', format: 'h2', preview: 'color: blue;'},\n    {title: 'Medium Header', format: 'h3'},\n    {title: 'Small Header', format: 'h4'},\n    {title: 'Tiny Header', format: 'h5'},\n    {\n        title: 'Paragraph', format: 'p', exact: true, classes: '',\n    },\n    {title: 'Blockquote', format: 'blockquote'},\n    {\n        title: 'Callouts',\n        items: [\n            {title: 'Information', format: 'calloutinfo'},\n            {title: 'Success', format: 'calloutsuccess'},\n            {title: 'Warning', format: 'calloutwarning'},\n            {title: 'Danger', format: 'calloutdanger'},\n        ],\n    },\n];\n\nconst formats = {\n    alignleft: {selector: 'p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img,iframe,video', classes: 'align-left'},\n    aligncenter: {selector: 'p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img,iframe,video', classes: 'align-center'},\n    alignright: {selector: 'p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li,table,img,iframe,video', classes: 'align-right'},\n    calloutsuccess: {block: 'p', exact: true, attributes: {class: 'callout success'}},\n    calloutinfo: {block: 'p', exact: true, attributes: {class: 'callout info'}},\n    calloutwarning: {block: 'p', exact: true, attributes: {class: 'callout warning'}},\n    calloutdanger: {block: 'p', exact: true, attributes: {class: 'callout danger'}},\n};\n\nconst colorMap = [\n    '#BFEDD2', '',\n    '#FBEEB8', '',\n    '#F8CAC6', '',\n    '#ECCAFA', '',\n    '#C2E0F4', '',\n\n    '#2DC26B', '',\n    '#F1C40F', '',\n    '#E03E2D', '',\n    '#B96AD9', '',\n    '#3598DB', '',\n\n    '#169179', '',\n    '#E67E23', '',\n    '#BA372A', '',\n    '#843FA1', '',\n    '#236FA1', '',\n\n    '#ECF0F1', '',\n    '#CED4D9', '',\n    '#95A5A6', '',\n    '#7E8C8D', '',\n    '#34495E', '',\n\n    '#000000', '',\n    '#ffffff', '',\n];\n\nfunction filePickerCallback(callback, value, meta) {\n    // field_name, url, type, win\n    if (meta.filetype === 'file') {\n        /** @type {EntitySelectorPopup} * */\n        const selector = window.$components.first('entity-selector-popup');\n        const selectionText = this.selection.getContent({format: 'text'}).trim();\n        selector.show(entity => {\n            callback(entity.link, {\n                text: entity.name,\n                title: entity.name,\n            });\n        }, {\n            initialValue: selectionText,\n            searchEndpoint: '/search/entity-selector',\n            entityTypes: 'page,book,chapter,bookshelf',\n            entityPermission: 'view',\n        });\n    }\n\n    if (meta.filetype === 'image') {\n        // Show image manager\n        /** @type {ImageManager} * */\n        const imageManager = window.$components.first('image-manager');\n        imageManager.show(image => {\n            callback(image.url, {alt: image.name});\n        }, 'gallery');\n    }\n}\n\n/**\n * @param {WysiwygConfigOptions} options\n * @return {string[]}\n */\nfunction gatherPlugins(options) {\n    const plugins = [\n        'image',\n        'table',\n        'link',\n        'autolink',\n        'fullscreen',\n        'code',\n        'customhr',\n        'autosave',\n        'lists',\n        'codeeditor',\n        'media',\n        'imagemanager',\n        'about',\n        'details',\n        'tasklist',\n        'tableadditions',\n        options.textDirection === 'rtl' ? 'directionality' : '',\n    ];\n\n    window.tinymce.PluginManager.add('codeeditor', getCodeeditorPlugin());\n    window.tinymce.PluginManager.add('customhr', getCustomhrPlugin());\n    window.tinymce.PluginManager.add('imagemanager', getImagemanagerPlugin());\n    window.tinymce.PluginManager.add('about', getAboutPlugin());\n    window.tinymce.PluginManager.add('details', getDetailsPlugin());\n    window.tinymce.PluginManager.add('tasklist', getTasklistPlugin());\n    window.tinymce.PluginManager.add('tableadditions', getTableAdditionsPlugin());\n\n    if (options.drawioUrl) {\n        window.tinymce.PluginManager.add('drawio', getDrawioPlugin(options));\n        plugins.push('drawio');\n    }\n\n    return plugins.filter(plugin => Boolean(plugin));\n}\n\n/**\n * Fetch custom HTML head content nodes from the outer page head\n * and add them to the given editor document.\n * @param {Document} editorDoc\n */\nfunction addCustomHeadContent(editorDoc) {\n    const headContentLines = document.head.innerHTML.split('\\n');\n    const startLineIndex = headContentLines.findIndex(line => line.trim() === '<!-- Start: custom user content -->');\n    const endLineIndex = headContentLines.findIndex(line => line.trim() === '<!-- End: custom user content -->');\n    if (startLineIndex === -1 || endLineIndex === -1) {\n        return;\n    }\n\n    const customHeadHtml = headContentLines.slice(startLineIndex + 1, endLineIndex).join('\\n');\n    const el = editorDoc.createElement('div');\n    el.innerHTML = customHeadHtml;\n\n    editorDoc.head.append(...el.children);\n}\n\n/**\n * @param {WysiwygConfigOptions} options\n * @return {function(Editor)}\n */\nfunction getSetupCallback(options) {\n    return function setupCallback(editor) {\n        function editorChange() {\n            if (options.darkMode) {\n                editor.contentDocument.documentElement.classList.add('dark-mode');\n            }\n            window.$events.emit('editor-html-change', '');\n        }\n\n        editor.on('ExecCommand change input NodeChange ObjectResized', editorChange);\n        listenForCommonEvents(editor);\n        listenForDragAndPaste(editor, options);\n\n        editor.on('init', () => {\n            editorChange();\n            scrollToQueryString(editor);\n            window.editor = editor;\n            registerShortcuts(editor);\n        });\n\n        editor.on('PreInit', () => {\n            setupFilters(editor);\n        });\n\n        handleEmbedAlignmentChanges(editor);\n        handleTableCellRangeEvents(editor);\n        handleTextDirectionCleaning(editor);\n\n        // Custom handler hook\n        window.$events.emitPublic(options.containerElement, 'editor-tinymce::setup', {editor});\n\n        // Inline code format button\n        editor.ui.registry.addButton('inlinecode', {\n            tooltip: 'Inline code',\n            icon: 'sourcecode',\n            onAction() {\n                editor.execCommand('mceToggleFormat', false, 'code');\n            },\n        });\n    };\n}\n\n/**\n * @param {WysiwygConfigOptions} options\n */\nfunction getContentStyle(options) {\n    return `\nhtml, body, html.dark-mode {\n    background: ${options.darkMode ? '#222' : '#fff'};\n} \nbody {\n    padding-left: 15px !important;\n    padding-right: 15px !important; \n    height: initial !important;\n    margin:0!important; \n    margin-left: auto! important;\n    margin-right: auto !important;\n    overflow-y: hidden !important;\n}`.trim().replace('\\n', '');\n}\n\n/**\n * @param {WysiwygConfigOptions} options\n * @return {Object}\n */\nexport function buildForEditor(options) {\n    // Set language\n    window.tinymce.addI18n(options.language, options.translationMap);\n\n    // BookStack Version\n    const version = document.querySelector('script[src*=\"/dist/app.js\"]').getAttribute('src').split('?version=')[1];\n\n    // Return config object\n    return {\n        width: '100%',\n        height: '100%',\n        selector: '#html-editor',\n        cache_suffix: `?version=${version}`,\n        content_css: [\n            window.baseUrl('/dist/styles.css'),\n        ],\n        branding: false,\n        skin: options.darkMode ? 'tinymce-5-dark' : 'tinymce-5',\n        body_class: 'page-content',\n        browser_spellcheck: true,\n        relative_urls: false,\n        language: options.language,\n        directionality: options.textDirection,\n        remove_script_host: false,\n        document_base_url: window.baseUrl('/'),\n        end_container_on_empty_block: true,\n        remove_trailing_brs: false,\n        statusbar: false,\n        menubar: false,\n        paste_data_images: false,\n        extended_valid_elements: 'pre[*],svg[*],div[drawio-diagram],details[*],summary[*],div[*],li[class|checked|style]',\n        automatic_uploads: false,\n        custom_elements: 'doc-root,code-block',\n        valid_children: [\n            '-div[p|h1|h2|h3|h4|h5|h6|blockquote|code-block]',\n            '+div[pre|img]',\n            '-doc-root[doc-root|#text]',\n            '-li[details]',\n            '+code-block[pre]',\n            '+doc-root[p|h1|h2|h3|h4|h5|h6|blockquote|code-block|div|hr]',\n        ].join(','),\n        plugins: gatherPlugins(options),\n        contextmenu: false,\n        toolbar: getPrimaryToolbar(options),\n        content_style: getContentStyle(options),\n        style_formats: styleFormats,\n        style_formats_merge: false,\n        media_alt_source: false,\n        media_poster: false,\n        formats,\n        table_style_by_css: true,\n        table_use_colgroups: true,\n        file_picker_types: 'file image',\n        color_map: colorMap,\n        file_picker_callback: filePickerCallback,\n        paste_preprocess(plugin, args) {\n            const {content} = args;\n            if (content.indexOf('<img src=\"file://') !== -1) {\n                args.content = '';\n            }\n        },\n        init_instance_callback(editor) {\n            addCustomHeadContent(editor.getDoc());\n        },\n        setup(editor) {\n            registerCustomIcons(editor);\n            registerAdditionalToolbars(editor);\n            getSetupCallback(options)(editor);\n        },\n    };\n}\n\n/**\n * @param {WysiwygConfigOptions} options\n * @return {RawEditorOptions}\n */\nexport function buildForInput(options) {\n    // Set language\n    window.tinymce.addI18n(options.language, options.translationMap);\n\n    // BookStack Version\n    const version = document.querySelector('script[src*=\"/dist/app.js\"]').getAttribute('src').split('?version=')[1];\n\n    // Return config object\n    return {\n        width: '100%',\n        height: '185px',\n        target: options.containerElement,\n        cache_suffix: `?version=${version}`,\n        content_css: [\n            window.baseUrl('/dist/styles.css'),\n        ],\n        branding: false,\n        skin: options.darkMode ? 'tinymce-5-dark' : 'tinymce-5',\n        body_class: 'wysiwyg-input',\n        browser_spellcheck: true,\n        relative_urls: false,\n        language: options.language,\n        directionality: options.textDirection,\n        remove_script_host: false,\n        document_base_url: window.baseUrl('/'),\n        end_container_on_empty_block: true,\n        remove_trailing_brs: false,\n        statusbar: false,\n        menubar: false,\n        plugins: 'link autolink lists',\n        contextmenu: false,\n        toolbar: 'bold italic link bullist numlist',\n        content_style: getContentStyle(options),\n        file_picker_types: 'file',\n        valid_elements: 'p,a[href|title|target],ol,ul,li,strong,em,br',\n        file_picker_callback: filePickerCallback,\n        init_instance_callback(editor) {\n            addCustomHeadContent(editor.getDoc());\n\n            editor.contentDocument.documentElement.classList.toggle('dark-mode', options.darkMode);\n        },\n    };\n}\n\n/**\n * @typedef {Object} WysiwygConfigOptions\n * @property {Element} containerElement\n * @property {string} language\n * @property {boolean} darkMode\n * @property {string} textDirection\n * @property {string} drawioUrl\n * @property {int} pageId\n * @property {Object} translations\n * @property {Object} translationMap\n */\n", "import {Component} from './component';\nimport {getLoading, htmlToDom} from '../services/dom';\nimport {buildForInput} from '../wysiwyg/config';\n\nexport class PageComment extends Component {\n\n    setup() {\n        // Options\n        this.commentId = this.$opts.commentId;\n        this.commentLocalId = this.$opts.commentLocalId;\n        this.commentParentId = this.$opts.commentParentId;\n        this.deletedText = this.$opts.deletedText;\n        this.updatedText = this.$opts.updatedText;\n\n        // Editor reference and text options\n        this.wysiwygEditor = null;\n        this.wysiwygLanguage = this.$opts.wysiwygLanguage;\n        this.wysiwygTextDirection = this.$opts.wysiwygTextDirection;\n\n        // Element references\n        this.container = this.$el;\n        this.contentContainer = this.$refs.contentContainer;\n        this.form = this.$refs.form;\n        this.formCancel = this.$refs.formCancel;\n        this.editButton = this.$refs.editButton;\n        this.deleteButton = this.$refs.deleteButton;\n        this.replyButton = this.$refs.replyButton;\n        this.input = this.$refs.input;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        if (this.replyButton) {\n            this.replyButton.addEventListener('click', () => this.$emit('reply', {\n                id: this.commentLocalId,\n                element: this.container,\n            }));\n        }\n\n        if (this.editButton) {\n            this.editButton.addEventListener('click', this.startEdit.bind(this));\n            this.form.addEventListener('submit', this.update.bind(this));\n            this.formCancel.addEventListener('click', () => this.toggleEditMode(false));\n        }\n\n        if (this.deleteButton) {\n            this.deleteButton.addEventListener('click', this.delete.bind(this));\n        }\n    }\n\n    toggleEditMode(show) {\n        this.contentContainer.toggleAttribute('hidden', show);\n        this.form.toggleAttribute('hidden', !show);\n    }\n\n    startEdit() {\n        this.toggleEditMode(true);\n\n        if (this.wysiwygEditor) {\n            this.wysiwygEditor.focus();\n            return;\n        }\n\n        const config = buildForInput({\n            language: this.wysiwygLanguage,\n            containerElement: this.input,\n            darkMode: document.documentElement.classList.contains('dark-mode'),\n            textDirection: this.wysiwygTextDirection,\n            translations: {},\n            translationMap: window.editor_translations,\n        });\n\n        window.tinymce.init(config).then(editors => {\n            this.wysiwygEditor = editors[0];\n            setTimeout(() => this.wysiwygEditor.focus(), 50);\n        });\n    }\n\n    async update(event) {\n        event.preventDefault();\n        const loading = this.showLoading();\n        this.form.toggleAttribute('hidden', true);\n\n        const reqData = {\n            html: this.wysiwygEditor.getContent(),\n            parent_id: this.parentId || null,\n        };\n\n        try {\n            const resp = await window.$http.put(`/comment/${this.commentId}`, reqData);\n            const newComment = htmlToDom(resp.data);\n            this.container.replaceWith(newComment);\n            window.$events.success(this.updatedText);\n        } catch (err) {\n            console.error(err);\n            window.$events.showValidationErrors(err);\n            this.form.toggleAttribute('hidden', false);\n            loading.remove();\n        }\n    }\n\n    async delete() {\n        this.showLoading();\n\n        await window.$http.delete(`/comment/${this.commentId}`);\n        this.container.closest('.comment-branch').remove();\n        window.$events.success(this.deletedText);\n        this.$emit('delete');\n    }\n\n    showLoading() {\n        const loading = getLoading();\n        loading.classList.add('px-l');\n        this.container.append(loading);\n        return loading;\n    }\n\n}\n", "import {Component} from './component';\nimport {getLoading, htmlToDom} from '../services/dom';\nimport {buildForInput} from '../wysiwyg/config';\n\nexport class PageComments extends Component {\n\n    setup() {\n        this.elem = this.$el;\n        this.pageId = Number(this.$opts.pageId);\n\n        // Element references\n        this.container = this.$refs.commentContainer;\n        this.commentCountBar = this.$refs.commentCountBar;\n        this.commentsTitle = this.$refs.commentsTitle;\n        this.addButtonContainer = this.$refs.addButtonContainer;\n        this.replyToRow = this.$refs.replyToRow;\n        this.formContainer = this.$refs.formContainer;\n        this.form = this.$refs.form;\n        this.formInput = this.$refs.formInput;\n        this.formReplyLink = this.$refs.formReplyLink;\n        this.addCommentButton = this.$refs.addCommentButton;\n        this.hideFormButton = this.$refs.hideFormButton;\n        this.removeReplyToButton = this.$refs.removeReplyToButton;\n\n        // WYSIWYG options\n        this.wysiwygLanguage = this.$opts.wysiwygLanguage;\n        this.wysiwygTextDirection = this.$opts.wysiwygTextDirection;\n        this.wysiwygEditor = null;\n\n        // Translations\n        this.createdText = this.$opts.createdText;\n        this.countText = this.$opts.countText;\n\n        // Internal State\n        this.parentId = null;\n        this.formReplyText = this.formReplyLink?.textContent || '';\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        this.elem.addEventListener('page-comment-delete', () => {\n            this.updateCount();\n            this.hideForm();\n        });\n\n        this.elem.addEventListener('page-comment-reply', event => {\n            this.setReply(event.detail.id, event.detail.element);\n        });\n\n        if (this.form) {\n            this.removeReplyToButton.addEventListener('click', this.removeReplyTo.bind(this));\n            this.hideFormButton.addEventListener('click', this.hideForm.bind(this));\n            this.addCommentButton.addEventListener('click', this.showForm.bind(this));\n            this.form.addEventListener('submit', this.saveComment.bind(this));\n        }\n    }\n\n    saveComment(event) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        const loading = getLoading();\n        loading.classList.add('px-l');\n        this.form.after(loading);\n        this.form.toggleAttribute('hidden', true);\n\n        const reqData = {\n            html: this.wysiwygEditor.getContent(),\n            parent_id: this.parentId || null,\n        };\n\n        window.$http.post(`/comment/${this.pageId}`, reqData).then(resp => {\n            const newElem = htmlToDom(resp.data);\n            this.formContainer.after(newElem);\n            window.$events.success(this.createdText);\n            this.hideForm();\n            this.updateCount();\n        }).catch(err => {\n            this.form.toggleAttribute('hidden', false);\n            window.$events.showValidationErrors(err);\n        });\n\n        this.form.toggleAttribute('hidden', false);\n        loading.remove();\n    }\n\n    updateCount() {\n        const count = this.getCommentCount();\n        this.commentsTitle.textContent = window.trans_plural(this.countText, count, {count});\n    }\n\n    resetForm() {\n        this.removeEditor();\n        this.formInput.value = '';\n        this.parentId = null;\n        this.replyToRow.toggleAttribute('hidden', true);\n        this.container.append(this.formContainer);\n    }\n\n    showForm() {\n        this.removeEditor();\n        this.formContainer.toggleAttribute('hidden', false);\n        this.addButtonContainer.toggleAttribute('hidden', true);\n        this.formContainer.scrollIntoView({behavior: 'smooth', block: 'nearest'});\n        this.loadEditor();\n    }\n\n    hideForm() {\n        this.resetForm();\n        this.formContainer.toggleAttribute('hidden', true);\n        if (this.getCommentCount() > 0) {\n            this.elem.append(this.addButtonContainer);\n        } else {\n            this.commentCountBar.append(this.addButtonContainer);\n        }\n        this.addButtonContainer.toggleAttribute('hidden', false);\n    }\n\n    loadEditor() {\n        if (this.wysiwygEditor) {\n            this.wysiwygEditor.focus();\n            return;\n        }\n\n        const config = buildForInput({\n            language: this.wysiwygLanguage,\n            containerElement: this.formInput,\n            darkMode: document.documentElement.classList.contains('dark-mode'),\n            textDirection: this.wysiwygTextDirection,\n            translations: {},\n            translationMap: window.editor_translations,\n        });\n\n        window.tinymce.init(config).then(editors => {\n            this.wysiwygEditor = editors[0];\n            setTimeout(() => this.wysiwygEditor.focus(), 50);\n        });\n    }\n\n    removeEditor() {\n        if (this.wysiwygEditor) {\n            this.wysiwygEditor.remove();\n            this.wysiwygEditor = null;\n        }\n    }\n\n    getCommentCount() {\n        return this.container.querySelectorAll('[component=\"page-comment\"]').length;\n    }\n\n    setReply(commentLocalId, commentElement) {\n        const targetFormLocation = commentElement.closest('.comment-branch').querySelector('.comment-branch-children');\n        targetFormLocation.append(this.formContainer);\n        this.showForm();\n        this.parentId = commentLocalId;\n        this.replyToRow.toggleAttribute('hidden', false);\n        this.formReplyLink.textContent = this.formReplyText.replace('1234', this.parentId);\n        this.formReplyLink.href = `#comment${this.parentId}`;\n    }\n\n    removeReplyTo() {\n        this.parentId = null;\n        this.replyToRow.toggleAttribute('hidden', true);\n        this.container.append(this.formContainer);\n        this.showForm();\n    }\n\n}\n", "import * as DOM from '../services/dom';\nimport {scrollAndHighlightElement} from '../services/util';\nimport {Component} from './component';\n\nfunction toggleAnchorHighlighting(elementId, shouldHighlight) {\n    DOM.forEach(`#page-navigation a[href=\"#${elementId}\"]`, anchor => {\n        anchor.closest('li').classList.toggle('current-heading', shouldHighlight);\n    });\n}\n\nfunction headingVisibilityChange(entries) {\n    for (const entry of entries) {\n        const isVisible = (entry.intersectionRatio === 1);\n        toggleAnchorHighlighting(entry.target.id, isVisible);\n    }\n}\n\nfunction addNavObserver(headings) {\n    // Setup the intersection observer.\n    const intersectOpts = {\n        rootMargin: '0px 0px 0px 0px',\n        threshold: 1.0,\n    };\n    const pageNavObserver = new IntersectionObserver(headingVisibilityChange, intersectOpts);\n\n    // observe each heading\n    for (const heading of headings) {\n        pageNavObserver.observe(heading);\n    }\n}\n\nexport class PageDisplay extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.pageId = this.$opts.pageId;\n\n        window.importVersioned('code').then(Code => Code.highlight());\n        this.setupNavHighlighting();\n\n        // Check the hash on load\n        if (window.location.hash) {\n            const text = window.location.hash.replace(/%20/g, ' ').substring(1);\n            this.goToText(text);\n        }\n\n        // Sidebar page nav click event\n        const sidebarPageNav = document.querySelector('.sidebar-page-nav');\n        if (sidebarPageNav) {\n            DOM.onChildEvent(sidebarPageNav, 'a', 'click', (event, child) => {\n                event.preventDefault();\n                window.$components.first('tri-layout').showContent();\n                const contentId = child.getAttribute('href').substr(1);\n                this.goToText(contentId);\n                window.history.pushState(null, null, `#${contentId}`);\n            });\n        }\n    }\n\n    goToText(text) {\n        const idElem = document.getElementById(text);\n\n        DOM.forEach('.page-content [data-highlighted]', elem => {\n            elem.removeAttribute('data-highlighted');\n            elem.style.backgroundColor = null;\n        });\n\n        if (idElem !== null) {\n            scrollAndHighlightElement(idElem);\n        } else {\n            const textElem = DOM.findText('.page-content > div > *', text);\n            if (textElem) {\n                scrollAndHighlightElement(textElem);\n            }\n        }\n    }\n\n    setupNavHighlighting() {\n        const pageNav = document.querySelector('.sidebar-page-nav');\n\n        // fetch all the headings.\n        const headings = document.querySelector('.page-content').querySelectorAll('h1, h2, h3, h4, h5, h6');\n        // if headings are present, add observers.\n        if (headings.length > 0 && pageNav !== null) {\n            addNavObserver(headings);\n        }\n    }\n\n}\n", "export function getCurrentDay() {\n    const date = new Date();\n    const month = date.getMonth() + 1;\n    const day = date.getDate();\n\n    return `${date.getFullYear()}-${(month > 9 ? '' : '0') + month}-${(day > 9 ? '' : '0') + day}`;\n}\n\nexport function utcTimeStampToLocalTime(timestamp) {\n    const date = new Date(timestamp * 1000);\n    const hours = date.getHours();\n    const mins = date.getMinutes();\n    return `${(hours > 9 ? '' : '0') + hours}:${(mins > 9 ? '' : '0') + mins}`;\n}\n\nexport function formatDateTime(date) {\n    const month = date.getMonth() + 1;\n    const day = date.getDate();\n    const hours = date.getHours();\n    const mins = date.getMinutes();\n\n    return `${date.getFullYear()}-${(month > 9 ? '' : '0') + month}-${(day > 9 ? '' : '0') + day} ${(hours > 9 ? '' : '0') + hours}:${(mins > 9 ? '' : '0') + mins}`;\n}\n", "import * as Dates from '../services/dates';\nimport {onSelect} from '../services/dom';\nimport {debounce} from '../services/util';\nimport {Component} from './component';\n\nexport class PageEditor extends Component {\n\n    setup() {\n        // Options\n        this.draftsEnabled = this.$opts.draftsEnabled === 'true';\n        this.editorType = this.$opts.editorType;\n        this.pageId = Number(this.$opts.pageId);\n        this.isNewDraft = this.$opts.pageNewDraft === 'true';\n        this.hasDefaultTitle = this.$opts.hasDefaultTitle || false;\n\n        // Elements\n        this.container = this.$el;\n        this.titleElem = this.$refs.titleContainer.querySelector('input');\n        this.saveDraftButton = this.$refs.saveDraft;\n        this.discardDraftButton = this.$refs.discardDraft;\n        this.discardDraftWrap = this.$refs.discardDraftWrap;\n        this.deleteDraftButton = this.$refs.deleteDraft;\n        this.deleteDraftWrap = this.$refs.deleteDraftWrap;\n        this.draftDisplay = this.$refs.draftDisplay;\n        this.draftDisplayIcon = this.$refs.draftDisplayIcon;\n        this.changelogInput = this.$refs.changelogInput;\n        this.changelogDisplay = this.$refs.changelogDisplay;\n        this.changeEditorButtons = this.$manyRefs.changeEditor || [];\n        this.switchDialogContainer = this.$refs.switchDialog;\n        this.deleteDraftDialogContainer = this.$refs.deleteDraftDialog;\n\n        // Translations\n        this.draftText = this.$opts.draftText;\n        this.autosaveFailText = this.$opts.autosaveFailText;\n        this.editingPageText = this.$opts.editingPageText;\n        this.draftDiscardedText = this.$opts.draftDiscardedText;\n        this.draftDeleteText = this.$opts.draftDeleteText;\n        this.draftDeleteFailText = this.$opts.draftDeleteFailText;\n        this.setChangelogText = this.$opts.setChangelogText;\n\n        // State data\n        this.autoSave = {\n            interval: null,\n            frequency: 30000,\n            last: 0,\n            pendingChange: false,\n        };\n        this.shownWarningsCache = new Set();\n\n        if (this.pageId !== 0 && this.draftsEnabled) {\n            window.setTimeout(() => {\n                this.startAutoSave();\n            }, 1000);\n        }\n        this.draftDisplay.innerHTML = this.draftText;\n\n        this.setupListeners();\n        this.setInitialFocus();\n    }\n\n    setupListeners() {\n        // Listen to save events from editor\n        window.$events.listen('editor-save-draft', this.saveDraft.bind(this));\n        window.$events.listen('editor-save-page', this.savePage.bind(this));\n\n        // Listen to content changes from the editor\n        const onContentChange = () => {\n            this.autoSave.pendingChange = true;\n        };\n        window.$events.listen('editor-html-change', onContentChange);\n        window.$events.listen('editor-markdown-change', onContentChange);\n\n        // Listen to changes on the title input\n        this.titleElem.addEventListener('input', onContentChange);\n\n        // Changelog controls\n        const updateChangelogDebounced = debounce(this.updateChangelogDisplay.bind(this), 300, false);\n        this.changelogInput.addEventListener('input', updateChangelogDebounced);\n\n        // Draft Controls\n        onSelect(this.saveDraftButton, this.saveDraft.bind(this));\n        onSelect(this.discardDraftButton, this.discardDraft.bind(this));\n        onSelect(this.deleteDraftButton, this.deleteDraft.bind(this));\n\n        // Change editor controls\n        onSelect(this.changeEditorButtons, this.changeEditor.bind(this));\n    }\n\n    setInitialFocus() {\n        if (this.hasDefaultTitle) {\n            this.titleElem.select();\n            return;\n        }\n\n        window.setTimeout(() => {\n            window.$events.emit('editor::focus', '');\n        }, 500);\n    }\n\n    startAutoSave() {\n        this.autoSave.interval = window.setInterval(this.runAutoSave.bind(this), this.autoSave.frequency);\n    }\n\n    runAutoSave() {\n        // Stop if manually saved recently to prevent bombarding the server\n        const savedRecently = (Date.now() - this.autoSave.last < (this.autoSave.frequency) / 2);\n        if (savedRecently || !this.autoSave.pendingChange) {\n            return;\n        }\n\n        this.saveDraft();\n    }\n\n    savePage() {\n        this.container.closest('form').submit();\n    }\n\n    async saveDraft() {\n        const data = {name: this.titleElem.value.trim()};\n\n        const editorContent = this.getEditorComponent().getContent();\n        Object.assign(data, editorContent);\n\n        let didSave = false;\n        try {\n            const resp = await window.$http.put(`/ajax/page/${this.pageId}/save-draft`, data);\n            if (!this.isNewDraft) {\n                this.discardDraftWrap.toggleAttribute('hidden', false);\n                this.deleteDraftWrap.toggleAttribute('hidden', false);\n            }\n\n            this.draftNotifyChange(`${resp.data.message} ${Dates.utcTimeStampToLocalTime(resp.data.timestamp)}`);\n            this.autoSave.last = Date.now();\n            if (resp.data.warning && !this.shownWarningsCache.has(resp.data.warning)) {\n                window.$events.emit('warning', resp.data.warning);\n                this.shownWarningsCache.add(resp.data.warning);\n            }\n\n            didSave = true;\n            this.autoSave.pendingChange = false;\n        } catch (err) {\n            // Save the editor content in LocalStorage as a last resort, just in case.\n            try {\n                const saveKey = `draft-save-fail-${(new Date()).toISOString()}`;\n                window.localStorage.setItem(saveKey, JSON.stringify(data));\n            } catch (lsErr) {\n                console.error(lsErr);\n            }\n\n            window.$events.emit('error', this.autosaveFailText);\n        }\n\n        return didSave;\n    }\n\n    draftNotifyChange(text) {\n        this.draftDisplay.innerText = text;\n        this.draftDisplayIcon.classList.add('visible');\n        window.setTimeout(() => {\n            this.draftDisplayIcon.classList.remove('visible');\n        }, 2000);\n    }\n\n    async discardDraft(notify = true) {\n        let response;\n        try {\n            response = await window.$http.get(`/ajax/page/${this.pageId}`);\n        } catch (e) {\n            console.error(e);\n            return;\n        }\n\n        if (this.autoSave.interval) {\n            window.clearInterval(this.autoSave.interval);\n        }\n\n        this.draftDisplay.innerText = this.editingPageText;\n        this.discardDraftWrap.toggleAttribute('hidden', true);\n        window.$events.emit('editor::replace', {\n            html: response.data.html,\n            markdown: response.data.markdown,\n        });\n\n        this.titleElem.value = response.data.name;\n        window.setTimeout(() => {\n            this.startAutoSave();\n        }, 1000);\n\n        if (notify) {\n            window.$events.success(this.draftDiscardedText);\n        }\n    }\n\n    async deleteDraft() {\n        /** @var {ConfirmDialog} * */\n        const dialog = window.$components.firstOnElement(this.deleteDraftDialogContainer, 'confirm-dialog');\n        const confirmed = await dialog.show();\n        if (!confirmed) {\n            return;\n        }\n\n        try {\n            const discard = this.discardDraft(false);\n            const draftDelete = window.$http.delete(`/page-revisions/user-drafts/${this.pageId}`);\n            await Promise.all([discard, draftDelete]);\n            window.$events.success(this.draftDeleteText);\n            this.deleteDraftWrap.toggleAttribute('hidden', true);\n        } catch (err) {\n            console.error(err);\n            window.$events.error(this.draftDeleteFailText);\n        }\n    }\n\n    updateChangelogDisplay() {\n        let summary = this.changelogInput.value.trim();\n        if (summary.length === 0) {\n            summary = this.setChangelogText;\n        } else if (summary.length > 16) {\n            summary = `${summary.slice(0, 16)}...`;\n        }\n        this.changelogDisplay.innerText = summary;\n    }\n\n    async changeEditor(event) {\n        event.preventDefault();\n\n        const link = event.target.closest('a').href;\n        /** @var {ConfirmDialog} * */\n        const dialog = window.$components.firstOnElement(this.switchDialogContainer, 'confirm-dialog');\n        const [saved, confirmed] = await Promise.all([this.saveDraft(), dialog.show()]);\n\n        if (saved && confirmed) {\n            window.location = link;\n        }\n    }\n\n    /**\n     * @return MarkdownEditor|WysiwygEditor\n     */\n    getEditorComponent() {\n        return window.$components.first('markdown-editor') || window.$components.first('wysiwyg-editor');\n    }\n\n}\n", "import {Component} from './component';\n\nfunction toggleElem(elem, show) {\n    elem.toggleAttribute('hidden', !show);\n}\n\nexport class PagePicker extends Component {\n\n    setup() {\n        this.input = this.$refs.input;\n        this.resetButton = this.$refs.resetButton;\n        this.selectButton = this.$refs.selectButton;\n        this.display = this.$refs.display;\n        this.defaultDisplay = this.$refs.defaultDisplay;\n        this.buttonSep = this.$refs.buttonSeperator;\n\n        this.selectorEndpoint = this.$opts.selectorEndpoint;\n\n        this.value = this.input.value;\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        this.selectButton.addEventListener('click', this.showPopup.bind(this));\n        this.display.parentElement.addEventListener('click', this.showPopup.bind(this));\n        this.display.addEventListener('click', e => e.stopPropagation());\n\n        this.resetButton.addEventListener('click', () => {\n            this.setValue('', '');\n        });\n    }\n\n    showPopup() {\n        /** @type {EntitySelectorPopup} * */\n        const selectorPopup = window.$components.first('entity-selector-popup');\n        selectorPopup.show(entity => {\n            this.setValue(entity.id, entity.name);\n        }, {\n            initialValue: '',\n            searchEndpoint: this.selectorEndpoint,\n            entityTypes: 'page',\n            entityPermission: 'view',\n        });\n    }\n\n    setValue(value, name) {\n        this.value = value;\n        this.input.value = value;\n        this.controlView(name);\n    }\n\n    controlView(name) {\n        const hasValue = this.value && this.value !== 0;\n        toggleElem(this.resetButton, hasValue);\n        toggleElem(this.buttonSep, hasValue);\n        toggleElem(this.defaultDisplay, !hasValue);\n        toggleElem(this.display, hasValue);\n        if (hasValue) {\n            const id = this.getAssetIdFromVal();\n            this.display.textContent = `#${id}, ${name}`;\n            this.display.href = window.baseUrl(`/link/${id}`);\n        }\n    }\n\n    getAssetIdFromVal() {\n        return Number(this.value);\n    }\n\n}\n", "import {Component} from './component';\n\nexport class PermissionsTable extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.cellSelector = this.$opts.cellSelector || 'td,th';\n        this.rowSelector = this.$opts.rowSelector || 'tr';\n\n        // Handle toggle all event\n        for (const toggleAllElem of (this.$manyRefs.toggleAll || [])) {\n            toggleAllElem.addEventListener('click', this.toggleAllClick.bind(this));\n        }\n\n        // Handle toggle row event\n        for (const toggleRowElem of (this.$manyRefs.toggleRow || [])) {\n            toggleRowElem.addEventListener('click', this.toggleRowClick.bind(this));\n        }\n\n        // Handle toggle column event\n        for (const toggleColElem of (this.$manyRefs.toggleColumn || [])) {\n            toggleColElem.addEventListener('click', this.toggleColumnClick.bind(this));\n        }\n    }\n\n    toggleAllClick(event) {\n        event.preventDefault();\n        this.toggleAllInElement(this.container);\n    }\n\n    toggleRowClick(event) {\n        event.preventDefault();\n        this.toggleAllInElement(event.target.closest(this.rowSelector));\n    }\n\n    toggleColumnClick(event) {\n        event.preventDefault();\n\n        const tableCell = event.target.closest(this.cellSelector);\n        const colIndex = Array.from(tableCell.parentElement.children).indexOf(tableCell);\n        const tableRows = this.container.querySelectorAll(this.rowSelector);\n        const inputsToToggle = [];\n\n        for (const row of tableRows) {\n            const targetCell = row.children[colIndex];\n            if (targetCell) {\n                inputsToToggle.push(...targetCell.querySelectorAll('input[type=checkbox]'));\n            }\n        }\n        this.toggleAllInputs(inputsToToggle);\n    }\n\n    toggleAllInElement(domElem) {\n        const inputsToToggle = domElem.querySelectorAll('input[type=checkbox]');\n        this.toggleAllInputs(inputsToToggle);\n    }\n\n    toggleAllInputs(inputsToToggle) {\n        const currentState = inputsToToggle.length > 0 ? inputsToToggle[0].checked : false;\n        for (const checkbox of inputsToToggle) {\n            checkbox.checked = !currentState;\n            checkbox.dispatchEvent(new Event('change'));\n        }\n    }\n\n}\n", "import * as DOM from '../services/dom';\nimport {Component} from './component';\nimport {copyTextToClipboard} from '../services/clipboard';\n\nexport class Pointer extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.pointer = this.$refs.pointer;\n        this.linkInput = this.$refs.linkInput;\n        this.linkButton = this.$refs.linkButton;\n        this.includeInput = this.$refs.includeInput;\n        this.includeButton = this.$refs.includeButton;\n        this.sectionModeButton = this.$refs.sectionModeButton;\n        this.modeToggles = this.$manyRefs.modeToggle;\n        this.modeSections = this.$manyRefs.modeSection;\n        this.pageId = this.$opts.pageId;\n\n        // Instance variables\n        this.showing = false;\n        this.isSelection = false;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        // Copy on copy button click\n        this.includeButton.addEventListener('click', () => copyTextToClipboard(this.includeInput.value));\n        this.linkButton.addEventListener('click', () => copyTextToClipboard(this.linkInput.value));\n\n        // Select all contents on input click\n        DOM.onSelect([this.includeInput, this.linkInput], event => {\n            event.target.select();\n            event.stopPropagation();\n        });\n\n        // Prevent closing pointer when clicked or focused\n        DOM.onEvents(this.pointer, ['click', 'focus'], event => {\n            event.stopPropagation();\n        });\n\n        // Hide pointer when clicking away\n        DOM.onEvents(document.body, ['click', 'focus'], () => {\n            if (!this.showing || this.isSelection) return;\n            this.hidePointer();\n        });\n\n        // Hide pointer on escape press\n        DOM.onEscapePress(this.pointer, this.hidePointer.bind(this));\n\n        // Show pointer when selecting a single block of tagged content\n        const pageContent = document.querySelector('.page-content');\n        DOM.onEvents(pageContent, ['mouseup', 'keyup'], event => {\n            event.stopPropagation();\n            const targetEl = event.target.closest('[id^=\"bkmrk\"]');\n            if (targetEl && window.getSelection().toString().length > 0) {\n                this.showPointerAtTarget(targetEl, event.pageX, false);\n            }\n        });\n\n        // Start section selection mode on button press\n        DOM.onSelect(this.sectionModeButton, this.enterSectionSelectMode.bind(this));\n\n        // Toggle between pointer modes\n        DOM.onSelect(this.modeToggles, event => {\n            for (const section of this.modeSections) {\n                const show = !section.contains(event.target);\n                section.toggleAttribute('hidden', !show);\n            }\n\n            this.modeToggles.find(b => b !== event.target).focus();\n        });\n    }\n\n    hidePointer() {\n        this.pointer.style.display = null;\n        this.showing = false;\n    }\n\n    /**\n     * Move and display the pointer at the given element, targeting the given screen x-position if possible.\n     * @param {Element} element\n     * @param {Number} xPosition\n     * @param {Boolean} keyboardMode\n     */\n    showPointerAtTarget(element, xPosition, keyboardMode) {\n        this.updateForTarget(element);\n\n        this.pointer.style.display = 'block';\n        const targetBounds = element.getBoundingClientRect();\n        const pointerBounds = this.pointer.getBoundingClientRect();\n\n        const xTarget = Math.min(Math.max(xPosition, targetBounds.left), targetBounds.right);\n        const xOffset = xTarget - (pointerBounds.width / 2);\n        const yOffset = (targetBounds.top - pointerBounds.height) - 16;\n\n        this.pointer.style.left = `${xOffset}px`;\n        this.pointer.style.top = `${yOffset}px`;\n\n        this.showing = true;\n        this.isSelection = true;\n\n        setTimeout(() => {\n            this.isSelection = false;\n        }, 100);\n\n        const scrollListener = () => {\n            this.hidePointer();\n            window.removeEventListener('scroll', scrollListener, {passive: true});\n        };\n\n        element.parentElement.insertBefore(this.pointer, element);\n        if (!keyboardMode) {\n            window.addEventListener('scroll', scrollListener, {passive: true});\n        }\n    }\n\n    /**\n     * Update the pointer inputs/content for the given target element.\n     * @param {?Element} element\n     */\n    updateForTarget(element) {\n        const permaLink = window.baseUrl(`/link/${this.pageId}#${element.id}`);\n        const includeTag = `{{@${this.pageId}#${element.id}}}`;\n\n        this.linkInput.value = permaLink;\n        this.includeInput.value = includeTag;\n\n        // Update anchor if present\n        const editAnchor = this.pointer.querySelector('#pointer-edit');\n        if (editAnchor && element) {\n            const {editHref} = editAnchor.dataset;\n            const elementId = element.id;\n\n            // Get the first 50 characters.\n            const queryContent = element.textContent && element.textContent.substring(0, 50);\n            editAnchor.href = `${editHref}?content-id=${elementId}&content-text=${encodeURIComponent(queryContent)}`;\n        }\n    }\n\n    enterSectionSelectMode() {\n        const sections = Array.from(document.querySelectorAll('.page-content [id^=\"bkmrk\"]'));\n        for (const section of sections) {\n            section.setAttribute('tabindex', '0');\n        }\n\n        sections[0].focus();\n\n        DOM.onEnterPress(sections, event => {\n            this.showPointerAtTarget(event.target, 0, true);\n            this.pointer.focus();\n        });\n    }\n\n}\n", "import {fadeIn, fadeOut} from '../services/animations';\nimport {onSelect} from '../services/dom';\nimport {Component} from './component';\n\n/**\n * Popup window that will contain other content.\n * This component provides the show/hide functionality\n * with the ability for popup@hide child references to close this.\n */\nexport class Popup extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.hideButtons = this.$manyRefs.hide || [];\n\n        this.onkeyup = null;\n        this.onHide = null;\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        let lastMouseDownTarget = null;\n        this.container.addEventListener('mousedown', event => {\n            lastMouseDownTarget = event.target;\n        });\n\n        this.container.addEventListener('click', event => {\n            if (event.target === this.container && lastMouseDownTarget === this.container) {\n                this.hide();\n            }\n        });\n\n        onSelect(this.hideButtons, () => this.hide());\n    }\n\n    hide(onComplete = null) {\n        fadeOut(this.container, 120, onComplete);\n        if (this.onkeyup) {\n            window.removeEventListener('keyup', this.onkeyup);\n            this.onkeyup = null;\n        }\n        if (this.onHide) {\n            this.onHide();\n        }\n    }\n\n    show(onComplete = null, onHide = null) {\n        fadeIn(this.container, 120, onComplete);\n\n        this.onkeyup = event => {\n            if (event.key === 'Escape') {\n                this.hide();\n            }\n        };\n        window.addEventListener('keyup', this.onkeyup);\n        this.onHide = onHide;\n    }\n\n}\n", "import {Component} from './component';\n\nexport class SettingAppColorScheme extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.mode = this.$opts.mode;\n        this.lightContainer = this.$refs.lightContainer;\n        this.darkContainer = this.$refs.darkContainer;\n\n        this.container.addEventListener('tabs-change', event => {\n            const panel = event.detail.showing;\n            const newMode = (panel === 'color-scheme-panel-light') ? 'light' : 'dark';\n            this.handleModeChange(newMode);\n        });\n\n        const onInputChange = event => {\n            this.updateAppColorsFromInputs();\n\n            if (event.target.name.startsWith('setting-app-color')) {\n                this.updateLightForInput(event.target);\n            }\n        };\n        this.container.addEventListener('change', onInputChange);\n        this.container.addEventListener('input', onInputChange);\n    }\n\n    handleModeChange(newMode) {\n        this.mode = newMode;\n        const isDark = (newMode === 'dark');\n\n        document.documentElement.classList.toggle('dark-mode', isDark);\n        this.updateAppColorsFromInputs();\n    }\n\n    updateAppColorsFromInputs() {\n        const inputContainer = this.mode === 'dark' ? this.darkContainer : this.lightContainer;\n        const inputs = inputContainer.querySelectorAll('input[type=\"color\"]');\n        for (const input of inputs) {\n            const splitName = input.name.split('-');\n            const colorPos = splitName.indexOf('color');\n            let cssId = splitName.slice(1, colorPos).join('-');\n            if (cssId === 'app') {\n                cssId = 'primary';\n            }\n\n            const varName = `--color-${cssId}`;\n            document.body.style.setProperty(varName, input.value);\n        }\n    }\n\n    /**\n     * Update the 'light' app color variant for the given input.\n     * @param {HTMLInputElement} input\n     */\n    updateLightForInput(input) {\n        const lightName = input.name.replace('-color', '-color-light');\n        const hexVal = input.value;\n        const rgb = this.hexToRgb(hexVal);\n        const rgbLightVal = `rgba(${[rgb.r, rgb.g, rgb.b, '0.15'].join(',')})`;\n\n        const lightColorInput = this.container.querySelector(`input[name=\"${lightName}\"][type=\"hidden\"]`);\n        lightColorInput.value = rgbLightVal;\n    }\n\n    /**\n     * Covert a hex color code to rgb components.\n     * @attribution https://stackoverflow.com/a/5624139\n     * @param {String} hex\n     * @returns {{r: Number, g: Number, b: Number}}\n     */\n    hexToRgb(hex) {\n        const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        return {\n            r: result ? parseInt(result[1], 16) : 0,\n            g: result ? parseInt(result[2], 16) : 0,\n            b: result ? parseInt(result[3], 16) : 0,\n        };\n    }\n\n}\n", "import {Component} from './component';\n\nexport class SettingColorPicker extends Component {\n\n    setup() {\n        this.colorInput = this.$refs.input;\n        this.resetButton = this.$refs.resetButton;\n        this.defaultButton = this.$refs.defaultButton;\n        this.currentColor = this.$opts.current;\n        this.defaultColor = this.$opts.default;\n\n        this.resetButton.addEventListener('click', () => this.setValue(this.currentColor));\n        this.defaultButton.addEventListener('click', () => this.setValue(this.defaultColor));\n    }\n\n    setValue(value) {\n        this.colorInput.value = value;\n        this.colorInput.dispatchEvent(new Event('change', {bubbles: true}));\n    }\n\n}\n", "import {Component} from './component';\n\nexport class SettingHomepageControl extends Component {\n\n    setup() {\n        this.typeControl = this.$refs.typeControl;\n        this.pagePickerContainer = this.$refs.pagePickerContainer;\n\n        this.typeControl.addEventListener('change', this.controlPagePickerVisibility.bind(this));\n        this.controlPagePickerVisibility();\n    }\n\n    controlPagePickerVisibility() {\n        const showPagePicker = this.typeControl.value === 'page';\n        this.pagePickerContainer.style.display = (showPagePicker ? 'block' : 'none');\n    }\n\n}\n", "import Sortable from 'sortablejs';\nimport {Component} from './component';\n\n/**\n * @type {Object<string, function(HTMLElement, HTMLElement, HTMLElement)>}\n */\nconst itemActions = {\n    move_up(item) {\n        const list = item.parentNode;\n        const index = Array.from(list.children).indexOf(item);\n        const newIndex = Math.max(index - 1, 0);\n        list.insertBefore(item, list.children[newIndex] || null);\n    },\n    move_down(item) {\n        const list = item.parentNode;\n        const index = Array.from(list.children).indexOf(item);\n        const newIndex = Math.min(index + 2, list.children.length);\n        list.insertBefore(item, list.children[newIndex] || null);\n    },\n    remove(item, shelfBooksList, allBooksList) {\n        allBooksList.appendChild(item);\n    },\n    add(item, shelfBooksList) {\n        shelfBooksList.appendChild(item);\n    },\n};\n\nexport class ShelfSort extends Component {\n\n    setup() {\n        this.elem = this.$el;\n        this.input = this.$refs.input;\n        this.shelfBookList = this.$refs.shelfBookList;\n        this.allBookList = this.$refs.allBookList;\n        this.bookSearchInput = this.$refs.bookSearch;\n        this.sortButtonContainer = this.$refs.sortButtonContainer;\n\n        this.lastSort = null;\n\n        this.initSortable();\n        this.setupListeners();\n    }\n\n    initSortable() {\n        const scrollBoxes = this.elem.querySelectorAll('.scroll-box');\n        for (const scrollBox of scrollBoxes) {\n            new Sortable(scrollBox, {\n                group: 'shelf-books',\n                ghostClass: 'primary-background-light',\n                handle: '.handle',\n                animation: 150,\n                onSort: this.onChange.bind(this),\n            });\n        }\n    }\n\n    setupListeners() {\n        this.elem.addEventListener('click', event => {\n            const sortItemAction = event.target.closest('.scroll-box-item button[data-action]');\n            if (sortItemAction) {\n                this.sortItemActionClick(sortItemAction);\n            }\n        });\n\n        this.bookSearchInput.addEventListener('input', () => {\n            this.filterBooksByName(this.bookSearchInput.value);\n        });\n\n        this.sortButtonContainer.addEventListener('click', event => {\n            const button = event.target.closest('button[data-sort]');\n            if (button) {\n                this.sortShelfBooks(button.dataset.sort);\n            }\n        });\n    }\n\n    /**\n     * @param {String} filterVal\n     */\n    filterBooksByName(filterVal) {\n        // Set height on first search, if not already set, to prevent the distraction\n        // of the list height jumping around\n        if (!this.allBookList.style.height) {\n            this.allBookList.style.height = `${this.allBookList.getBoundingClientRect().height}px`;\n        }\n\n        const books = this.allBookList.children;\n        const lowerFilter = filterVal.trim().toLowerCase();\n\n        for (const bookEl of books) {\n            const show = !filterVal || bookEl.textContent.toLowerCase().includes(lowerFilter);\n            bookEl.style.display = show ? null : 'none';\n        }\n    }\n\n    /**\n     * Called when a sort item action button is clicked.\n     * @param {HTMLElement} sortItemAction\n     */\n    sortItemActionClick(sortItemAction) {\n        const sortItem = sortItemAction.closest('.scroll-box-item');\n        const {action} = sortItemAction.dataset;\n\n        const actionFunction = itemActions[action];\n        actionFunction(sortItem, this.shelfBookList, this.allBookList);\n\n        this.onChange();\n    }\n\n    onChange() {\n        const shelfBookElems = Array.from(this.shelfBookList.querySelectorAll('[data-id]'));\n        this.input.value = shelfBookElems.map(elem => elem.getAttribute('data-id')).join(',');\n    }\n\n    sortShelfBooks(sortProperty) {\n        const books = Array.from(this.shelfBookList.children);\n        const reverse = sortProperty === this.lastSort;\n\n        books.sort((bookA, bookB) => {\n            const aProp = bookA.dataset[sortProperty].toLowerCase();\n            const bProp = bookB.dataset[sortProperty].toLowerCase();\n\n            if (reverse) {\n                return bProp.localeCompare(aProp);\n            }\n\n            return aProp.localeCompare(bProp);\n        });\n\n        for (const book of books) {\n            this.shelfBookList.append(book);\n        }\n\n        this.lastSort = (this.lastSort === sortProperty) ? null : sortProperty;\n        this.onChange();\n    }\n\n}\n", "import {Component} from './component';\n\nfunction reverseMap(map) {\n    const reversed = {};\n    for (const [key, value] of Object.entries(map)) {\n        reversed[value] = key;\n    }\n    return reversed;\n}\n\nexport class Shortcuts extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.mapById = JSON.parse(this.$opts.keyMap);\n        this.mapByShortcut = reverseMap(this.mapById);\n\n        this.hintsShowing = false;\n\n        this.hideHints = this.hideHints.bind(this);\n        this.hintAbortController = null;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        window.addEventListener('keydown', event => {\n            if (event.target.closest('input, select, textarea, .cm-editor')) {\n                return;\n            }\n\n            if (event.key === '?') {\n                if (this.hintsShowing) {\n                    this.hideHints();\n                } else {\n                    this.showHints();\n                }\n                return;\n            }\n\n            this.handleShortcutPress(event);\n        });\n    }\n\n    /**\n     * @param {KeyboardEvent} event\n     */\n    handleShortcutPress(event) {\n        const keys = [\n            event.ctrlKey ? 'Ctrl' : '',\n            event.metaKey ? 'Cmd' : '',\n            event.key,\n        ];\n\n        const combo = keys.filter(s => Boolean(s)).join(' + ');\n\n        const shortcutId = this.mapByShortcut[combo];\n        if (shortcutId) {\n            const wasHandled = this.runShortcut(shortcutId);\n            if (wasHandled) {\n                event.preventDefault();\n            }\n        }\n    }\n\n    /**\n     * Run the given shortcut, and return a boolean to indicate if the event\n     * was successfully handled by a shortcut action.\n     * @param {String} id\n     * @return {boolean}\n     */\n    runShortcut(id) {\n        const el = this.container.querySelector(`[data-shortcut=\"${id}\"]`);\n        if (!el) {\n            return false;\n        }\n\n        if (el.matches('input, textarea, select')) {\n            el.focus();\n            return true;\n        }\n\n        if (el.matches('a, button')) {\n            el.click();\n            return true;\n        }\n\n        if (el.matches('div[tabindex]')) {\n            el.click();\n            el.focus();\n            return true;\n        }\n\n        console.error('Shortcut attempted to be ran for element type that does not have handling setup', el);\n\n        return false;\n    }\n\n    showHints() {\n        const wrapper = document.createElement('div');\n        wrapper.classList.add('shortcut-container');\n        this.container.append(wrapper);\n\n        const shortcutEls = this.container.querySelectorAll('[data-shortcut]');\n        const displayedIds = new Set();\n        for (const shortcutEl of shortcutEls) {\n            const id = shortcutEl.getAttribute('data-shortcut');\n            if (displayedIds.has(id)) {\n                continue;\n            }\n\n            const key = this.mapById[id];\n            this.showHintLabel(shortcutEl, key, wrapper);\n            displayedIds.add(id);\n        }\n\n        this.hintAbortController = new AbortController();\n        const signal = this.hintAbortController.signal;\n        window.addEventListener('scroll', this.hideHints, {signal});\n        window.addEventListener('focus', this.hideHints, {signal});\n        window.addEventListener('blur', this.hideHints, {signal});\n        window.addEventListener('click', this.hideHints, {signal});\n\n        this.hintsShowing = true;\n    }\n\n    /**\n     * @param {Element} targetEl\n     * @param {String} key\n     * @param {Element} wrapper\n     */\n    showHintLabel(targetEl, key, wrapper) {\n        const targetBounds = targetEl.getBoundingClientRect();\n\n        const label = document.createElement('div');\n        label.classList.add('shortcut-hint');\n        label.textContent = key;\n\n        const linkage = document.createElement('div');\n        linkage.classList.add('shortcut-linkage');\n        linkage.style.left = `${targetBounds.x}px`;\n        linkage.style.top = `${targetBounds.y}px`;\n        linkage.style.width = `${targetBounds.width}px`;\n        linkage.style.height = `${targetBounds.height}px`;\n\n        wrapper.append(label, linkage);\n\n        const labelBounds = label.getBoundingClientRect();\n\n        label.style.insetInlineStart = `${((targetBounds.x + targetBounds.width) - (labelBounds.width + 6))}px`;\n        label.style.insetBlockStart = `${(targetBounds.y + (targetBounds.height - labelBounds.height) / 2)}px`;\n    }\n\n    hideHints() {\n        const wrapper = this.container.querySelector('.shortcut-container');\n        wrapper.remove();\n        this.hintAbortController?.abort();\n        this.hintsShowing = false;\n    }\n\n}\n", "import {Component} from './component';\n\n/**\n * Keys to ignore when recording shortcuts.\n * @type {string[]}\n */\nconst ignoreKeys = ['Control', 'Alt', 'Shift', 'Meta', 'Super', ' ', '+', 'Tab', 'Escape'];\n\nexport class ShortcutInput extends Component {\n\n    setup() {\n        this.input = this.$el;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        this.listenerRecordKey = this.listenerRecordKey.bind(this);\n\n        this.input.addEventListener('focus', () => {\n            this.startListeningForInput();\n        });\n\n        this.input.addEventListener('blur', () => {\n            this.stopListeningForInput();\n        });\n    }\n\n    startListeningForInput() {\n        this.input.addEventListener('keydown', this.listenerRecordKey);\n    }\n\n    /**\n     * @param {KeyboardEvent} event\n     */\n    listenerRecordKey(event) {\n        if (ignoreKeys.includes(event.key)) {\n            return;\n        }\n\n        const keys = [\n            event.ctrlKey ? 'Ctrl' : '',\n            event.metaKey ? 'Cmd' : '',\n            event.key,\n        ];\n\n        this.input.value = keys.filter(s => Boolean(s)).join(' + ');\n    }\n\n    stopListeningForInput() {\n        this.input.removeEventListener('keydown', this.listenerRecordKey);\n    }\n\n}\n", "import Sortable from 'sortablejs';\nimport {Component} from './component';\n\n/**\n * SortableList\n *\n * Can have data set on the dragged items by setting a 'data-drag-content' attribute.\n * This attribute must contain JSON where the keys are content types and the values are\n * the data to set on the data-transfer.\n */\nexport class SortableList extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.handleSelector = this.$opts.handleSelector;\n\n        const sortable = new Sortable(this.container, {\n            handle: this.handleSelector,\n            animation: 150,\n            onSort: () => {\n                this.$emit('sort', {ids: sortable.toArray()});\n            },\n            setData(dataTransferItem, dragEl) {\n                const jsonContent = dragEl.getAttribute('data-drag-content');\n                if (jsonContent) {\n                    const contentByType = JSON.parse(jsonContent);\n                    for (const [type, content] of Object.entries(contentByType)) {\n                        dataTransferItem.setData(type, content);\n                    }\n                }\n            },\n            revertOnSpill: true,\n            dropBubble: true,\n            dragoverBubble: false,\n        });\n    }\n\n}\n", "import {Component} from './component';\n\n/**\n * Submit on change\n * Simply submits a parent form when this input is changed.\n */\nexport class SubmitOnChange extends Component {\n\n    setup() {\n        this.filter = this.$opts.filter;\n\n        this.$el.addEventListener('change', event => {\n            if (this.filter && !event.target.matches(this.filter)) {\n                return;\n            }\n\n            const form = this.$el.closest('form');\n            if (form) {\n                form.submit();\n            }\n        });\n    }\n\n}\n", "import {Component} from './component';\n\n/**\n * Tabs\n * Uses accessible attributes to drive its functionality.\n * On tab wrapping element:\n * - role=tablist\n * On tabs (Should be a button):\n * - id\n * - role=tab\n * - aria-selected=true/false\n * - aria-controls=<id-of-panel-section>\n * On panels:\n * - id\n * - tabindex=0\n * - role=tabpanel\n * - aria-labelledby=<id-of-tab-for-panel>\n * - hidden (If not shown by default).\n */\nexport class Tabs extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.tabList = this.container.querySelector('[role=\"tablist\"]');\n        this.tabs = Array.from(this.tabList.querySelectorAll('[role=\"tab\"]'));\n        this.panels = Array.from(this.container.querySelectorAll(':scope > [role=\"tabpanel\"], :scope > * > [role=\"tabpanel\"]'));\n        this.activeUnder = this.$opts.activeUnder ? Number(this.$opts.activeUnder) : 10000;\n        this.active = null;\n\n        this.container.addEventListener('click', event => {\n            const tab = event.target.closest('[role=\"tab\"]');\n            if (tab && this.tabs.includes(tab)) {\n                this.show(tab.getAttribute('aria-controls'));\n            }\n        });\n\n        window.addEventListener('resize', this.updateActiveState.bind(this), {\n            passive: true,\n        });\n        this.updateActiveState();\n    }\n\n    show(sectionId) {\n        for (const panel of this.panels) {\n            panel.toggleAttribute('hidden', panel.id !== sectionId);\n        }\n\n        for (const tab of this.tabs) {\n            const tabSection = tab.getAttribute('aria-controls');\n            const selected = tabSection === sectionId;\n            tab.setAttribute('aria-selected', selected ? 'true' : 'false');\n        }\n\n        this.$emit('change', {showing: sectionId});\n    }\n\n    updateActiveState() {\n        const active = window.innerWidth < this.activeUnder;\n        if (active === this.active) {\n            return;\n        }\n\n        if (active) {\n            this.activate();\n        } else {\n            this.deactivate();\n        }\n\n        this.active = active;\n    }\n\n    activate() {\n        const panelToShow = this.panels.find(p => !p.hasAttribute('hidden')) || this.panels[0];\n        this.show(panelToShow.id);\n        this.tabList.toggleAttribute('hidden', false);\n    }\n\n    deactivate() {\n        for (const panel of this.panels) {\n            panel.removeAttribute('hidden');\n        }\n        for (const tab of this.tabs) {\n            tab.setAttribute('aria-selected', 'false');\n        }\n        this.tabList.toggleAttribute('hidden', true);\n    }\n\n}\n", "import {Component} from './component';\n\nexport class TagManager extends Component {\n\n    setup() {\n        this.addRemoveComponentEl = this.$refs.addRemove;\n        this.container = this.$el;\n        this.rowSelector = this.$opts.rowSelector;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        this.container.addEventListener('input', event => {\n            /** @var {AddRemoveRows} * */\n            const addRemoveComponent = window.$components.firstOnElement(this.addRemoveComponentEl, 'add-remove-rows');\n            if (!this.hasEmptyRows() && event.target.value) {\n                addRemoveComponent.add();\n            }\n        });\n    }\n\n    hasEmptyRows() {\n        const rows = this.container.querySelectorAll(this.rowSelector);\n        const firstEmpty = [...rows].find(row => [...row.querySelectorAll('input')].filter(input => input.value).length === 0);\n        return firstEmpty !== undefined;\n    }\n\n}\n", "import * as DOM from '../services/dom';\nimport {Component} from './component';\n\nexport class TemplateManager extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.list = this.$refs.list;\n\n        this.searchInput = this.$refs.searchInput;\n        this.searchButton = this.$refs.searchButton;\n        this.searchCancel = this.$refs.searchCancel;\n\n        this.setupListeners();\n    }\n\n    setupListeners() {\n        // Template insert action buttons\n        DOM.onChildEvent(this.container, '[template-action]', 'click', this.handleTemplateActionClick.bind(this));\n\n        // Template list pagination click\n        DOM.onChildEvent(this.container, '.pagination a', 'click', this.handlePaginationClick.bind(this));\n\n        // Template list item content click\n        DOM.onChildEvent(this.container, '.template-item-content', 'click', this.handleTemplateItemClick.bind(this));\n\n        // Template list item drag start\n        DOM.onChildEvent(this.container, '.template-item', 'dragstart', this.handleTemplateItemDragStart.bind(this));\n\n        // Search box enter press\n        this.searchInput.addEventListener('keypress', event => {\n            if (event.key === 'Enter') {\n                event.preventDefault();\n                this.performSearch();\n            }\n        });\n\n        // Search submit button press\n        this.searchButton.addEventListener('click', () => this.performSearch());\n\n        // Search cancel button press\n        this.searchCancel.addEventListener('click', () => {\n            this.searchInput.value = '';\n            this.performSearch();\n        });\n    }\n\n    handleTemplateItemClick(event, templateItem) {\n        const templateId = templateItem.closest('[template-id]').getAttribute('template-id');\n        this.insertTemplate(templateId, 'replace');\n    }\n\n    handleTemplateItemDragStart(event, templateItem) {\n        const templateId = templateItem.closest('[template-id]').getAttribute('template-id');\n        event.dataTransfer.setData('bookstack/template', templateId);\n        event.dataTransfer.setData('text/plain', templateId);\n    }\n\n    handleTemplateActionClick(event, actionButton) {\n        event.stopPropagation();\n\n        const action = actionButton.getAttribute('template-action');\n        const templateId = actionButton.closest('[template-id]').getAttribute('template-id');\n        this.insertTemplate(templateId, action);\n    }\n\n    async insertTemplate(templateId, action = 'replace') {\n        const resp = await window.$http.get(`/templates/${templateId}`);\n        const eventName = `editor::${action}`;\n        window.$events.emit(eventName, resp.data);\n    }\n\n    async handlePaginationClick(event, paginationLink) {\n        event.preventDefault();\n        const paginationUrl = paginationLink.getAttribute('href');\n        const resp = await window.$http.get(paginationUrl);\n        this.list.innerHTML = resp.data;\n    }\n\n    async performSearch() {\n        const searchTerm = this.searchInput.value;\n        const resp = await window.$http.get('/templates', {\n            search: searchTerm,\n        });\n        this.searchCancel.style.display = searchTerm ? 'block' : 'none';\n        this.list.innerHTML = resp.data;\n    }\n\n}\n", "import {Component} from './component';\n\nexport class ToggleSwitch extends Component {\n\n    setup() {\n        this.input = this.$el.querySelector('input[type=hidden]');\n        this.checkbox = this.$el.querySelector('input[type=checkbox]');\n\n        this.checkbox.addEventListener('change', this.stateChange.bind(this));\n    }\n\n    stateChange() {\n        this.input.value = (this.checkbox.checked ? 'true' : 'false');\n\n        // Dispatch change event from hidden input so they can be listened to\n        // like a normal checkbox.\n        const changeEvent = new Event('change');\n        this.input.dispatchEvent(changeEvent);\n    }\n\n}\n", "import {Component} from './component';\n\nexport class TriLayout extends Component {\n\n    setup() {\n        this.container = this.$refs.container;\n        this.tabs = this.$manyRefs.tab;\n\n        this.lastLayoutType = 'none';\n        this.onDestroy = null;\n        this.scrollCache = {\n            content: 0,\n            info: 0,\n        };\n        this.lastTabShown = 'content';\n\n        // Bind any listeners\n        this.mobileTabClick = this.mobileTabClick.bind(this);\n\n        // Watch layout changes\n        this.updateLayout();\n        window.addEventListener('resize', () => {\n            this.updateLayout();\n        }, {passive: true});\n    }\n\n    updateLayout() {\n        let newLayout = 'tablet';\n        if (window.innerWidth <= 1000) newLayout = 'mobile';\n        if (window.innerWidth >= 1400) newLayout = 'desktop';\n        if (newLayout === this.lastLayoutType) return;\n\n        if (this.onDestroy) {\n            this.onDestroy();\n            this.onDestroy = null;\n        }\n\n        if (newLayout === 'desktop') {\n            this.setupDesktop();\n        } else if (newLayout === 'mobile') {\n            this.setupMobile();\n        }\n\n        this.lastLayoutType = newLayout;\n    }\n\n    setupMobile() {\n        for (const tab of this.tabs) {\n            tab.addEventListener('click', this.mobileTabClick);\n        }\n\n        this.onDestroy = () => {\n            for (const tab of this.tabs) {\n                tab.removeEventListener('click', this.mobileTabClick);\n            }\n        };\n    }\n\n    setupDesktop() {\n        //\n    }\n\n    /**\n     * Action to run when the mobile info toggle bar is clicked/tapped\n     * @param event\n     */\n    mobileTabClick(event) {\n        const {tab} = event.target.dataset;\n        this.showTab(tab);\n    }\n\n    /**\n     * Show the content tab.\n     * Used by the page-display component.\n     */\n    showContent() {\n        this.showTab('content', false);\n    }\n\n    /**\n     * Show the given tab\n     * @param {String} tabName\n     * @param {Boolean }scroll\n     */\n    showTab(tabName, scroll = true) {\n        this.scrollCache[this.lastTabShown] = document.documentElement.scrollTop;\n\n        // Set tab status\n        for (const tab of this.tabs) {\n            const isActive = (tab.dataset.tab === tabName);\n            tab.setAttribute('aria-selected', isActive ? 'true' : 'false');\n        }\n\n        // Toggle section\n        const showInfo = (tabName === 'info');\n        this.container.classList.toggle('show-info', showInfo);\n\n        // Set the scroll position from cache\n        if (scroll) {\n            const pageHeader = document.querySelector('header');\n            const defaultScrollTop = pageHeader.getBoundingClientRect().bottom;\n            document.documentElement.scrollTop = this.scrollCache[tabName] || defaultScrollTop;\n            setTimeout(() => {\n                document.documentElement.scrollTop = this.scrollCache[tabName] || defaultScrollTop;\n            }, 50);\n        }\n\n        this.lastTabShown = tabName;\n    }\n\n}\n", "import {onChildEvent} from '../services/dom';\nimport {Component} from './component';\n\nexport class UserSelect extends Component {\n\n    setup() {\n        this.container = this.$el;\n        this.input = this.$refs.input;\n        this.userInfoContainer = this.$refs.userInfo;\n\n        onChildEvent(this.container, 'a.dropdown-search-item', 'click', this.selectUser.bind(this));\n    }\n\n    selectUser(event, userEl) {\n        event.preventDefault();\n        this.input.value = userEl.getAttribute('data-id');\n        this.userInfoContainer.innerHTML = userEl.innerHTML;\n        this.input.dispatchEvent(new Event('change', {bubbles: true}));\n        this.hide();\n    }\n\n    hide() {\n        /** @var {Dropdown} * */\n        const dropdown = window.$components.firstOnElement(this.container, 'dropdown');\n        dropdown.hide();\n    }\n\n}\n", "/**\n * Webhook Events\n * Manages dynamic selection control in the webhook form interface.\n */\nimport {Component} from './component';\n\nexport class WebhookEvents extends Component {\n\n    setup() {\n        this.checkboxes = this.$el.querySelectorAll('input[type=\"checkbox\"]');\n        this.allCheckbox = this.$el.querySelector('input[type=\"checkbox\"][value=\"all\"]');\n\n        this.$el.addEventListener('change', event => {\n            if (event.target.checked && event.target === this.allCheckbox) {\n                this.deselectIndividualEvents();\n            } else if (event.target.checked) {\n                this.allCheckbox.checked = false;\n            }\n        });\n    }\n\n    deselectIndividualEvents() {\n        for (const checkbox of this.checkboxes) {\n            if (checkbox !== this.allCheckbox) {\n                checkbox.checked = false;\n            }\n        }\n    }\n\n}\n", "import {buildForEditor as buildEditorConfig} from '../wysiwyg/config';\nimport {Component} from './component';\n\nexport class WysiwygEditor extends Component {\n\n    setup() {\n        this.elem = this.$el;\n\n        this.tinyMceConfig = buildEditorConfig({\n            language: this.$opts.language,\n            containerElement: this.elem,\n            darkMode: document.documentElement.classList.contains('dark-mode'),\n            textDirection: this.$opts.textDirection,\n            drawioUrl: this.getDrawIoUrl(),\n            pageId: Number(this.$opts.pageId),\n            translations: {\n                imageUploadErrorText: this.$opts.imageUploadErrorText,\n                serverUploadLimitText: this.$opts.serverUploadLimitText,\n            },\n            translationMap: window.editor_translations,\n        });\n\n        window.$events.emitPublic(this.elem, 'editor-tinymce::pre-init', {config: this.tinyMceConfig});\n        window.tinymce.init(this.tinyMceConfig).then(editors => {\n            this.editor = editors[0];\n        });\n    }\n\n    getDrawIoUrl() {\n        const drawioUrlElem = document.querySelector('[drawio-url]');\n        if (drawioUrlElem) {\n            return drawioUrlElem.getAttribute('drawio-url');\n        }\n        return '';\n    }\n\n    /**\n     * Get the content of this editor.\n     * Used by the parent page editor component.\n     * @return {{html: String}}\n     */\n    getContent() {\n        return {\n            html: this.editor.getContent(),\n        };\n    }\n\n}\n", "import {Component} from './component';\nimport {buildForInput} from '../wysiwyg/config';\n\nexport class WysiwygInput extends Component {\n\n    setup() {\n        this.elem = this.$el;\n\n        const config = buildForInput({\n            language: this.$opts.language,\n            containerElement: this.elem,\n            darkMode: document.documentElement.classList.contains('dark-mode'),\n            textDirection: this.$opts.textDirection,\n            translations: {},\n            translationMap: window.editor_translations,\n        });\n\n        window.tinymce.init(config).then(editors => {\n            this.editor = editors[0];\n        });\n    }\n\n}\n", "import * as events from './services/events';\nimport * as httpInstance from './services/http';\nimport Translations from './services/translations';\n\nimport * as components from './services/components';\nimport * as componentMap from './components';\n\n// Url retrieval function\nwindow.baseUrl = function baseUrl(path) {\n    let targetPath = path;\n    let basePath = document.querySelector('meta[name=\"base-url\"]').getAttribute('content');\n    if (basePath[basePath.length - 1] === '/') basePath = basePath.slice(0, basePath.length - 1);\n    if (targetPath[0] === '/') targetPath = targetPath.slice(1);\n    return `${basePath}/${targetPath}`;\n};\n\nwindow.importVersioned = function importVersioned(moduleName) {\n    const version = document.querySelector('link[href*=\"/dist/styles.css?version=\"]').href.split('?version=').pop();\n    const importPath = window.baseUrl(`dist/${moduleName}.js?version=${version}`);\n    return import(importPath);\n};\n\n// Set events and http services on window\nwindow.$http = httpInstance;\nwindow.$events = events;\n\n// Translation setup\n// Creates a global function with name 'trans' to be used in the same way as the Laravel translation system\nconst translator = new Translations();\nwindow.trans = translator.get.bind(translator);\nwindow.trans_choice = translator.getPlural.bind(translator);\nwindow.trans_plural = translator.parsePlural.bind(translator);\n\n// Load & initialise components\ncomponents.register(componentMap);\nwindow.$components = components;\ncomponents.init();\n"],
  "mappings": ";oeAAA,IAAAA,GAAA,GAAAC,GAAAD,GAAA,UAAAE,GAAA,eAAAC,GAAA,UAAAC,GAAA,WAAAC,GAAA,sBAAAC,GAAA,yBAAAC,GAAA,YAAAC,KAAA,IAAMC,GAAY,CAAC,EACbC,GAAQ,CAAC,EAOR,SAASR,GAAKS,EAAWC,EAAW,CACvCF,GAAM,KAAK,CAAC,KAAMC,EAAW,KAAMC,CAAS,CAAC,EAE7C,IAAMC,EAAiBJ,GAAUE,CAAS,GAAK,CAAC,EAChD,QAAWG,KAAYD,EACnBC,EAASF,CAAS,CAE1B,CAQO,SAASP,GAAOM,EAAWI,EAAU,CACpC,OAAON,GAAUE,CAAS,EAAM,MAAaF,GAAUE,CAAS,EAAI,CAAC,GACzEF,GAAUE,CAAS,EAAE,KAAKI,CAAQ,CACtC,CASO,SAASZ,GAAWa,EAAeL,EAAWC,EAAW,CAC5D,IAAMK,EAAQ,IAAI,YAAYN,EAAW,CACrC,OAAQC,EACR,QAAS,EACb,CAAC,EACDI,EAAc,cAAcC,CAAK,CACrC,CAMO,SAAST,GAAQU,EAAS,CAC7BhB,GAAK,UAAWgB,CAAO,CAC3B,CAMO,SAASd,GAAMc,EAAS,CAC3BhB,GAAK,QAASgB,CAAO,CACzB,CAMO,SAASX,GAAqBY,EAAa,CAC9C,GAAKA,EAAY,QACbA,EAAY,SAAW,KAAOA,EAAY,KAAM,CAChD,IAAMD,EAAU,OAAO,OAAOC,EAAY,IAAI,EAAE,KAAK,EAAE,KAAK;AAAA,CAAI,EAChEf,GAAMc,CAAO,CACjB,CACJ,CAMO,SAASZ,GAAkBa,EAAa,CACtCA,EAAY,QACbA,EAAY,QAAU,KAAOA,EAAY,MAAQA,EAAY,KAAK,SAClEf,GAAMe,EAAY,KAAK,OAAO,CAEtC,CChFA,IAAAC,GAAA,GAAAC,GAAAD,GAAA,eAAAE,GAAA,yBAAAC,GAAA,WAAAC,GAAA,QAAAC,GAAA,UAAAC,GAAA,SAAAC,GAAA,QAAAC,KAiBA,eAAeC,GAAmBC,EAAU,CACxC,GAAIA,EAAS,SAAW,IACpB,OAAO,KAIX,IAAMC,GADsBD,EAAS,QAAQ,IAAI,cAAc,GAAK,IAChC,MAAM,GAAG,EAAE,CAAC,EAAE,MAAM,GAAG,EAAE,IAAI,EAEjE,OAAIC,IAAY,cAAgBA,IAAY,OACjCD,EAAS,KAAK,EAGlBA,EAAS,KAAK,CACzB,CAEO,IAAMR,GAAN,cAAwB,KAAM,CAEjC,YAAYQ,EAAUE,EAAS,CAC3B,MAAMF,EAAS,UAAU,EACzB,KAAK,KAAOE,EACZ,KAAK,QAAUF,EAAS,QACxB,KAAK,WAAaA,EAAS,WAC3B,KAAK,OAASA,EAAS,OACvB,KAAK,WAAaA,EAAS,WAC3B,KAAK,IAAMA,EAAS,IACpB,KAAK,SAAWA,CACpB,CAEJ,EAQO,SAASP,GAAqBU,EAAQC,EAAKC,EAAS,CAAC,EAAG,CAC3D,IAAMC,EAAY,SAAS,cAAc,kBAAkB,EAAE,aAAa,SAAS,EAC7EC,EAAM,IAAI,eAEhB,OAAW,CAACC,EAAWC,CAAQ,IAAK,OAAO,QAAQJ,CAAM,EACrDE,EAAI,iBAAiBC,EAAWC,EAAS,KAAKF,CAAG,CAAC,EAGtD,OAAAA,EAAI,KAAKJ,EAAQC,CAAG,EACpBG,EAAI,gBAAkB,GACtBA,EAAI,iBAAiB,eAAgBD,CAAS,EAEvCC,CACX,CASA,eAAeG,GAAQN,EAAKO,EAAU,CAAC,EAAG,CACtC,IAAIC,EAAaR,EAMjB,GAJKQ,EAAW,WAAW,MAAM,IAC7BA,EAAa,OAAO,QAAQA,CAAU,GAGtCD,EAAQ,OAAQ,CAChB,IAAME,EAAS,IAAI,IAAID,CAAU,EACjC,QAAWE,KAAa,OAAO,KAAKH,EAAQ,MAAM,EAAG,CACjD,IAAMI,EAAQJ,EAAQ,OAAOG,CAAS,EAClC,OAAOC,EAAU,KAAeA,IAAU,MAC1CF,EAAO,aAAa,IAAIC,EAAWC,CAAK,CAEhD,CACAH,EAAaC,EAAO,SAAS,CACjC,CAEA,IAAMP,EAAY,SAAS,cAAc,kBAAkB,EAAE,aAAa,SAAS,EAC7EU,EAAiB,CAAC,GAAGL,EAAS,YAAa,aAAa,EAC9DK,EAAe,QAAU,CACrB,GAAGA,EAAe,SAAW,CAAC,EAC9B,QAAS,OAAO,QAAQ,EAAE,EAC1B,eAAgBV,CACpB,EAEA,IAAMN,EAAW,MAAM,MAAMY,EAAYI,CAAc,EACjDd,EAAU,MAAMH,GAAmBC,CAAQ,EAC3CiB,EAAa,CACf,KAAMf,EACN,QAASF,EAAS,QAClB,WAAYA,EAAS,WACrB,OAAQA,EAAS,OACjB,WAAYA,EAAS,WACrB,IAAKA,EAAS,IACd,SAAUA,CACd,EAEA,GAAI,CAACA,EAAS,GACV,MAAM,IAAIR,GAAUQ,EAAUE,CAAO,EAGzC,OAAOe,CACX,CAUA,eAAeC,GAAYf,EAAQC,EAAKe,EAAO,KAAM,CACjD,IAAMR,EAAU,CACZ,OAAAR,EACA,KAAMgB,CACV,EAGA,OAAI,OAAOA,GAAS,UAAY,EAAEA,aAAgB,YAC9CR,EAAQ,QAAU,CACd,eAAgB,mBAChB,mBAAoB,gBACxB,EACAA,EAAQ,KAAO,KAAK,UAAUQ,CAAI,GAMlCA,aAAgB,UAAYhB,IAAW,SACvCgB,EAAK,OAAO,UAAWhB,CAAM,EAC7BQ,EAAQ,OAAS,QAGdD,GAAQN,EAAKO,CAAO,CAC/B,CASA,eAAsBhB,GAAIS,EAAKgB,EAAS,CAAC,EAAG,CACxC,OAAOV,GAAQN,EAAK,CAChB,OAAQ,MACR,OAAAgB,CACJ,CAAC,CACL,CAQA,eAAsBvB,GAAKO,EAAKe,EAAO,KAAM,CACzC,OAAOD,GAAY,OAAQd,EAAKe,CAAI,CACxC,CAQA,eAAsBrB,GAAIM,EAAKe,EAAO,KAAM,CACxC,OAAOD,GAAY,MAAOd,EAAKe,CAAI,CACvC,CAQA,eAAsBvB,GAAMQ,EAAKe,EAAO,KAAM,CAC1C,OAAOD,GAAY,QAASd,EAAKe,CAAI,CACzC,CAQA,eAAezB,GAAcU,EAAKe,EAAO,KAAM,CAC3C,OAAOD,GAAY,SAAUd,EAAKe,CAAI,CAC1C,CCzMA,IAAME,GAAN,KAAiB,CAEb,aAAc,CACV,KAAK,MAAQ,IAAI,IACjB,KAAK,kBAAkB,CAC3B,CAKA,mBAAoB,CAChB,IAAMC,EAAsB,SAAS,iBAAiB,0BAA0B,EAChF,QAAWC,KAAOD,EAAqB,CACnC,IAAME,EAAMD,EAAI,aAAa,KAAK,EAC5BE,EAAQF,EAAI,aAAa,OAAO,EACtC,KAAK,MAAM,IAAIC,EAAKC,CAAK,CAC7B,CACJ,CAQA,IAAID,EAAKE,EAAc,CACnB,IAAMC,EAAO,KAAK,aAAaH,CAAG,EAClC,OAAO,KAAK,oBAAoBG,EAAMD,CAAY,CACtD,CAUA,UAAUF,EAAKI,EAAOF,EAAc,CAChC,IAAMC,EAAO,KAAK,aAAaH,CAAG,EAClC,OAAO,KAAK,YAAYG,EAAMC,EAAOF,CAAY,CACrD,CAUA,YAAYG,EAAaD,EAAOF,EAAc,CAC1C,IAAMI,EAAYD,EAAY,MAAM,GAAG,EACjCE,EAAkB,cAClBC,EAAa,yBACfC,EAAS,KAEb,QAAWC,KAAKJ,EAAW,CAEvB,IAAMK,EAAeD,EAAE,MAAMH,CAAe,EAC5C,GAAII,IAAiB,MAAQ,OAAOA,EAAa,CAAC,CAAC,IAAMP,EAAO,CAC5DK,EAASC,EAAE,QAAQH,EAAiB,EAAE,EAAE,KAAK,EAC7C,KACJ,CAGA,IAAMK,EAAeF,EAAE,MAAMF,CAAU,EACvC,GAAII,IAAiB,MACE,OAAOA,EAAa,CAAC,CAAC,GACvBR,IAAUQ,EAAa,CAAC,IAAM,KAAO,OAAOA,EAAa,CAAC,CAAC,GAAKR,GAAQ,CACtFK,EAASC,EAAE,QAAQF,EAAY,EAAE,EAAE,KAAK,EACxC,KACJ,CAER,CAEA,OAAIC,IAAW,MAAQH,EAAU,OAAS,IACtCG,EAAUL,IAAU,EAAKE,EAAU,CAAC,EAAIA,EAAU,CAAC,GAGnDG,IAAW,OACXA,EAASH,EAAU,CAAC,GAGjB,KAAK,oBAAoBG,EAAQP,CAAY,CACxD,CAOA,aAAaF,EAAK,CACd,IAAMC,EAAQ,KAAK,MAAM,IAAID,CAAG,EAEhC,OAAIC,IAAU,QACV,QAAQ,KAAK,yBAAyBD,CAAG,kBAAkB,EAGxDC,CACX,CAQA,oBAAoBY,EAAQX,EAAc,CACtC,GAAI,CAACA,EAAc,OAAOW,EAC1B,IAAMC,EAAiBD,EAAO,MAAM,SAAS,EAC7C,GAAIC,IAAmB,KAAM,OAAOD,EACpC,IAAIE,EAAgBF,EAEpB,OAAAC,EAAe,QAAQE,GAAS,CAC5B,IAAMhB,EAAMgB,EAAM,UAAU,CAAC,EACzB,OAAOd,EAAaF,CAAG,EAAM,MACjCe,EAAgBA,EAAc,QAAQC,EAAOd,EAAaF,CAAG,CAAC,EAClE,CAAC,EAEMe,CACX,CAEJ,EAEOE,GAAQpB,GClIf,IAAAqB,GAAA,GAAAC,GAAAD,GAAA,WAAAE,GAAA,mBAAAC,GAAA,QAAAC,GAAA,SAAAC,GAAA,aAAAC,KCKO,SAASC,GAAaC,EAAO,CAChC,IAAMC,EAAUC,GAAQA,EAAK,MAAM,EAAG,CAAC,EAAE,YAAY,EAAIA,EAAK,MAAM,CAAC,EAC/DC,EAAQH,EAAM,MAAM,GAAG,EAC7B,OAAOG,EAAM,CAAC,EAAIA,EAAM,MAAM,CAAC,EAAE,IAAIF,CAAO,EAAE,KAAK,EAAE,CACzD,CAOO,SAASG,GAAaC,EAAU,CACnC,OAAOA,EAAS,QAAQ,SAAU,CAACC,EAAKC,KAAYA,EAAS,EAAI,IAAM,IAAMD,EAAI,YAAY,CAAC,CAClG,CDXA,IAAME,GAAa,CAAC,EAMdC,GAAoB,CAAC,EAMrBC,GAAsB,IAAI,QAQhC,SAASC,GAAUC,EAAMC,EAAS,CAC9B,IAAMC,EAAO,CAAC,EACRC,EAAW,CAAC,EAEZC,EAAS,GAAGJ,CAAI,IAChBK,EAAW,WAAWD,CAAM,KAC5BE,EAAW,CAAC,GAAGL,EAAQ,iBAAiBI,CAAQ,CAAC,EACnDJ,EAAQ,QAAQI,CAAQ,GACxBC,EAAS,KAAKL,CAAO,EAGzB,QAAWM,KAAMD,EAAU,CACvB,IAAME,EAAWD,EAAG,aAAa,MAAM,EAClC,MAAM,GAAG,EACT,OAAOE,GAAOA,EAAI,WAAWL,CAAM,CAAC,EACpC,IAAIK,GAAOA,EAAI,QAAQL,EAAQ,EAAE,CAAC,EAClC,IAAIM,EAAY,EACrB,QAAWC,KAAOH,EACdN,EAAKS,CAAG,EAAIJ,EACR,OAAOJ,EAASQ,CAAG,EAAM,MACzBR,EAASQ,CAAG,EAAI,CAAC,GAErBR,EAASQ,CAAG,EAAE,KAAKJ,CAAE,CAE7B,CACA,MAAO,CAAC,KAAAL,EAAM,SAAAC,CAAQ,CAC1B,CAQA,SAASS,GAAUC,EAAeZ,EAAS,CACvC,IAAMa,EAAO,CAAC,EACRV,EAAS,UAAUS,CAAa,IACtC,OAAW,CAAC,KAAAb,EAAM,MAAAe,CAAK,IAAKd,EAAQ,WAChC,GAAID,EAAK,WAAWI,CAAM,EAAG,CACzB,IAAMY,EAAUhB,EAAK,QAAQI,EAAQ,EAAE,EACvCU,EAAKJ,GAAaM,CAAO,CAAC,EAAID,GAAS,EAC3C,CAEJ,OAAOD,CACX,CAOA,SAASG,GAAcjB,EAAMC,EAAS,CAElC,IAAMiB,EAAiBrB,GAAkBG,CAAI,EAC7C,GAAIkB,IAAmB,OAAW,OAIlC,IAAIC,EACJ,GAAI,CACAA,EAAW,IAAID,EACfC,EAAS,MAAQnB,EACjBmB,EAAS,IAAMlB,EACf,IAAMmB,EAAUrB,GAAUC,EAAMC,CAAO,EACvCkB,EAAS,MAAQC,EAAQ,KACzBD,EAAS,UAAYC,EAAQ,SAC7BD,EAAS,MAAQP,GAAUZ,EAAMC,CAAO,EACxCkB,EAAS,MAAM,CACnB,OAASE,EAAG,CACR,QAAQ,MAAM,6BAA8BA,EAAGrB,EAAMC,CAAO,CAChE,CAGI,OAAOL,GAAWI,CAAI,EAAM,MAC5BJ,GAAWI,CAAI,EAAI,CAAC,GAExBJ,GAAWI,CAAI,EAAE,KAAKmB,CAAQ,EAG9B,IAAMG,EAAexB,GAAoB,IAAIG,CAAO,GAAK,CAAC,EAC1DqB,EAAatB,CAAI,EAAImB,EACrBrB,GAAoB,IAAIG,EAASqB,CAAY,CACjD,CAMO,SAASC,GAAKC,EAAgB,SAAU,CAC3C,IAAMC,EAAiBD,EAAc,iBAAiB,0BAA0B,EAEhF,QAAWjB,KAAMkB,EAAgB,CAC7B,IAAMC,EAAiB,GAAGnB,EAAG,aAAa,WAAW,GAAK,EAAE,IAAKA,EAAG,aAAa,YAAY,CAAE,GAAG,YAAY,EAAE,MAAM,GAAG,EAAE,OAAO,OAAO,EACzI,QAAWP,KAAQ0B,EACfT,GAAcjB,EAAMO,CAAE,CAE9B,CACJ,CAMO,SAASoB,GAASC,EAAS,CAC9B,IAAMC,EAAO,OAAO,KAAKD,CAAO,EAChC,QAAWE,KAAOD,EACdhC,GAAkBkC,GAAaD,CAAG,CAAC,EAAIF,EAAQE,CAAG,CAE1D,CAOO,SAASE,GAAMhC,EAAM,CACxB,OAAQJ,GAAWI,CAAI,GAAK,CAAC,IAAI,GAAG,CAAC,CACzC,CAOO,SAASiC,GAAIjC,EAAM,CACtB,OAAOJ,GAAWI,CAAI,GAAK,CAAC,CAChC,CAQO,SAASkC,GAAejC,EAASD,EAAM,CAE1C,OADqBF,GAAoB,IAAIG,CAAO,GAAK,CAAC,GACtCD,CAAI,GAAK,IACjC,CEpKA,IAAAmC,GAAA,GAAAC,GAAAD,GAAA,mBAAAE,GAAA,kBAAAC,GAAA,aAAAC,GAAA,gBAAAC,GAAA,oBAAAC,GAAA,eAAAC,GAAA,gBAAAC,GAAA,cAAAC,GAAA,aAAAC,GAAA,oBAAAC,GAAA,eAAAC,GAAA,oBAAAC,GAAA,iBAAAC,GAAA,gBAAAC,GAAA,kBAAAC,GAAA,mBAAAC,GAAA,uBAAAC,GAAA,aAAAC,GAAA,mBAAAC,GAAA,aAAAC,GAAA,kBAAAC,GAAA,sBAAAC,GAAA,iBAAAC,GAAA,mBAAAC,GAAA,wBAAAC,GAAA,oBAAAC,GAAA,iBAAAC,GAAA,iBAAAC,GAAA,uBAAAC,GAAA,iBAAAC,GAAA,gBAAAC,GAAA,oBAAAC,GAAA,mBAAAC,GAAA,oBAAAC,GAAA,iBAAAC,GAAA,kBAAAC,GAAA,gBAAAC,GAAA,iBAAAC,GAAA,gBAAAC,GAAA,eAAAC,GAAA,eAAAC,GAAA,qBAAAC,GAAA,YAAAC,GAAA,UAAAC,GAAA,0BAAAC,GAAA,uBAAAC,GAAA,2BAAAC,GAAA,cAAAC,GAAA,kBAAAC,GAAA,cAAAC,GAAA,iBAAAC,GAAA,mBAAAC,GAAA,SAAAC,GAAA,eAAAC,GAAA,oBAAAC,GAAA,iBAAAC,GAAA,cAAAC,GAAA,eAAAC,GAAA,kBAAAC,GAAA,kBAAAC,GAAA,iBAAAC,KCQO,SAASC,GAAKC,EAASC,EAAQ,CAAC,EAAGC,EAAW,CAAC,EAAG,CACrD,IAAMC,EAAK,SAAS,cAAcH,CAAO,EAEzC,OAAW,CAACI,EAAKC,CAAG,IAAK,OAAO,QAAQJ,CAAK,EACrCI,IAAQ,KACRF,EAAG,gBAAgBC,CAAG,EAEtBD,EAAG,aAAaC,EAAKC,CAAG,EAIhC,QAAWC,KAASJ,EACZ,OAAOI,GAAU,SACjBH,EAAG,OAAO,SAAS,eAAeG,CAAK,CAAC,EAExCH,EAAG,OAAOG,CAAK,EAIvB,OAAOH,CACX,CAOO,SAASI,GAAQC,EAAUC,EAAU,CACxC,IAAMC,EAAW,SAAS,iBAAiBF,CAAQ,EACnD,QAAWG,KAAWD,EAClBD,EAASE,CAAO,CAExB,CAQO,SAASC,GAASC,EAAiBC,EAAQL,EAAU,CACxD,QAAWM,KAAaD,EACpBD,EAAgB,iBAAiBE,EAAWN,CAAQ,CAE5D,CAQO,SAASO,EAASN,EAAUD,EAAU,CACpC,MAAM,QAAQC,CAAQ,IACvBA,EAAW,CAACA,CAAQ,GAGxB,QAAWG,KAAmBH,EAC1BG,EAAgB,iBAAiB,QAASJ,CAAQ,EAClDI,EAAgB,iBAAiB,UAAWI,GAAS,EAC7CA,EAAM,MAAQ,SAAWA,EAAM,MAAQ,OACvCA,EAAM,eAAe,EACrBR,EAASQ,CAAK,EAEtB,CAAC,CAET,CAQA,SAASC,GAAWd,EAAKM,EAAUD,EAAU,CACpC,MAAM,QAAQC,CAAQ,IACvBA,EAAW,CAACA,CAAQ,GAGxB,IAAMS,EAAWF,GAAS,CAClBA,EAAM,MAAQb,GACdK,EAASQ,CAAK,CAEtB,EAEAP,EAAS,QAAQU,GAAKA,EAAE,iBAAiB,UAAWD,CAAQ,CAAC,CACjE,CAOO,SAASE,GAAaX,EAAUD,EAAU,CAC7CS,GAAW,QAASR,EAAUD,CAAQ,CAC1C,CAOO,SAASa,GAAcZ,EAAUD,EAAU,CAC9CS,GAAW,SAAUR,EAAUD,CAAQ,CAC3C,CAWO,SAASc,EAAaV,EAAiBW,EAAeT,EAAWN,EAAU,CAC9EI,EAAgB,iBAAiBE,EAAWE,GAAS,CACjD,IAAMQ,EAAgBR,EAAM,OAAO,QAAQO,CAAa,EACpDC,GACAhB,EAAS,KAAKgB,EAAeR,EAAOQ,CAAa,CAEzD,CAAC,CACL,CASO,SAASC,GAASlB,EAAUmB,EAAM,CACrC,IAAMjB,EAAW,SAAS,iBAAiBF,CAAQ,EACnDmB,EAAOA,EAAK,YAAY,EACxB,QAAWhB,KAAWD,EAClB,GAAIC,EAAQ,YAAY,YAAY,EAAE,SAASgB,CAAI,EAC/C,OAAOhB,EAGf,OAAO,IACX,CAOO,SAASiB,GAAYjB,EAAS,CACjCA,EAAQ,UAAY,wEACxB,CAMO,SAASkB,IAAa,CACzB,IAAMC,EAAO,SAAS,cAAc,KAAK,EACzC,OAAAA,EAAK,UAAU,IAAI,mBAAmB,EACtCA,EAAK,UAAY,oCACVA,CACX,CAMO,SAASC,GAAcpB,EAAS,CACnC,IAAMqB,EAAarB,EAAQ,iBAAiB,oBAAoB,EAChE,QAAWR,KAAM6B,EACb7B,EAAG,OAAO,CAElB,CAQO,SAAS8B,GAAUC,EAAM,CAC5B,IAAMJ,EAAO,SAAS,cAAc,KAAK,EACzC,OAAAA,EAAK,UAAYI,EACjB,OAAO,YAAY,KAAKJ,CAAI,EACrBA,EAAK,SAAS,CAAC,CAC1B,CCrLO,SAASK,GAASC,EAAMC,EAAQC,EAAW,CAC9C,IAAIC,EACJ,OAAO,YAA6BC,EAAM,CACtC,IAAMC,EAAU,KACVC,EAAQ,UAA4B,CACtCH,EAAU,KACLD,GAAWF,EAAK,MAAMK,EAASD,CAAI,CAC5C,EACMG,EAAUL,GAAa,CAACC,EAC9B,aAAaA,CAAO,EACpBA,EAAU,WAAWG,EAAOL,CAAM,EAC9BM,GAASP,EAAK,MAAMK,EAASD,CAAI,CACzC,CACJ,CAMO,SAASI,GAA0BC,EAAS,CAC/C,GAAI,CAACA,EAAS,OAEd,IAAIC,EAASD,EACb,KAAOC,EAAO,eACVA,EAASA,EAAO,cACZA,EAAO,WAAa,WAAa,CAACA,EAAO,OACzCA,EAAO,KAAO,IAItBD,EAAQ,eAAe,CAAC,SAAU,QAAQ,CAAC,EAE3C,IAAME,EAAY,iBAAiB,SAAS,IAAI,EAAE,iBAAiB,cAAc,EACjFF,EAAQ,MAAM,QAAU,cAAcE,CAAS,GAC/CF,EAAQ,MAAM,cAAgB,MAC9BA,EAAQ,MAAM,WAAa,KAC3B,WAAW,IAAM,CACbA,EAAQ,MAAM,WAAa,oBAC3BA,EAAQ,MAAM,QAAU,8BACxB,IAAMG,EAAW,IAAM,CACnBH,EAAQ,oBAAoB,gBAAiBG,CAAQ,EACrDH,EAAQ,MAAM,WAAa,KAC3BA,EAAQ,MAAM,QAAU,KACxBA,EAAQ,MAAM,cAAgB,IAClC,EACAA,EAAQ,iBAAiB,gBAAiBG,CAAQ,CACtD,EAAG,GAAI,CACX,CAQO,SAASC,GAAWC,EAAQ,CAC/B,OAAOA,EACF,QAAQ,KAAM,OAAO,EACrB,QAAQ,KAAM,MAAM,EACpB,QAAQ,KAAM,MAAM,EACpB,QAAQ,KAAM,QAAQ,EACtB,QAAQ,KAAM,QAAQ,CAC/B,CAOO,SAASC,IAAW,CAEvB,IAAMC,EAAK,MAAS,EAAI,KAAK,OAAO,GAAK,MAAW,GAAG,SAAS,EAAE,EAAE,UAAU,CAAC,EAC/E,MAAQ,GAAGA,EAAG,EAAIA,EAAG,CAAC,IAAIA,EAAG,CAAC,IAAIA,EAAG,CAAC,IAAIA,EAAG,CAAC,IAAIA,EAAG,CAAC,GAAGA,EAAG,CAAC,GAAGA,EAAG,CAAC,EACxE,CAOO,SAASC,GAAKC,EAAQ,CACzB,OAAO,IAAI,QAAQC,GAAO,CACtB,WAAWA,EAAKD,CAAM,CAC1B,CAAC,CACL,CC/FO,IAAME,EAAN,KAAgB,CAAhB,cAMHC,EAAA,aAAQ,IAMRA,EAAA,WAAM,MAMNA,EAAA,aAAQ,CAAC,GAOTA,EAAA,iBAAY,CAAC,GAMbA,EAAA,aAAQ,CAAC,GAMT,OAAQ,CAER,CASA,MAAMC,EAAWC,EAAO,CAAC,EAAG,CACxBA,EAAK,KAAO,KACZ,IAAMC,EAAgB,KAAK,MACrBC,EAAQ,IAAI,YAAY,GAAGD,CAAa,IAAIF,CAAS,GAAI,CAC3D,QAAS,GACT,OAAQC,CACZ,CAAC,EACD,KAAK,IAAI,cAAcE,CAAK,CAChC,CAEJ,ECjDO,IAAMC,GAAN,cAA4BC,CAAU,CAEzC,OAAQ,CACJ,KAAK,SAAW,KAAK,MAAM,MAC3B,KAAK,UAAY,KAAK,MAAM,IAC5B,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,KAAK,UAAU,iBAAiB,QAAS,KAAK,IAAI,KAAK,IAAI,CAAC,EAE5DC,EAAa,KAAK,IAAK,KAAK,eAAgB,QAASC,GAAK,CAC1CA,EAAE,OAAO,QAAQ,KAAK,WAAW,EACzC,OAAO,CACf,CAAC,CACL,CAGA,KAAM,CACF,IAAMC,EAAQ,KAAK,SAAS,UAAU,EAAI,EAC1CA,EAAM,UAAU,OAAO,QAAQ,EAC/B,KAAK,oBAAoBA,CAAK,EAC9B,KAAK,SAAS,WAAW,aAAaA,EAAO,KAAK,QAAQ,EAC1D,OAAO,YAAY,KAAKA,CAAK,CACjC,CAUA,oBAAoBA,EAAO,CACvB,IAAMC,EAAQC,GAAS,EACjBC,EAAiBH,EAAM,iBAAiB,qBAAqB,EACnE,QAAWI,KAAQD,EACfC,EAAK,KAAOA,EAAK,KAAK,MAAM,WAAW,EAAE,KAAKH,CAAK,CAE3D,CAEJ,EClDO,IAAMI,GAAN,cAA4BC,CAAU,CAEzC,OAAQ,CACJ,KAAK,IAAM,KAAK,IAChB,KAAK,IAAM,KAAK,MAAM,IACtB,KAAK,cAAgB,KAAK,UAAU,OAEpCC,EAAS,KAAK,cAAe,KAAK,UAAU,KAAK,IAAI,CAAC,CAC1D,CAEA,WAAY,CACR,KAAK,IAAI,MAAM,QAAU,MACzB,KAAK,IAAI,MAAM,cAAgB,OAE/B,OAAO,MAAM,OAAO,KAAK,GAAG,EAAE,KAAKC,GAAQ,CACnC,OAAOA,EAAK,MAAS,UAAYA,EAAK,KAAK,SAC3C,OAAO,QAAQ,KAAK,UAAWA,EAAK,KAAK,OAAO,EAEpD,KAAK,IAAI,OAAO,CACpB,CAAC,EAAE,MAAM,IAAM,CACX,KAAK,IAAI,MAAM,QAAU,KACzB,KAAK,IAAI,MAAM,cAAgB,IACnC,CAAC,CACL,CAEJ,EChBO,IAAMC,GAAN,cAAuBC,CAAU,CAEpC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,kBAAoB,KAAK,UAC9B,KAAK,IAAM,KAAK,MAAM,IACtB,KAAK,OAAS,KAAK,MAAM,QAAU,OACnC,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,cAAgB,KAAK,UAAU,QAAU,CAAC,EAE3C,KAAK,MAAM,oBACX,KAAK,kBAAoB,KAAK,UAAU,QAAQ,KAAK,MAAM,iBAAiB,GAGhF,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,GAAI,KAAK,UAAU,UAAY,OAAQ,CACnC,KAAK,UAAU,iBAAiB,SAAU,KAAK,eAAe,KAAK,IAAI,CAAC,EACxE,MACJ,CAEAC,GAAa,KAAK,UAAWC,GAAS,CAClC,KAAK,eAAe,EACpBA,EAAM,eAAe,CACzB,CAAC,EAED,KAAK,cAAc,QAAQC,GAAUC,EAASD,EAAQ,KAAK,eAAe,KAAK,IAAI,CAAC,CAAC,CACzF,CAEA,gBAAiB,CACb,IAAME,EAAK,IAAI,SACTC,EAAS,KAAK,UAAU,iBAAiB,QAAQ,EACvD,QAAWC,KAASD,EAChBD,EAAG,OAAOE,EAAM,aAAa,MAAM,EAAGA,EAAM,KAAK,EAErD,KAAK,OAAOF,CAAE,CAClB,CAEA,eAAeH,EAAO,CAClBA,EAAM,eAAe,EACrB,IAAMG,EAAK,IAAI,SAAS,KAAK,SAAS,EACtC,KAAK,OAAOA,CAAE,CAClB,CAEA,MAAM,OAAOG,EAAU,CACnB,KAAK,kBAAkB,MAAM,QAAU,MACvC,KAAK,kBAAkB,MAAM,cAAgB,OAE7C,GAAI,CACA,IAAMC,EAAO,MAAM,OAAO,MAAM,KAAK,OAAO,YAAY,CAAC,EAAE,KAAK,IAAKD,CAAQ,EAC7E,KAAK,MAAM,UAAW,CAAC,SAAAA,CAAQ,CAAC,EAChC,KAAK,kBAAkB,UAAYC,EAAK,KACpC,KAAK,gBACL,OAAO,QAAQ,KAAK,UAAW,KAAK,cAAc,CAE1D,OAASC,EAAK,CACV,KAAK,kBAAkB,UAAYA,EAAI,IAC3C,CAEA,OAAO,YAAY,KAAK,KAAK,iBAAiB,EAC9C,KAAK,kBAAkB,MAAM,QAAU,KACvC,KAAK,kBAAkB,MAAM,cAAgB,IACjD,CAEJ,EC3EO,IAAMC,GAAN,cAA0BC,CAAU,CAEvC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,OAAS,KAAK,MAAM,OACzB,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,UAAY,KAAK,MAAM,UAC5B,KAAK,iBAAmB,KAAK,MAAM,iBAEnC,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,IAAMC,EAAkB,KAAK,WAAW,KAAK,IAAI,EACjD,KAAK,UAAU,iBAAiB,0BAA2BA,CAAe,EAC1E,KAAK,UAAU,iBAAiB,oBAAqBA,CAAe,EAEpE,KAAK,UAAU,iBAAiB,qBAAsBC,GAAS,CAC3D,KAAK,YAAYA,EAAM,OAAO,GAAG,CACrC,CAAC,EAED,KAAK,UAAU,iBAAiB,yBAA0BA,GAAS,CAC/D,KAAK,UAAUA,EAAM,OAAO,EAAE,CAClC,CAAC,EAED,KAAK,UAAU,iBAAiB,8BAA+B,IAAM,CACjE,KAAK,SAAS,CAClB,CAAC,EAED,KAAK,UAAU,iBAAiB,2BAA4BA,GAAS,CACjE,IAAMC,EAAgBD,EAAM,OAAO,QAAQ,qBAAqB,EAAE,aAAa,mBAAmB,EAC5FE,EAAe,KAAK,MAAMD,CAAa,EAC7C,OAAO,QAAQ,KAAK,iBAAkB,CAClC,KAAMC,EAAa,WAAW,EAC9B,SAAUA,EAAa,YAAY,CACvC,CAAC,CACL,CAAC,EAED,KAAK,iBAAiB,iBAAiB,QAAS,IAAM,CAClD,KAAK,YAAY,OAAO,CAC5B,CAAC,CACL,CAEA,YAAYC,EAAS,CACjB,IAAMC,EAAa,CACf,MAAO,KAAK,eACZ,KAAM,KAAK,cACX,KAAM,KAAK,aACf,EAEA,OAAW,CAACC,EAAMC,CAAI,IAAK,OAAO,QAAQF,CAAU,EAChDE,EAAK,gBAAgB,SAAUD,IAASF,CAAO,CAEvD,CAEA,YAAa,CACT,KAAK,SAAS,EACd,OAAO,MAAM,IAAI,yBAAyB,KAAK,MAAM,EAAE,EAAE,KAAKI,GAAQ,CAClE,KAAK,UAAU,UAAYA,EAAK,KAChC,OAAO,YAAY,KAAK,KAAK,SAAS,CAC1C,CAAC,CACL,CAEA,YAAYC,EAAS,CACjB,OAAO,MAAM,IAAI,0BAA0B,KAAK,MAAM,GAAI,CAAC,MAAOA,CAAO,CAAC,EAAE,KAAKD,GAAQ,CACrF,OAAO,QAAQ,KAAK,UAAWA,EAAK,KAAK,OAAO,CACpD,CAAC,CACL,CAEA,MAAM,UAAUE,EAAI,CAChB,KAAK,YAAY,MAAM,EAEvBC,GAAY,KAAK,aAAa,EAC9B,IAAMH,EAAO,MAAM,OAAO,MAAM,IAAI,qBAAqBE,CAAE,EAAE,EAC7D,KAAK,cAAc,UAAYF,EAAK,KACpC,OAAO,YAAY,KAAK,KAAK,aAAa,CAC9C,CAEA,UAAW,CACP,KAAK,YAAY,MAAM,CAC3B,CAEJ,EChFO,IAAMI,GAAN,cAA8BC,CAAU,CAE3C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,UAAY,KAAK,UAAU,aAEhC,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,IAAMC,EAAgBC,GAASA,EAAM,MAAQ,WAAaA,EAAM,MAAQ,OACxE,OAAO,iBAAiB,UAAWA,GAAS,CACpCD,EAAcC,CAAK,GACnB,KAAK,oBAAoB,CAEjC,EAAG,CAAC,QAAS,EAAI,CAAC,EAClB,OAAO,iBAAiB,QAASA,GAAS,CAClCD,EAAcC,CAAK,GACnB,KAAK,yBAAyB,CAEtC,EAAG,CAAC,QAAS,EAAI,CAAC,CACtB,CAEA,qBAAsB,CAClB,QAAWC,KAAQ,KAAK,UAChBA,EAAK,KAAK,MAAM,GAAG,EAAE,CAAC,IAAM,cAC5BA,EAAK,MAAQ,aACbA,EAAK,aAAa,SAAU,QAAQ,EAGhD,CAEA,0BAA2B,CACvB,QAAWA,KAAQ,KAAK,UACpBA,EAAK,KAAOA,EAAK,KAAK,MAAM,GAAG,EAAE,CAAC,EAClCA,EAAK,gBAAgB,QAAQ,CAErC,CAEJ,EC9CA,IAAAC,GAAAC,GAAAC,GAAAC,GAGaC,GAAN,KAAgC,CAOnC,YAAYC,EAAWC,EAAW,KAAMC,EAAU,KAAM,CAgDxDC,GAAA,KAAAR,IA2BAQ,GAAA,KAAAN,IA1EI,KAAK,WAAa,CAACG,CAAS,EAC5B,KAAK,SAAWC,EAChB,KAAK,QAAUC,EACfF,EAAU,iBAAiB,UAAWI,GAAA,KAAKT,GAAAC,IAAgB,KAAK,IAAI,CAAC,CACzE,CAOA,kBAAkBS,EAAS,CACvB,KAAK,WAAW,KAAKA,CAAO,EAC5BA,EAAQ,iBAAiB,UAAWD,GAAA,KAAKT,GAAAC,IAAgB,KAAK,IAAI,CAAC,CACvE,CAKA,WAAY,CACR,IAAMU,EAAYF,GAAA,KAAKP,GAAAC,IAAL,WAEdS,EADiBD,EAAU,QAAQ,SAAS,aAAa,EAC/B,EAC1BC,GAAYD,EAAU,SACtBC,EAAW,GAGfD,EAAUC,CAAQ,EAAE,MAAM,CAC9B,CAKA,eAAgB,CACZ,IAAMD,EAAYF,GAAA,KAAKP,GAAAC,IAAL,WAEdS,EADiBD,EAAU,QAAQ,SAAS,aAAa,EAC/B,EAC1BC,EAAW,IACXA,EAAWD,EAAU,OAAS,GAGlCA,EAAUC,CAAQ,EAAE,MAAM,CAC9B,CAyCJ,EApCIZ,GAAA,YAAAC,GAAe,SAACY,EAAO,CAEfA,EAAM,OAAO,QAAQ,OAAO,IAAMA,EAAM,MAAQ,cAAgBA,EAAM,MAAQ,eAI9EA,EAAM,MAAQ,aAAeA,EAAM,MAAQ,cAC3C,KAAK,UAAU,EACfA,EAAM,eAAe,GACdA,EAAM,MAAQ,WAAaA,EAAM,MAAQ,aAChD,KAAK,cAAc,EACnBA,EAAM,eAAe,GACdA,EAAM,MAAQ,SACjB,KAAK,SACL,KAAK,SAASA,CAAK,EACZ,SAAS,eAChB,SAAS,cAAc,KAAK,EAEzBA,EAAM,MAAQ,SAAW,KAAK,SACrC,KAAK,QAAQA,CAAK,EAE1B,EAMAX,GAAA,YAAAC,GAAa,UAAG,CACZ,IAAMQ,EAAY,CAAC,EACbG,EAAW,yGACjB,QAAWT,KAAa,KAAK,WACzBM,EAAU,KAAK,GAAGN,EAAU,iBAAiBS,CAAQ,CAAC,EAE1D,OAAOH,CACX,ECvFJ,IAAMI,GAAY,CAAC,EAKNC,GAAN,cAA0BC,CAAU,CAEvC,OAAQ,CACJ,KAAK,OAAS,KAAK,IAAI,cACvB,KAAK,UAAY,KAAK,IACtB,KAAK,KAAO,KAAK,MAAM,KACvB,KAAK,IAAM,KAAK,MAAM,IACtB,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,KAAO,KAAK,MAAM,KAEvB,KAAK,cAAgB,EACrB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACM,IAAIC,GACnB,KAAK,KACL,IAAM,CACF,KAAK,MAAM,MAAM,EACjB,WAAW,IAAM,KAAK,gBAAgB,EAAG,CAAC,CAC9C,EACAC,GAAS,CACLA,EAAM,eAAe,EACrB,IAAMC,EAAiBD,EAAM,OAAO,YAChCC,GACA,KAAK,iBAAiBA,CAAc,CAE5C,CACJ,EACW,kBAAkB,KAAK,KAAK,EAEvCC,EAAa,KAAK,KAAM,aAAc,QAAS,CAACF,EAAOG,IAAO,CAC1D,KAAK,iBAAiBA,EAAG,WAAW,CACxC,CAAC,EAED,KAAK,MAAM,iBAAiB,QAAS,KAAK,mBAAmB,KAAK,IAAI,CAAC,EACvE,KAAK,MAAM,iBAAiB,QAAS,KAAK,mBAAmB,KAAK,IAAI,CAAC,EACvE,KAAK,MAAM,iBAAiB,OAAQ,KAAK,6BAA6B,KAAK,IAAI,CAAC,EAChF,KAAK,MAAM,iBAAiB,UAAWH,GAAS,CACxCA,EAAM,MAAQ,OACd,KAAK,gBAAgB,CAE7B,CAAC,CACL,CAEA,iBAAiBI,EAAO,CACpB,KAAK,MAAM,MAAQA,EACnB,KAAK,cAAgB,KAAK,IAAI,EAC9B,KAAK,MAAM,MAAM,EACjB,KAAK,MAAM,cAAc,IAAI,MAAM,QAAS,CAAC,QAAS,EAAI,CAAC,CAAC,EAC5D,KAAK,MAAM,cAAc,IAAI,MAAM,SAAU,CAAC,QAAS,EAAI,CAAC,CAAC,EAC7D,KAAK,gBAAgB,CACzB,CAEA,MAAM,oBAAqB,CACvB,GAAI,KAAK,IAAI,EAAI,KAAK,cAAgB,GAClC,OAGJ,IAAMC,EAAa,KAAK,sBAAsB,EACxCC,EAAS,KAAK,MAAM,MAAM,YAAY,EAGtCC,GAFc,MAAM,KAAK,gBAAgBD,EAAQD,CAAU,GAEtC,OAAOG,GAAOF,IAAW,IAAME,EAAI,YAAY,EAAE,WAAWF,CAAM,CAAC,EAAE,MAAM,EAAG,EAAE,EAE3G,KAAK,mBAAmBC,CAAM,CAClC,CAEA,uBAAwB,CACpB,OAAI,KAAK,OAAS,QAAgB,KAC3B,KAAK,OAAO,cAAc,OAAO,EAAE,KAC9C,CAOA,MAAM,gBAAgBD,EAAQD,EAAa,KAAM,CAE7CC,EAASA,EAAO,MAAM,EAAG,CAAC,EAE1B,IAAMG,EAAS,CAAC,OAAAH,EAAQ,KAAMD,CAAU,EAClCK,EAAW,GAAG,KAAK,GAAG,IAAI,KAAK,UAAUD,CAAM,CAAC,GAEtD,GAAIb,GAAUc,CAAQ,EAClB,OAAOd,GAAUc,CAAQ,EAG7B,IAAMC,EAAO,MAAM,OAAO,MAAM,IAAI,KAAK,IAAKF,CAAM,EACpD,OAAAb,GAAUc,CAAQ,EAAIC,EAAK,KACpBA,EAAK,IAChB,CAKA,mBAAmBC,EAAa,CAC5B,GAAIA,EAAY,SAAW,EAAG,CAC1B,KAAK,gBAAgB,EACrB,MACJ,CAIA,KAAK,KAAK,UAAYA,EAAY,IAAIR,GAAS,2CAA2CS,GAAWT,CAAK,CAAC,aAAa,EAAE,KAAK,EAAE,EACjI,KAAK,KAAK,MAAM,QAAU,QAC1B,QAAWU,KAAU,KAAK,KAAK,iBAAiB,YAAY,EACxDA,EAAO,iBAAiB,OAAQ,KAAK,6BAA6B,KAAK,IAAI,CAAC,CAEpF,CAEA,iBAAkB,CACd,KAAK,KAAK,MAAM,QAAU,MAC9B,CAEA,6BAA6Bd,EAAO,CAC3B,KAAK,UAAU,SAASA,EAAM,aAAa,GAC5C,KAAK,gBAAgB,CAE7B,CAEJ,EClIO,IAAMe,GAAN,cAAyBC,CAAU,CAEtC,OAAQ,CACJ,KAAK,KAAO,KAAK,IAEjB,KAAK,KAAK,OAAO,CACrB,CAEJ,ECRO,IAAMC,GAAN,cAAwBC,CAAU,CAErC,OAAQ,CAMJ,GALA,KAAK,OAAS,KAAK,IACnB,KAAK,WAAa,SAAS,eAAe,QAAQ,EAClD,KAAK,QAAU,GACf,KAAK,WAAa,KAEd,SAAS,KAAK,UAAU,SAAS,SAAS,EAAG,CAC7C,KAAK,OAAO,MAAM,QAAU,OAC5B,MACJ,CAEA,KAAK,OAAO,iBAAiB,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,EACjE,OAAO,iBAAiB,SAAU,KAAK,aAAa,KAAK,IAAI,CAAC,CAClE,CAEA,cAAe,CACX,IAAMC,EAAe,SAAS,gBAAgB,WAAa,SAAS,KAAK,WAAa,EAClF,CAAC,KAAK,SAAWA,EAAe,KAAK,YACrC,KAAK,OAAO,MAAM,QAAU,QAC5B,KAAK,QAAU,GACf,WAAW,IAAM,CACb,KAAK,OAAO,MAAM,QAAU,EAChC,EAAG,CAAC,GACG,KAAK,SAAWA,EAAe,KAAK,aAC3C,KAAK,OAAO,MAAM,QAAU,EAC5B,KAAK,QAAU,GACf,WAAW,IAAM,CACb,KAAK,OAAO,MAAM,QAAU,MAChC,EAAG,GAAG,EAEd,CAEA,aAAc,CACV,IAAMC,EAAY,KAAK,WAAW,sBAAsB,EAAE,IACpDC,EAAa,SAAS,gBAAgB,UAAY,SAAS,gBAAkB,SAAS,KACtFC,EAAW,IACXC,EAAQ,KAAK,IAAI,EACjBC,EAAc,KAAK,WAAW,sBAAsB,EAAE,IAE5D,SAASC,GAAS,CACd,IAAMC,EAAmB,GAAM,KAAK,IAAI,EAAIH,GAASD,EAC/CK,EAAS,KAAK,IAAID,EAAkBF,CAAW,EACjDE,EAAkB,GAClBL,EAAW,UAAYM,EACvB,sBAAsBF,EAAO,KAAK,IAAI,CAAC,GAEvCJ,EAAW,UAAYD,CAE/B,CAEA,sBAAsBK,EAAO,KAAK,IAAI,CAAC,CAC3C,CAEJ,ECnDA,SAASG,GAAQC,EAAQC,EAAgB,CACvC,IAAIC,EAAO,OAAO,KAAKF,CAAM,EAC7B,GAAI,OAAO,sBAAuB,CAChC,IAAIG,EAAU,OAAO,sBAAsBH,CAAM,EAC7CC,IACFE,EAAUA,EAAQ,OAAO,SAAUC,EAAK,CACtC,OAAO,OAAO,yBAAyBJ,EAAQI,CAAG,EAAE,UACtD,CAAC,GAEHF,EAAK,KAAK,MAAMA,EAAMC,CAAO,CAC/B,CACA,OAAOD,CACT,CACA,SAASG,GAAeC,EAAQ,CAC9B,QAASC,EAAI,EAAGA,EAAI,UAAU,OAAQA,IAAK,CACzC,IAAIC,EAAS,UAAUD,CAAC,GAAK,KAAO,UAAUA,CAAC,EAAI,CAAC,EAChDA,EAAI,EACNR,GAAQ,OAAOS,CAAM,EAAG,EAAI,EAAE,QAAQ,SAAUC,EAAK,CACnDC,GAAgBJ,EAAQG,EAAKD,EAAOC,CAAG,CAAC,CAC1C,CAAC,EACQ,OAAO,0BAChB,OAAO,iBAAiBH,EAAQ,OAAO,0BAA0BE,CAAM,CAAC,EAExET,GAAQ,OAAOS,CAAM,CAAC,EAAE,QAAQ,SAAUC,EAAK,CAC7C,OAAO,eAAeH,EAAQG,EAAK,OAAO,yBAAyBD,EAAQC,CAAG,CAAC,CACjF,CAAC,CAEL,CACA,OAAOH,CACT,CACA,SAASK,GAAQC,EAAK,CACpB,0BAEA,OAAI,OAAO,QAAW,YAAc,OAAO,OAAO,UAAa,SAC7DD,GAAU,SAAUC,EAAK,CACvB,OAAO,OAAOA,CAChB,EAEAD,GAAU,SAAUC,EAAK,CACvB,OAAOA,GAAO,OAAO,QAAW,YAAcA,EAAI,cAAgB,QAAUA,IAAQ,OAAO,UAAY,SAAW,OAAOA,CAC3H,EAEKD,GAAQC,CAAG,CACpB,CACA,SAASF,GAAgBE,EAAKH,EAAKI,EAAO,CACxC,OAAIJ,KAAOG,EACT,OAAO,eAAeA,EAAKH,EAAK,CAC9B,MAAOI,EACP,WAAY,GACZ,aAAc,GACd,SAAU,EACZ,CAAC,EAEDD,EAAIH,CAAG,EAAII,EAEND,CACT,CACA,SAASE,GAAW,CAClB,OAAAA,EAAW,OAAO,QAAU,SAAUR,EAAQ,CAC5C,QAASC,EAAI,EAAGA,EAAI,UAAU,OAAQA,IAAK,CACzC,IAAIC,EAAS,UAAUD,CAAC,EACxB,QAASE,KAAOD,EACV,OAAO,UAAU,eAAe,KAAKA,EAAQC,CAAG,IAClDH,EAAOG,CAAG,EAAID,EAAOC,CAAG,EAG9B,CACA,OAAOH,CACT,EACOQ,EAAS,MAAM,KAAM,SAAS,CACvC,CACA,SAASC,GAA8BP,EAAQQ,EAAU,CACvD,GAAIR,GAAU,KAAM,MAAO,CAAC,EAC5B,IAAIF,EAAS,CAAC,EACVW,EAAa,OAAO,KAAKT,CAAM,EAC/BC,EAAKF,EACT,IAAKA,EAAI,EAAGA,EAAIU,EAAW,OAAQV,IACjCE,EAAMQ,EAAWV,CAAC,EACd,EAAAS,EAAS,QAAQP,CAAG,GAAK,KAC7BH,EAAOG,CAAG,EAAID,EAAOC,CAAG,GAE1B,OAAOH,CACT,CACA,SAASY,GAAyBV,EAAQQ,EAAU,CAClD,GAAIR,GAAU,KAAM,MAAO,CAAC,EAC5B,IAAIF,EAASS,GAA8BP,EAAQQ,CAAQ,EACvDP,EAAKF,EACT,GAAI,OAAO,sBAAuB,CAChC,IAAIY,EAAmB,OAAO,sBAAsBX,CAAM,EAC1D,IAAKD,EAAI,EAAGA,EAAIY,EAAiB,OAAQZ,IACvCE,EAAMU,EAAiBZ,CAAC,EACpB,EAAAS,EAAS,QAAQP,CAAG,GAAK,IACxB,OAAO,UAAU,qBAAqB,KAAKD,EAAQC,CAAG,IAC3DH,EAAOG,CAAG,EAAID,EAAOC,CAAG,EAE5B,CACA,OAAOH,CACT,CACA,SAASc,GAAmBC,EAAK,CAC/B,OAAOC,GAAmBD,CAAG,GAAKE,GAAiBF,CAAG,GAAKG,GAA4BH,CAAG,GAAKI,GAAmB,CACpH,CACA,SAASH,GAAmBD,EAAK,CAC/B,GAAI,MAAM,QAAQA,CAAG,EAAG,OAAOK,GAAkBL,CAAG,CACtD,CACA,SAASE,GAAiBI,EAAM,CAC9B,GAAI,OAAO,OAAW,KAAeA,EAAK,OAAO,QAAQ,GAAK,MAAQA,EAAK,YAAY,GAAK,KAAM,OAAO,MAAM,KAAKA,CAAI,CAC1H,CACA,SAASH,GAA4BI,EAAGC,EAAQ,CAC9C,GAAKD,EACL,IAAI,OAAOA,GAAM,SAAU,OAAOF,GAAkBE,EAAGC,CAAM,EAC7D,IAAIC,EAAI,OAAO,UAAU,SAAS,KAAKF,CAAC,EAAE,MAAM,EAAG,EAAE,EAErD,GADIE,IAAM,UAAYF,EAAE,cAAaE,EAAIF,EAAE,YAAY,MACnDE,IAAM,OAASA,IAAM,MAAO,OAAO,MAAM,KAAKF,CAAC,EACnD,GAAIE,IAAM,aAAe,2CAA2C,KAAKA,CAAC,EAAG,OAAOJ,GAAkBE,EAAGC,CAAM,EACjH,CACA,SAASH,GAAkBL,EAAKU,EAAK,EAC/BA,GAAO,MAAQA,EAAMV,EAAI,UAAQU,EAAMV,EAAI,QAC/C,QAASd,EAAI,EAAGyB,EAAO,IAAI,MAAMD,CAAG,EAAGxB,EAAIwB,EAAKxB,IAAKyB,EAAKzB,CAAC,EAAIc,EAAId,CAAC,EACpE,OAAOyB,CACT,CACA,SAASP,IAAqB,CAC5B,MAAM,IAAI,UAAU;AAAA,mFAAsI,CAC5J,CAEA,IAAIQ,GAAU,SAEd,SAASC,GAAUC,EAAS,CAC1B,GAAI,OAAO,OAAW,KAAe,OAAO,UAC1C,MAAO,CAAC,CAAe,UAAU,UAAU,MAAMA,CAAO,CAE5D,CACA,IAAIC,GAAaF,GAAU,uDAAuD,EAC9EG,GAAOH,GAAU,OAAO,EACxBI,GAAUJ,GAAU,UAAU,EAC9BK,GAASL,GAAU,SAAS,GAAK,CAACA,GAAU,SAAS,GAAK,CAACA,GAAU,UAAU,EAC/EM,GAAMN,GAAU,iBAAiB,EACjCO,GAAmBP,GAAU,SAAS,GAAKA,GAAU,UAAU,EAE/DQ,GAAc,CAChB,QAAS,GACT,QAAS,EACX,EACA,SAASC,EAAGC,EAAIC,EAAOC,EAAI,CACzBF,EAAG,iBAAiBC,EAAOC,EAAI,CAACV,IAAcM,EAAW,CAC3D,CACA,SAASK,EAAIH,EAAIC,EAAOC,EAAI,CAC1BF,EAAG,oBAAoBC,EAAOC,EAAI,CAACV,IAAcM,EAAW,CAC9D,CACA,SAASM,GAAyBJ,EAAeK,EAAU,CACzD,GAAKA,EAEL,IADAA,EAAS,CAAC,IAAM,MAAQA,EAAWA,EAAS,UAAU,CAAC,GACnDL,EACF,GAAI,CACF,GAAIA,EAAG,QACL,OAAOA,EAAG,QAAQK,CAAQ,EACrB,GAAIL,EAAG,kBACZ,OAAOA,EAAG,kBAAkBK,CAAQ,EAC/B,GAAIL,EAAG,sBACZ,OAAOA,EAAG,sBAAsBK,CAAQ,CAE5C,MAAY,CACV,MAAO,EACT,CAEF,MAAO,GACT,CACA,SAASC,GAAgBN,EAAI,CAC3B,OAAOA,EAAG,MAAQA,IAAO,UAAYA,EAAG,KAAK,SAAWA,EAAG,KAAOA,EAAG,UACvE,CACA,SAASO,EAAyBP,EAAeK,EAA0BG,EAAKC,EAAY,CAC1F,GAAIT,EAAI,CACNQ,EAAMA,GAAO,SACb,EAAG,CACD,GAAIH,GAAY,OAASA,EAAS,CAAC,IAAM,IAAML,EAAG,aAAeQ,GAAOJ,GAAQJ,EAAIK,CAAQ,EAAID,GAAQJ,EAAIK,CAAQ,IAAMI,GAAcT,IAAOQ,EAC7I,OAAOR,EAET,GAAIA,IAAOQ,EAAK,KAElB,OAASR,EAAKM,GAAgBN,CAAE,EAClC,CACA,OAAO,IACT,CACA,IAAIU,GAAU,OACd,SAASC,EAAYX,EAAIY,EAAMC,EAAO,CACpC,GAAIb,GAAMY,EACR,GAAIZ,EAAG,UACLA,EAAG,UAAUa,EAAQ,MAAQ,QAAQ,EAAED,CAAI,MACtC,CACL,IAAIE,GAAa,IAAMd,EAAG,UAAY,KAAK,QAAQU,GAAS,GAAG,EAAE,QAAQ,IAAME,EAAO,IAAK,GAAG,EAC9FZ,EAAG,WAAac,GAAaD,EAAQ,IAAMD,EAAO,KAAK,QAAQF,GAAS,GAAG,CAC7E,CAEJ,CACA,SAASK,EAAIf,EAAIgB,EAAMC,EAAK,CAC1B,IAAIC,EAAQlB,GAAMA,EAAG,MACrB,GAAIkB,EAAO,CACT,GAAID,IAAQ,OACV,OAAI,SAAS,aAAe,SAAS,YAAY,iBAC/CA,EAAM,SAAS,YAAY,iBAAiBjB,EAAI,EAAE,EACzCA,EAAG,eACZiB,EAAMjB,EAAG,cAEJgB,IAAS,OAASC,EAAMA,EAAID,CAAI,EAEnC,EAAEA,KAAQE,IAAUF,EAAK,QAAQ,QAAQ,IAAM,KACjDA,EAAO,WAAaA,GAEtBE,EAAMF,CAAI,EAAIC,GAAO,OAAOA,GAAQ,SAAW,GAAK,KAExD,CACF,CACA,SAASE,GAAOnB,EAAIoB,EAAU,CAC5B,IAAIC,EAAoB,GACxB,GAAI,OAAOrB,GAAO,SAChBqB,EAAoBrB,MAEpB,GAAG,CACD,IAAIsB,EAAYP,EAAIf,EAAI,WAAW,EAC/BsB,GAAaA,IAAc,SAC7BD,EAAoBC,EAAY,IAAMD,EAG1C,OAAS,CAACD,IAAapB,EAAKA,EAAG,aAEjC,IAAIuB,EAAW,OAAO,WAAa,OAAO,iBAAmB,OAAO,WAAa,OAAO,YAExF,OAAOA,GAAY,IAAIA,EAASF,CAAiB,CACnD,CACA,SAASG,GAAKhB,EAAKiB,EAASC,EAAU,CACpC,GAAIlB,EAAK,CACP,IAAImB,EAAOnB,EAAI,qBAAqBiB,CAAO,EACzC9D,EAAI,EACJuB,EAAIyC,EAAK,OACX,GAAID,EACF,KAAO/D,EAAIuB,EAAGvB,IACZ+D,EAASC,EAAKhE,CAAC,EAAGA,CAAC,EAGvB,OAAOgE,CACT,CACA,MAAO,CAAC,CACV,CACA,SAASC,IAA4B,CACnC,IAAIC,EAAmB,SAAS,iBAChC,OAAIA,GAGK,SAAS,eAEpB,CAWA,SAASC,EAAQ9B,EAAI+B,EAA2BC,EAA2BC,EAAWC,EAAW,CAC/F,GAAI,GAAClC,EAAG,uBAAyBA,IAAO,QACxC,KAAImC,EAAQC,EAAKC,EAAMC,EAAQC,EAAOC,EAAQC,EAiB9C,GAhBIzC,IAAO,QAAUA,EAAG,YAAcA,IAAO4B,GAA0B,GACrEO,EAASnC,EAAG,sBAAsB,EAClCoC,EAAMD,EAAO,IACbE,EAAOF,EAAO,KACdG,EAASH,EAAO,OAChBI,EAAQJ,EAAO,MACfK,EAASL,EAAO,OAChBM,EAAQN,EAAO,QAEfC,EAAM,EACNC,EAAO,EACPC,EAAS,OAAO,YAChBC,EAAQ,OAAO,WACfC,EAAS,OAAO,YAChBC,EAAQ,OAAO,aAEZV,GAA6BC,IAA8BhC,IAAO,SAErEkC,EAAYA,GAAalC,EAAG,WAIxB,CAACR,IACH,EACE,IAAI0C,GAAaA,EAAU,wBAA0BnB,EAAImB,EAAW,WAAW,IAAM,QAAUF,GAA6BjB,EAAImB,EAAW,UAAU,IAAM,UAAW,CACpK,IAAIQ,EAAgBR,EAAU,sBAAsB,EAGpDE,GAAOM,EAAc,IAAM,SAAS3B,EAAImB,EAAW,kBAAkB,CAAC,EACtEG,GAAQK,EAAc,KAAO,SAAS3B,EAAImB,EAAW,mBAAmB,CAAC,EACzEI,EAASF,EAAMD,EAAO,OACtBI,EAAQF,EAAOF,EAAO,MACtB,KACF,OAEOD,EAAYA,EAAU,YAGnC,GAAID,GAAajC,IAAO,OAAQ,CAE9B,IAAI2C,EAAWxB,GAAOe,GAAalC,CAAE,EACnC4C,EAASD,GAAYA,EAAS,EAC9BE,EAASF,GAAYA,EAAS,EAC5BA,IACFP,GAAOS,EACPR,GAAQO,EACRH,GAASG,EACTJ,GAAUK,EACVP,EAASF,EAAMI,EACfD,EAAQF,EAAOI,EAEnB,CACA,MAAO,CACL,IAAKL,EACL,KAAMC,EACN,OAAQC,EACR,MAAOC,EACP,MAAOE,EACP,OAAQD,CACV,EACF,CASA,SAASM,GAAe9C,EAAI+C,EAAQC,EAAY,CAK9C,QAJIC,EAASC,GAA2BlD,EAAI,EAAI,EAC9CmD,EAAYrB,EAAQ9B,CAAE,EAAE+C,CAAM,EAGzBE,GAAQ,CACb,IAAIG,EAAgBtB,EAAQmB,CAAM,EAAED,CAAU,EAC5CK,EAAU,OAMZ,GALIL,IAAe,OAASA,IAAe,OACzCK,EAAUF,GAAaC,EAEvBC,EAAUF,GAAaC,EAErB,CAACC,EAAS,OAAOJ,EACrB,GAAIA,IAAWrB,GAA0B,EAAG,MAC5CqB,EAASC,GAA2BD,EAAQ,EAAK,CACnD,CACA,MAAO,EACT,CAUA,SAASK,GAAStD,EAAIuD,EAAUC,EAASC,EAAe,CAItD,QAHIC,EAAe,EACjB/F,EAAI,EACJgG,EAAW3D,EAAG,SACTrC,EAAIgG,EAAS,QAAQ,CAC1B,GAAIA,EAAShG,CAAC,EAAE,MAAM,UAAY,QAAUgG,EAAShG,CAAC,IAAMiG,EAAS,QAAUH,GAAiBE,EAAShG,CAAC,IAAMiG,EAAS,UAAYrD,EAAQoD,EAAShG,CAAC,EAAG6F,EAAQ,UAAWxD,EAAI,EAAK,EAAG,CACvL,GAAI0D,IAAiBH,EACnB,OAAOI,EAAShG,CAAC,EAEnB+F,GACF,CACA/F,GACF,CACA,OAAO,IACT,CAQA,SAASkG,GAAU7D,EAAIK,EAAU,CAE/B,QADIyD,EAAO9D,EAAG,iBACP8D,IAASA,IAASF,EAAS,OAAS7C,EAAI+C,EAAM,SAAS,IAAM,QAAUzD,GAAY,CAACD,GAAQ0D,EAAMzD,CAAQ,IAC/GyD,EAAOA,EAAK,uBAEd,OAAOA,GAAQ,IACjB,CASA,SAASC,EAAM/D,EAAIK,EAAU,CAC3B,IAAI0D,EAAQ,EACZ,GAAI,CAAC/D,GAAM,CAACA,EAAG,WACb,MAAO,GAIT,KAAOA,EAAKA,EAAG,wBACTA,EAAG,SAAS,YAAY,IAAM,YAAcA,IAAO4D,EAAS,QAAU,CAACvD,GAAYD,GAAQJ,EAAIK,CAAQ,IACzG0D,IAGJ,OAAOA,CACT,CAQA,SAASC,GAAwBhE,EAAI,CACnC,IAAIiE,EAAa,EACfC,EAAY,EACZC,EAAcvC,GAA0B,EAC1C,GAAI5B,EACF,EAAG,CACD,IAAI2C,EAAWxB,GAAOnB,CAAE,EACtB4C,EAASD,EAAS,EAClBE,EAASF,EAAS,EACpBsB,GAAcjE,EAAG,WAAa4C,EAC9BsB,GAAalE,EAAG,UAAY6C,CAC9B,OAAS7C,IAAOmE,IAAgBnE,EAAKA,EAAG,aAE1C,MAAO,CAACiE,EAAYC,CAAS,CAC/B,CAQA,SAASE,GAAc3F,EAAKT,EAAK,CAC/B,QAASL,KAAKc,EACZ,GAAKA,EAAI,eAAed,CAAC,GACzB,QAASE,KAAOG,EACd,GAAIA,EAAI,eAAeH,CAAG,GAAKG,EAAIH,CAAG,IAAMY,EAAId,CAAC,EAAEE,CAAG,EAAG,OAAO,OAAOF,CAAC,EAG5E,MAAO,EACT,CACA,SAASuF,GAA2BlD,EAAIqE,EAAa,CAEnD,GAAI,CAACrE,GAAM,CAACA,EAAG,sBAAuB,OAAO4B,GAA0B,EACvE,IAAI0C,EAAOtE,EACPuE,EAAU,GACd,EAEE,IAAID,EAAK,YAAcA,EAAK,aAAeA,EAAK,aAAeA,EAAK,aAAc,CAChF,IAAIE,EAAUzD,EAAIuD,CAAI,EACtB,GAAIA,EAAK,YAAcA,EAAK,cAAgBE,EAAQ,WAAa,QAAUA,EAAQ,WAAa,WAAaF,EAAK,aAAeA,EAAK,eAAiBE,EAAQ,WAAa,QAAUA,EAAQ,WAAa,UAAW,CACpN,GAAI,CAACF,EAAK,uBAAyBA,IAAS,SAAS,KAAM,OAAO1C,GAA0B,EAC5F,GAAI2C,GAAWF,EAAa,OAAOC,EACnCC,EAAU,EACZ,CACF,OAEOD,EAAOA,EAAK,YACrB,OAAO1C,GAA0B,CACnC,CACA,SAAS6C,GAAOC,EAAKC,EAAK,CACxB,GAAID,GAAOC,EACT,QAAS9G,KAAO8G,EACVA,EAAI,eAAe9G,CAAG,IACxB6G,EAAI7G,CAAG,EAAI8G,EAAI9G,CAAG,GAIxB,OAAO6G,CACT,CACA,SAASE,GAAYC,EAAOC,EAAO,CACjC,OAAO,KAAK,MAAMD,EAAM,GAAG,IAAM,KAAK,MAAMC,EAAM,GAAG,GAAK,KAAK,MAAMD,EAAM,IAAI,IAAM,KAAK,MAAMC,EAAM,IAAI,GAAK,KAAK,MAAMD,EAAM,MAAM,IAAM,KAAK,MAAMC,EAAM,MAAM,GAAK,KAAK,MAAMD,EAAM,KAAK,IAAM,KAAK,MAAMC,EAAM,KAAK,CAC5N,CACA,IAAIC,GACJ,SAASC,GAASC,EAAUC,EAAI,CAC9B,OAAO,UAAY,CACjB,GAAI,CAACH,GAAkB,CACrB,IAAII,EAAO,UACTC,EAAQ,KACND,EAAK,SAAW,EAClBF,EAAS,KAAKG,EAAOD,EAAK,CAAC,CAAC,EAE5BF,EAAS,MAAMG,EAAOD,CAAI,EAE5BJ,GAAmB,WAAW,UAAY,CACxCA,GAAmB,MACrB,EAAGG,CAAE,CACP,CACF,CACF,CACA,SAASG,IAAiB,CACxB,aAAaN,EAAgB,EAC7BA,GAAmB,MACrB,CACA,SAASO,GAAStF,EAAIuF,EAAGC,EAAG,CAC1BxF,EAAG,YAAcuF,EACjBvF,EAAG,WAAawF,CAClB,CACA,SAASC,GAAMzF,EAAI,CACjB,IAAI0F,EAAU,OAAO,QACjBC,EAAI,OAAO,QAAU,OAAO,MAChC,OAAID,GAAWA,EAAQ,IACdA,EAAQ,IAAI1F,CAAE,EAAE,UAAU,EAAI,EAC5B2F,EACFA,EAAE3F,CAAE,EAAE,MAAM,EAAI,EAAE,CAAC,EAEnBA,EAAG,UAAU,EAAI,CAE5B,CACA,SAAS4F,GAAQ5F,EAAI6F,EAAM,CACzB9E,EAAIf,EAAI,WAAY,UAAU,EAC9Be,EAAIf,EAAI,MAAO6F,EAAK,GAAG,EACvB9E,EAAIf,EAAI,OAAQ6F,EAAK,IAAI,EACzB9E,EAAIf,EAAI,QAAS6F,EAAK,KAAK,EAC3B9E,EAAIf,EAAI,SAAU6F,EAAK,MAAM,CAC/B,CACA,SAASC,GAAU9F,EAAI,CACrBe,EAAIf,EAAI,WAAY,EAAE,EACtBe,EAAIf,EAAI,MAAO,EAAE,EACjBe,EAAIf,EAAI,OAAQ,EAAE,EAClBe,EAAIf,EAAI,QAAS,EAAE,EACnBe,EAAIf,EAAI,SAAU,EAAE,CACtB,CACA,SAAS+F,GAAkC7D,EAAWsB,EAASwC,EAAS,CACtE,IAAIH,EAAO,CAAC,EACZ,aAAM,KAAK3D,EAAU,QAAQ,EAAE,QAAQ,SAAU+D,EAAO,CACtD,IAAIC,EAAYC,EAAWC,EAAaC,EACxC,GAAI,GAAC9F,EAAQ0F,EAAOzC,EAAQ,UAAWtB,EAAW,EAAK,GAAK+D,EAAM,UAAYA,IAAUD,GACxF,KAAIM,EAAYxE,EAAQmE,CAAK,EAC7BJ,EAAK,KAAO,KAAK,KAAKK,EAAaL,EAAK,QAAU,MAAQK,IAAe,OAASA,EAAa,IAAUI,EAAU,IAAI,EACvHT,EAAK,IAAM,KAAK,KAAKM,EAAYN,EAAK,OAAS,MAAQM,IAAc,OAASA,EAAY,IAAUG,EAAU,GAAG,EACjHT,EAAK,MAAQ,KAAK,KAAKO,EAAcP,EAAK,SAAW,MAAQO,IAAgB,OAASA,EAAc,KAAWE,EAAU,KAAK,EAC9HT,EAAK,OAAS,KAAK,KAAKQ,EAAeR,EAAK,UAAY,MAAQQ,IAAiB,OAASA,EAAe,KAAWC,EAAU,MAAM,EACtI,CAAC,EACDT,EAAK,MAAQA,EAAK,MAAQA,EAAK,KAC/BA,EAAK,OAASA,EAAK,OAASA,EAAK,IACjCA,EAAK,EAAIA,EAAK,KACdA,EAAK,EAAIA,EAAK,IACPA,CACT,CACA,IAAIU,EAAU,WAAa,IAAI,KAAK,EAAE,QAAQ,EAE9C,SAASC,IAAwB,CAC/B,IAAIC,EAAkB,CAAC,EACrBC,EACF,MAAO,CACL,sBAAuB,UAAiC,CAEtD,GADAD,EAAkB,CAAC,EACf,EAAC,KAAK,QAAQ,UAClB,KAAI9C,EAAW,CAAC,EAAE,MAAM,KAAK,KAAK,GAAG,QAAQ,EAC7CA,EAAS,QAAQ,SAAUsC,EAAO,CAChC,GAAI,EAAAlF,EAAIkF,EAAO,SAAS,IAAM,QAAUA,IAAUrC,EAAS,OAC3D,CAAA6C,EAAgB,KAAK,CACnB,OAAQR,EACR,KAAMnE,EAAQmE,CAAK,CACrB,CAAC,EACD,IAAIU,EAAWlJ,GAAe,CAAC,EAAGgJ,EAAgBA,EAAgB,OAAS,CAAC,EAAE,IAAI,EAGlF,GAAIR,EAAM,sBAAuB,CAC/B,IAAIW,EAAczF,GAAO8E,EAAO,EAAI,EAChCW,IACFD,EAAS,KAAOC,EAAY,EAC5BD,EAAS,MAAQC,EAAY,EAEjC,CACAX,EAAM,SAAWU,EACnB,CAAC,EACH,EACA,kBAAmB,SAA2B9F,EAAO,CACnD4F,EAAgB,KAAK5F,CAAK,CAC5B,EACA,qBAAsB,SAA8BnD,EAAQ,CAC1D+I,EAAgB,OAAOrC,GAAcqC,EAAiB,CACpD,OAAQ/I,CACV,CAAC,EAAG,CAAC,CACP,EACA,WAAY,SAAoBuH,EAAU,CACxC,IAAIG,EAAQ,KACZ,GAAI,CAAC,KAAK,QAAQ,UAAW,CAC3B,aAAasB,CAAmB,EAC5B,OAAOzB,GAAa,YAAYA,EAAS,EAC7C,MACF,CACA,IAAI4B,EAAY,GACdC,EAAgB,EAClBL,EAAgB,QAAQ,SAAU5F,EAAO,CACvC,IAAIkG,EAAO,EACTrJ,EAASmD,EAAM,OACf8F,EAAWjJ,EAAO,SAClBsJ,EAASlF,EAAQpE,CAAM,EACvBuJ,EAAevJ,EAAO,aACtBwJ,EAAaxJ,EAAO,WACpByJ,EAAgBtG,EAAM,KACtBuG,EAAejG,GAAOzD,EAAQ,EAAI,EAChC0J,IAEFJ,EAAO,KAAOI,EAAa,EAC3BJ,EAAO,MAAQI,EAAa,GAE9B1J,EAAO,OAASsJ,EACZtJ,EAAO,uBAELkH,GAAYqC,EAAcD,CAAM,GAAK,CAACpC,GAAY+B,EAAUK,CAAM,IAErEG,EAAc,IAAMH,EAAO,MAAQG,EAAc,KAAOH,EAAO,SAAWL,EAAS,IAAMK,EAAO,MAAQL,EAAS,KAAOK,EAAO,QAE9HD,EAAOM,GAAkBF,EAAeF,EAAcC,EAAY9B,EAAM,OAAO,GAK9ER,GAAYoC,EAAQL,CAAQ,IAC/BjJ,EAAO,aAAeiJ,EACtBjJ,EAAO,WAAasJ,EACfD,IACHA,EAAO3B,EAAM,QAAQ,WAEvBA,EAAM,QAAQ1H,EAAQyJ,EAAeH,EAAQD,CAAI,GAE/CA,IACFF,EAAY,GACZC,EAAgB,KAAK,IAAIA,EAAeC,CAAI,EAC5C,aAAarJ,EAAO,mBAAmB,EACvCA,EAAO,oBAAsB,WAAW,UAAY,CAClDA,EAAO,cAAgB,EACvBA,EAAO,aAAe,KACtBA,EAAO,SAAW,KAClBA,EAAO,WAAa,KACpBA,EAAO,sBAAwB,IACjC,EAAGqJ,CAAI,EACPrJ,EAAO,sBAAwBqJ,EAEnC,CAAC,EACD,aAAaL,CAAmB,EAC3BG,EAGHH,EAAsB,WAAW,UAAY,CACvC,OAAOzB,GAAa,YAAYA,EAAS,CAC/C,EAAG6B,CAAa,EAJZ,OAAO7B,GAAa,YAAYA,EAAS,EAM/CwB,EAAkB,CAAC,CACrB,EACA,QAAS,SAAiB/I,EAAQ4J,EAAaN,EAAQO,EAAU,CAC/D,GAAIA,EAAU,CACZxG,EAAIrD,EAAQ,aAAc,EAAE,EAC5BqD,EAAIrD,EAAQ,YAAa,EAAE,EAC3B,IAAIiF,EAAWxB,GAAO,KAAK,EAAE,EAC3ByB,EAASD,GAAYA,EAAS,EAC9BE,EAASF,GAAYA,EAAS,EAC9B6E,GAAcF,EAAY,KAAON,EAAO,OAASpE,GAAU,GAC3D6E,GAAcH,EAAY,IAAMN,EAAO,MAAQnE,GAAU,GAC3DnF,EAAO,WAAa,CAAC,CAAC8J,EACtB9J,EAAO,WAAa,CAAC,CAAC+J,EACtB1G,EAAIrD,EAAQ,YAAa,eAAiB8J,EAAa,MAAQC,EAAa,OAAO,EACnF,KAAK,gBAAkBC,GAAQhK,CAAM,EAErCqD,EAAIrD,EAAQ,aAAc,aAAe6J,EAAW,MAAQ,KAAK,QAAQ,OAAS,IAAM,KAAK,QAAQ,OAAS,GAAG,EACjHxG,EAAIrD,EAAQ,YAAa,oBAAoB,EAC7C,OAAOA,EAAO,UAAa,UAAY,aAAaA,EAAO,QAAQ,EACnEA,EAAO,SAAW,WAAW,UAAY,CACvCqD,EAAIrD,EAAQ,aAAc,EAAE,EAC5BqD,EAAIrD,EAAQ,YAAa,EAAE,EAC3BA,EAAO,SAAW,GAClBA,EAAO,WAAa,GACpBA,EAAO,WAAa,EACtB,EAAG6J,CAAQ,CACb,CACF,CACF,CACF,CACA,SAASG,GAAQhK,EAAQ,CACvB,OAAOA,EAAO,WAChB,CACA,SAAS2J,GAAkBF,EAAeR,EAAUK,EAAQxD,EAAS,CACnE,OAAO,KAAK,KAAK,KAAK,IAAImD,EAAS,IAAMQ,EAAc,IAAK,CAAC,EAAI,KAAK,IAAIR,EAAS,KAAOQ,EAAc,KAAM,CAAC,CAAC,EAAI,KAAK,KAAK,KAAK,IAAIR,EAAS,IAAMK,EAAO,IAAK,CAAC,EAAI,KAAK,IAAIL,EAAS,KAAOK,EAAO,KAAM,CAAC,CAAC,EAAIxD,EAAQ,SAC7N,CAEA,IAAImE,GAAU,CAAC,EACXC,GAAW,CACb,oBAAqB,EACvB,EACIC,GAAgB,CAClB,MAAO,SAAeC,EAAQ,CAE5B,QAASC,KAAUH,GACbA,GAAS,eAAeG,CAAM,GAAK,EAAEA,KAAUD,KACjDA,EAAOC,CAAM,EAAIH,GAASG,CAAM,GAGpCJ,GAAQ,QAAQ,SAAUK,EAAG,CAC3B,GAAIA,EAAE,aAAeF,EAAO,WAC1B,KAAM,iCAAiC,OAAOA,EAAO,WAAY,iBAAiB,CAEtF,CAAC,EACDH,GAAQ,KAAKG,CAAM,CACrB,EACA,YAAa,SAAqBG,EAAWC,EAAUC,EAAK,CAC1D,IAAI/C,EAAQ,KACZ,KAAK,cAAgB,GACrB+C,EAAI,OAAS,UAAY,CACvB/C,EAAM,cAAgB,EACxB,EACA,IAAIgD,EAAkBH,EAAY,SAClCN,GAAQ,QAAQ,SAAUG,EAAQ,CAC3BI,EAASJ,EAAO,UAAU,IAE3BI,EAASJ,EAAO,UAAU,EAAEM,CAAe,GAC7CF,EAASJ,EAAO,UAAU,EAAEM,CAAe,EAAE3K,GAAe,CAC1D,SAAUyK,CACZ,EAAGC,CAAG,CAAC,EAKLD,EAAS,QAAQJ,EAAO,UAAU,GAAKI,EAASJ,EAAO,UAAU,EAAEG,CAAS,GAC9EC,EAASJ,EAAO,UAAU,EAAEG,CAAS,EAAExK,GAAe,CACpD,SAAUyK,CACZ,EAAGC,CAAG,CAAC,EAEX,CAAC,CACH,EACA,kBAAmB,SAA2BD,EAAUlI,EAAI4H,EAAUpE,EAAS,CAC7EmE,GAAQ,QAAQ,SAAUG,EAAQ,CAChC,IAAIO,EAAaP,EAAO,WACxB,GAAI,GAACI,EAAS,QAAQG,CAAU,GAAK,CAACP,EAAO,qBAC7C,KAAIQ,EAAc,IAAIR,EAAOI,EAAUlI,EAAIkI,EAAS,OAAO,EAC3DI,EAAY,SAAWJ,EACvBI,EAAY,QAAUJ,EAAS,QAC/BA,EAASG,CAAU,EAAIC,EAGvBpK,EAAS0J,EAAUU,EAAY,QAAQ,EACzC,CAAC,EACD,QAASP,KAAUG,EAAS,QAC1B,GAAKA,EAAS,QAAQ,eAAeH,CAAM,EAC3C,KAAIQ,EAAW,KAAK,aAAaL,EAAUH,EAAQG,EAAS,QAAQH,CAAM,CAAC,EACvE,OAAOQ,EAAa,MACtBL,EAAS,QAAQH,CAAM,EAAIQ,GAGjC,EACA,mBAAoB,SAA4B3H,EAAMsH,EAAU,CAC9D,IAAIM,EAAkB,CAAC,EACvB,OAAAb,GAAQ,QAAQ,SAAUG,EAAQ,CAC5B,OAAOA,EAAO,iBAAoB,YACtC5J,EAASsK,EAAiBV,EAAO,gBAAgB,KAAKI,EAASJ,EAAO,UAAU,EAAGlH,CAAI,CAAC,CAC1F,CAAC,EACM4H,CACT,EACA,aAAc,SAAsBN,EAAUtH,EAAM3C,EAAO,CACzD,IAAIwK,EACJ,OAAAd,GAAQ,QAAQ,SAAUG,EAAQ,CAE3BI,EAASJ,EAAO,UAAU,GAG3BA,EAAO,iBAAmB,OAAOA,EAAO,gBAAgBlH,CAAI,GAAM,aACpE6H,EAAgBX,EAAO,gBAAgBlH,CAAI,EAAE,KAAKsH,EAASJ,EAAO,UAAU,EAAG7J,CAAK,EAExF,CAAC,EACMwK,CACT,CACF,EAEA,SAASC,GAAcC,EAAM,CAC3B,IAAIT,EAAWS,EAAK,SAClBC,EAASD,EAAK,OACd/H,EAAO+H,EAAK,KACZE,EAAWF,EAAK,SAChBG,EAAUH,EAAK,QACfI,EAAOJ,EAAK,KACZK,EAASL,EAAK,OACdM,EAAWN,EAAK,SAChBO,EAAWP,EAAK,SAChBQ,EAAoBR,EAAK,kBACzBS,EAAoBT,EAAK,kBACzBU,EAAgBV,EAAK,cACrBW,EAAcX,EAAK,YACnBY,EAAuBZ,EAAK,qBAE9B,GADAT,EAAWA,GAAYU,GAAUA,EAAOrC,CAAO,EAC3C,EAAC2B,EACL,KAAIC,EACF3E,EAAU0E,EAAS,QACnBsB,EAAS,KAAO5I,EAAK,OAAO,CAAC,EAAE,YAAY,EAAIA,EAAK,OAAO,CAAC,EAE1D,OAAO,aAAe,CAACpB,IAAc,CAACC,GACxC0I,EAAM,IAAI,YAAYvH,EAAM,CAC1B,QAAS,GACT,WAAY,EACd,CAAC,GAEDuH,EAAM,SAAS,YAAY,OAAO,EAClCA,EAAI,UAAUvH,EAAM,GAAM,EAAI,GAEhCuH,EAAI,GAAKY,GAAQH,EACjBT,EAAI,KAAOa,GAAUJ,EACrBT,EAAI,KAAOU,GAAYD,EACvBT,EAAI,MAAQW,EACZX,EAAI,SAAWc,EACfd,EAAI,SAAWe,EACff,EAAI,kBAAoBgB,EACxBhB,EAAI,kBAAoBiB,EACxBjB,EAAI,cAAgBkB,EACpBlB,EAAI,SAAWmB,EAAcA,EAAY,YAAc,OACvD,IAAIG,EAAqBhM,GAAeA,GAAe,CAAC,EAAG8L,CAAoB,EAAG1B,GAAc,mBAAmBjH,EAAMsH,CAAQ,CAAC,EAClI,QAASH,KAAU0B,EACjBtB,EAAIJ,CAAM,EAAI0B,EAAmB1B,CAAM,EAErCa,GACFA,EAAO,cAAcT,CAAG,EAEtB3E,EAAQgG,CAAM,GAChBhG,EAAQgG,CAAM,EAAE,KAAKtB,EAAUC,CAAG,EAEtC,CAEA,IAAIuB,GAAY,CAAC,KAAK,EAClBC,EAAc,SAAqB1B,EAAWC,EAAU,CAC1D,IAAIS,EAAO,UAAU,OAAS,GAAK,UAAU,CAAC,IAAM,OAAY,UAAU,CAAC,EAAI,CAAC,EAC9EU,EAAgBV,EAAK,IACrBiB,EAAOtL,GAAyBqK,EAAMe,EAAS,EACjD7B,GAAc,YAAY,KAAKjE,CAAQ,EAAEqE,EAAWC,EAAUzK,GAAe,CAC3E,OAAQoM,EACR,SAAUC,EACV,QAAS9D,EACT,OAAQ4C,EACR,OAAQmB,GACR,WAAYC,GACZ,QAASlB,EACT,YAAamB,GACb,YAAaC,GACb,YAAaZ,EACb,eAAgB1F,EAAS,OACzB,cAAeyF,EACf,SAAUJ,GACV,kBAAmBE,GACnB,SAAUD,EACV,kBAAmBE,GACnB,mBAAoBe,GACpB,qBAAsBC,GACtB,eAAgB,UAA0B,CACxCH,GAAc,EAChB,EACA,cAAe,UAAyB,CACtCA,GAAc,EAChB,EACA,sBAAuB,SAA+BrJ,EAAM,CAC1DyJ,EAAe,CACb,SAAUnC,EACV,KAAMtH,EACN,cAAeyI,CACjB,CAAC,CACH,CACF,EAAGO,CAAI,CAAC,CACV,EACA,SAASS,EAAeC,EAAM,CAC5B5B,GAAcjL,GAAe,CAC3B,YAAa6L,EACb,QAASR,EACT,SAAUe,EACV,OAAQjB,EACR,SAAUK,GACV,kBAAmBE,GACnB,SAAUD,EACV,kBAAmBE,EACrB,EAAGkB,CAAI,CAAC,CACV,CACA,IAAIT,EACFC,EACA9D,EACA4C,EACAmB,GACAC,GACAlB,EACAmB,GACAhB,GACAC,EACAC,GACAC,GACAmB,GACAjB,EACAkB,GAAsB,GACtBC,GAAkB,GAClBC,GAAY,CAAC,EACbC,GACAC,EACAC,GACAC,GACAC,GACAC,GACAd,GACAe,GACAC,GACAC,GAAwB,GACxBC,GAAyB,GACzBC,GAEAC,EACAC,GAAmC,CAAC,EAGpCC,GAAU,GACVC,GAAoB,CAAC,EAGnBC,GAAiB,OAAO,SAAa,IACvCC,GAA0B/L,GAC1BgM,GAAmBnM,IAAQD,GAAa,WAAa,QAErDqM,GAAmBH,IAAkB,CAAC7L,IAAoB,CAACD,IAAO,cAAe,SAAS,cAAc,KAAK,EAC7GkM,GAA0B,UAAY,CACpC,GAAKJ,GAEL,IAAIlM,GACF,MAAO,GAET,IAAIQ,EAAK,SAAS,cAAc,GAAG,EACnC,OAAAA,EAAG,MAAM,QAAU,sBACZA,EAAG,MAAM,gBAAkB,OACpC,EAAE,EACF+L,GAAmB,SAA0B/L,EAAIwD,EAAS,CACxD,IAAIwI,EAAQjL,EAAIf,CAAE,EAChBiM,EAAU,SAASD,EAAM,KAAK,EAAI,SAASA,EAAM,WAAW,EAAI,SAASA,EAAM,YAAY,EAAI,SAASA,EAAM,eAAe,EAAI,SAASA,EAAM,gBAAgB,EAChKE,EAAS5I,GAAStD,EAAI,EAAGwD,CAAO,EAChC2I,EAAS7I,GAAStD,EAAI,EAAGwD,CAAO,EAChC4I,EAAgBF,GAAUnL,EAAImL,CAAM,EACpCG,EAAiBF,GAAUpL,EAAIoL,CAAM,EACrCG,EAAkBF,GAAiB,SAASA,EAAc,UAAU,EAAI,SAASA,EAAc,WAAW,EAAItK,EAAQoK,CAAM,EAAE,MAC9HK,EAAmBF,GAAkB,SAASA,EAAe,UAAU,EAAI,SAASA,EAAe,WAAW,EAAIvK,EAAQqK,CAAM,EAAE,MACpI,GAAIH,EAAM,UAAY,OACpB,OAAOA,EAAM,gBAAkB,UAAYA,EAAM,gBAAkB,iBAAmB,WAAa,aAErG,GAAIA,EAAM,UAAY,OACpB,OAAOA,EAAM,oBAAoB,MAAM,GAAG,EAAE,QAAU,EAAI,WAAa,aAEzE,GAAIE,GAAUE,EAAc,OAAYA,EAAc,QAAa,OAAQ,CACzE,IAAII,EAAqBJ,EAAc,QAAa,OAAS,OAAS,QACtE,OAAOD,IAAWE,EAAe,QAAU,QAAUA,EAAe,QAAUG,GAAsB,WAAa,YACnH,CACA,OAAON,IAAWE,EAAc,UAAY,SAAWA,EAAc,UAAY,QAAUA,EAAc,UAAY,SAAWA,EAAc,UAAY,QAAUE,GAAmBL,GAAWD,EAAMJ,EAAgB,IAAM,QAAUO,GAAUH,EAAMJ,EAAgB,IAAM,QAAUU,EAAkBC,EAAmBN,GAAW,WAAa,YACvV,EACAQ,GAAqB,SAA4BC,EAAUC,EAAYC,EAAU,CAC/E,IAAIC,EAAcD,EAAWF,EAAS,KAAOA,EAAS,IACpDI,EAAcF,EAAWF,EAAS,MAAQA,EAAS,OACnDK,EAAkBH,EAAWF,EAAS,MAAQA,EAAS,OACvDM,EAAcJ,EAAWD,EAAW,KAAOA,EAAW,IACtDM,EAAcL,EAAWD,EAAW,MAAQA,EAAW,OACvDO,EAAkBN,EAAWD,EAAW,MAAQA,EAAW,OAC7D,OAAOE,IAAgBG,GAAeF,IAAgBG,GAAeJ,EAAcE,EAAkB,IAAMC,EAAcE,EAAkB,CAC7I,EAOAC,GAA8B,SAAqC5H,EAAGC,EAAG,CACvE,IAAI4H,EACJ,OAAA1C,GAAU,KAAK,SAAUxC,EAAU,CACjC,IAAImF,EAAYnF,EAAS3B,CAAO,EAAE,QAAQ,qBAC1C,GAAI,GAAC8G,GAAaxJ,GAAUqE,CAAQ,GACpC,KAAIrC,EAAO/D,EAAQoG,CAAQ,EACzBoF,EAAqB/H,GAAKM,EAAK,KAAOwH,GAAa9H,GAAKM,EAAK,MAAQwH,EACrEE,EAAmB/H,GAAKK,EAAK,IAAMwH,GAAa7H,GAAKK,EAAK,OAASwH,EACrE,GAAIC,GAAsBC,EACxB,OAAOH,EAAMlF,EAEjB,CAAC,EACMkF,CACT,EACAI,GAAgB,SAAuBhK,EAAS,CAC9C,SAASiK,EAAKxP,EAAOyP,EAAM,CACzB,OAAO,SAAUC,EAAIC,EAAM/D,EAAQ1B,EAAK,CACtC,IAAI0F,EAAYF,EAAG,QAAQ,MAAM,MAAQC,EAAK,QAAQ,MAAM,MAAQD,EAAG,QAAQ,MAAM,OAASC,EAAK,QAAQ,MAAM,KACjH,GAAI3P,GAAS,OAASyP,GAAQG,GAG5B,MAAO,GACF,GAAI5P,GAAS,MAAQA,IAAU,GACpC,MAAO,GACF,GAAIyP,GAAQzP,IAAU,QAC3B,OAAOA,EACF,GAAI,OAAOA,GAAU,WAC1B,OAAOwP,EAAKxP,EAAM0P,EAAIC,EAAM/D,EAAQ1B,CAAG,EAAGuF,CAAI,EAAEC,EAAIC,EAAM/D,EAAQ1B,CAAG,EAErE,IAAI2F,GAAcJ,EAAOC,EAAKC,GAAM,QAAQ,MAAM,KAClD,OAAO3P,IAAU,IAAQ,OAAOA,GAAU,UAAYA,IAAU6P,GAAc7P,EAAM,MAAQA,EAAM,QAAQ6P,CAAU,EAAI,EAE5H,CACF,CACA,IAAIC,EAAQ,CAAC,EACTC,EAAgBxK,EAAQ,OACxB,CAACwK,GAAiBjQ,GAAQiQ,CAAa,GAAK,YAC9CA,EAAgB,CACd,KAAMA,CACR,GAEFD,EAAM,KAAOC,EAAc,KAC3BD,EAAM,UAAYN,EAAKO,EAAc,KAAM,EAAI,EAC/CD,EAAM,SAAWN,EAAKO,EAAc,GAAG,EACvCD,EAAM,YAAcC,EAAc,YAClCxK,EAAQ,MAAQuK,CAClB,EACA5D,GAAsB,UAA+B,CAC/C,CAAC2B,IAA2B9F,GAC9BjF,EAAIiF,EAAS,UAAW,MAAM,CAElC,EACAoE,GAAwB,UAAiC,CACnD,CAAC0B,IAA2B9F,GAC9BjF,EAAIiF,EAAS,UAAW,EAAE,CAE9B,EAGE0F,IAAkB,CAAC7L,IACrB,SAAS,iBAAiB,QAAS,SAAUsI,EAAK,CAChD,GAAIsC,GACF,OAAAtC,EAAI,eAAe,EACnBA,EAAI,iBAAmBA,EAAI,gBAAgB,EAC3CA,EAAI,0BAA4BA,EAAI,yBAAyB,EAC7DsC,GAAkB,GACX,EAEX,EAAG,EAAI,EAET,IAAIwD,GAAgC,SAAuC9F,EAAK,CAC9E,GAAI0B,EAAQ,CACV1B,EAAMA,EAAI,QAAUA,EAAI,QAAQ,CAAC,EAAIA,EACrC,IAAI+F,EAAUf,GAA4BhF,EAAI,QAASA,EAAI,OAAO,EAClE,GAAI+F,EAAS,CAEX,IAAIjO,EAAQ,CAAC,EACb,QAAStC,KAAKwK,EACRA,EAAI,eAAexK,CAAC,IACtBsC,EAAMtC,CAAC,EAAIwK,EAAIxK,CAAC,GAGpBsC,EAAM,OAASA,EAAM,OAASiO,EAC9BjO,EAAM,eAAiB,OACvBA,EAAM,gBAAkB,OACxBiO,EAAQ3H,CAAO,EAAE,YAAYtG,CAAK,CACpC,CACF,CACF,EACIkO,GAAwB,SAA+BhG,EAAK,CAC1D0B,GACFA,EAAO,WAAWtD,CAAO,EAAE,iBAAiB4B,EAAI,MAAM,CAE1D,EAOA,SAASvE,EAAS5D,EAAIwD,EAAS,CAC7B,GAAI,EAAExD,GAAMA,EAAG,UAAYA,EAAG,WAAa,GACzC,KAAM,8CAA8C,OAAO,CAAC,EAAE,SAAS,KAAKA,CAAE,CAAC,EAEjF,KAAK,GAAKA,EACV,KAAK,QAAUwD,EAAUtF,EAAS,CAAC,EAAGsF,CAAO,EAG7CxD,EAAGuG,CAAO,EAAI,KACd,IAAIqB,EAAW,CACb,MAAO,KACP,KAAM,GACN,SAAU,GACV,MAAO,KACP,OAAQ,KACR,UAAW,WAAW,KAAK5H,EAAG,QAAQ,EAAI,MAAQ,KAClD,cAAe,EAEf,WAAY,GAEZ,sBAAuB,KAEvB,kBAAmB,GACnB,UAAW,UAAqB,CAC9B,OAAO+L,GAAiB/L,EAAI,KAAK,OAAO,CAC1C,EACA,WAAY,iBACZ,YAAa,kBACb,UAAW,gBACX,OAAQ,SACR,OAAQ,KACR,gBAAiB,GACjB,UAAW,EACX,OAAQ,KACR,QAAS,SAAiBoO,EAAcvE,EAAQ,CAC9CuE,EAAa,QAAQ,OAAQvE,EAAO,WAAW,CACjD,EACA,WAAY,GACZ,eAAgB,GAChB,WAAY,UACZ,MAAO,EACP,iBAAkB,GAClB,qBAAsB,OAAO,SAAW,OAAS,QAAQ,SAAS,OAAO,iBAAkB,EAAE,GAAK,EAClG,cAAe,GACf,cAAe,oBACf,eAAgB,GAChB,kBAAmB,EACnB,eAAgB,CACd,EAAG,EACH,EAAG,CACL,EACA,eAAgBjG,EAAS,iBAAmB,IAAS,iBAAkB,QAAU,CAACjE,GAClF,qBAAsB,CACxB,EACAkI,GAAc,kBAAkB,KAAM7H,EAAI4H,CAAQ,EAGlD,QAAShH,KAAQgH,EACf,EAAEhH,KAAQ4C,KAAaA,EAAQ5C,CAAI,EAAIgH,EAAShH,CAAI,GAEtD4M,GAAchK,CAAO,EAGrB,QAAStD,KAAM,KACTA,EAAG,OAAO,CAAC,IAAM,KAAO,OAAO,KAAKA,CAAE,GAAM,aAC9C,KAAKA,CAAE,EAAI,KAAKA,CAAE,EAAE,KAAK,IAAI,GAKjC,KAAK,gBAAkBsD,EAAQ,cAAgB,GAAQqI,GACnD,KAAK,kBAEP,KAAK,QAAQ,oBAAsB,GAIjCrI,EAAQ,eACVzD,EAAGC,EAAI,cAAe,KAAK,WAAW,GAEtCD,EAAGC,EAAI,YAAa,KAAK,WAAW,EACpCD,EAAGC,EAAI,aAAc,KAAK,WAAW,GAEnC,KAAK,kBACPD,EAAGC,EAAI,WAAY,IAAI,EACvBD,EAAGC,EAAI,YAAa,IAAI,GAE1B0K,GAAU,KAAK,KAAK,EAAE,EAGtBlH,EAAQ,OAASA,EAAQ,MAAM,KAAO,KAAK,KAAKA,EAAQ,MAAM,IAAI,IAAI,GAAK,CAAC,CAAC,EAG7EtF,EAAS,KAAMsI,GAAsB,CAAC,CACxC,CACA5C,EAAS,UAA4C,CACnD,YAAaA,EACb,iBAAkB,SAA0BlG,EAAQ,CAC9C,CAAC,KAAK,GAAG,SAASA,CAAM,GAAKA,IAAW,KAAK,KAC/CuN,GAAa,KAEjB,EACA,cAAe,SAAuB9C,EAAKzK,EAAQ,CACjD,OAAO,OAAO,KAAK,QAAQ,WAAc,WAAa,KAAK,QAAQ,UAAU,KAAK,KAAMyK,EAAKzK,EAAQmM,CAAM,EAAI,KAAK,QAAQ,SAC9H,EACA,YAAa,SAA6C1B,EAAK,CAC7D,GAAKA,EAAI,WACT,KAAI/C,EAAQ,KACVpF,EAAK,KAAK,GACVwD,EAAU,KAAK,QACf6K,EAAkB7K,EAAQ,gBAC1B8K,EAAOnG,EAAI,KACXoG,EAAQpG,EAAI,SAAWA,EAAI,QAAQ,CAAC,GAAKA,EAAI,aAAeA,EAAI,cAAgB,SAAWA,EAC3FzK,GAAU6Q,GAASpG,GAAK,OACxBqG,EAAiBrG,EAAI,OAAO,aAAeA,EAAI,MAAQA,EAAI,KAAK,CAAC,GAAKA,EAAI,cAAgBA,EAAI,aAAa,EAAE,CAAC,IAAMzK,EACpH+Q,EAASjL,EAAQ,OAInB,GAHAkL,GAAuB1O,CAAE,EAGrB,CAAA6J,GAGA,0BAAwB,KAAKyE,CAAI,GAAKnG,EAAI,SAAW,GAAK3E,EAAQ,WAKlE,CAAAgL,EAAe,mBAKf,GAAC,KAAK,iBAAmB7O,IAAUjC,GAAUA,EAAO,QAAQ,YAAY,IAAM,YAGlFA,EAAS6C,EAAQ7C,EAAQ8F,EAAQ,UAAWxD,EAAI,EAAK,EACjD,EAAAtC,GAAUA,EAAO,WAGjBsM,KAAetM,GAUnB,IAJAuL,GAAWlF,EAAMrG,CAAM,EACvByL,GAAoBpF,EAAMrG,EAAQ8F,EAAQ,SAAS,EAG/C,OAAOiL,GAAW,YACpB,GAAIA,EAAO,KAAK,KAAMtG,EAAKzK,EAAQ,IAAI,EAAG,CACxC2M,EAAe,CACb,SAAUjF,EACV,OAAQoJ,EACR,KAAM,SACN,SAAU9Q,EACV,KAAMsC,EACN,OAAQA,CACV,CAAC,EACD2J,EAAY,SAAUvE,EAAO,CAC3B,IAAK+C,CACP,CAAC,EACDkG,GAAmBlG,EAAI,YAAcA,EAAI,eAAe,EACxD,MACF,UACSsG,IACTA,EAASA,EAAO,MAAM,GAAG,EAAE,KAAK,SAAUE,EAAU,CAElD,GADAA,EAAWpO,EAAQiO,EAAgBG,EAAS,KAAK,EAAG3O,EAAI,EAAK,EACzD2O,EACF,OAAAtE,EAAe,CACb,SAAUjF,EACV,OAAQuJ,EACR,KAAM,SACN,SAAUjR,EACV,OAAQsC,EACR,KAAMA,CACR,CAAC,EACD2J,EAAY,SAAUvE,EAAO,CAC3B,IAAK+C,CACP,CAAC,EACM,EAEX,CAAC,EACGsG,GAAQ,CACVJ,GAAmBlG,EAAI,YAAcA,EAAI,eAAe,EACxD,MACF,CAEE3E,EAAQ,QAAU,CAACjD,EAAQiO,EAAgBhL,EAAQ,OAAQxD,EAAI,EAAK,GAKxE,KAAK,kBAAkBmI,EAAKoG,EAAO7Q,CAAM,GAC3C,EACA,kBAAmB,SAAwCyK,EAAiBoG,EAAyB7Q,EAAQ,CAC3G,IAAI0H,EAAQ,KACVpF,EAAKoF,EAAM,GACX5B,EAAU4B,EAAM,QAChBwJ,EAAgB5O,EAAG,cACnB6O,EACF,GAAInR,GAAU,CAACmM,GAAUnM,EAAO,aAAesC,EAAI,CACjD,IAAI0M,EAAW5K,EAAQpE,CAAM,EAoE7B,GAnEAkL,EAAS5I,EACT6J,EAASnM,EACToM,EAAWD,EAAO,WAClBE,GAASF,EAAO,YAChBG,GAAatM,EACb6M,GAAc/G,EAAQ,MACtBI,EAAS,QAAUiG,EACnBc,GAAS,CACP,OAAQd,EACR,SAAU0E,GAASpG,GAAK,QACxB,SAAUoG,GAASpG,GAAK,OAC1B,EACA4C,GAAkBJ,GAAO,QAAU+B,EAAS,KAC5C1B,GAAiBL,GAAO,QAAU+B,EAAS,IAC3C,KAAK,QAAU6B,GAASpG,GAAK,QAC7B,KAAK,QAAUoG,GAASpG,GAAK,QAC7B0B,EAAO,MAAM,aAAa,EAAI,MAC9BgF,EAAc,UAAuB,CAInC,GAHAlF,EAAY,aAAcvE,EAAO,CAC/B,IAAK+C,CACP,CAAC,EACGvE,EAAS,cAAe,CAC1BwB,EAAM,QAAQ,EACd,MACF,CAGAA,EAAM,0BAA0B,EAC5B,CAAC1F,IAAW0F,EAAM,kBACpByE,EAAO,UAAY,IAIrBzE,EAAM,kBAAkB+C,EAAKoG,CAAK,EAGlClE,EAAe,CACb,SAAUjF,EACV,KAAM,SACN,cAAe+C,CACjB,CAAC,EAGDxH,EAAYkJ,EAAQrG,EAAQ,YAAa,EAAI,CAC/C,EAGAA,EAAQ,OAAO,MAAM,GAAG,EAAE,QAAQ,SAAUmL,EAAU,CACpDnN,GAAKqI,EAAQ8E,EAAS,KAAK,EAAGG,EAAiB,CACjD,CAAC,EACD/O,EAAG6O,EAAe,WAAYX,EAA6B,EAC3DlO,EAAG6O,EAAe,YAAaX,EAA6B,EAC5DlO,EAAG6O,EAAe,YAAaX,EAA6B,EAC5DlO,EAAG6O,EAAe,UAAWxJ,EAAM,OAAO,EAC1CrF,EAAG6O,EAAe,WAAYxJ,EAAM,OAAO,EAC3CrF,EAAG6O,EAAe,cAAexJ,EAAM,OAAO,EAG1C1F,IAAW,KAAK,kBAClB,KAAK,QAAQ,oBAAsB,EACnCmK,EAAO,UAAY,IAErBF,EAAY,aAAc,KAAM,CAC9B,IAAKxB,CACP,CAAC,EAGG3E,EAAQ,QAAU,CAACA,EAAQ,kBAAoB+K,KAAW,CAAC,KAAK,iBAAmB,EAAE9O,IAAQD,KAAc,CAC7G,GAAIoE,EAAS,cAAe,CAC1B,KAAK,QAAQ,EACb,MACF,CAIA7D,EAAG6O,EAAe,UAAWxJ,EAAM,mBAAmB,EACtDrF,EAAG6O,EAAe,WAAYxJ,EAAM,mBAAmB,EACvDrF,EAAG6O,EAAe,cAAexJ,EAAM,mBAAmB,EAC1DrF,EAAG6O,EAAe,YAAaxJ,EAAM,4BAA4B,EACjErF,EAAG6O,EAAe,YAAaxJ,EAAM,4BAA4B,EACjE5B,EAAQ,gBAAkBzD,EAAG6O,EAAe,cAAexJ,EAAM,4BAA4B,EAC7FA,EAAM,gBAAkB,WAAWyJ,EAAarL,EAAQ,KAAK,CAC/D,MACEqL,EAAY,CAEhB,CACF,EACA,6BAA8B,SAAsEE,EAAG,CACrG,IAAIR,EAAQQ,EAAE,QAAUA,EAAE,QAAQ,CAAC,EAAIA,EACnC,KAAK,IAAI,KAAK,IAAIR,EAAM,QAAU,KAAK,MAAM,EAAG,KAAK,IAAIA,EAAM,QAAU,KAAK,MAAM,CAAC,GAAK,KAAK,MAAM,KAAK,QAAQ,qBAAuB,KAAK,iBAAmB,OAAO,kBAAoB,EAAE,GAChM,KAAK,oBAAoB,CAE7B,EACA,oBAAqB,UAA+B,CAClD1E,GAAUiF,GAAkBjF,CAAM,EAClC,aAAa,KAAK,eAAe,EACjC,KAAK,0BAA0B,CACjC,EACA,0BAA2B,UAAqC,CAC9D,IAAI+E,EAAgB,KAAK,GAAG,cAC5BzO,EAAIyO,EAAe,UAAW,KAAK,mBAAmB,EACtDzO,EAAIyO,EAAe,WAAY,KAAK,mBAAmB,EACvDzO,EAAIyO,EAAe,cAAe,KAAK,mBAAmB,EAC1DzO,EAAIyO,EAAe,YAAa,KAAK,4BAA4B,EACjEzO,EAAIyO,EAAe,YAAa,KAAK,4BAA4B,EACjEzO,EAAIyO,EAAe,cAAe,KAAK,4BAA4B,CACrE,EACA,kBAAmB,SAAwCzG,EAAiBoG,EAAO,CACjFA,EAAQA,GAASpG,EAAI,aAAe,SAAWA,EAC3C,CAAC,KAAK,iBAAmBoG,EACvB,KAAK,QAAQ,eACfxO,EAAG,SAAU,cAAe,KAAK,YAAY,EACpCwO,EACTxO,EAAG,SAAU,YAAa,KAAK,YAAY,EAE3CA,EAAG,SAAU,YAAa,KAAK,YAAY,GAG7CA,EAAG8J,EAAQ,UAAW,IAAI,EAC1B9J,EAAG6I,EAAQ,YAAa,KAAK,YAAY,GAE3C,GAAI,CACE,SAAS,UAEXoG,GAAU,UAAY,CACpB,SAAS,UAAU,MAAM,CAC3B,CAAC,EAED,OAAO,aAAa,EAAE,gBAAgB,CAE1C,MAAc,CAAC,CACjB,EACA,aAAc,SAAsBC,EAAU9G,EAAK,CAEjD,GADAqC,GAAsB,GAClB5B,GAAUiB,EAAQ,CACpBF,EAAY,cAAe,KAAM,CAC/B,IAAKxB,CACP,CAAC,EACG,KAAK,iBACPpI,EAAG,SAAU,WAAYoO,EAAqB,EAEhD,IAAI3K,EAAU,KAAK,QAGnB,CAACyL,GAAYtO,EAAYkJ,EAAQrG,EAAQ,UAAW,EAAK,EACzD7C,EAAYkJ,EAAQrG,EAAQ,WAAY,EAAI,EAC5CI,EAAS,OAAS,KAClBqL,GAAY,KAAK,aAAa,EAG9B5E,EAAe,CACb,SAAU,KACV,KAAM,QACN,cAAelC,CACjB,CAAC,CACH,MACE,KAAK,SAAS,CAElB,EACA,iBAAkB,UAA4B,CAC5C,GAAIyC,EAAU,CACZ,KAAK,OAASA,EAAS,QACvB,KAAK,OAASA,EAAS,QACvBT,GAAoB,EAGpB,QAFIzM,EAAS,SAAS,iBAAiBkN,EAAS,QAASA,EAAS,OAAO,EACrE3H,EAASvF,EACNA,GAAUA,EAAO,aACtBA,EAASA,EAAO,WAAW,iBAAiBkN,EAAS,QAASA,EAAS,OAAO,EAC1ElN,IAAWuF,IACfA,EAASvF,EAGX,GADAmM,EAAO,WAAWtD,CAAO,EAAE,iBAAiB7I,CAAM,EAC9CuF,EACF,EAAG,CACD,GAAIA,EAAOsD,CAAO,EAAG,CACnB,IAAI2I,EAAW,OAOf,GANAA,EAAWjM,EAAOsD,CAAO,EAAE,YAAY,CACrC,QAASqE,EAAS,QAClB,QAASA,EAAS,QAClB,OAAQlN,EACR,OAAQuF,CACV,CAAC,EACGiM,GAAY,CAAC,KAAK,QAAQ,eAC5B,KAEJ,CACAxR,EAASuF,CACX,OAC8BA,EAASA,EAAO,YAEhDmH,GAAsB,CACxB,CACF,EACA,aAAc,SAAsCjC,EAAK,CACvD,GAAIwC,GAAQ,CACV,IAAInH,EAAU,KAAK,QACjB2L,EAAoB3L,EAAQ,kBAC5B4L,EAAiB5L,EAAQ,eACzB+K,EAAQpG,EAAI,QAAUA,EAAI,QAAQ,CAAC,EAAIA,EACvCkH,EAAcrJ,GAAW7E,GAAO6E,EAAS,EAAI,EAC7CpD,EAASoD,GAAWqJ,GAAeA,EAAY,EAC/CxM,EAASmD,GAAWqJ,GAAeA,EAAY,EAC/CC,EAAuB3D,IAA2BL,GAAuBtH,GAAwBsH,CAAmB,EACpHiE,GAAMhB,EAAM,QAAU5D,GAAO,QAAUyE,EAAe,IAAMxM,GAAU,IAAM0M,EAAuBA,EAAqB,CAAC,EAAI/D,GAAiC,CAAC,EAAI,IAAM3I,GAAU,GACnL4M,GAAMjB,EAAM,QAAU5D,GAAO,QAAUyE,EAAe,IAAMvM,GAAU,IAAMyM,EAAuBA,EAAqB,CAAC,EAAI/D,GAAiC,CAAC,EAAI,IAAM1I,GAAU,GAGrL,GAAI,CAACe,EAAS,QAAU,CAAC4G,GAAqB,CAC5C,GAAI2E,GAAqB,KAAK,IAAI,KAAK,IAAIZ,EAAM,QAAU,KAAK,MAAM,EAAG,KAAK,IAAIA,EAAM,QAAU,KAAK,MAAM,CAAC,EAAIY,EAChH,OAEF,KAAK,aAAahH,EAAK,EAAI,CAC7B,CACA,GAAInC,EAAS,CACPqJ,GACFA,EAAY,GAAKE,GAAM1E,IAAU,GACjCwE,EAAY,GAAKG,GAAM1E,IAAU,IAEjCuE,EAAc,CACZ,EAAG,EACH,EAAG,EACH,EAAG,EACH,EAAG,EACH,EAAGE,EACH,EAAGC,CACL,EAEF,IAAIC,EAAY,UAAU,OAAOJ,EAAY,EAAG,GAAG,EAAE,OAAOA,EAAY,EAAG,GAAG,EAAE,OAAOA,EAAY,EAAG,GAAG,EAAE,OAAOA,EAAY,EAAG,GAAG,EAAE,OAAOA,EAAY,EAAG,GAAG,EAAE,OAAOA,EAAY,EAAG,GAAG,EAC1LtO,EAAIiF,EAAS,kBAAmByJ,CAAS,EACzC1O,EAAIiF,EAAS,eAAgByJ,CAAS,EACtC1O,EAAIiF,EAAS,cAAeyJ,CAAS,EACrC1O,EAAIiF,EAAS,YAAayJ,CAAS,EACnC5E,GAAS0E,EACTzE,GAAS0E,EACT5E,EAAW2D,CACb,CACApG,EAAI,YAAcA,EAAI,eAAe,CACvC,CACF,EACA,aAAc,UAAwB,CAGpC,GAAI,CAACnC,EAAS,CACZ,IAAI9D,EAAY,KAAK,QAAQ,eAAiB,SAAS,KAAO0G,EAC5D/C,EAAO/D,EAAQ+H,EAAQ,GAAM8B,GAAyB,GAAMzJ,CAAS,EACrEsB,EAAU,KAAK,QAGjB,GAAImI,GAAyB,CAG3B,IADAL,EAAsBpJ,EACfnB,EAAIuK,EAAqB,UAAU,IAAM,UAAYvK,EAAIuK,EAAqB,WAAW,IAAM,QAAUA,IAAwB,UACtIA,EAAsBA,EAAoB,WAExCA,IAAwB,SAAS,MAAQA,IAAwB,SAAS,iBACxEA,IAAwB,WAAUA,EAAsB1J,GAA0B,GACtFiE,EAAK,KAAOyF,EAAoB,UAChCzF,EAAK,MAAQyF,EAAoB,YAEjCA,EAAsB1J,GAA0B,EAElD2J,GAAmCvH,GAAwBsH,CAAmB,CAChF,CACAtF,EAAU6D,EAAO,UAAU,EAAI,EAC/BlJ,EAAYqF,EAASxC,EAAQ,WAAY,EAAK,EAC9C7C,EAAYqF,EAASxC,EAAQ,cAAe,EAAI,EAChD7C,EAAYqF,EAASxC,EAAQ,UAAW,EAAI,EAC5CzC,EAAIiF,EAAS,aAAc,EAAE,EAC7BjF,EAAIiF,EAAS,YAAa,EAAE,EAC5BjF,EAAIiF,EAAS,aAAc,YAAY,EACvCjF,EAAIiF,EAAS,SAAU,CAAC,EACxBjF,EAAIiF,EAAS,MAAOH,EAAK,GAAG,EAC5B9E,EAAIiF,EAAS,OAAQH,EAAK,IAAI,EAC9B9E,EAAIiF,EAAS,QAASH,EAAK,KAAK,EAChC9E,EAAIiF,EAAS,SAAUH,EAAK,MAAM,EAClC9E,EAAIiF,EAAS,UAAW,KAAK,EAC7BjF,EAAIiF,EAAS,WAAY2F,GAA0B,WAAa,OAAO,EACvE5K,EAAIiF,EAAS,SAAU,QAAQ,EAC/BjF,EAAIiF,EAAS,gBAAiB,MAAM,EACpCpC,EAAS,MAAQoC,EACjB9D,EAAU,YAAY8D,CAAO,EAG7BjF,EAAIiF,EAAS,mBAAoB+E,GAAkB,SAAS/E,EAAQ,MAAM,KAAK,EAAI,IAAM,KAAOgF,GAAiB,SAAShF,EAAQ,MAAM,MAAM,EAAI,IAAM,GAAG,CAC7J,CACF,EACA,aAAc,SAAiCmC,EAAiB8G,EAAU,CACxE,IAAI7J,EAAQ,KACRgJ,EAAejG,EAAI,aACnB3E,EAAU4B,EAAM,QAIpB,GAHAuE,EAAY,YAAa,KAAM,CAC7B,IAAKxB,CACP,CAAC,EACGvE,EAAS,cAAe,CAC1B,KAAK,QAAQ,EACb,MACF,CACA+F,EAAY,aAAc,IAAI,EACzB/F,EAAS,gBACZkF,EAAUrD,GAAMoE,CAAM,EACtBf,EAAQ,gBAAgB,IAAI,EAC5BA,EAAQ,UAAY,GACpBA,EAAQ,MAAM,aAAa,EAAI,GAC/B,KAAK,WAAW,EAChBnI,EAAYmI,EAAS,KAAK,QAAQ,YAAa,EAAK,EACpDlF,EAAS,MAAQkF,GAInB1D,EAAM,QAAU4J,GAAU,UAAY,CACpCrF,EAAY,QAASvE,CAAK,EACtB,CAAAxB,EAAS,gBACRwB,EAAM,QAAQ,mBACjBwD,EAAO,aAAaE,EAASe,CAAM,EAErCzE,EAAM,WAAW,EACjBiF,EAAe,CACb,SAAUjF,EACV,KAAM,OACR,CAAC,EACH,CAAC,EACD,CAAC6J,GAAYtO,EAAYkJ,EAAQrG,EAAQ,UAAW,EAAI,EAGpDyL,GACFxE,GAAkB,GAClBrF,EAAM,QAAU,YAAYA,EAAM,iBAAkB,EAAE,IAGtDjF,EAAI,SAAU,UAAWiF,EAAM,OAAO,EACtCjF,EAAI,SAAU,WAAYiF,EAAM,OAAO,EACvCjF,EAAI,SAAU,cAAeiF,EAAM,OAAO,EACtCgJ,IACFA,EAAa,cAAgB,OAC7B5K,EAAQ,SAAWA,EAAQ,QAAQ,KAAK4B,EAAOgJ,EAAcvE,CAAM,GAErE9J,EAAG,SAAU,OAAQqF,CAAK,EAG1BrE,EAAI8I,EAAQ,YAAa,eAAe,GAE1CW,GAAsB,GACtBpF,EAAM,aAAe4J,GAAU5J,EAAM,aAAa,KAAKA,EAAO6J,EAAU9G,CAAG,CAAC,EAC5EpI,EAAG,SAAU,cAAeqF,CAAK,EACjC8E,GAAQ,GACJvK,IACFoB,EAAI,SAAS,KAAM,cAAe,MAAM,CAE5C,EAEA,YAAa,SAAgCoH,EAAK,CAChD,IAAInI,EAAK,KAAK,GACZtC,EAASyK,EAAI,OACbuE,EACAC,EACA+C,EACAlM,EAAU,KAAK,QACfuK,EAAQvK,EAAQ,MAChBmM,EAAiB/L,EAAS,OAC1BgM,EAAUrF,KAAgBwD,EAC1B8B,EAAUrM,EAAQ,KAClBsM,EAAexG,GAAeqG,EAC9B/C,EACAxH,EAAQ,KACR2K,EAAiB,GACnB,GAAIvE,GAAS,OACb,SAASwE,EAAcpP,GAAMqP,GAAO,CAClCtG,EAAY/I,GAAMwE,EAAO3H,GAAe,CACtC,IAAK0K,EACL,QAASyH,EACT,KAAMhD,EAAW,WAAa,aAC9B,OAAQ8C,EACR,SAAUhD,EACV,WAAYC,EACZ,QAASkD,EACT,aAAcC,EACd,OAAQpS,EACR,UAAWwS,EACX,OAAQ,SAAgBxS,GAAQyS,GAAO,CACrC,OAAOC,GAAQxH,EAAQ5I,EAAI6J,EAAQ6C,EAAUhP,GAAQoE,EAAQpE,EAAM,EAAGyK,EAAKgI,EAAK,CAClF,EACA,QAASE,CACX,EAAGJ,EAAK,CAAC,CACX,CAGA,SAASK,GAAU,CACjBN,EAAc,0BAA0B,EACxC5K,EAAM,sBAAsB,EACxBA,IAAU0K,GACZA,EAAa,sBAAsB,CAEvC,CAGA,SAASI,EAAUK,GAAW,CAC5B,OAAAP,EAAc,oBAAqB,CACjC,UAAWO,EACb,CAAC,EACGA,KAEEX,EACFD,EAAe,WAAW,EAE1BA,EAAe,WAAWvK,CAAK,EAE7BA,IAAU0K,IAEZnP,EAAYkJ,EAAQP,EAAcA,EAAY,QAAQ,WAAaqG,EAAe,QAAQ,WAAY,EAAK,EAC3GhP,EAAYkJ,EAAQrG,EAAQ,WAAY,EAAI,GAE1C8F,IAAgBlE,GAASA,IAAUxB,EAAS,OAC9C0F,EAAclE,EACLA,IAAUxB,EAAS,QAAU0F,IACtCA,EAAc,MAIZwG,IAAiB1K,IACnBA,EAAM,sBAAwB1H,GAEhC0H,EAAM,WAAW,UAAY,CAC3B4K,EAAc,2BAA2B,EACzC5K,EAAM,sBAAwB,IAChC,CAAC,EACGA,IAAU0K,IACZA,EAAa,WAAW,EACxBA,EAAa,sBAAwB,QAKrCpS,IAAWmM,GAAU,CAACA,EAAO,UAAYnM,IAAWsC,GAAM,CAACtC,EAAO,YACpEuN,GAAa,MAIX,CAACzH,EAAQ,gBAAkB,CAAC2E,EAAI,QAAUzK,IAAW,WACvDmM,EAAO,WAAWtD,CAAO,EAAE,iBAAiB4B,EAAI,MAAM,EAGtD,CAACoI,IAAatC,GAA8B9F,CAAG,GAEjD,CAAC3E,EAAQ,gBAAkB2E,EAAI,iBAAmBA,EAAI,gBAAgB,EAC/D4H,EAAiB,EAC1B,CAGA,SAASM,GAAU,CACjBnH,EAAWnF,EAAM8F,CAAM,EACvBT,GAAoBrF,EAAM8F,EAAQrG,EAAQ,SAAS,EACnD6G,EAAe,CACb,SAAUjF,EACV,KAAM,SACN,KAAMpF,EACN,SAAUkJ,EACV,kBAAmBE,GACnB,cAAejB,CACjB,CAAC,CACH,CAMA,GALIA,EAAI,iBAAmB,QACzBA,EAAI,YAAcA,EAAI,eAAe,EAEvCzK,EAAS6C,EAAQ7C,EAAQ8F,EAAQ,UAAWxD,EAAI,EAAI,EACpDgQ,EAAc,UAAU,EACpBpM,EAAS,cAAe,OAAOmM,EACnC,GAAIlG,EAAO,SAAS1B,EAAI,MAAM,GAAKzK,EAAO,UAAYA,EAAO,YAAcA,EAAO,YAAc0H,EAAM,wBAA0B1H,EAC9H,OAAOwS,EAAU,EAAK,EAGxB,GADAzF,GAAkB,GACdkF,GAAkB,CAACnM,EAAQ,WAAaoM,EAAUC,IAAYH,EAAS5F,IAAalB,GACtFU,IAAgB,OAAS,KAAK,YAAciB,GAAY,UAAU,KAAMoF,EAAgB9F,EAAQ1B,CAAG,IAAM4F,EAAM,SAAS,KAAM4B,EAAgB9F,EAAQ1B,CAAG,GAAI,CAI7J,GAHAyE,EAAW,KAAK,cAAczE,EAAKzK,CAAM,IAAM,WAC/CgP,EAAW5K,EAAQ+H,CAAM,EACzBmG,EAAc,eAAe,EACzBpM,EAAS,cAAe,OAAOmM,EACnC,GAAIL,EACF,OAAA5F,EAAWlB,EACX0H,EAAQ,EACR,KAAK,WAAW,EAChBN,EAAc,QAAQ,EACjBpM,EAAS,gBACRmG,GACFnB,EAAO,aAAaiB,EAAQE,EAAM,EAElCnB,EAAO,YAAYiB,CAAM,GAGtBqG,EAAU,EAAI,EAEvB,IAAIM,EAAc3M,GAAU7D,EAAIwD,EAAQ,SAAS,EACjD,GAAI,CAACgN,GAAeC,GAAatI,EAAKyE,EAAU,IAAI,GAAK,CAAC4D,EAAY,SAAU,CAI9E,GAAIA,IAAgB3G,EAClB,OAAOqG,EAAU,EAAK,EAUxB,GANIM,GAAexQ,IAAOmI,EAAI,SAC5BzK,EAAS8S,GAEP9S,IACFiP,EAAa7K,EAAQpE,CAAM,GAEzB0S,GAAQxH,EAAQ5I,EAAI6J,EAAQ6C,EAAUhP,EAAQiP,EAAYxE,EAAK,CAAC,CAACzK,CAAM,IAAM,GAC/E,OAAA4S,EAAQ,EACJE,GAAeA,EAAY,YAE7BxQ,EAAG,aAAa6J,EAAQ2G,EAAY,WAAW,EAE/CxQ,EAAG,YAAY6J,CAAM,EAEvBC,EAAW9J,EAEXqQ,EAAQ,EACDH,EAAU,EAAI,CAEzB,SAAWM,GAAeE,GAAcvI,EAAKyE,EAAU,IAAI,EAAG,CAE5D,IAAI+D,GAAarN,GAAStD,EAAI,EAAGwD,EAAS,EAAI,EAC9C,GAAImN,KAAe9G,EACjB,OAAOqG,EAAU,EAAK,EAIxB,GAFAxS,EAASiT,GACThE,EAAa7K,EAAQpE,CAAM,EACvB0S,GAAQxH,EAAQ5I,EAAI6J,EAAQ6C,EAAUhP,EAAQiP,EAAYxE,EAAK,EAAK,IAAM,GAC5E,OAAAmI,EAAQ,EACRtQ,EAAG,aAAa6J,EAAQ8G,EAAU,EAClC7G,EAAW9J,EAEXqQ,EAAQ,EACDH,EAAU,EAAI,CAEzB,SAAWxS,EAAO,aAAesC,EAAI,CACnC2M,EAAa7K,EAAQpE,CAAM,EAC3B,IAAIkT,GAAY,EACdC,GACAC,GAAiBjH,EAAO,aAAe7J,EACvC+Q,EAAkB,CAACtE,GAAmB5C,EAAO,UAAYA,EAAO,QAAU6C,EAAUhP,EAAO,UAAYA,EAAO,QAAUiP,EAAYC,CAAQ,EAC5IoE,GAAQpE,EAAW,MAAQ,OAC3BqE,GAAkBnO,GAAepF,EAAQ,MAAO,KAAK,GAAKoF,GAAe+G,EAAQ,MAAO,KAAK,EAC7FqH,GAAeD,GAAkBA,GAAgB,UAAY,OAC3DhG,KAAevN,IACjBmT,GAAwBlE,EAAWqE,EAAK,EACxC7F,GAAwB,GACxBC,GAAyB,CAAC2F,GAAmBvN,EAAQ,YAAcsN,IAErEF,GAAYO,GAAkBhJ,EAAKzK,EAAQiP,EAAYC,EAAUmE,EAAkB,EAAIvN,EAAQ,cAAeA,EAAQ,uBAAyB,KAAOA,EAAQ,cAAgBA,EAAQ,sBAAuB4H,GAAwBH,KAAevN,CAAM,EAC1P,IAAI0T,GACJ,GAAIR,KAAc,EAAG,CAEnB,IAAIS,GAAYtN,EAAM8F,CAAM,EAC5B,GACEwH,IAAaT,GACbQ,GAAUtH,EAAS,SAASuH,EAAS,QAC9BD,KAAYrQ,EAAIqQ,GAAS,SAAS,IAAM,QAAUA,KAAYpL,GACzE,CAEA,GAAI4K,KAAc,GAAKQ,KAAY1T,EACjC,OAAOwS,EAAU,EAAK,EAExBjF,GAAavN,EACbwN,GAAgB0F,GAChB,IAAIU,GAAc5T,EAAO,mBACvByS,GAAQ,GACVA,GAAQS,KAAc,EACtB,IAAIW,GAAanB,GAAQxH,EAAQ5I,EAAI6J,EAAQ6C,EAAUhP,EAAQiP,EAAYxE,EAAKgI,EAAK,EACrF,GAAIoB,KAAe,GACjB,OAAIA,KAAe,GAAKA,KAAe,MACrCpB,GAAQoB,KAAe,GAEzB/F,GAAU,GACV,WAAWgG,GAAW,EAAE,EACxBlB,EAAQ,EACJH,IAAS,CAACmB,GACZtR,EAAG,YAAY6J,CAAM,EAErBnM,EAAO,WAAW,aAAamM,EAAQsG,GAAQmB,GAAc5T,CAAM,EAIjEuT,IACF3L,GAAS2L,GAAiB,EAAGC,GAAeD,GAAgB,SAAS,EAEvEnH,EAAWD,EAAO,WAGdgH,KAA0B,QAAa,CAACzF,KAC1CC,GAAqB,KAAK,IAAIwF,GAAwB/O,EAAQpE,CAAM,EAAEsT,EAAK,CAAC,GAE9EX,EAAQ,EACDH,EAAU,EAAI,CAEzB,CACA,GAAIlQ,EAAG,SAAS6J,CAAM,EACpB,OAAOqG,EAAU,EAAK,CAE1B,CACA,MAAO,EACT,EACA,sBAAuB,KACvB,eAAgB,UAA0B,CACxC/P,EAAI,SAAU,YAAa,KAAK,YAAY,EAC5CA,EAAI,SAAU,YAAa,KAAK,YAAY,EAC5CA,EAAI,SAAU,cAAe,KAAK,YAAY,EAC9CA,EAAI,SAAU,WAAY8N,EAA6B,EACvD9N,EAAI,SAAU,YAAa8N,EAA6B,EACxD9N,EAAI,SAAU,YAAa8N,EAA6B,CAC1D,EACA,aAAc,UAAwB,CACpC,IAAIW,EAAgB,KAAK,GAAG,cAC5BzO,EAAIyO,EAAe,UAAW,KAAK,OAAO,EAC1CzO,EAAIyO,EAAe,WAAY,KAAK,OAAO,EAC3CzO,EAAIyO,EAAe,YAAa,KAAK,OAAO,EAC5CzO,EAAIyO,EAAe,cAAe,KAAK,OAAO,EAC9CzO,EAAI,SAAU,cAAe,IAAI,CACnC,EACA,QAAS,SAA4BgI,EAAK,CACxC,IAAInI,EAAK,KAAK,GACZwD,EAAU,KAAK,QAajB,GAVA0F,EAAWnF,EAAM8F,CAAM,EACvBT,GAAoBrF,EAAM8F,EAAQrG,EAAQ,SAAS,EACnDmG,EAAY,OAAQ,KAAM,CACxB,IAAKxB,CACP,CAAC,EACD2B,EAAWD,GAAUA,EAAO,WAG5BX,EAAWnF,EAAM8F,CAAM,EACvBT,GAAoBrF,EAAM8F,EAAQrG,EAAQ,SAAS,EAC/CI,EAAS,cAAe,CAC1B,KAAK,SAAS,EACd,MACF,CACA4G,GAAsB,GACtBY,GAAyB,GACzBD,GAAwB,GACxB,cAAc,KAAK,OAAO,EAC1B,aAAa,KAAK,eAAe,EACjCsG,GAAgB,KAAK,OAAO,EAC5BA,GAAgB,KAAK,YAAY,EAG7B,KAAK,kBACPtR,EAAI,SAAU,OAAQ,IAAI,EAC1BA,EAAIH,EAAI,YAAa,KAAK,YAAY,GAExC,KAAK,eAAe,EACpB,KAAK,aAAa,EACdL,IACFoB,EAAI,SAAS,KAAM,cAAe,EAAE,EAEtCA,EAAI8I,EAAQ,YAAa,EAAE,EACvB1B,IACE+B,KACF/B,EAAI,YAAcA,EAAI,eAAe,EACrC,CAAC3E,EAAQ,YAAc2E,EAAI,gBAAgB,GAE7CnC,GAAWA,EAAQ,YAAcA,EAAQ,WAAW,YAAYA,CAAO,GACnE4C,IAAWkB,GAAYR,GAAeA,EAAY,cAAgB,UAEpER,GAAWA,EAAQ,YAAcA,EAAQ,WAAW,YAAYA,CAAO,EAErEe,IACE,KAAK,iBACP1J,EAAI0J,EAAQ,UAAW,IAAI,EAE7BiF,GAAkBjF,CAAM,EACxBA,EAAO,MAAM,aAAa,EAAI,GAI1BK,IAAS,CAACM,IACZ7J,EAAYkJ,EAAQP,EAAcA,EAAY,QAAQ,WAAa,KAAK,QAAQ,WAAY,EAAK,EAEnG3I,EAAYkJ,EAAQ,KAAK,QAAQ,YAAa,EAAK,EAGnDQ,EAAe,CACb,SAAU,KACV,KAAM,WACN,KAAMP,EACN,SAAU,KACV,kBAAmB,KACnB,cAAe3B,CACjB,CAAC,EACGS,IAAWkB,GACTZ,GAAY,IAEdmB,EAAe,CACb,OAAQP,EACR,KAAM,MACN,KAAMA,EACN,OAAQlB,EACR,cAAeT,CACjB,CAAC,EAGDkC,EAAe,CACb,SAAU,KACV,KAAM,SACN,KAAMP,EACN,cAAe3B,CACjB,CAAC,EAGDkC,EAAe,CACb,OAAQP,EACR,KAAM,OACN,KAAMA,EACN,OAAQlB,EACR,cAAeT,CACjB,CAAC,EACDkC,EAAe,CACb,SAAU,KACV,KAAM,OACN,KAAMP,EACN,cAAe3B,CACjB,CAAC,GAEHmB,GAAeA,EAAY,KAAK,GAE5BJ,IAAaD,IACXC,GAAY,IAEdmB,EAAe,CACb,SAAU,KACV,KAAM,SACN,KAAMP,EACN,cAAe3B,CACjB,CAAC,EACDkC,EAAe,CACb,SAAU,KACV,KAAM,OACN,KAAMP,EACN,cAAe3B,CACjB,CAAC,GAIHvE,EAAS,UAEPsF,GAAY,MAAQA,IAAa,MACnCA,EAAWD,GACXG,GAAoBD,IAEtBkB,EAAe,CACb,SAAU,KACV,KAAM,MACN,KAAMP,EACN,cAAe3B,CACjB,CAAC,EAGD,KAAK,KAAK,KAIhB,KAAK,SAAS,CAChB,EACA,SAAU,UAAoB,CAC5BwB,EAAY,UAAW,IAAI,EAC3Bf,EAASiB,EAASC,EAAW9D,EAAU+D,GAASjB,EAAUkB,GAAaC,GAAcU,GAASC,EAAWV,GAAQhB,EAAWE,GAAoBH,GAAWE,GAAoB8B,GAAaC,GAAgB5B,EAAciB,GAAc3G,EAAS,QAAUA,EAAS,MAAQA,EAAS,MAAQA,EAAS,OAAS,KAC/S6H,GAAkB,QAAQ,SAAUzL,EAAI,CACtCA,EAAG,QAAU,EACf,CAAC,EACDyL,GAAkB,OAASZ,GAASC,GAAS,CAC/C,EACA,YAAa,SAAgC3C,EAAK,CAChD,OAAQA,EAAI,KAAM,CAChB,IAAK,OACL,IAAK,UACH,KAAK,QAAQA,CAAG,EAChB,MACF,IAAK,YACL,IAAK,WACC0B,IACF,KAAK,YAAY1B,CAAG,EACpBuJ,GAAgBvJ,CAAG,GAErB,MACF,IAAK,cACHA,EAAI,eAAe,EACnB,KACJ,CACF,EAKA,QAAS,UAAmB,CAO1B,QANIwJ,EAAQ,CAAC,EACX3R,EACA2D,EAAW,KAAK,GAAG,SACnBhG,EAAI,EACJuB,EAAIyE,EAAS,OACbH,EAAU,KAAK,QACV7F,EAAIuB,EAAGvB,IACZqC,EAAK2D,EAAShG,CAAC,EACX4C,EAAQP,EAAIwD,EAAQ,UAAW,KAAK,GAAI,EAAK,GAC/CmO,EAAM,KAAK3R,EAAG,aAAawD,EAAQ,UAAU,GAAKoO,GAAY5R,CAAE,CAAC,EAGrE,OAAO2R,CACT,EAKA,KAAM,SAAcA,EAAOE,EAAc,CACvC,IAAIC,EAAQ,CAAC,EACXlJ,EAAS,KAAK,GAChB,KAAK,QAAQ,EAAE,QAAQ,SAAUmJ,EAAIpU,EAAG,CACtC,IAAIqC,EAAK4I,EAAO,SAASjL,CAAC,EACtB4C,EAAQP,EAAI,KAAK,QAAQ,UAAW4I,EAAQ,EAAK,IACnDkJ,EAAMC,CAAE,EAAI/R,EAEhB,EAAG,IAAI,EACP6R,GAAgB,KAAK,sBAAsB,EAC3CF,EAAM,QAAQ,SAAUI,EAAI,CACtBD,EAAMC,CAAE,IACVnJ,EAAO,YAAYkJ,EAAMC,CAAE,CAAC,EAC5BnJ,EAAO,YAAYkJ,EAAMC,CAAE,CAAC,EAEhC,CAAC,EACDF,GAAgB,KAAK,WAAW,CAClC,EAIA,KAAM,UAAgB,CACpB,IAAIG,EAAQ,KAAK,QAAQ,MACzBA,GAASA,EAAM,KAAOA,EAAM,IAAI,IAAI,CACtC,EAOA,QAAS,SAAmBhS,EAAIK,EAAU,CACxC,OAAOE,EAAQP,EAAIK,GAAY,KAAK,QAAQ,UAAW,KAAK,GAAI,EAAK,CACvE,EAOA,OAAQ,SAAgBO,EAAM3C,EAAO,CACnC,IAAIuF,EAAU,KAAK,QACnB,GAAIvF,IAAU,OACZ,OAAOuF,EAAQ5C,CAAI,EAEnB,IAAI6H,EAAgBZ,GAAc,aAAa,KAAMjH,EAAM3C,CAAK,EAC5D,OAAOwK,EAAkB,IAC3BjF,EAAQ5C,CAAI,EAAI6H,EAEhBjF,EAAQ5C,CAAI,EAAI3C,EAEd2C,IAAS,SACX4M,GAAchK,CAAO,CAG3B,EAIA,QAAS,UAAmB,CAC1BmG,EAAY,UAAW,IAAI,EAC3B,IAAI3J,EAAK,KAAK,GACdA,EAAGuG,CAAO,EAAI,KACdpG,EAAIH,EAAI,YAAa,KAAK,WAAW,EACrCG,EAAIH,EAAI,aAAc,KAAK,WAAW,EACtCG,EAAIH,EAAI,cAAe,KAAK,WAAW,EACnC,KAAK,kBACPG,EAAIH,EAAI,WAAY,IAAI,EACxBG,EAAIH,EAAI,YAAa,IAAI,GAG3B,MAAM,UAAU,QAAQ,KAAKA,EAAG,iBAAiB,aAAa,EAAG,SAAUA,EAAI,CAC7EA,EAAG,gBAAgB,WAAW,CAChC,CAAC,EACD,KAAK,QAAQ,EACb,KAAK,0BAA0B,EAC/B0K,GAAU,OAAOA,GAAU,QAAQ,KAAK,EAAE,EAAG,CAAC,EAC9C,KAAK,GAAK1K,EAAK,IACjB,EACA,WAAY,UAAsB,CAChC,GAAI,CAACiK,GAAa,CAEhB,GADAN,EAAY,YAAa,IAAI,EACzB/F,EAAS,cAAe,OAC5B7C,EAAI+H,EAAS,UAAW,MAAM,EAC1B,KAAK,QAAQ,mBAAqBA,EAAQ,YAC5CA,EAAQ,WAAW,YAAYA,CAAO,EAExCmB,GAAc,EAChB,CACF,EACA,WAAY,SAAoBX,EAAa,CAC3C,GAAIA,EAAY,cAAgB,QAAS,CACvC,KAAK,WAAW,EAChB,MACF,CACA,GAAIW,GAAa,CAEf,GADAN,EAAY,YAAa,IAAI,EACzB/F,EAAS,cAAe,OAGxBiG,EAAO,YAAcjB,GAAU,CAAC,KAAK,QAAQ,MAAM,YACrDA,EAAO,aAAaE,EAASe,CAAM,EAC1BE,GACTnB,EAAO,aAAaE,EAASiB,EAAM,EAEnCnB,EAAO,YAAYE,CAAO,EAExB,KAAK,QAAQ,MAAM,aACrB,KAAK,QAAQe,EAAQf,CAAO,EAE9B/H,EAAI+H,EAAS,UAAW,EAAE,EAC1BmB,GAAc,EAChB,CACF,CACF,EACA,SAASyH,GAA2BvJ,EAAK,CACnCA,EAAI,eACNA,EAAI,aAAa,WAAa,QAEhCA,EAAI,YAAcA,EAAI,eAAe,CACvC,CACA,SAASiI,GAAQpH,EAAQD,EAAMc,EAAQ6C,EAAU7D,EAAU8D,EAAYtD,EAAe4I,EAAiB,CACrG,IAAI9J,EACFD,EAAWc,EAAOzC,CAAO,EACzB2L,EAAWhK,EAAS,QAAQ,OAC5BiK,EAEF,OAAI,OAAO,aAAe,CAAC3S,IAAc,CAACC,GACxC0I,EAAM,IAAI,YAAY,OAAQ,CAC5B,QAAS,GACT,WAAY,EACd,CAAC,GAEDA,EAAM,SAAS,YAAY,OAAO,EAClCA,EAAI,UAAU,OAAQ,GAAM,EAAI,GAElCA,EAAI,GAAKY,EACTZ,EAAI,KAAOa,EACXb,EAAI,QAAU0B,EACd1B,EAAI,YAAcuE,EAClBvE,EAAI,QAAUU,GAAYE,EAC1BZ,EAAI,YAAcwE,GAAc7K,EAAQiH,CAAI,EAC5CZ,EAAI,gBAAkB8J,EACtB9J,EAAI,cAAgBkB,EACpBL,EAAO,cAAcb,CAAG,EACpB+J,IACFC,EAASD,EAAS,KAAKhK,EAAUC,EAAKkB,CAAa,GAE9C8I,CACT,CACA,SAASrD,GAAkB9O,EAAI,CAC7BA,EAAG,UAAY,EACjB,CACA,SAASwR,IAAY,CACnBhG,GAAU,EACZ,CACA,SAASkF,GAAcvI,EAAKyE,EAAU1E,EAAU,CAC9C,IAAIkK,EAActQ,EAAQwB,GAAS4E,EAAS,GAAI,EAAGA,EAAS,QAAS,EAAI,CAAC,EACtEmK,EAAsBtM,GAAkCmC,EAAS,GAAIA,EAAS,QAASlC,CAAO,EAC9FsM,EAAS,GACb,OAAO1F,EAAWzE,EAAI,QAAUkK,EAAoB,KAAOC,GAAUnK,EAAI,QAAUiK,EAAY,KAAOjK,EAAI,QAAUiK,EAAY,MAAQjK,EAAI,QAAUkK,EAAoB,IAAMC,GAAUnK,EAAI,QAAUiK,EAAY,QAAUjK,EAAI,QAAUiK,EAAY,IAC1P,CACA,SAAS3B,GAAatI,EAAKyE,EAAU1E,EAAU,CAC7C,IAAIqK,EAAazQ,EAAQ+B,GAAUqE,EAAS,GAAIA,EAAS,QAAQ,SAAS,CAAC,EACvEmK,EAAsBtM,GAAkCmC,EAAS,GAAIA,EAAS,QAASlC,CAAO,EAC9FsM,EAAS,GACb,OAAO1F,EAAWzE,EAAI,QAAUkK,EAAoB,MAAQC,GAAUnK,EAAI,QAAUoK,EAAW,QAAUpK,EAAI,QAAUoK,EAAW,KAAOpK,EAAI,QAAUkK,EAAoB,OAASC,GAAUnK,EAAI,QAAUoK,EAAW,OAASpK,EAAI,QAAUoK,EAAW,GAC3P,CACA,SAASpB,GAAkBhJ,EAAKzK,EAAQiP,EAAYC,EAAU4F,EAAeC,EAAuBC,EAAYC,EAAc,CAC5H,IAAIC,EAAchG,EAAWzE,EAAI,QAAUA,EAAI,QAC7C0K,EAAejG,EAAWD,EAAW,OAASA,EAAW,MACzDmG,EAAWlG,EAAWD,EAAW,IAAMA,EAAW,KAClDoG,EAAWnG,EAAWD,EAAW,OAASA,EAAW,MACrDqG,EAAS,GACX,GAAI,CAACN,GAEH,GAAIC,GAAgBtH,GAAqBwH,EAAeL,GAOtD,GAJI,CAACrH,KAA0BD,KAAkB,EAAI0H,EAAcE,EAAWD,EAAeJ,EAAwB,EAAIG,EAAcG,EAAWF,EAAeJ,EAAwB,KAEvLtH,GAAwB,IAErBA,GAOH6H,EAAS,WALL9H,KAAkB,EAAI0H,EAAcE,EAAWzH,GACjDuH,EAAcG,EAAW1H,GACzB,MAAO,CAACH,WAOR0H,EAAcE,EAAWD,GAAgB,EAAIL,GAAiB,GAAKI,EAAcG,EAAWF,GAAgB,EAAIL,GAAiB,EACnI,OAAOS,GAAoBvV,CAAM,EAKvC,OADAsV,EAASA,GAAUN,EACfM,IAEEJ,EAAcE,EAAWD,EAAeJ,EAAwB,GAAKG,EAAcG,EAAWF,EAAeJ,EAAwB,GAChIG,EAAcE,EAAWD,EAAe,EAAI,EAAI,GAGpD,CACT,CAQA,SAASI,GAAoBvV,EAAQ,CACnC,OAAIqG,EAAM8F,CAAM,EAAI9F,EAAMrG,CAAM,EACvB,EAEA,EAEX,CAQA,SAASkU,GAAY5R,EAAI,CAIvB,QAHIkT,EAAMlT,EAAG,QAAUA,EAAG,UAAYA,EAAG,IAAMA,EAAG,KAAOA,EAAG,YAC1DrC,EAAIuV,EAAI,OACRC,EAAM,EACDxV,KACLwV,GAAOD,EAAI,WAAWvV,CAAC,EAEzB,OAAOwV,EAAI,SAAS,EAAE,CACxB,CACA,SAASzE,GAAuB0E,EAAM,CACpC3H,GAAkB,OAAS,EAG3B,QAFI4H,EAASD,EAAK,qBAAqB,OAAO,EAC1CE,EAAMD,EAAO,OACVC,KAAO,CACZ,IAAItT,EAAKqT,EAAOC,CAAG,EACnBtT,EAAG,SAAWyL,GAAkB,KAAKzL,CAAE,CACzC,CACF,CACA,SAASgP,GAAU9O,EAAI,CACrB,OAAO,WAAWA,EAAI,CAAC,CACzB,CACA,SAASuR,GAAgBM,EAAI,CAC3B,OAAO,aAAaA,CAAE,CACxB,CAGIrG,IACF3L,EAAG,SAAU,YAAa,SAAUoI,EAAK,EAClCvE,EAAS,QAAU4G,KAAwBrC,EAAI,YAClDA,EAAI,eAAe,CAEvB,CAAC,EAIHvE,EAAS,MAAQ,CACf,GAAI7D,EACJ,IAAKI,EACL,IAAKY,EACL,KAAMS,GACN,GAAI,SAAYxB,EAAIK,EAAU,CAC5B,MAAO,CAAC,CAACE,EAAQP,EAAIK,EAAUL,EAAI,EAAK,CAC1C,EACA,OAAQyE,GACR,SAAUO,GACV,QAASzE,EACT,YAAaI,EACb,MAAO8E,GACP,MAAO1B,EACP,SAAUiL,GACV,eAAgByC,GAChB,gBAAiB1F,GACjB,SAAUzI,EACZ,EAOAM,EAAS,IAAM,SAAU2P,EAAS,CAChC,OAAOA,EAAQhN,CAAO,CACxB,EAMA3C,EAAS,MAAQ,UAAY,CAC3B,QAAS4P,EAAO,UAAU,OAAQ7L,EAAU,IAAI,MAAM6L,CAAI,EAAGC,EAAO,EAAGA,EAAOD,EAAMC,IAClF9L,EAAQ8L,CAAI,EAAI,UAAUA,CAAI,EAE5B9L,EAAQ,CAAC,EAAE,cAAgB,QAAOA,EAAUA,EAAQ,CAAC,GACzDA,EAAQ,QAAQ,SAAUG,EAAQ,CAChC,GAAI,CAACA,EAAO,WAAa,CAACA,EAAO,UAAU,YACzC,KAAM,gEAAgE,OAAO,CAAC,EAAE,SAAS,KAAKA,CAAM,CAAC,EAEnGA,EAAO,QAAOlE,EAAS,MAAQnG,GAAeA,GAAe,CAAC,EAAGmG,EAAS,KAAK,EAAGkE,EAAO,KAAK,GAClGD,GAAc,MAAMC,CAAM,CAC5B,CAAC,CACH,EAOAlE,EAAS,OAAS,SAAU5D,EAAIwD,EAAS,CACvC,OAAO,IAAII,EAAS5D,EAAIwD,CAAO,CACjC,EAGAI,EAAS,QAAUvE,GAEnB,IAAIqU,EAAc,CAAC,EACjBC,GACAC,GACAC,GAAY,GACZC,GACAC,GACAC,GACAC,GACF,SAASC,IAAmB,CAC1B,SAASC,GAAa,CACpB,KAAK,SAAW,CACd,OAAQ,GACR,wBAAyB,GACzB,kBAAmB,GACnB,YAAa,GACb,aAAc,EAChB,EAGA,QAASjU,KAAM,KACTA,EAAG,OAAO,CAAC,IAAM,KAAO,OAAO,KAAKA,CAAE,GAAM,aAC9C,KAAKA,CAAE,EAAI,KAAKA,CAAE,EAAE,KAAK,IAAI,EAGnC,CACA,OAAAiU,EAAW,UAAY,CACrB,YAAa,SAAqBxL,EAAM,CACtC,IAAIU,EAAgBV,EAAK,cACrB,KAAK,SAAS,gBAChB5I,EAAG,SAAU,WAAY,KAAK,iBAAiB,EAE3C,KAAK,QAAQ,eACfA,EAAG,SAAU,cAAe,KAAK,yBAAyB,EACjDsJ,EAAc,QACvBtJ,EAAG,SAAU,YAAa,KAAK,yBAAyB,EAExDA,EAAG,SAAU,YAAa,KAAK,yBAAyB,CAG9D,EACA,kBAAmB,SAA2BqU,EAAO,CACnD,IAAI/K,EAAgB+K,EAAM,cAEtB,CAAC,KAAK,QAAQ,gBAAkB,CAAC/K,EAAc,QACjD,KAAK,kBAAkBA,CAAa,CAExC,EACA,KAAM,UAAgB,CAChB,KAAK,SAAS,gBAChBlJ,EAAI,SAAU,WAAY,KAAK,iBAAiB,GAEhDA,EAAI,SAAU,cAAe,KAAK,yBAAyB,EAC3DA,EAAI,SAAU,YAAa,KAAK,yBAAyB,EACzDA,EAAI,SAAU,YAAa,KAAK,yBAAyB,GAE3DkU,GAAgC,EAChCC,GAAiB,EACjBjP,GAAe,CACjB,EACA,QAAS,UAAmB,CAC1B2O,GAAaJ,GAAeD,GAAWE,GAAYI,GAA6BH,GAAkBC,GAAkB,KACpHL,EAAY,OAAS,CACvB,EACA,0BAA2B,SAAmCvL,EAAK,CACjE,KAAK,kBAAkBA,EAAK,EAAI,CAClC,EACA,kBAAmB,SAA2BA,EAAK8G,EAAU,CAC3D,IAAI7J,EAAQ,KACRG,GAAK4C,EAAI,QAAUA,EAAI,QAAQ,CAAC,EAAIA,GAAK,QAC3C3C,GAAK2C,EAAI,QAAUA,EAAI,QAAQ,CAAC,EAAIA,GAAK,QACzC7D,EAAO,SAAS,iBAAiBiB,EAAGC,CAAC,EAOvC,GANAwO,GAAa7L,EAMT8G,GAAY,KAAK,QAAQ,yBAA2BxP,IAAQD,IAAcG,GAAQ,CACpF4U,GAAWpM,EAAK,KAAK,QAAS7D,EAAM2K,CAAQ,EAG5C,IAAIuF,EAAiBtR,GAA2BoB,EAAM,EAAI,EACtDuP,KAAc,CAACI,IAA8B1O,IAAMuO,IAAmBtO,IAAMuO,MAC9EE,IAA8BI,GAAgC,EAE9DJ,GAA6B,YAAY,UAAY,CACnD,IAAIQ,EAAUvR,GAA2B,SAAS,iBAAiBqC,EAAGC,CAAC,EAAG,EAAI,EAC1EiP,IAAYD,IACdA,EAAiBC,EACjBH,GAAiB,GAEnBC,GAAWpM,EAAK/C,EAAM,QAASqP,EAASxF,CAAQ,CAClD,EAAG,EAAE,EACL6E,GAAkBvO,EAClBwO,GAAkBvO,EAEtB,KAAO,CAEL,GAAI,CAAC,KAAK,QAAQ,cAAgBtC,GAA2BoB,EAAM,EAAI,IAAM1C,GAA0B,EAAG,CACxG0S,GAAiB,EACjB,MACF,CACAC,GAAWpM,EAAK,KAAK,QAASjF,GAA2BoB,EAAM,EAAK,EAAG,EAAK,CAC9E,CACF,CACF,EACOpG,EAASiW,EAAY,CAC1B,WAAY,SACZ,oBAAqB,EACvB,CAAC,CACH,CACA,SAASG,IAAmB,CAC1BZ,EAAY,QAAQ,SAAUa,EAAY,CACxC,cAAcA,EAAW,GAAG,CAC9B,CAAC,EACDb,EAAc,CAAC,CACjB,CACA,SAASW,IAAkC,CACzC,cAAcJ,EAA0B,CAC1C,CACA,IAAIM,GAAavP,GAAS,SAAUmD,EAAK3E,EAASoF,EAAQ8L,EAAY,CAEpE,GAAKlR,EAAQ,OACb,KAAI+B,GAAK4C,EAAI,QAAUA,EAAI,QAAQ,CAAC,EAAIA,GAAK,QAC3C3C,GAAK2C,EAAI,QAAUA,EAAI,QAAQ,CAAC,EAAIA,GAAK,QACzCwM,EAAOnR,EAAQ,kBACfoR,EAAQpR,EAAQ,YAChBW,EAAcvC,GAA0B,EACtCiT,EAAqB,GACvBC,EAGElB,KAAiBhL,IACnBgL,GAAehL,EACf0L,GAAiB,EACjBX,GAAWnQ,EAAQ,OACnBsR,EAAiBtR,EAAQ,SACrBmQ,KAAa,KACfA,GAAWzQ,GAA2B0F,EAAQ,EAAI,IAGtD,IAAImM,EAAY,EACZC,EAAgBrB,GACpB,EAAG,CACD,IAAI3T,EAAKgV,EACPnP,EAAO/D,EAAQ9B,CAAE,EACjBoC,EAAMyD,EAAK,IACXvD,EAASuD,EAAK,OACdxD,EAAOwD,EAAK,KACZtD,EAAQsD,EAAK,MACbpD,EAAQoD,EAAK,MACbrD,EAASqD,EAAK,OACdoP,GAAa,OACbC,GAAa,OACbC,GAAcnV,EAAG,YACjBoV,GAAepV,EAAG,aAClBgM,EAAQjL,EAAIf,CAAE,EACdqV,GAAarV,EAAG,WAChBsV,GAAatV,EAAG,UACdA,IAAOmE,GACT8Q,GAAaxS,EAAQ0S,KAAgBnJ,EAAM,YAAc,QAAUA,EAAM,YAAc,UAAYA,EAAM,YAAc,WACvHkJ,GAAa1S,EAAS4S,KAAiBpJ,EAAM,YAAc,QAAUA,EAAM,YAAc,UAAYA,EAAM,YAAc,aAEzHiJ,GAAaxS,EAAQ0S,KAAgBnJ,EAAM,YAAc,QAAUA,EAAM,YAAc,UACvFkJ,GAAa1S,EAAS4S,KAAiBpJ,EAAM,YAAc,QAAUA,EAAM,YAAc,WAE3F,IAAIuJ,GAAKN,KAAe,KAAK,IAAI1S,EAAQgD,CAAC,GAAKoP,GAAQU,GAAa5S,EAAQ0S,KAAgB,KAAK,IAAI9S,EAAOkD,CAAC,GAAKoP,GAAQ,CAAC,CAACU,IACxHG,GAAKN,KAAe,KAAK,IAAI5S,EAASkD,CAAC,GAAKmP,GAAQW,GAAa9S,EAAS4S,KAAiB,KAAK,IAAIhT,EAAMoD,CAAC,GAAKmP,GAAQ,CAAC,CAACW,IAC9H,GAAI,CAAC5B,EAAYqB,CAAS,EACxB,QAASpX,GAAI,EAAGA,IAAKoX,EAAWpX,KACzB+V,EAAY/V,EAAC,IAChB+V,EAAY/V,EAAC,EAAI,CAAC,IAIpB+V,EAAYqB,CAAS,EAAE,IAAMQ,IAAM7B,EAAYqB,CAAS,EAAE,IAAMS,IAAM9B,EAAYqB,CAAS,EAAE,KAAO/U,KACtG0T,EAAYqB,CAAS,EAAE,GAAK/U,EAC5B0T,EAAYqB,CAAS,EAAE,GAAKQ,GAC5B7B,EAAYqB,CAAS,EAAE,GAAKS,GAC5B,cAAc9B,EAAYqB,CAAS,EAAE,GAAG,GACpCQ,IAAM,GAAKC,IAAM,KACnBX,EAAqB,GAErBnB,EAAYqB,CAAS,EAAE,IAAM,YAAY,UAAY,CAE/CL,GAAc,KAAK,QAAU,GAC/B9Q,EAAS,OAAO,aAAaoQ,EAAU,EAEzC,IAAIyB,GAAgB/B,EAAY,KAAK,KAAK,EAAE,GAAKA,EAAY,KAAK,KAAK,EAAE,GAAKkB,EAAQ,EAClFc,GAAgBhC,EAAY,KAAK,KAAK,EAAE,GAAKA,EAAY,KAAK,KAAK,EAAE,GAAKkB,EAAQ,EAClF,OAAOE,GAAmB,YACxBA,EAAe,KAAKlR,EAAS,QAAQ,WAAW2C,CAAO,EAAGmP,GAAeD,GAAetN,EAAK6L,GAAYN,EAAY,KAAK,KAAK,EAAE,EAAE,IAAM,YAI/IpO,GAASoO,EAAY,KAAK,KAAK,EAAE,GAAIgC,GAAeD,EAAa,CACnE,EAAE,KAAK,CACL,MAAOV,CACT,CAAC,EAAG,EAAE,IAGVA,GACF,OAASvR,EAAQ,cAAgBwR,IAAkB7Q,IAAgB6Q,EAAgB9R,GAA2B8R,EAAe,EAAK,IAClInB,GAAYgB,EACd,EAAG,EAAE,EAEDc,GAAO,SAAchN,EAAM,CAC7B,IAAIU,EAAgBV,EAAK,cACvBW,EAAcX,EAAK,YACnBkB,EAASlB,EAAK,OACdgH,EAAiBhH,EAAK,eACtBiN,EAAwBjN,EAAK,sBAC7BkN,EAAqBlN,EAAK,mBAC1BmN,EAAuBnN,EAAK,qBAC9B,GAAKU,EACL,KAAI0M,EAAazM,GAAeqG,EAChCkG,EAAmB,EACnB,IAAItH,EAAQlF,EAAc,gBAAkBA,EAAc,eAAe,OAASA,EAAc,eAAe,CAAC,EAAIA,EAChH3L,EAAS,SAAS,iBAAiB6Q,EAAM,QAASA,EAAM,OAAO,EACnEuH,EAAqB,EACjBC,GAAc,CAACA,EAAW,GAAG,SAASrY,CAAM,IAC9CkY,EAAsB,OAAO,EAC7B,KAAK,QAAQ,CACX,OAAQ/L,EACR,YAAaP,CACf,CAAC,GAEL,EACA,SAAS0M,IAAS,CAAC,CACnBA,GAAO,UAAY,CACjB,WAAY,KACZ,UAAW,SAAmB5B,EAAO,CACnC,IAAIjL,EAAoBiL,EAAM,kBAC9B,KAAK,WAAajL,CACpB,EACA,QAAS,SAAiB8M,EAAO,CAC/B,IAAIpM,EAASoM,EAAM,OACjB3M,EAAc2M,EAAM,YACtB,KAAK,SAAS,sBAAsB,EAChC3M,GACFA,EAAY,sBAAsB,EAEpC,IAAIgI,EAAchO,GAAS,KAAK,SAAS,GAAI,KAAK,WAAY,KAAK,OAAO,EACtEgO,EACF,KAAK,SAAS,GAAG,aAAazH,EAAQyH,CAAW,EAEjD,KAAK,SAAS,GAAG,YAAYzH,CAAM,EAErC,KAAK,SAAS,WAAW,EACrBP,GACFA,EAAY,WAAW,CAE3B,EACA,KAAMqM,EACR,EACAzX,EAAS8X,GAAQ,CACf,WAAY,eACd,CAAC,EACD,SAASE,IAAS,CAAC,CACnBA,GAAO,UAAY,CACjB,QAAS,SAAiBC,EAAO,CAC/B,IAAItM,EAASsM,EAAM,OACjB7M,EAAc6M,EAAM,YAClBC,EAAiB9M,GAAe,KAAK,SACzC8M,EAAe,sBAAsB,EACrCvM,EAAO,YAAcA,EAAO,WAAW,YAAYA,CAAM,EACzDuM,EAAe,WAAW,CAC5B,EACA,KAAMT,EACR,EACAzX,EAASgY,GAAQ,CACf,WAAY,eACd,CAAC,EAqFD,IAAIG,EAAoB,CAAC,EACvBC,EAAkB,CAAC,EACnBC,GAEAC,EACAC,GAAiB,GAEjBC,EAAU,GAEVC,GAAc,GACdC,EACAC,GACAC,GACF,SAASC,IAAkB,CACzB,SAASC,EAAUC,EAAU,CAE3B,QAASC,KAAM,KACTA,EAAG,OAAO,CAAC,IAAM,KAAO,OAAO,KAAKA,CAAE,GAAM,aAC9C,KAAKA,CAAE,EAAI,KAAKA,CAAE,EAAE,KAAK,IAAI,GAG5BD,EAAS,QAAQ,wBAChBA,EAAS,QAAQ,eACnBE,EAAG,SAAU,YAAa,KAAK,kBAAkB,GAEjDA,EAAG,SAAU,UAAW,KAAK,kBAAkB,EAC/CA,EAAG,SAAU,WAAY,KAAK,kBAAkB,IAGpDA,EAAG,SAAU,UAAW,KAAK,aAAa,EAC1CA,EAAG,SAAU,QAAS,KAAK,WAAW,EACtC,KAAK,SAAW,CACd,cAAe,oBACf,aAAc,KACd,sBAAuB,GACvB,QAAS,SAAiBC,EAAcC,EAAQ,CAC9C,IAAIC,EAAO,GACPjB,EAAkB,QAAUG,IAAsBS,EACpDZ,EAAkB,QAAQ,SAAUkB,EAAkBC,EAAG,CACvDF,IAAUE,EAAS,KAAL,IAAaD,EAAiB,WAC9C,CAAC,EAEDD,EAAOD,EAAO,YAEhBD,EAAa,QAAQ,OAAQE,CAAI,CACnC,CACF,CACF,CACA,OAAAN,EAAU,UAAY,CACpB,iBAAkB,GAClB,YAAa,GACb,iBAAkB,SAA0BS,EAAM,CAChD,IAAIC,EAAUD,EAAK,OACnBb,EAAWc,CACb,EACA,WAAY,UAAsB,CAChC,KAAK,YAAc,CAACrB,EAAkB,QAAQO,CAAQ,CACxD,EACA,WAAY,SAAoBe,EAAO,CACrC,IAAIV,EAAWU,EAAM,SACnBC,EAASD,EAAM,OACjB,GAAK,KAAK,YACV,SAASH,EAAI,EAAGA,EAAInB,EAAkB,OAAQmB,IAC5ClB,EAAgB,KAAKuB,GAAMxB,EAAkBmB,CAAC,CAAC,CAAC,EAChDlB,EAAgBkB,CAAC,EAAE,cAAgBnB,EAAkBmB,CAAC,EAAE,cACxDlB,EAAgBkB,CAAC,EAAE,UAAY,GAC/BlB,EAAgBkB,CAAC,EAAE,MAAM,aAAa,EAAI,GAC1CM,EAAYxB,EAAgBkB,CAAC,EAAG,KAAK,QAAQ,cAAe,EAAK,EACjEnB,EAAkBmB,CAAC,IAAMZ,GAAYkB,EAAYxB,EAAgBkB,CAAC,EAAG,KAAK,QAAQ,YAAa,EAAK,EAEtGP,EAAS,WAAW,EACpBW,EAAO,EACT,EACA,MAAO,SAAeG,EAAO,CAC3B,IAAId,EAAWc,EAAM,SACnBC,EAASD,EAAM,OACfE,EAAwBF,EAAM,sBAC9BH,EAASG,EAAM,OACZ,KAAK,cACL,KAAK,QAAQ,mBACZ1B,EAAkB,QAAUG,IAAsBS,IACpDiB,GAAsB,GAAMF,CAAM,EAClCC,EAAsB,OAAO,EAC7BL,EAAO,GAGb,EACA,UAAW,SAAmBO,EAAO,CACnC,IAAIC,EAAgBD,EAAM,cACxBH,EAASG,EAAM,OACfP,EAASO,EAAM,OACZ,KAAK,cACVD,GAAsB,GAAOF,CAAM,EACnC1B,EAAgB,QAAQ,SAAUuB,EAAO,CACvCQ,EAAIR,EAAO,UAAW,EAAE,CAC1B,CAAC,EACDO,EAAc,EACdtB,GAAe,GACfc,EAAO,EACT,EACA,UAAW,SAAmBU,EAAO,CACnC,IAAIC,EAAQ,KACRtB,EAAWqB,EAAM,SACnBE,EAAiBF,EAAM,eACvBV,EAASU,EAAM,OACZ,KAAK,cACVhC,EAAgB,QAAQ,SAAUuB,EAAO,CACvCQ,EAAIR,EAAO,UAAW,MAAM,EACxBU,EAAM,QAAQ,mBAAqBV,EAAM,YAC3CA,EAAM,WAAW,YAAYA,CAAK,CAEtC,CAAC,EACDW,EAAe,EACf1B,GAAe,GACfc,EAAO,EACT,EACA,gBAAiB,SAAyBa,EAAO,CAC/C,IAAIxB,EAAWwB,EAAM,SACjB,CAAC,KAAK,aAAejC,GACvBA,EAAkB,UAAU,mBAAmB,EAEjDH,EAAkB,QAAQ,SAAUkB,EAAkB,CACpDA,EAAiB,cAAgBmB,EAAMnB,CAAgB,CACzD,CAAC,EAGDlB,EAAoBA,EAAkB,KAAK,SAAUsC,EAAGC,EAAG,CACzD,OAAOD,EAAE,cAAgBC,EAAE,aAC7B,CAAC,EACDjC,GAAc,EAChB,EACA,YAAa,SAAqBkC,EAAO,CACvC,IAAIC,EAAS,KACT7B,EAAW4B,EAAM,SACrB,GAAK,KAAK,YACV,IAAI,KAAK,QAAQ,OAQf5B,EAAS,sBAAsB,EAC3B,KAAK,QAAQ,WAAW,CAC1BZ,EAAkB,QAAQ,SAAUkB,EAAkB,CAChDA,IAAqBX,GACzByB,EAAId,EAAkB,WAAY,UAAU,CAC9C,CAAC,EACD,IAAIwB,EAAWC,EAAQpC,EAAU,GAAO,GAAM,EAAI,EAClDP,EAAkB,QAAQ,SAAUkB,EAAkB,CAChDA,IAAqBX,GACzBqC,GAAQ1B,EAAkBwB,CAAQ,CACpC,CAAC,EACDrC,EAAU,GACVD,GAAiB,EACnB,CAEFQ,EAAS,WAAW,UAAY,CAC9BP,EAAU,GACVD,GAAiB,GACbqC,EAAO,QAAQ,WACjBzC,EAAkB,QAAQ,SAAUkB,EAAkB,CACpD2B,GAAU3B,CAAgB,CAC5B,CAAC,EAICuB,EAAO,QAAQ,MACjBK,GAAwB,CAE5B,CAAC,EACH,EACA,SAAU,SAAkBC,EAAO,CACjC,IAAIC,EAASD,EAAM,OACjBE,EAAYF,EAAM,UAClBxB,EAASwB,EAAM,OACb1C,GAAW,CAACL,EAAkB,QAAQgD,CAAM,IAC9CC,EAAU,EAAK,EACf1B,EAAO,EAEX,EACA,OAAQ,SAAgB2B,EAAO,CAC7B,IAAIC,EAAeD,EAAM,aACvBvB,EAASuB,EAAM,OACftC,EAAWsC,EAAM,SACjBR,EAAWQ,EAAM,SACflD,EAAkB,OAAS,IAE7BA,EAAkB,QAAQ,SAAUkB,EAAkB,CACpDN,EAAS,kBAAkB,CACzB,OAAQM,EACR,KAAMb,EAAUsC,EAAQzB,CAAgB,EAAIwB,CAC9C,CAAC,EACDG,GAAU3B,CAAgB,EAC1BA,EAAiB,SAAWwB,EAC5BS,EAAa,qBAAqBjC,CAAgB,CACpD,CAAC,EACDb,EAAU,GACV+C,GAAwB,CAAC,KAAK,QAAQ,kBAAmBzB,CAAM,EAEnE,EACA,kBAAmB,SAA2B0B,EAAQ,CACpD,IAAIzC,EAAWyC,EAAO,SACpBC,EAAUD,EAAO,QACjBE,EAAYF,EAAO,UACnBG,EAAiBH,EAAO,eACxBI,EAAWJ,EAAO,SAClBK,EAAcL,EAAO,YACnBM,EAAU,KAAK,QACnB,GAAIJ,EAAW,CAOb,GALID,GACFE,EAAe,WAAW,EAE5BpD,GAAiB,GAEbuD,EAAQ,WAAa3D,EAAkB,OAAS,IAAMK,GAAW,CAACiD,GAAW,CAACE,EAAe,QAAQ,MAAQ,CAACE,GAAc,CAE9H,IAAIE,EAAmBjB,EAAQpC,EAAU,GAAO,GAAM,EAAI,EAC1DP,EAAkB,QAAQ,SAAUkB,EAAkB,CAChDA,IAAqBX,IACzBqC,GAAQ1B,EAAkB0C,CAAgB,EAI1CH,EAAS,YAAYvC,CAAgB,EACvC,CAAC,EACDb,EAAU,EACZ,CAGA,GAAI,CAACiD,EAKH,GAHKjD,GACHyC,GAAwB,EAEtB9C,EAAkB,OAAS,EAAG,CAChC,IAAI6D,EAAqBpD,GACzB+C,EAAe,WAAW5C,CAAQ,EAG9B4C,EAAe,QAAQ,WAAa,CAAC/C,IAAgBoD,GACvD5D,EAAgB,QAAQ,SAAUuB,EAAO,CACvCgC,EAAe,kBAAkB,CAC/B,OAAQhC,EACR,KAAMhB,EACR,CAAC,EACDgB,EAAM,SAAWhB,GACjBgB,EAAM,sBAAwB,IAChC,CAAC,CAEL,MACEgC,EAAe,WAAW5C,CAAQ,CAGxC,CACF,EACA,yBAA0B,SAAkCkD,EAAQ,CAClE,IAAIpB,EAAWoB,EAAO,SACpBR,EAAUQ,EAAO,QACjBN,EAAiBM,EAAO,eAI1B,GAHA9D,EAAkB,QAAQ,SAAUkB,EAAkB,CACpDA,EAAiB,sBAAwB,IAC3C,CAAC,EACGsC,EAAe,QAAQ,WAAa,CAACF,GAAWE,EAAe,UAAU,YAAa,CACxFhD,GAAiBuD,EAAS,CAAC,EAAGrB,CAAQ,EACtC,IAAIsB,EAAaC,GAAO1D,EAAU,EAAI,EACtCC,GAAe,KAAOwD,EAAW,EACjCxD,GAAe,MAAQwD,EAAW,CACpC,CACF,EACA,0BAA2B,UAAqC,CAC1D3D,IACFA,EAAU,GACVyC,GAAwB,EAE5B,EACA,KAAM,SAAcoB,EAAQ,CAC1B,IAAIC,EAAMD,EAAO,cACfvC,EAASuC,EAAO,OAChBT,EAAWS,EAAO,SAClBtD,EAAWsD,EAAO,SAClBtC,EAAwBsC,EAAO,sBAC/BE,EAAWF,EAAO,SAClBR,EAAcQ,EAAO,YACnBG,EAAaX,GAAe,KAAK,SACrC,GAAKS,EACL,KAAIR,EAAU,KAAK,QACjBW,EAAWb,EAAS,SAGtB,GAAI,CAACnD,GAKH,GAJIqD,EAAQ,cAAgB,CAAC,KAAK,kBAChC,KAAK,mBAAmB,EAE1BlC,EAAYlB,EAAUoD,EAAQ,cAAe,CAAC,CAAC3D,EAAkB,QAAQO,CAAQ,CAAC,EAC7E,CAACP,EAAkB,QAAQO,CAAQ,EA2CtCP,EAAkB,OAAOA,EAAkB,QAAQO,CAAQ,EAAG,CAAC,EAC/DL,GAAsB,KACtBqE,GAAc,CACZ,SAAU3D,EACV,OAAQe,EACR,KAAM,WACN,SAAUpB,EACV,cAAe4D,CACjB,CAAC,MAnDwC,CAWzC,GAVAnE,EAAkB,KAAKO,CAAQ,EAC/BgE,GAAc,CACZ,SAAU3D,EACV,OAAQe,EACR,KAAM,SACN,SAAUpB,EACV,cAAe4D,CACjB,CAAC,EAGGA,EAAI,UAAYjE,IAAuBU,EAAS,GAAG,SAASV,EAAmB,EAAG,CACpF,IAAIsE,EAAYnC,EAAMnC,EAAmB,EACvCuE,EAAepC,EAAM9B,CAAQ,EAC/B,GAAI,CAACiE,GAAa,CAACC,GAAgBD,IAAcC,EAAc,CAG7D,IAAIC,EAAGvD,EAQP,IAPIsD,EAAeD,GACjBrD,EAAIqD,EACJE,EAAID,IAEJtD,EAAIsD,EACJC,EAAIF,EAAY,GAEXrD,EAAIuD,EAAGvD,IACR,CAACnB,EAAkB,QAAQsE,EAASnD,CAAC,CAAC,IAC1CM,EAAY6C,EAASnD,CAAC,EAAGwC,EAAQ,cAAe,EAAI,EACpD3D,EAAkB,KAAKsE,EAASnD,CAAC,CAAC,EAClCoD,GAAc,CACZ,SAAU3D,EACV,OAAQe,EACR,KAAM,SACN,SAAU2C,EAASnD,CAAC,EACpB,cAAegD,CACjB,CAAC,EAEL,CACF,MACEjE,GAAsBK,EAExBJ,EAAoBkE,CACtB,CAcF,GAAI/D,IAAe,KAAK,YAAa,CAGnC,GAFAD,EAAU,IAELoD,EAASkB,CAAO,EAAE,QAAQ,MAAQlB,IAAa9B,IAAW3B,EAAkB,OAAS,EAAG,CAC3F,IAAI0C,EAAWC,EAAQpC,CAAQ,EAC7BqE,EAAiBvC,EAAM9B,EAAU,SAAW,KAAK,QAAQ,cAAgB,GAAG,EAG9E,GAFI,CAACH,IAAkBuD,EAAQ,YAAWpD,EAAS,sBAAwB,MAC3E8D,EAAW,sBAAsB,EAC7B,CAACjE,KACCuD,EAAQ,YACVpD,EAAS,SAAWmC,EACpB1C,EAAkB,QAAQ,SAAUkB,EAAkB,CAEpD,GADAA,EAAiB,sBAAwB,KACrCA,IAAqBX,EAAU,CACjC,IAAIsE,GAAOxE,EAAUsC,EAAQzB,CAAgB,EAAIwB,EACjDxB,EAAiB,SAAW2D,GAG5BR,EAAW,kBAAkB,CAC3B,OAAQnD,EACR,KAAM2D,EACR,CAAC,CACH,CACF,CAAC,GAKH/B,GAAwB,EACxB9C,EAAkB,QAAQ,SAAUkB,EAAkB,CAChDoD,EAASM,CAAc,EACzBnB,EAAS,aAAavC,EAAkBoD,EAASM,CAAc,CAAC,EAEhEnB,EAAS,YAAYvC,CAAgB,EAEvC0D,GACF,CAAC,EAKGR,IAAa/B,EAAM9B,CAAQ,GAAG,CAChC,IAAIuE,EAAS,GACb9E,EAAkB,QAAQ,SAAUkB,EAAkB,CACpD,GAAIA,EAAiB,gBAAkBmB,EAAMnB,CAAgB,EAAG,CAC9D4D,EAAS,GACT,MACF,CACF,CAAC,EACGA,IACFlD,EAAsB,QAAQ,EAC9BA,EAAsB,MAAM,EAEhC,CAIF5B,EAAkB,QAAQ,SAAUkB,EAAkB,CACpD2B,GAAU3B,CAAgB,CAC5B,CAAC,EACDmD,EAAW,WAAW,CACxB,CACAlE,EAAoBkE,CACtB,EAGI1C,IAAW8B,GAAYC,GAAeA,EAAY,cAAgB,UACpEzD,EAAgB,QAAQ,SAAUuB,EAAO,CACvCA,EAAM,YAAcA,EAAM,WAAW,YAAYA,CAAK,CACxD,CAAC,EAEL,EACA,cAAe,UAAyB,CACtC,KAAK,YAAclB,GAAc,GACjCL,EAAgB,OAAS,CAC3B,EACA,cAAe,UAAyB,CACtC,KAAK,mBAAmB,EACxB8E,EAAI,SAAU,YAAa,KAAK,kBAAkB,EAClDA,EAAI,SAAU,UAAW,KAAK,kBAAkB,EAChDA,EAAI,SAAU,WAAY,KAAK,kBAAkB,EACjDA,EAAI,SAAU,UAAW,KAAK,aAAa,EAC3CA,EAAI,SAAU,QAAS,KAAK,WAAW,CACzC,EACA,mBAAoB,SAA4BZ,EAAK,CACnD,GAAI,SAAO7D,GAAgB,KAAeA,KAGtCH,IAAsB,KAAK,UAG3B,EAAAgE,GAAOa,EAAQb,EAAI,OAAQ,KAAK,QAAQ,UAAW,KAAK,SAAS,GAAI,EAAK,IAG1E,EAAAA,GAAOA,EAAI,SAAW,GAC1B,KAAOnE,EAAkB,QAAQ,CAC/B,IAAIiF,EAAKjF,EAAkB,CAAC,EAC5ByB,EAAYwD,EAAI,KAAK,QAAQ,cAAe,EAAK,EACjDjF,EAAkB,MAAM,EACxBuE,GAAc,CACZ,SAAU,KAAK,SACf,OAAQ,KAAK,SAAS,GACtB,KAAM,WACN,SAAUU,EACV,cAAed,CACjB,CAAC,CACH,CACF,EACA,cAAe,SAAuBA,EAAK,CACrCA,EAAI,MAAQ,KAAK,QAAQ,eAC3B,KAAK,iBAAmB,GAE5B,EACA,YAAa,SAAqBA,EAAK,CACjCA,EAAI,MAAQ,KAAK,QAAQ,eAC3B,KAAK,iBAAmB,GAE5B,CACF,EACOJ,EAASpD,EAAW,CAEzB,WAAY,YACZ,MAAO,CAKL,OAAQ,SAAgBsE,EAAI,CAC1B,IAAIrE,EAAWqE,EAAG,WAAWN,CAAO,EAChC,CAAC/D,GAAY,CAACA,EAAS,QAAQ,WAAa,CAACZ,EAAkB,QAAQiF,CAAE,IACzE9E,GAAqBA,IAAsBS,IAC7CT,EAAkB,UAAU,mBAAmB,EAC/CA,EAAoBS,GAEtBa,EAAYwD,EAAIrE,EAAS,QAAQ,cAAe,EAAI,EACpDZ,EAAkB,KAAKiF,CAAE,EAC3B,EAKA,SAAU,SAAkBA,EAAI,CAC9B,IAAIrE,EAAWqE,EAAG,WAAWN,CAAO,EAClCtC,EAAQrC,EAAkB,QAAQiF,CAAE,EAClC,CAACrE,GAAY,CAACA,EAAS,QAAQ,WAAa,CAAC,CAACyB,IAClDZ,EAAYwD,EAAIrE,EAAS,QAAQ,cAAe,EAAK,EACrDZ,EAAkB,OAAOqC,EAAO,CAAC,EACnC,CACF,EACA,gBAAiB,UAA2B,CAC1C,IAAI6C,EAAS,KACTC,EAAc,CAAC,EACjBC,EAAc,CAAC,EACjB,OAAApF,EAAkB,QAAQ,SAAUkB,EAAkB,CACpDiE,EAAY,KAAK,CACf,iBAAkBjE,EAClB,MAAOA,EAAiB,aAC1B,CAAC,EAGD,IAAImE,EACAhF,GAAWa,IAAqBX,EAClC8E,EAAW,GACFhF,EACTgF,EAAWhD,EAAMnB,EAAkB,SAAWgE,EAAO,QAAQ,cAAgB,GAAG,EAEhFG,EAAWhD,EAAMnB,CAAgB,EAEnCkE,EAAY,KAAK,CACf,iBAAkBlE,EAClB,MAAOmE,CACT,CAAC,CACH,CAAC,EACM,CACL,MAAOC,GAAmBtF,CAAiB,EAC3C,OAAQ,CAAC,EAAE,OAAOC,CAAe,EACjC,YAAakF,EACb,YAAaC,CACf,CACF,EACA,gBAAiB,CACf,aAAc,SAAsBG,EAAK,CACvC,OAAAA,EAAMA,EAAI,YAAY,EAClBA,IAAQ,OACVA,EAAM,UACGA,EAAI,OAAS,IACtBA,EAAMA,EAAI,OAAO,CAAC,EAAE,YAAY,EAAIA,EAAI,OAAO,CAAC,GAE3CA,CACT,CACF,CACF,CAAC,CACH,CACA,SAASnC,GAAwBoC,EAAgB7D,EAAQ,CACvD3B,EAAkB,QAAQ,SAAUkB,EAAkBC,EAAG,CACvD,IAAI6B,EAASrB,EAAO,SAAST,EAAiB,eAAiBsE,EAAiB,OAAOrE,CAAC,EAAI,EAAE,EAC1F6B,EACFrB,EAAO,aAAaT,EAAkB8B,CAAM,EAE5CrB,EAAO,YAAYT,CAAgB,CAEvC,CAAC,CACH,CAOA,SAASW,GAAsB4D,EAAkB9D,EAAQ,CACvD1B,EAAgB,QAAQ,SAAUuB,EAAOL,EAAG,CAC1C,IAAI6B,EAASrB,EAAO,SAASH,EAAM,eAAiBiE,EAAmB,OAAOtE,CAAC,EAAI,EAAE,EACjF6B,EACFrB,EAAO,aAAaH,EAAOwB,CAAM,EAEjCrB,EAAO,YAAYH,CAAK,CAE5B,CAAC,CACH,CACA,SAASsB,IAA0B,CACjC9C,EAAkB,QAAQ,SAAUkB,EAAkB,CAChDA,IAAqBX,GACzBW,EAAiB,YAAcA,EAAiB,WAAW,YAAYA,CAAgB,CACzF,CAAC,CACH,CAEAwE,EAAS,MAAM,IAAIC,EAAkB,EACrCD,EAAS,MAAME,GAAQC,EAAM,EAE7B,IAAOC,GAAQJ,ECjxGf,IAAMK,GAAiB,CACnB,KAAKC,EAAGC,EAAG,CACP,IAAMC,EAAQF,EAAE,aAAa,WAAW,EAAE,KAAK,EAAE,YAAY,EACvDG,EAAQF,EAAE,aAAa,WAAW,EAAE,KAAK,EAAE,YAAY,EAC7D,OAAOC,EAAM,cAAcC,CAAK,CACpC,EACA,QAAQH,EAAGC,EAAG,CACV,IAAMG,EAAQ,OAAOJ,EAAE,aAAa,cAAc,CAAC,EAEnD,OADc,OAAOC,EAAE,aAAa,cAAc,CAAC,EACpCG,CACnB,EACA,QAAQJ,EAAGC,EAAG,CACV,IAAMG,EAAQ,OAAOJ,EAAE,aAAa,cAAc,CAAC,EAEnD,OADc,OAAOC,EAAE,aAAa,cAAc,CAAC,EACpCG,CACnB,EACA,cAAcJ,EAAGC,EAAG,CAChB,IAAMI,EAAQL,EAAE,aAAa,WAAW,EAClCM,EAAQL,EAAE,aAAa,WAAW,EACxC,OAAII,IAAUC,EACH,EAEHD,IAAU,UAAY,GAAK,CACvC,EACA,aAAaL,EAAGC,EAAG,CACf,IAAMI,EAAQL,EAAE,aAAa,WAAW,EAClCM,EAAQL,EAAE,aAAa,WAAW,EACxC,OAAII,IAAUC,EACH,EAEHD,IAAU,UAAY,EAAI,EACtC,CACJ,EAQME,GAAc,CAChB,GAAI,CACA,OAAOC,EAAMC,EAAQ,CACjB,MAAO,EAAED,EAAK,yBAA2B,MAAQ,CAACC,EACtD,EACA,IAAID,EAAMC,EAAQ,EACKD,EAAK,wBAA0BC,GACvC,sBAAsB,cAAeD,CAAI,CACxD,CACJ,EACA,KAAM,CACF,OAAOA,EAAMC,EAAQ,CACjB,MAAO,EAAED,EAAK,qBAAuB,MAAQ,CAACC,EAClD,EACA,IAAID,EAAMC,EAAQ,EACKD,EAAK,oBAAsBC,GACnC,sBAAsB,WAAYD,CAAI,CACrD,CACJ,EACA,UAAW,CACP,OAAOA,EAAMC,EAAQC,EAAM,CACvB,OAAOA,EAAK,qBAAuB,IACvC,EACA,IAAIF,EAAMC,EAAQC,EAAM,CACJA,EAAK,mBAAmB,cAAc,IAAI,EAClD,QAAQF,CAAI,CACxB,CACJ,EACA,UAAW,CACP,OAAOA,EAAMC,EAAQC,EAAM,CACvB,OAAOA,EAAK,yBAA2B,IAC3C,EACA,IAAIF,EAAMC,EAAQC,EAAM,CACJA,EAAK,uBAAuB,cAAc,IAAI,EACtD,YAAYF,CAAI,CAC5B,CACJ,EACA,aAAc,CACV,OAAOA,EAAMC,EAAQ,CACjB,OAAOD,EAAK,QAAQ,OAAS,QAAU,KAAK,eAAeA,EAAMC,CAAM,CAC3E,EACA,IAAID,EAAMC,EAAQ,CACM,KAAK,eAAeD,EAAMC,CAAM,EACxC,cAAc,IAAI,EAAE,QAAQD,CAAI,CAChD,EACA,eAAeA,EAAMC,EAAQ,CACzB,IAAME,EAAYF,GAAUD,EACtBI,EAAW,MAAM,KAAKD,EAAS,cAAc,QAAQ,EACrDE,EAAQD,EAAS,QAAQD,CAAQ,EACvC,OAAOC,EAAS,MAAMC,EAAQ,CAAC,EAAE,KAAKC,GAAQA,EAAK,QAAQ,OAAS,SAAS,CACjF,CACJ,EACA,aAAc,CACV,OAAON,EAAMC,EAAQ,CACjB,OAAOD,EAAK,QAAQ,OAAS,QAAU,KAAK,eAAeA,EAAMC,CAAM,CAC3E,EACA,IAAID,EAAMC,EAAQ,CACM,KAAK,eAAeD,EAAMC,CAAM,EACxC,cAAc,IAAI,EAAE,OAAOD,CAAI,CAC/C,EACA,eAAeA,EAAMC,EAAQ,CACzB,IAAME,EAAYF,GAAUD,EACtBI,EAAW,MAAM,KAAKD,EAAS,cAAc,QAAQ,EACrDE,EAAQD,EAAS,QAAQD,CAAQ,EACvC,OAAOC,EAAS,MAAM,EAAGC,CAAK,EAAE,QAAQ,EAAE,KAAKC,GAAQA,EAAK,QAAQ,OAAS,SAAS,CAC1F,CACJ,EACA,SAAU,CACN,OAAON,EAAMC,EAAQ,CACjB,OAAOA,GAAWA,IAAW,MAAQD,EAAK,kBAC9C,EACA,IAAIA,EAAMC,EAAQC,EAAM,CACpBA,EAAK,cAAc,IAAI,EAAE,OAAOF,CAAI,CACxC,CACJ,EACA,WAAY,CACR,OAAOA,EAAMC,EAAQ,CACjB,OAAOA,GAAWA,IAAW,MAAQD,EAAK,sBAC9C,EACA,IAAIA,EAAMC,EAAQC,EAAM,CACpBA,EAAK,cAAc,IAAI,EAAE,QAAQF,CAAI,CACzC,CACJ,EACA,eAAgB,CACZ,OAAOA,EAAMC,EAAQ,CACjB,OAAOA,CACX,EACA,IAAID,EAAMC,EAAQ,CACdA,EAAO,sBAAsB,cAAeD,CAAI,CACpD,CACJ,EACA,cAAe,CACX,OAAOA,EAAMC,EAAQ,CACjB,OAAOA,CACX,EACA,IAAID,EAAMC,EAAQ,CACdA,EAAO,sBAAsB,WAAYD,CAAI,CACjD,CACJ,CACJ,EAEaO,GAAN,cAAuBC,CAAU,CAEpC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,MAAQ,KAAK,MAAM,MAExBC,GAAS,MAAM,IAAIC,EAAW,EAE9B,IAAMC,EAAiB,KAAK,UAAU,cAAc,WAAW,EAC/D,KAAK,kBAAkBA,CAAc,EACrC,KAAK,iBAAiB,EACtB,KAAK,iBAAiB,EAEtB,OAAO,QAAQ,OAAO,uBAAwB,KAAK,WAAW,KAAK,IAAI,CAAC,CAC5E,CAKA,kBAAmB,CAEf,KAAK,UAAU,iBAAiB,QAASC,GAAS,CAC9C,GAAIA,EAAM,OAAO,QAAQ,aAAa,EAAG,CACrC,IAAMC,EAASD,EAAM,OAAO,aAAa,WAAW,EAC9CE,EAAWF,EAAM,OAAO,QAAQ,WAAW,EACjD,KAAK,cAAcE,EAAUD,CAAM,CACvC,CACJ,CAAC,EAED,KAAK,4BAA4B,CACrC,CAKA,kBAAmB,CACf,IAAIE,EAAW,GACXC,EAAU,GACRC,EAAkB,CAAC,OAAQ,UAAW,SAAS,EAErD,KAAK,cAAc,iBAAiB,QAASL,GAAS,CAClD,IAAMM,EAAaN,EAAM,OAAO,QAAQ,+BAA+B,EACvE,GAAI,CAACM,EAAY,OAEjBN,EAAM,eAAe,EACrB,IAAMO,EAAYD,EAAW,QAAQ,WAAW,EAAE,iBAAiB,IAAI,EACjEE,EAAOF,EAAW,aAAa,WAAW,EAEhDF,EAAWD,IAAaK,EAAQ,CAACJ,EAAU,GAC3C,IAAIK,EAAe9B,GAAe6B,CAAI,EAClCJ,GAAWC,EAAgB,SAASG,CAAI,IACxCC,EAAe,SAA8B7B,EAAGC,EAAG,CAC/C,MAAO,GAAIF,GAAe6B,CAAI,EAAE5B,EAAGC,CAAC,CACxC,GAGJ,QAAW6B,KAAQH,EACK,MAAM,KAAKG,EAAK,QAAQ,EAAE,OAAOC,GAASA,EAAM,QAAQ,IAAI,CAAC,EACrE,KAAKF,CAAY,EAAE,QAAQG,GAAc,CACjDF,EAAK,YAAYE,CAAU,CAC/B,CAAC,EAGLT,EAAWK,EACX,KAAK,eAAe,CACxB,CAAC,CACL,CAMA,WAAWK,EAAY,CAEnB,GADqB,KAAK,UAAU,cAAc,+BAA+BA,EAAW,EAAE,IAAI,IAAM,KACtF,OAElB,IAAMC,EAAoB,GAAGD,EAAW,IAAI,aAC5C,OAAO,MAAM,IAAIC,CAAiB,EAAE,KAAKC,GAAQ,CAC7C,IAAMC,EAAmBC,GAAUF,EAAK,IAAI,EAC5C,KAAK,cAAc,OAAOC,CAAgB,EAC1C,KAAK,kBAAkBA,CAAgB,EACvC,KAAK,4BAA4B,EAEjBA,EAAiB,cAAc,SAAS,EAChD,MAAM,CAClB,CAAC,CACL,CAMA,kBAAkBE,EAAe,CAC7B,IAAMC,EAAY,MAAM,KAAKD,EAAc,iBAAiB,oCAAoC,CAAC,EAE3FE,EAAkB,CACpB,KAAM,OACN,KAAM,CAAC,OAAQ,SAAS,EACxB,IAAK,CAAC,OAAQ,SAAS,CAC3B,EAEMC,EAAqB,CACvB,KAAM,UACN,KAAM,CAAC,OAAQ,SAAS,EACxB,IAAIC,EAAQC,EAAUC,EAAa,CAC/B,OAAOA,EAAY,aAAa,WAAW,IAAM,MACrD,CACJ,EAEA,QAAWC,KAAYN,EACnBtB,GAAS,OAAO4B,EAAU,CACtB,MAAOA,EAAS,UAAU,SAAS,WAAW,EAAIL,EAAkBC,EACpE,UAAW,IACX,eAAgB,GAChB,cAAe,IACf,OAAQ,IAAM,CACV,KAAK,uBAAuB,EAC5B,KAAK,eAAe,EACpB,KAAK,4BAA4B,CACrC,EACA,UAAW,WACX,WAAY,2BACZ,UAAW,GACX,aAAc,UACd,cAAe,mBACnB,CAAC,CAET,CAQA,wBAAyB,CACrB,IAAMK,EAAiB,KAAK,UAAU,iBAAiB,6CAA6C,EACpG,QAAWC,KAAWD,EACIC,EAAQ,cAAc,QAAQ,uBAAuB,EAC7D,sBAAsB,WAAYA,CAAO,CAE/D,CAKA,gBAAiB,CACb,IAAMC,EAAU,KAAK,eAAe,EACpC,KAAK,MAAM,MAAQ,KAAK,UAAUA,CAAO,CAC7C,CAMA,gBAAiB,CACb,IAAMC,EAAY,CAAC,EACbC,EAAQ,KAAK,UAAU,iBAAiB,YAAY,EAE1D,QAAWpB,KAAQoB,EAAO,CACtB,IAAMC,EAASrB,EAAK,QAAQ,oBAAoB,EAAE,aAAa,SAAS,EAClEsB,EAAiB,MAAM,KAAKtB,EAAK,QAAQ,EAC1C,OAAOtB,GAAQA,EAAK,QAAQ,2CAA2C,CAAC,EAC7E,QAAS6C,EAAI,EAAGA,EAAID,EAAe,OAAQC,IACvC,KAAK,kBAAkBD,EAAeC,CAAC,EAAGA,EAAGF,EAAQF,CAAS,CAEtE,CAEA,OAAOA,CACX,CAUA,kBAAkBK,EAAWzC,EAAOsC,EAAQF,EAAW,CACnD,IAAMM,EAAOD,EAAU,aAAa,WAAW,EACzCE,EAAgB,GAChBC,EAAUH,EAAU,aAAa,SAAS,EAEhDL,EAAU,KAAK,CACX,GAAIQ,EACJ,KAAM5C,EACN,cAAA2C,EACA,KAAAD,EACA,KAAMJ,CACV,CAAC,EAED,IAAMO,EAAWJ,EAAU,iBAAiB,oBAAoB,EAChE,QAASD,EAAI,EAAGA,EAAIK,EAAS,OAAQL,IACjCJ,EAAU,KAAK,CACX,GAAIS,EAASL,CAAC,EAAE,aAAa,SAAS,EACtC,KAAMA,EACN,cAAeI,EACf,KAAM,OACN,KAAMN,CACV,CAAC,CAET,CAOA,cAAcrC,EAAMO,EAAQ,CACxB,IAAMsC,EAAa7C,EAAK,cAAc,QAAQ,aAAa,EACrD8C,EAAa9C,EAAK,cAAc,QAAQ,oBAAoB,EAClEP,GAAYc,CAAM,EAAE,IAAIP,EAAM6C,EAAYC,CAAU,EACpD,KAAK,eAAe,EACpB,KAAK,4BAA4B,EACjC9C,EAAK,eAAe,CAAC,SAAU,SAAU,MAAO,SAAS,CAAC,EAC1DA,EAAK,MAAM,CACf,CAMA,sBAAsBA,EAAM,CACxB,IAAM6C,EAAa7C,EAAK,cAAc,QAAQ,aAAa,EACrD8C,EAAa9C,EAAK,cAAc,QAAQ,oBAAoB,EAClE,OAAW,CAACO,EAAQwC,CAAS,IAAK,OAAO,QAAQtD,EAAW,EAAG,CAC3D,IAAMuD,EAAahD,EAAK,cAAc,eAAeO,CAAM,IAAI,EAC/DyC,EAAW,SAAW,CAACD,EAAU,OAAO/C,EAAM6C,EAAYC,CAAU,CACxE,CACJ,CAEA,6BAA8B,CAC1B,IAAMG,EAAQ,KAAK,UAAU,iBAAiB,0CAA0C,EACxF,QAAWjD,KAAQiD,EACf,KAAK,sBAAsBjD,CAAI,CAEvC,CAEJ,EC7XA,IAAMkD,GAA0B,IAAI,QAWpC,SAASC,GAAcC,EAASC,EAAQC,EAAW,IAAKC,EAAa,KAAM,CACvE,IAAMC,EAAa,OAAO,KAAKH,CAAM,EACrC,QAAWI,KAASD,EAChBJ,EAAQ,MAAMK,CAAK,EAAIJ,EAAOI,CAAK,EAAE,CAAC,EAG1C,IAAMC,EAAU,IAAM,CAClB,QAAWD,KAASD,EAChBJ,EAAQ,MAAMK,CAAK,EAAI,KAE3BL,EAAQ,MAAM,WAAa,KAC3BA,EAAQ,oBAAoB,gBAAiBM,CAAO,EACpDR,GAAwB,OAAOE,CAAO,EAClCG,GAAYA,EAAW,CAC/B,EAEA,WAAW,IAAM,CACbH,EAAQ,MAAM,WAAa,mBAAmBE,CAAQ,KACtD,QAAWG,KAASD,EAChBJ,EAAQ,MAAMK,CAAK,EAAIJ,EAAOI,CAAK,EAAE,CAAC,EAG1CL,EAAQ,iBAAiB,gBAAiBM,CAAO,EACjDR,GAAwB,IAAIE,EAASM,CAAO,CAChD,EAAG,EAAE,CACT,CAMA,SAASC,GAAgCP,EAAS,CAC1CF,GAAwB,IAAIE,CAAO,GAChBF,GAAwB,IAAIE,CAAO,EAC3C,CAEnB,CAQO,SAASQ,GAAOR,EAASE,EAAW,IAAKC,EAAa,KAAM,CAC/DI,GAAgCP,CAAO,EACvCA,EAAQ,MAAM,QAAU,QACxBD,GAAcC,EAAS,CACnB,QAAS,CAAC,IAAK,GAAG,CACtB,EAAGE,EAAU,IAAM,CACXC,GAAYA,EAAW,CAC/B,CAAC,CACL,CAQO,SAASM,GAAQT,EAASE,EAAW,IAAKC,EAAa,KAAM,CAChEI,GAAgCP,CAAO,EACvCD,GAAcC,EAAS,CACnB,QAAS,CAAC,IAAK,GAAG,CACtB,EAAGE,EAAU,IAAM,CACfF,EAAQ,MAAM,QAAU,OACpBG,GAAYA,EAAW,CAC/B,CAAC,CACL,CAOO,SAASO,GAAQV,EAASE,EAAW,IAAK,CAC7CK,GAAgCP,CAAO,EACvC,IAAMW,EAAgBX,EAAQ,sBAAsB,EAAE,OAChDY,EAAiB,iBAAiBZ,CAAO,EACzCa,EAAoBD,EAAe,iBAAiB,aAAa,EACjEE,EAAuBF,EAAe,iBAAiB,gBAAgB,EACvEG,EAAa,CACf,UAAW,CAAC,GAAGJ,CAAa,KAAM,KAAK,EACvC,SAAU,CAAC,SAAU,QAAQ,EAC7B,WAAY,CAACE,EAAmB,KAAK,EACrC,cAAe,CAACC,EAAsB,KAAK,CAC/C,EAEAf,GAAcC,EAASe,EAAYb,EAAU,IAAM,CAC/CF,EAAQ,MAAM,QAAU,MAC5B,CAAC,CACL,CAOO,SAASgB,GAAUhB,EAASE,EAAW,IAAK,CAC/CK,GAAgCP,CAAO,EACvCA,EAAQ,MAAM,QAAU,QACxB,IAAMiB,EAAejB,EAAQ,sBAAsB,EAAE,OAC/CY,EAAiB,iBAAiBZ,CAAO,EACzCkB,EAAmBN,EAAe,iBAAiB,aAAa,EAChEO,EAAsBP,EAAe,iBAAiB,gBAAgB,EACtEG,EAAa,CACf,UAAW,CAAC,MAAO,GAAGE,CAAY,IAAI,EACtC,SAAU,CAAC,SAAU,QAAQ,EAC7B,WAAY,CAAC,MAAOC,CAAgB,EACpC,cAAe,CAAC,MAAOC,CAAmB,CAC9C,EAEApB,GAAcC,EAASe,EAAYb,CAAQ,CAC/C,CAWO,SAASkB,GAAiBpB,EAASE,EAAW,IAAK,CACtD,IAAMmB,EAAcrB,EAAQ,sBAAsB,EAAE,OAC9CsB,EAAwB,iBAAiBtB,CAAO,EAChDuB,EAAkBD,EAAsB,iBAAiB,aAAa,EACtEE,EAAqBF,EAAsB,iBAAiB,gBAAgB,EAElF,MAAO,IAAM,CACTf,GAAgCP,CAAO,EACvC,IAAMiB,EAAejB,EAAQ,sBAAsB,EAAE,OAC/CY,EAAiB,iBAAiBZ,CAAO,EACzCkB,EAAmBN,EAAe,iBAAiB,aAAa,EAChEO,EAAsBP,EAAe,iBAAiB,gBAAgB,EACtEG,EAAa,CACf,OAAQ,CAAC,GAAGM,CAAW,KAAM,GAAGJ,CAAY,IAAI,EAChD,SAAU,CAAC,SAAU,QAAQ,EAC7B,WAAY,CAACM,EAAiBL,CAAgB,EAC9C,cAAe,CAACM,EAAoBL,CAAmB,CAC3D,EAEApB,GAAcC,EAASe,EAAYb,CAAQ,CAC/C,CACJ,CC9JO,IAAMuB,GAAN,cAA8BC,CAAU,CAE3C,OAAQ,CACJ,KAAK,KAAO,KAAK,MAAM,KACvB,KAAK,OAAS,KAAK,MAAM,OAEzB,KAAK,OAAS,KAAK,OAAO,UAAU,SAAS,MAAM,EACnD,KAAK,OAAO,iBAAiB,QAAS,KAAK,MAAM,KAAK,IAAI,CAAC,CAC/D,CAEA,MAAO,CACH,KAAK,OAAO,UAAU,IAAI,MAAM,EAChC,KAAK,OAAO,aAAa,gBAAiB,MAAM,EAChDC,GAAU,KAAK,KAAM,GAAG,EACxB,KAAK,OAAS,EAClB,CAEA,OAAQ,CACJ,KAAK,OAAO,UAAU,OAAO,MAAM,EACnC,KAAK,OAAO,aAAa,gBAAiB,OAAO,EACjDC,GAAQ,KAAK,KAAM,GAAG,EACtB,KAAK,OAAS,EAClB,CAEA,MAAMC,EAAO,CACTA,EAAM,eAAe,EACjB,KAAK,OACL,KAAK,MAAM,EAEX,KAAK,KAAK,CAElB,CAEJ,ECjCO,IAAMC,GAAN,cAAyBC,CAAU,CAAnC,kCAKHC,EAAA,cAAS,MAKTA,EAAA,oBAAe,MAKfA,EAAA,sBAAiB,MAEjBA,EAAA,eAAU,CAAC,GAEXA,EAAA,kBAAa,gBAEb,OAAQ,CACJ,KAAK,UAAY,KAAK,MAAM,UAC5B,KAAK,MAAQ,KAAK,IAClB,KAAK,YAAc,KAAK,MAAM,OAC9B,KAAK,gBAAkB,KAAK,UAAU,eACtC,KAAK,yBAA2B,KAAK,MAAM,yBAC3C,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,gBAAkB,KAAK,MAAM,gBAClC,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,WAAa,IAAI,IAAI,KAAK,MAAM,WAAW,MAAM,GAAG,CAAC,EAE1D,KAAK,eAAe,EACpB,KAAK,gBAAgB,CACzB,CAEA,gBAAiB,CACb,KAAK,UAAU,iBAAiB,UAAWC,GAAS,CAC5CA,EAAM,SAAWA,EAAM,MAAQ,SAC/B,KAAK,KAAK,CAElB,CAAC,EAEDC,EAAS,KAAK,gBAAiBD,GAAS,CACpC,IAAME,EAAWF,EAAM,OAAO,QAAQ,KACtC,KAAK,cAAc,MAAQE,EAC3B,KAAK,oBAAoBA,CAAQ,CACrC,CAAC,EAEDC,GAAa,KAAK,cAAe,IAAM,KAAK,KAAK,CAAC,EAClD,KAAK,cAAc,iBAAiB,QAAS,IAAM,KAAK,oBAAoB,KAAK,cAAc,KAAK,CAAC,EACrGF,EAAS,KAAK,WAAY,IAAM,KAAK,KAAK,CAAC,EAE3CG,EAAa,KAAK,YAAa,SAAU,QAAS,CAACJ,EAAOK,IAAS,CAC/DL,EAAM,eAAe,EACrB,IAAMM,EAAcD,EAAK,QAAQ,KAC7B,KAAK,QACL,KAAK,OAAO,WAAW,KAAK,QAAQC,CAAW,CAAC,CAExD,CAAC,CACL,CAEA,iBAAkB,CACd,QAAWC,KAAU,KAAK,gBACtB,KAAK,yBAAyBA,CAAM,EAGxC,KAAK,iBAAiB,CAC1B,CAKA,yBAAyBA,EAAQ,CAC7B,IAAML,EAAWK,EAAO,QAAQ,KAC5BC,EAAa,KAAK,WAAW,IAAIN,CAAQ,EAC7CK,EAAO,aAAa,iBAAkBC,EAAa,OAAS,OAAO,EAEnEJ,EAAaG,EAAO,cAAe,+BAAgC,QAAS,IAAM,CAC9EC,EAAa,CAACA,EAEVA,EACA,KAAK,WAAW,IAAIN,CAAQ,EAE5B,KAAK,WAAW,OAAOA,CAAQ,EAGnCK,EAAO,aAAa,iBAAkBC,EAAa,OAAS,OAAO,EAEnE,OAAO,MAAM,MAAM,8CAA+C,CAC9D,SAAAN,EACA,OAAQM,CACZ,CAAC,EAED,KAAK,iBAAiB,EAClBA,GACAD,EAAO,eAAe,CAAC,MAAO,SAAU,SAAU,QAAQ,CAAC,CAEnE,CAAC,CACL,CAEA,kBAAmB,CACf,IAAME,EAAgB,KAAK,gBAAgB,KAAK,CAACC,EAAGC,IAAM,CACtD,IAAMC,EAAOF,EAAE,QAAQ,YAAc,OAC/BG,EAAOF,EAAE,QAAQ,YAAc,OAErC,OAAIC,GAAQ,CAACC,EACF,GACLA,GAAQ,CAACD,GAIRF,EAAE,QAAQ,KAAOC,EAAE,QAAQ,KAHvB,EAGkC,EACjD,CAAC,EAAE,IAAIJ,GAAUA,EAAO,aAAa,EAErC,QAAWO,KAAUL,EACjB,KAAK,yBAAyB,OAAOK,CAAM,CAEnD,CAEA,MAAO,CACC,KAAK,cACL,KAAK,aAAa,KAAK,OAAO,WAAW,EAAG,KAAK,cAAc,KAAK,EAExE,KAAK,KAAK,CACd,CAEA,MAAM,KAAKC,EAAMb,EAAUc,EAAcC,EAAgB,CACrD,KAAK,cAAc,MAAQf,EAC3B,KAAK,aAAec,EACpB,KAAK,eAAiBC,EAEtB,MAAM,KAAK,KAAK,EAChB,KAAK,oBAAoBf,CAAQ,EACjC,KAAK,OAAO,WAAWa,CAAI,CAC/B,CAEA,MAAM,MAAO,CACT,IAAMG,EAAO,MAAM,OAAO,gBAAgB,MAAM,EAC3C,KAAK,SACN,KAAK,OAASA,EAAK,YAAY,KAAK,YAAa,KAAK,cAAc,KAAK,GAG7E,KAAK,YAAY,EACjB,KAAK,SAAS,EAAE,KAAK,IAAM,CACvB,KAAK,OAAO,MAAM,CACtB,EAAG,IAAM,CACL,KAAK,WAAW,EACZ,KAAK,gBACL,KAAK,eAAe,CAE5B,CAAC,CACL,CAEA,MAAO,CACH,KAAK,SAAS,EAAE,KAAK,EACrB,KAAK,WAAW,CACpB,CAKA,UAAW,CACP,OAAO,OAAO,YAAY,eAAe,KAAK,MAAO,OAAO,CAChE,CAEA,MAAM,iBAAiBhB,EAAU,CAC7B,KAAK,OAAO,QAAQA,EAAU,KAAK,OAAO,WAAW,CAAC,CAC1D,CAEA,oBAAoBA,EAAU,CAC1B,KAAK,iBAAiBA,CAAQ,EAC9B,IAAMiB,EAAYjB,EAAS,YAAY,EAEvC,QAAWkB,KAAQ,KAAK,gBAAiB,CACrC,IAAMC,EAAOD,EAAK,QAAQ,KAAK,YAAY,EAAE,KAAK,EAC5CE,EAAUH,IAAcE,EAC9BD,EAAK,UAAU,OAAO,SAAUE,CAAO,EACnCA,GACAF,EAAK,eAAe,CAAC,MAAO,SAAU,SAAU,QAAQ,CAAC,CAEjE,CACJ,CAEA,aAAc,CACV,KAAK,QAAU,KAAK,MAAM,OAAO,eAAe,QAAQ,KAAK,UAAU,GAAK,IAAI,EAChF,IAAMG,EAAc,OAAO,KAAK,KAAK,OAAO,EAAE,QAAQ,EACtD,KAAK,gBAAgB,UAAU,OAAO,SAAUA,EAAY,SAAW,CAAC,EACxE,KAAK,YAAY,UAAYA,EAAY,IAAIC,GAAO,CAChD,IAAMC,EAAa,IAAI,KAAK,SAASD,EAAK,EAAE,CAAC,EAAG,mBAAmB,EACnE,MAAO,wCAAwCA,CAAG,uBAAuBC,CAAS,gBACtF,CAAC,EAAE,KAAK,EAAE,CACd,CAEA,YAAa,CACT,GAAI,CAAC,KAAK,OAAQ,OAClB,IAAMV,EAAO,KAAK,OAAO,WAAW,EACpC,GAAI,CAACA,EAAM,OAGX,IAAMW,EAAiB,OAAO,KAAK,KAAK,OAAO,EAAE,IAAI,EACrD,GAAI,KAAK,QAAQA,CAAc,IAAMX,EAAM,OAE3C,KAAK,QAAQ,OAAO,KAAK,IAAI,CAAC,CAAC,EAAIA,EACnC,IAAMY,EAAgB,KAAK,UAAU,KAAK,OAAO,EACjD,OAAO,eAAe,QAAQ,KAAK,WAAYA,CAAa,CAChE,CAEJ,EClNO,IAAMC,GAAN,cAA8BC,CAAU,CAE3C,OAAQ,CACJ,IAAMC,EAAY,KAAK,IAEJA,EAAU,iBAAiB,KAAK,EACpC,OAAS,GACpB,OAAO,gBAAgB,MAAM,EAAE,KAAKC,GAAQ,CACxCA,EAAK,gBAAgBD,CAAS,CAClC,CAAC,CAET,CAEJ,ECTO,IAAME,GAAN,cAA2BC,CAAU,CAExC,MAAM,OAAQ,CACV,GAAM,CAAC,KAAAC,CAAI,EAAI,KAAK,OACP,MAAM,OAAO,gBAAgB,MAAM,GAC3C,aAAa,KAAK,IAAKA,CAAI,CACpC,CAEJ,ECPO,IAAMC,GAAN,cAA0BC,CAAU,CAEvC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,QAAU,KAAK,MAAM,QAC1B,KAAK,QAAU,KAAK,MAAM,QAEtB,KAAK,UACL,KAAK,QAAQ,iBAAiB,QAAS,KAAK,OAAO,KAAK,IAAI,CAAC,EAC7D,KAAK,oBAAoB,EAEjC,CAEA,MAAO,CACH,KAAK,UAAU,UAAU,IAAI,MAAM,EACnC,KAAK,QAAQ,aAAa,gBAAiB,MAAM,EACjDC,GAAU,KAAK,QAAS,GAAG,CAC/B,CAEA,OAAQ,CACJ,KAAK,UAAU,UAAU,OAAO,MAAM,EACtC,KAAK,QAAQ,aAAa,gBAAiB,OAAO,EAClDC,GAAQ,KAAK,QAAS,GAAG,CAC7B,CAEA,QAAS,CACD,KAAK,UAAU,UAAU,SAAS,MAAM,EACxC,KAAK,MAAM,EAEX,KAAK,KAAK,CAElB,CAEA,qBAAsB,CACJ,KAAK,QAAQ,cAAc,sBAAsB,GAE3D,KAAK,KAAK,CAElB,CAEJ,ECvCO,IAAMC,GAAN,cAA4BC,CAAU,CAEzC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,cAAgB,KAAK,MAAM,QAEhC,KAAK,IAAM,KAEXC,EAAS,KAAK,cAAe,IAAM,CAC/B,KAAK,WAAW,EAAI,EACpB,KAAK,SAAS,EAAE,KAAK,CACzB,CAAC,CACL,CAEA,MAAO,CACH,YAAK,SAAS,EAAE,KAAK,KAAM,IAAM,CAC7B,KAAK,WAAW,EAAK,CACzB,CAAC,EAEM,IAAI,QAAQC,GAAO,CACtB,KAAK,IAAMA,CACf,CAAC,CACL,CAKA,UAAW,CACP,OAAO,OAAO,YAAY,eAAe,KAAK,UAAW,OAAO,CACpE,CAKA,WAAWC,EAAQ,CACX,KAAK,MACL,KAAK,IAAIA,CAAM,EACf,KAAK,IAAM,KAEnB,CAEJ,EC/CO,IAAMC,GAAN,cAA6BC,CAAU,CAE1C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,SAAW,KAAK,UAAU,cAAc,sBAAsB,EACnE,KAAK,QAAU,KAAK,UAAU,cAAc,mBAAmB,EAE/D,KAAK,SAAS,iBAAiB,SAAU,KAAK,YAAY,KAAK,IAAI,CAAC,EACpE,KAAK,UAAU,iBAAiB,UAAW,KAAK,UAAU,KAAK,IAAI,CAAC,CACxE,CAEA,UAAUC,EAAO,EACUA,EAAM,MAAQ,KAAOA,EAAM,MAAQ,WAEtDA,EAAM,eAAe,EACrB,KAAK,OAAO,EAEpB,CAEA,QAAS,CACL,KAAK,SAAS,QAAU,CAAC,KAAK,SAAS,QACvC,KAAK,SAAS,cAAc,IAAI,MAAM,QAAQ,CAAC,EAC/C,KAAK,YAAY,CACrB,CAEA,aAAc,CACV,IAAMC,EAAU,KAAK,SAAS,QAAU,OAAS,QACjD,KAAK,QAAQ,aAAa,eAAgBA,CAAO,CACrD,CAEJ,EC9BO,IAAMC,GAAN,cAAiCC,CAAU,CAE9C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,UAAY,GAEjB,KAAK,UAAU,iBAAiB,SAAU,KAAK,SAAS,KAAK,IAAI,CAAC,CACtE,CAEA,UAAW,CACH,KAAK,YAEL,KAAK,UAAU,cAAc,KAAK,GAClC,OAAO,gBAAgB,MAAM,EAAE,KAAKC,GAAQ,CACxCA,EAAK,gBAAgB,KAAK,SAAS,CACvC,CAAC,EAEL,KAAK,UAAY,GACrB,CAEJ,ECdO,IAAMC,GAAN,cAAuBC,CAAU,CAEpC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,KAAO,KAAK,MAAM,KACvB,KAAK,OAAS,KAAK,MAAM,OACzB,KAAK,SAAW,KAAK,MAAM,SAC3B,KAAK,cAAgB,KAAK,MAAM,gBAAkB,OAElD,KAAK,UAAa,SAAS,MAAQ,MAAS,QAAU,OACtD,KAAK,KAAO,SAAS,KACrB,KAAK,QAAU,GAEf,KAAK,KAAO,KAAK,KAAK,KAAK,IAAI,EAC/B,KAAK,eAAe,CACxB,CAEA,KAAKC,EAAQ,KAAM,CACf,KAAK,QAAQ,EAEb,KAAK,KAAK,MAAM,QAAU,QAC1B,KAAK,KAAK,UAAU,IAAI,OAAQ,QAAQ,EACxC,KAAK,OAAO,aAAa,gBAAiB,MAAM,EAEhD,IAAMC,EAAmB,KAAK,KAAK,sBAAsB,EACrDC,EAAe,EACbC,EAAe,KAAK,OAAO,sBAAsB,EAAE,OACnDC,EAAcH,EAAiB,OAAS,OAAO,YAC/CI,EAAgB,KAAK,UAAU,sBAAsB,EAgB3D,GAbI,KAAK,WACL,KAAK,KAAK,YAAY,KAAK,IAAI,EAC/B,KAAK,KAAK,MAAM,SAAW,QAC3B,KAAK,KAAK,MAAM,MAAQ,GAAGJ,EAAiB,KAAK,KACjD,KAAK,KAAK,MAAM,KAAO,GAAGA,EAAiB,IAAI,KAC3CG,EACAF,EAAgB,OAAO,YAAcD,EAAiB,IAAME,EAAe,EAE3ED,EAAeD,EAAiB,KAKpCG,EAAa,CACb,KAAK,KAAK,MAAM,IAAM,UACtB,KAAK,KAAK,MAAM,OAAS,GAAGF,CAAY,KACxC,IAAMI,EAAa,OAAO,YAAc,IAAO,OAAO,YAAcD,EAAc,QAClF,KAAK,KAAK,MAAM,UAAY,GAAG,KAAK,MAAMC,CAAS,CAAC,IACxD,KAAO,CACH,KAAK,KAAK,MAAM,IAAM,GAAGJ,CAAY,KACrC,KAAK,KAAK,MAAM,OAAS,UACzB,IAAMI,EAAa,OAAO,YAAc,GAAMD,EAAc,IAC5D,KAAK,KAAK,MAAM,UAAY,GAAG,KAAK,MAAMC,CAAS,CAAC,IACxD,CAGA,KAAK,KAAK,iBAAiB,aAAc,KAAK,IAAI,EAClD,OAAO,iBAAiB,QAASC,GAAc,CACtC,KAAK,KAAK,SAASA,EAAW,MAAM,GACrC,KAAK,KAAK,CAElB,CAAC,EAGD,IAAMC,EAAQ,KAAK,KAAK,cAAc,OAAO,EACzCA,IAAU,MAAMA,EAAM,MAAM,EAEhC,KAAK,QAAU,GAEf,IAAMC,EAAY,IAAI,MAAM,MAAM,EAClC,KAAK,UAAU,cAAcA,CAAS,EAElCT,GACAA,EAAM,gBAAgB,CAE9B,CAEA,SAAU,CACN,QAAWU,KAAY,OAAO,YAAY,IAAI,UAAU,EACpDA,EAAS,KAAK,CAEtB,CAEA,MAAO,CACH,KAAK,KAAK,MAAM,QAAU,OAC1B,KAAK,KAAK,UAAU,OAAO,OAAQ,QAAQ,EAC3C,KAAK,OAAO,aAAa,gBAAiB,OAAO,EACjD,KAAK,KAAK,MAAM,IAAM,GACtB,KAAK,KAAK,MAAM,OAAS,GACzB,KAAK,KAAK,MAAM,UAAY,GAExB,KAAK,WACL,KAAK,KAAK,MAAM,SAAW,GAC3B,KAAK,KAAK,MAAM,KAAK,SAAS,EAAI,GAClC,KAAK,KAAK,MAAM,MAAQ,GACxB,KAAK,KAAK,MAAM,KAAO,GACvB,KAAK,UAAU,YAAY,KAAK,IAAI,GAGxC,KAAK,QAAU,EACnB,CAEA,gBAAiB,CACb,IAAMC,EAAqB,IAAIC,GAA0B,KAAK,UAAWZ,GAAS,CAC9E,KAAK,KAAK,EACV,KAAK,OAAO,MAAM,EACb,KAAK,eACNA,EAAM,gBAAgB,CAE9B,EAAGA,GAAS,CACJA,EAAM,OAAO,WAAa,UAC1BA,EAAM,eAAe,EACrBA,EAAM,gBAAgB,GAE1B,KAAK,KAAK,CACd,CAAC,EAEG,KAAK,UACLW,EAAmB,kBAAkB,KAAK,IAAI,EAIlD,KAAK,UAAU,iBAAiB,QAASX,GAAS,CACrB,MAAM,KAAK,KAAK,KAAK,iBAAiB,GAAG,CAAC,EAC9C,SAASA,EAAM,MAAM,GACtC,KAAK,KAAK,CAElB,CAAC,EAEDa,EAAS,KAAK,OAAQb,GAAS,CAC3BA,EAAM,gBAAgB,EACtBA,EAAM,eAAe,EACrB,KAAK,KAAKA,CAAK,EACXA,aAAiB,eACjBW,EAAmB,UAAU,CAErC,CAAC,CACL,CAEJ,EChJO,IAAMG,GAAN,cAA6BC,CAAU,CAE1C,OAAQ,CACJ,KAAK,KAAO,KAAK,IACjB,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,YAAc,KAAK,MAAM,QAC9B,KAAK,kBAAoB,KAAK,MAAM,cAEpC,KAAK,oBAAsB,KAAK,MAAM,oBACtC,KAAK,IAAM,KAAK,MAAM,IAEtB,KAAK,KAAK,iBAAiB,OAAQ,KAAK,OAAO,KAAK,IAAI,CAAC,EACzD,KAAK,YAAY,iBAAiB,QAAS,KAAK,SAAS,KAAK,IAAI,CAAC,EAEnE,KAAK,cAAgBC,GAAS,KAAK,cAAe,IAAK,EAAK,CAChE,CAEA,QAAS,CACL,KAAK,SAAS,CAClB,CAEA,UAAW,CACP,IAAMC,EAAQ,KAAK,YAAY,MAAM,YAAY,EAAE,KAAK,EACpD,KAAK,oBACL,KAAK,eAAeA,CAAK,GAEzB,KAAK,cAAc,EAAI,EACvB,KAAK,kBAAkB,UAAY,GACnC,KAAK,cAAcA,CAAK,EAEhC,CAEA,cAAcC,EAAY,CACtB,KAAK,SAASA,CAAU,CAC5B,CAEA,eAAeA,EAAY,CACvB,IAAMC,EAAY,KAAK,kBAAkB,iBAAiB,KAAK,mBAAmB,EAClF,QAAWC,KAAYD,EAAW,CAC9B,IAAME,EAAQ,CAACH,GAAcE,EAAS,YAAY,YAAY,EAAE,SAASF,CAAU,EACnFE,EAAS,MAAM,QAAUC,EAAQ,OAAS,OAC1CD,EAAS,UAAU,OAAO,SAAU,CAACC,CAAK,CAC9C,CACJ,CAEA,MAAM,SAASH,EAAa,GAAI,CAC5B,KAAK,kBAAkB,UAAY,GACnC,KAAK,cAAc,EAAI,EAEvB,GAAI,CACA,IAAMI,EAAO,MAAM,OAAO,MAAM,IAAI,KAAK,WAAWJ,CAAU,CAAC,EACzDK,EAAUC,GAAiB,KAAK,kBAAmB,EAAE,EAC3D,KAAK,kBAAkB,UAAYF,EAAK,KACxCC,EAAQ,CACZ,OAASE,EAAK,CACV,QAAQ,MAAMA,CAAG,CACrB,CAEA,KAAK,cAAc,EAAK,EACpB,KAAK,qBACL,KAAK,SAAS,CAEtB,CAEA,WAAWP,EAAa,KAAM,CAC1B,GAAI,CAACA,EACD,OAAO,KAAK,IAGhB,IAAMQ,EAAS,KAAK,IAAI,SAAS,GAAG,EAAI,IAAM,IAC9C,MAAO,GAAG,KAAK,GAAG,GAAGA,CAAM,UAAU,mBAAmBR,CAAU,CAAC,EACvE,CAEA,cAAcS,EAAO,GAAO,CACxB,KAAK,YAAY,MAAM,QAAUA,EAAO,QAAU,MACtD,CAEJ,ECjFO,IAAMC,GAAN,KAAgB,CAMnB,YAAYC,EAAe,CACvB,KAAK,KAAOA,CAChB,CAKA,UAAW,CACP,MAAO,EAAQ,KAAK,MAAS,EAAQ,KAAK,KAAK,OAAU,KAAK,KAAK,MAAM,OAAS,CACtF,CAMA,qBAAsB,CAClB,IAAMC,EAAU,KAAK,KAAK,QAAQ,UAAU,EAC5C,OAAOA,GAAWA,EAAQ,SAAS,SAAS,CAChD,CAMA,WAAY,CACR,GAAM,CAAC,MAAAC,CAAK,EAAI,KAAK,KACfC,EAAS,CAAC,EAEhB,QAAWC,KAAQF,EACf,GAAIE,EAAK,SAAS,OAAO,EAAG,CACxB,IAAMC,EAAO,KAAK,KAAK,QAAQD,CAAI,EACnCD,EAAO,KAAKE,EAAK,UAAU,CAAC,CAChC,CAGJ,IAAMC,EAAa,KAAK,SAAS,EAAE,OAAOC,GAAKA,EAAE,KAAK,SAAS,OAAO,CAAC,EACvE,OAAAJ,EAAO,KAAK,GAAGG,CAAU,EAElBH,CACX,CAMA,UAAW,CACP,GAAM,CAAC,MAAAK,CAAK,EAAI,KAAK,KACrB,MAAO,CAAC,GAAGA,CAAK,CACpB,CAEJ,EAEA,eAAsBC,GAAoBC,EAAM,CAC5C,GAAI,OAAO,iBAAmB,UAAU,UAAW,CAC/C,MAAM,UAAU,UAAU,UAAUA,CAAI,EACxC,MACJ,CAGA,IAAMC,EAAY,SAAS,cAAc,UAAU,EACnDA,EAAU,MAAQ,mDAClBA,EAAU,MAAQD,EAClB,SAAS,KAAK,YAAYC,CAAS,EACnCA,EAAU,OAAO,EACjB,SAAS,YAAY,MAAM,EAC3B,SAAS,KAAK,YAAYA,CAAS,CACvC,CClEO,IAAMC,GAAN,cAAuBC,CAAU,CAEpC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,cAAgB,KAAK,UAAU,cAAgB,CAAC,EAErD,KAAK,SAAW,GAEhB,KAAK,IAAM,KAAK,MAAM,IACtB,KAAK,QAAU,KAAK,MAAM,QAAU,QAAQ,YAAY,EACxD,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,cAAgB,OAAO,KAAK,MAAM,WAAW,EAClD,KAAK,mBAAqB,KAAK,MAAM,mBACrC,KAAK,SAAW,KAAK,MAAM,SAC3B,KAAK,gBAAkB,KAAK,MAAM,WAClC,KAAK,cAAgB,KAAK,MAAM,gBAAkB,OAElD,KAAK,eAAe,CACxB,CAMA,aAAaC,EAAQ,CACjB,KAAK,SAAWA,CACpB,CAEA,gBAAiB,CACbC,EAAS,KAAK,cAAe,KAAK,oBAAoB,KAAK,IAAI,CAAC,EAChE,KAAK,wBAAwB,CACjC,CAEA,yBAA0B,CACtB,IAAIC,EAAQ,EAENC,EAAQ,IAAM,CAChB,KAAK,YAAY,EACjBD,EAAQ,CACZ,EAEA,KAAK,WAAW,iBAAiB,YAAaE,GAAS,CACnDA,EAAM,eAAe,EACrBF,GAAS,EAELA,IAAU,GAAK,KAAK,UACpB,KAAK,YAAY,CAEzB,CAAC,EAED,KAAK,WAAW,iBAAiB,WAAYE,GAAS,CAClDA,EAAM,eAAe,CACzB,CAAC,EAED,KAAK,WAAW,iBAAiB,UAAWD,CAAK,EACjD,KAAK,WAAW,iBAAiB,YAAa,IAAM,CAChDD,GAAS,EACLA,IAAU,GACVC,EAAM,CAEd,CAAC,EACD,KAAK,WAAW,iBAAiB,OAAQC,GAAS,CAI9C,GAHAA,EAAM,eAAe,EACrBD,EAAM,EAEF,CAAC,KAAK,SACN,OAIJ,IAAME,EADY,IAAIC,GAAUF,EAAM,YAAY,EAC1B,SAAS,EACjC,QAAWG,KAAQF,EACf,KAAK,qBAAqBE,CAAI,CAEtC,CAAC,CACL,CAEA,qBAAsB,CAClB,IAAMC,EAAQC,GAAK,QAAS,CACxB,KAAM,OACN,MAAO,qDACP,OAAQ,KAAK,gBACb,SAAU,KAAK,cAAgB,GAAK,IACxC,CAAC,EACD,KAAK,UAAU,OAAOD,CAAK,EAC3BA,EAAM,MAAM,EACZA,EAAM,iBAAiB,SAAU,IAAM,CACnC,QAAWD,KAAQC,EAAM,MACrB,KAAK,qBAAqBD,CAAI,EAElCC,EAAM,OAAO,CACjB,CAAC,CACL,CAEA,aAAc,CAEV,GAAI,CADY,KAAK,WAAW,cAAc,mBAAmB,EACnD,CACV,IAAME,EAAWD,GAAK,MAAO,CAAC,MAAO,kBAAkB,EAAG,CAAC,KAAK,QAAQ,CAAC,EACzE,KAAK,WAAW,OAAOC,CAAQ,CACnC,CACJ,CAEA,aAAc,CACV,IAAMC,EAAU,KAAK,WAAW,cAAc,mBAAmB,EAC7DA,GACAA,EAAQ,OAAO,CAEvB,CAMA,qBAAqBJ,EAAM,CACvB,GAAM,CACF,IAAAK,EAAK,OAAAC,EAAQ,SAAAC,EAAU,QAAAC,CAC3B,EAAI,KAAK,iBAAiBR,CAAI,EAC9B,KAAK,WAAW,OAAOK,CAAG,EAC1B,IAAMI,EAAY,KAEZC,EAAS,CACX,KAAAV,EACA,IAAAK,EACA,eAAeM,EAAiB,CAC5BJ,EAAS,YAAc,GAAGI,CAAe,IACzCJ,EAAS,MAAM,MAAQ,GAAGI,CAAe,GAC7C,EACA,UAAUC,EAAS,CACfN,EAAO,aAAa,cAAe,OAAO,EAC1CA,EAAO,YAAcM,EACrBC,GAAcR,CAAG,EACjB,KAAK,eAAe,GAAG,CAC3B,EACA,YAAYO,EAAS,CACjBN,EAAO,aAAa,cAAe,SAAS,EAC5CA,EAAO,YAAcM,EACrBC,GAAcR,CAAG,EACjB,WAAWG,EAAS,IAAI,EACxBC,EAAU,MAAM,iBAAkB,CAC9B,KAAMT,EAAK,IACf,CAAC,CACL,CACJ,EAGA,OAAIA,EAAK,KAAQ,KAAK,cAAgB,KAClCU,EAAO,UAAU,KAAK,kBAAkB,EACjCA,IAGX,KAAK,kBAAkBA,CAAM,EAEtBA,EACX,CAKA,kBAAkBA,EAAQ,CACtB,IAAMI,EAAW,IAAI,SACrBA,EAAS,OAAO,OAAQJ,EAAO,KAAMA,EAAO,KAAK,IAAI,EACjD,KAAK,SAAW,QAChBI,EAAS,OAAO,UAAW,KAAK,MAAM,EAE1C,IAAML,EAAY,KAEZM,EAAM,OAAO,MAAM,qBAAqB,OAAQ,KAAK,IAAK,CAC5D,OAAQ,CACJL,EAAO,UAAUD,EAAU,YAAY,CAC3C,EACA,kBAAmB,CACf,GAAI,KAAK,aAAe,eAAe,MAAQ,KAAK,SAAW,IAC3DC,EAAO,YAAYD,EAAU,cAAc,UACpC,KAAK,aAAe,eAAe,MAAQ,KAAK,QAAU,IAAK,CACtE,IAAMO,EAAU,KAAK,aACfC,EAAOD,EAAQ,WAAW,GAAG,EAAI,KAAK,MAAMA,CAAO,EAAI,CAAC,QAASA,CAAO,EACxEJ,EAAUK,GAAM,SAAWA,GAAM,OAASD,EAChDN,EAAO,UAAUE,CAAO,CAC5B,CACJ,CACJ,CAAC,EAEDG,EAAI,OAAO,iBAAiB,WAAYG,GAAO,CAC3C,IAAMC,EAAU,KAAK,IAAI,KAAK,KAAMD,EAAI,OAASA,EAAI,MAAS,GAAG,EAAG,GAAG,EACvER,EAAO,eAAeS,CAAO,CACjC,CAAC,EAEDJ,EAAI,iBAAiB,SAAU,kBAAkB,EACjDA,EAAI,KAAKD,CAAQ,CACrB,CAMA,iBAAiBd,EAAM,CACnB,IAAMoB,EAAQlB,GAAK,MAAO,CAAC,IAAK,6SAA6S,CAAC,EACxUI,EAASJ,GAAK,MAAO,CAAC,MAAO,2BAA2B,EAAG,CAAC,CAAC,EAC7DK,EAAWL,GAAK,MAAO,CAAC,MAAO,6BAA6B,CAAC,EAC7DmB,EAAYnB,GAAK,MAAO,CAAC,MAAO,+BAA+B,EAAG,CAACkB,CAAK,CAAC,EAEzEf,EAAMH,GAAK,MAAO,CAAC,MAAO,oBAAoB,EAAG,CACnDmB,EACAnB,GAAK,MAAO,CAAC,MAAO,8BAA8B,EAAG,CACjDA,GAAK,MAAO,CAAC,MAAO,0BAA0B,EAAG,CAACF,EAAK,IAAI,CAAC,EAC5DsB,GAAW,EACXhB,CACJ,CAAC,EACDC,CACJ,CAAC,EAEGP,EAAK,KAAK,WAAW,QAAQ,IAC7BoB,EAAM,IAAM,IAAI,gBAAgBpB,CAAI,GAGxC,IAAMQ,EAAU,IAAM,CAClBH,EAAI,UAAU,IAAI,SAAS,EAC3BA,EAAI,iBAAiB,eAAgB,IAAM,CACvCA,EAAI,OAAO,CACf,CAAC,CACL,EAEA,OAAAA,EAAI,iBAAiB,QAASG,CAAO,EAE9B,CACH,IAAAH,EAAK,SAAAE,EAAU,OAAAD,EAAQ,QAAAE,CAC3B,CACJ,CAEJ,EC5OO,IAAMe,GAAN,cAA4BC,CAAU,CAEzC,OAAQ,CAEJ,KAAK,UAAY,KAAK,IACtB,KAAK,QAAU,KAAK,UAAU,UAC9B,KAAK,gBAAkB,KAAK,UAAU,WACtC,KAAK,aAAe,KAAK,MAAM,OAC/B,KAAK,aAAe,KAAK,UAAU,QAAQ,cAAc,EAEzD,KAAK,eAAe,EAGpB,KAAK,aAAa,KAAK,gBAAgB,CAAC,EAAE,QAAQ,UAAU,CAChE,CAEA,gBAAiB,CAEb,KAAK,aAAa,iBAAiB,QAAS,IAAM,KAAK,OAAO,CAAC,EAE/D,KAAK,UAAU,iBAAiB,QAASC,GAAS,CAC9C,IAAMC,EAASD,EAAM,OAAO,QAAQ,QAAQ,EAC5C,GAAI,KAAK,QAAQ,SAASC,CAAM,EAAG,CAC/B,IAAMC,EAAOD,EAAO,QAAQ,IAC5B,KAAK,aAAaC,EAAM,EAAI,CAChC,CACJ,CAAC,CACL,CAEA,QAAS,CACL,KAAK,UAAU,UAAU,OAAO,MAAM,EACtC,IAAMC,EAAS,KAAK,UAAU,UAAU,SAAS,MAAM,EACvD,KAAK,aAAa,aAAa,gBAAiBA,EAAS,OAAS,OAAO,EACzE,KAAK,aAAa,UAAU,OAAO,eAAgBA,CAAM,CAC7D,CAEA,aAAaC,EAASC,EAAc,GAAO,CAEvC,QAAWJ,KAAU,KAAK,QACtBA,EAAO,UAAU,OAAO,QAAQ,EAClBA,EAAO,QAAQ,MACfG,GAASH,EAAO,UAAU,IAAI,QAAQ,EAIxD,QAAWK,KAAa,KAAK,gBACzBA,EAAU,MAAM,QAAU,OACZA,EAAU,QAAQ,aAClBF,IAASE,EAAU,MAAM,QAAU,SAGjDD,GAAe,CAAC,KAAK,UAAU,UAAU,SAAS,MAAM,GACxD,KAAK,OAAO,CAEpB,CAEJ,ECvDO,IAAME,GAAN,cAAgCC,CAAU,CAE7C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,WAAa,KAAK,MAAM,WAE7B,KAAK,sBAAwB,KAAK,MAAM,gBACxC,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,cAAgB,KAAK,MAAM,cAEhC,KAAK,eAAe,CACxB,CAEA,gBAAiB,CAEb,KAAK,sBAAsB,iBAAiB,SAAUC,GAAS,CAC3D,IAAMC,EAAUD,EAAM,OAAO,QACvBE,EAAc,SAAS,iBAAiB,gCAAgC,EAC9E,QAAWC,KAAcD,EACrBC,EAAW,SAAWF,EACtBE,EAAW,QAAU,EAE7B,CAAC,EAGD,KAAK,UAAU,iBAAiB,QAASH,GAAS,CAC9C,IAAMI,EAASJ,EAAM,OAAO,QAAQ,QAAQ,EACxCI,GAAUA,EAAO,QAAQ,QACzB,KAAK,uBAAuBA,CAAM,CAE1C,CAAC,EAGD,KAAK,WAAW,iBAAiB,SAAU,IAAM,CAC7C,IAAMC,EAAS,KAAK,WAAW,MAC3BA,GACA,KAAK,WAAWA,CAAM,CAE9B,CAAC,CACL,CAEA,MAAM,WAAWA,EAAQ,CACrB,KAAK,WAAW,SAAW,GAG3B,IAAMC,EAAS,KAAK,WAAW,cAAc,iBAAiBD,CAAM,IAAI,EACpEC,GACAA,EAAO,OAAO,EAIlB,IAAMC,EAAO,MAAM,OAAO,MAAM,IAAI,yBAAyB,KAAK,UAAU,IAAIF,CAAM,EAAE,EAClFG,EAAMC,GAAUF,EAAK,IAAI,EAC/B,KAAK,cAAc,OAAOC,CAAG,EAE7B,KAAK,WAAW,SAAW,EAC/B,CAEA,uBAAuBJ,EAAQ,CAC3B,IAAMI,EAAMJ,EAAO,QAAQ,gBAAgB,EACrC,CAAC,OAAAC,CAAM,EAAID,EAAO,QAClB,CAAC,SAAAM,CAAQ,EAAIN,EAAO,QAEpBE,EAAS,SAAS,cAAc,QAAQ,EAC9CA,EAAO,MAAQD,EACfC,EAAO,YAAcI,EAErB,KAAK,WAAW,OAAOJ,CAAM,EAC7BE,EAAI,OAAO,CACf,CAEJ,ECvEO,IAAMG,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CACJ,KAAK,SAAW,KAAK,MAAM,SAC3B,KAAK,WAAa,KAAK,MAAM,WAE7B,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,aAAe,KAAK,MAAM,aAE/B,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,KAAK,YAAY,iBAAiB,SAAU,KAAK,UAAU,KAAK,IAAI,CAAC,EACrE,KAAK,WAAW,iBAAiB,SAAUC,GAAK,CAC5CA,EAAE,eAAe,EACjB,KAAK,UAAU,CACnB,CAAC,EAEDC,EAAS,KAAK,YAAa,KAAK,YAAY,KAAK,IAAI,CAAC,CAC1D,CAEA,WAAY,CACR,IAAMC,EAAO,KAAK,YAAY,MAAM,KAAK,EACzC,GAAIA,EAAK,SAAW,EAAG,CACnB,KAAK,YAAY,EACjB,MACJ,CAEA,KAAK,WAAW,UAAU,OAAO,QAAQ,EACzC,KAAK,YAAY,UAAU,IAAI,QAAQ,EACvC,KAAK,aAAa,UAAU,OAAO,QAAQ,EAE3C,IAAMC,EAAM,OAAO,QAAQ,WAAW,KAAK,UAAU,IAAI,KAAK,QAAQ,EAAE,EACxE,OAAO,MAAM,IAAIA,EAAK,CAAC,KAAAD,CAAI,CAAC,EAAE,KAAKE,GAAQ,CACvC,KAAK,cAAc,UAAYA,EAAK,IACxC,CAAC,EAAE,MAAM,QAAQ,KAAK,EAAE,KAAK,IAAM,CAC/B,KAAK,aAAa,UAAU,IAAI,QAAQ,CAC5C,CAAC,CACL,CAEA,aAAc,CACV,KAAK,WAAW,UAAU,IAAI,QAAQ,EACtC,KAAK,YAAY,UAAU,OAAO,QAAQ,EAC1C,KAAK,aAAa,UAAU,IAAI,QAAQ,EACxC,KAAK,YAAY,MAAQ,EAC7B,CAEJ,EC1CO,IAAMC,GAAN,cAA6BC,CAAU,CAE1C,OAAQ,CACJ,KAAK,KAAO,KAAK,IAEjB,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,YAAc,KAAK,MAAM,OAC9B,KAAK,QAAU,KAAK,MAAM,QAC1B,KAAK,iBAAmB,KAAK,MAAM,QAEnC,KAAK,cAAgB,CACjB,YAAa,KAAK,MAAM,aAAe,oBACvC,iBAAkB,KAAK,MAAM,kBAAoB,OACjD,eAAgB,KAAK,MAAM,gBAAkB,GAC7C,aAAc,KAAK,YAAY,OAAS,EAC5C,EAEA,KAAK,OAAS,GACd,KAAK,UAAY,EAEjB,KAAK,eAAe,EACpB,KAAK,YAAY,EAEb,KAAK,cAAc,gBACnB,KAAK,YAAY,CAEzB,CAKA,uBAAuBC,EAAS,CAC5B,OAAO,OAAO,KAAK,cAAeA,CAAO,EACzC,KAAK,MAAM,EACX,KAAK,YAAY,MAAQ,KAAK,cAAc,YAChD,CAEA,gBAAiB,CACb,KAAK,KAAK,iBAAiB,QAAS,KAAK,QAAQ,KAAK,IAAI,CAAC,EAE3D,IAAIC,EAAa,EACjB,KAAK,YAAY,iBAAiB,QAAS,IAAM,CAC7CA,EAAa,KAAK,IAAI,EACtB,KAAK,YAAY,EACjB,WAAW,IAAM,CACT,KAAK,IAAI,EAAIA,EAAa,KAC9B,KAAK,eAAe,KAAK,YAAY,KAAK,CAC9C,EAAG,GAAG,CACV,CAAC,EAED,KAAK,YAAY,iBAAiB,UAAWC,GAAS,CAC9CA,EAAM,UAAY,IAAIA,EAAM,eAAe,CACnD,CAAC,EAGDC,EAAa,KAAK,IAAK,qBAAsB,UAAWD,GAAS,CAC7D,GAAIA,EAAM,SAAWA,EAAM,OAAS,QAAS,CACzC,IAAME,EAAO,KAAK,IAAI,QAAQ,MAAM,EACpC,GAAIA,EAAM,CACNA,EAAK,OAAO,EACZF,EAAM,eAAe,EACrB,MACJ,CACJ,CAEIA,EAAM,OAAS,aACf,KAAK,cAAc,EAAI,EAEvBA,EAAM,OAAS,WACf,KAAK,cAAc,EAAK,CAEhC,CAAC,EAED,KAAK,YAAY,iBAAiB,UAAWA,GAAS,CAC9CA,EAAM,OAAS,aACf,KAAK,cAAc,EAAI,CAE/B,CAAC,CACL,CAEA,cAAcG,EAAU,GAAM,CAC1B,IAAMC,EAAQ,MAAM,KAAK,KAAK,iBAAiB,iBAAiB,oBAAoB,CAAC,EAC/EC,EAAgBD,EAAM,QAAQ,SAAS,aAAa,EACpDE,EAAUF,EAAMC,GAAiBF,EAAU,EAAI,GAAG,GAAKC,EAAM,CAAC,EAChEE,GACAA,EAAQ,MAAM,CAEtB,CAEA,OAAQ,CACJ,KAAK,YAAY,MAAQ,GACzB,KAAK,YAAY,EACjB,KAAK,YAAY,CACrB,CAEA,aAAc,CACV,KAAK,YAAY,MAAM,CAC3B,CAEA,aAAc,CACV,KAAK,QAAQ,MAAM,QAAU,QAC7B,KAAK,iBAAiB,MAAM,QAAU,MAC1C,CAEA,aAAc,CACV,KAAK,QAAQ,MAAM,QAAU,OAC7B,KAAK,iBAAiB,MAAM,QAAU,OAC1C,CAEA,aAAc,CACV,GAAI,CAAC,KAAK,cAAc,eACpB,MAAM,IAAI,MAAM,kDAAkD,EAGtE,GAAI,KAAK,cAAc,aAAc,CACjC,KAAK,eAAe,KAAK,cAAc,YAAY,EACnD,MACJ,CAEA,OAAO,MAAM,IAAI,KAAK,UAAU,CAAC,EAAE,KAAKC,GAAQ,CAC5C,KAAK,iBAAiB,UAAYA,EAAK,KACvC,KAAK,YAAY,CACrB,CAAC,CACL,CAEA,WAAY,CACR,IAAMC,EAAQ,SAAS,mBAAmB,KAAK,cAAc,WAAW,CAAC,eAAe,mBAAmB,KAAK,cAAc,gBAAgB,CAAC,GAC/I,MAAO,GAAG,KAAK,cAAc,cAAc,IAAIA,CAAK,EACxD,CAEA,eAAeC,EAAY,CACvB,GAAI,CAAC,KAAK,cAAc,eACpB,MAAM,IAAI,MAAM,kDAAkD,EAGtE,KAAK,MAAM,MAAQ,GACnB,IAAMC,EAAM,GAAG,KAAK,UAAU,CAAC,SAAS,mBAAmBD,CAAU,CAAC,GACtE,OAAO,MAAM,IAAIC,CAAG,EAAE,KAAKH,GAAQ,CAC/B,KAAK,iBAAiB,UAAYA,EAAK,KACvC,KAAK,YAAY,CACrB,CAAC,CACL,CAEA,eAAgB,CACZ,IAAMI,EAAM,KAAK,IAAI,EACfC,EAASD,EAAM,KAAK,UAAY,IACtC,YAAK,UAAYA,EACVC,CACX,CAEA,QAAQZ,EAAO,CACX,IAAMa,EAAWb,EAAM,OAAO,QAAQ,oBAAoB,EACtDa,IACAb,EAAM,eAAe,EACrBA,EAAM,gBAAgB,EACtB,KAAK,WAAWa,CAAQ,EAEhC,CAEA,WAAWC,EAAM,CACb,IAAMC,EAAa,KAAK,cAAc,EAChCC,EAAOF,EAAK,aAAa,kBAAkB,EAC3CG,EAAKH,EAAK,aAAa,gBAAgB,EACvCI,EAAc,CAACJ,EAAK,UAAU,SAAS,UAAU,GAAKC,EAE5D,KAAK,YAAY,EACjB,KAAK,MAAM,MAAQG,EAAa,GAAGF,CAAI,IAAIC,CAAE,GAAK,GAElD,IAAME,EAAOL,EAAK,aAAa,MAAM,EAC/BM,EAAON,EAAK,cAAc,wBAAwB,EAAE,YACpDO,EAAO,CAAC,GAAI,OAAOJ,CAAE,EAAG,KAAAG,EAAM,KAAAD,CAAI,EAEpCD,EACAJ,EAAK,UAAU,IAAI,UAAU,EAE7B,OAAO,QAAQ,KAAK,uBAAwB,IAAI,EAGhD,GAACC,GAAc,CAACG,KAEhBH,GACA,KAAK,iBAAiBM,CAAI,EAE1BH,GACA,OAAO,QAAQ,KAAK,uBAAwBG,CAAI,EAExD,CAEA,iBAAiBA,EAAM,CACnB,OAAO,QAAQ,KAAK,wBAAyBA,CAAI,CACrD,CAEA,aAAc,CACV,IAAMC,EAAW,KAAK,KAAK,iBAAiB,WAAW,EACvD,QAAWC,KAAgBD,EACvBC,EAAa,UAAU,OAAO,WAAY,oBAAoB,CAEtE,CAEJ,ECnNO,IAAMC,GAAN,cAAkCC,CAAU,CAE/C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,aAAe,KAAK,MAAM,OAC/B,KAAK,WAAa,KAAK,MAAM,SAE7B,KAAK,SAAW,KAChB,KAAK,UAAY,KAEjB,KAAK,aAAa,iBAAiB,QAAS,KAAK,oBAAoB,KAAK,IAAI,CAAC,EAC/E,OAAO,QAAQ,OAAO,uBAAwB,KAAK,kBAAkB,KAAK,IAAI,CAAC,EAC/E,OAAO,QAAQ,OAAO,wBAAyB,KAAK,yBAAyB,KAAK,IAAI,CAAC,CAC3F,CAOA,KAAKC,EAAUC,EAAgB,CAAC,EAAG,CAC/B,KAAK,SAAWD,EAChB,KAAK,YAAY,EAAE,uBAAuBC,CAAa,EACvD,KAAK,SAAS,EAAE,KAAK,EAErB,KAAK,YAAY,EAAE,YAAY,CACnC,CAEA,MAAO,CACH,KAAK,SAAS,EAAE,KAAK,CACzB,CAKA,UAAW,CACP,OAAO,OAAO,YAAY,eAAe,KAAK,UAAW,OAAO,CACpE,CAKA,aAAc,CACV,OAAO,OAAO,YAAY,eAAe,KAAK,WAAY,iBAAiB,CAC/E,CAEA,qBAAsB,CAClB,KAAK,yBAAyB,KAAK,SAAS,CAChD,CAEA,kBAAkBC,EAAQ,CACtB,KAAK,UAAYA,EACbA,IAAW,KACX,KAAK,aAAa,aAAa,WAAY,MAAM,EAEjD,KAAK,aAAa,gBAAgB,UAAU,CAEpD,CAEA,yBAAyBA,EAAQ,CAC7B,KAAK,KAAK,EACV,KAAK,YAAY,EAAE,MAAM,EACrB,KAAK,UAAYA,GAAQ,KAAK,SAASA,CAAM,CACrD,CAEJ,ECrDO,IAAMC,GAAN,cAA8BC,CAAU,CAE3C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,KAAO,KAAK,MAAM,KAEvBC,EAAS,KAAK,IAAK,IAAM,CACrB,KAAK,MAAM,KAAK,KAAM,KAAK,KAAK,CACpC,CAAC,CACL,CAEJ,ECtBO,IAAMC,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CACJ,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,OAAS,KAAK,MAAM,SAAW,OACpC,KAAK,eAAiB,KAAK,MAAM,eAGjC,KAAK,IAAI,iBAAiB,QAAS,KAAK,MAAM,KAAK,IAAI,CAAC,CAC5D,CAEA,KAAKC,EAAc,CACfC,GAAUD,EAAc,GAAG,CAC/B,CAEA,MAAMA,EAAc,CAChBE,GAAQF,EAAc,GAAG,CAC7B,CAEA,MAAMG,EAAO,CACTA,EAAM,eAAe,EAErB,IAAMC,EAAgB,SAAS,iBAAiB,KAAK,cAAc,EACnE,QAAWC,KAASD,GACD,KAAK,OAAS,KAAK,MAAQ,KAAK,MACxCC,CAAK,EAGhB,KAAK,OAAS,CAAC,KAAK,OACpB,KAAK,iBAAiB,KAAK,MAAM,CACrC,CAEA,iBAAiBC,EAAQ,CACrB,OAAO,MAAM,MAAM,KAAK,eAAgB,CACpC,OAAQA,EAAS,OAAS,OAC9B,CAAC,CACL,CAEJ,EChCO,IAAMC,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,sBAAwB,KAAK,MAAM,kBACxC,KAAK,YAAc,KAAK,MAAM,QAC9B,KAAK,OAAS,KAAK,MAAM,OAEzB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,IAAMC,EAA6BC,GAAS,KAAK,kBAAkB,KAAK,IAAI,EAAG,IAAK,EAAK,EAGzF,KAAK,MAAM,iBAAiB,QAAS,IAAM,CACvC,GAAM,CAAC,MAAAC,CAAK,EAAI,KAAK,MACjBA,EAAM,OAAS,GACf,KAAK,YAAY,MAAM,QAAU,QACjC,KAAK,sBAAsB,MAAM,QAAU,MAC3CF,EAA2BE,CAAK,GAEhC,KAAK,gBAAgB,CAE7B,CAAC,EAGD,KAAK,MAAM,iBAAiB,WAAY,IAAM,CAC1C,KAAK,MAAM,aAAa,eAAgB,IAAI,EAC5C,KAAK,OAAO,MAAM,EAClB,KAAK,MAAM,MAAM,CACrB,CAAC,EAED,IAAIC,GAA0B,KAAK,UAAW,IAAM,CAChD,KAAK,gBAAgB,CACzB,CAAC,CACL,CAKA,MAAM,kBAAkBC,EAAQ,CAC5B,GAAM,CAAC,KAAMC,CAAO,EAAI,MAAM,OAAO,MAAM,IAAI,kBAAmB,CAAC,KAAMD,CAAM,CAAC,EAChF,GAAI,CAAC,KAAK,MAAM,MACZ,OAGJ,IAAME,EAAYC,GAAUF,CAAO,EAEnC,KAAK,sBAAsB,UAAY,GACvC,KAAK,sBAAsB,MAAM,QAAU,IAC3C,KAAK,YAAY,MAAM,QAAU,OACjC,KAAK,sBAAsB,OAAOC,CAAS,EACtC,KAAK,UAAU,UAAU,SAAS,eAAe,GAClD,KAAK,gBAAgB,CAE7B,CAEA,iBAAkB,CACd,KAAK,UAAU,UAAU,IAAI,eAAe,EAC5C,OAAO,sBAAsB,IAAM,CAC/B,KAAK,YAAY,UAAU,IAAI,8BAA8B,CACjE,CAAC,CACL,CAEA,iBAAkB,CACd,KAAK,UAAU,UAAU,OAAO,eAAe,EAC/C,KAAK,YAAY,UAAU,OAAO,8BAA8B,EAChE,KAAK,sBAAsB,UAAY,EAC3C,CAEJ,EChFO,IAAME,GAAN,cAAiCC,CAAU,CAE9C,OAAQ,CACJ,KAAK,KAAO,KAAK,IACjB,KAAK,aAAe,KAAK,MAAM,OAC/B,KAAK,KAAO,KAAK,MAAM,KAEvB,KAAK,KAAO,GACZ,KAAK,aAAa,iBAAiB,QAAS,KAAK,SAAS,KAAK,IAAI,CAAC,EACpE,KAAK,cAAgB,KAAK,cAAc,KAAK,IAAI,EACjD,KAAK,UAAY,KAAK,UAAU,KAAK,IAAI,CAC7C,CAEA,SAASC,EAAO,CACZ,KAAK,KAAO,CAAC,KAAK,KAClB,KAAK,KAAK,UAAU,OAAO,OAAQ,KAAK,IAAI,EAC5C,KAAK,aAAa,aAAa,gBAAiB,KAAK,KAAO,OAAS,OAAO,EACxE,KAAK,MACL,KAAK,KAAK,iBAAiB,UAAW,KAAK,SAAS,EACpD,OAAO,iBAAiB,QAAS,KAAK,aAAa,IAEnD,KAAK,KAAK,oBAAoB,UAAW,KAAK,SAAS,EACvD,OAAO,oBAAoB,QAAS,KAAK,aAAa,GAE1DA,EAAM,gBAAgB,CAC1B,CAEA,UAAUA,EAAO,CACTA,EAAM,OAAS,UACf,KAAK,SAASA,CAAK,CAE3B,CAEA,cAAcA,EAAO,CACjB,KAAK,SAASA,CAAK,CACvB,CAEJ,EClCO,IAAMC,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CAEJ,KAAK,WAAa,KAAK,MAAM,WAG7B,KAAK,UAAY,KAAK,IACtB,KAAK,QAAU,KAAK,MAAM,MAC1B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,WAAa,KAAK,UAAU,WACjC,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,yBAA2B,KAAK,MAAM,yBAC3C,KAAK,kBAAoB,KAAK,MAAM,kBACpC,KAAK,SAAW,KAAK,MAAM,SAG3B,KAAK,KAAO,UACZ,KAAK,aAAe,CAAC,EACrB,KAAK,iBAAmB,EACxB,KAAK,SAAW,KAChB,KAAK,WAAa,IAAM,CACpB,KAAK,QAAU,GACf,KAAK,KAAO,EACZ,KAAK,OAAS,KAClB,EACA,KAAK,WAAW,EAEhB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CAEbC,EAAS,KAAK,WAAYC,GAAK,CAC3B,KAAK,SAAS,EACd,KAAK,OAASA,EAAE,OAAO,QAAQ,OAC/B,KAAK,mBAAmB,KAAK,MAAM,EACnC,KAAK,YAAY,CACrB,CAAC,EAGD,KAAK,WAAW,iBAAiB,SAAUC,GAAS,CAChD,KAAK,cAAc,EACnB,KAAK,YAAY,EACjB,KAAK,aAAa,gBAAgB,SAAU,CAAC,KAAK,YAAY,KAAK,EACnEA,EAAM,eAAe,CACzB,CAAC,EAGDF,EAAS,KAAK,aAAc,IAAM,CAC9B,KAAK,cAAc,EACnB,KAAK,gBAAgB,EACrB,KAAK,YAAY,CACrB,CAAC,EAGDG,EAAa,KAAK,UAAW,oBAAqB,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,EAGtF,KAAK,cAAc,iBAAiB,0BAA2B,KAAK,mBAAmB,KAAK,IAAI,CAAC,EAGjG,KAAK,cAAc,iBAAiB,QAASD,GAAS,CAClDA,EAAM,OAAO,IAAM,OAAO,QAAQ,mBAAmB,CACzD,EAAG,EAAI,EAGPF,EAAS,KAAK,aAAc,IAAM,CAC1B,KAAK,UACL,KAAK,SAAS,KAAK,YAAY,EAEnC,KAAK,KAAK,CACd,CAAC,EAGDG,EAAa,KAAK,cAAe,wBAAyB,QAAS,IAAM,CACjE,KAAK,cACL,KAAK,kBAAkB,KAAK,aAAa,GAAI,EAAI,CAEzD,CAAC,EAGDA,EAAa,KAAK,cAAe,gCAAiC,QAAS,MAAOC,EAAGC,IAAW,CAC5FA,EAAO,SAAW,GACd,KAAK,cACL,MAAM,KAAK,kBAAkB,KAAK,aAAa,EAAE,EAErDA,EAAO,SAAW,EACtB,CAAC,EAGD,KAAK,cAAc,iBAAiB,oBAAqB,IAAM,CAC3D,KAAK,eAAe,EACpB,KAAK,cAAc,CACvB,CAAC,EAGD,KAAK,UAAU,iBAAiB,0BAA2B,KAAK,eAAe,KAAK,IAAI,CAAC,EAGzF,IAAMC,EAAa,KAAK,cAAc,cAClCC,EAAe,CAAC,EACpBD,EAAW,iBAAiB,QAASJ,GAAS,CAG1C,GAAI,EAFiB,KAAK,KAAKI,EAAW,aAAeA,EAAW,SAAS,IACxCA,EAAW,eAC5BJ,EAAM,OAAS,EAC/B,OAGJ,IAAMM,EAAY,KAAK,IAAI,EAAI,IAC/BD,EAAa,KAAK,KAAK,IAAI,CAAC,EAC5BA,EAAeA,EAAa,OAAOE,GAAKA,GAAKD,CAAS,EAClDD,EAAa,OAAS,GAAK,KAAK,YAAY,GAC5C,KAAK,YAAY,CAEzB,CAAC,CACL,CAEA,KAAKG,EAAUC,EAAO,UAAW,CAC7B,KAAK,SAAS,EAEd,KAAK,SAAWD,EAChB,KAAK,KAAOC,EACZ,KAAK,SAAS,EAAE,KAAK,EAErB,IAAMC,EAAcD,IAAS,UAC7B,KAAK,kBAAkB,UAAU,OAAO,SAAUC,CAAW,EAC7D,KAAK,aAAa,UAAU,OAAO,SAAUA,CAAW,EACxD,KAAK,WAAW,UAAU,OAAO,SAAUA,CAAW,EAGrC,OAAO,YAAY,eAAe,KAAK,UAAW,UAAU,EACpE,aAAa,CAACA,CAAW,EAE7B,KAAK,UACN,KAAK,YAAY,EACjB,KAAK,QAAU,GAEvB,CAEA,MAAO,CACH,KAAK,SAAS,EAAE,KAAK,CACzB,CAKA,UAAW,CACP,OAAO,OAAO,YAAY,eAAe,KAAK,QAAS,OAAO,CAClE,CAEA,MAAM,aAAc,CAChB,IAAMC,EAAS,CACX,KAAM,KAAK,KACX,OAAQ,KAAK,YAAY,OAAS,KAClC,YAAa,KAAK,WAClB,YAAa,KAAK,SAAW,MAAQ,KAAO,KAAK,MACrD,EAEM,CAAC,KAAMC,CAAI,EAAI,MAAM,OAAO,MAAM,IAAI,UAAU,KAAK,IAAI,GAAID,CAAM,EACrEA,EAAO,OAAS,IAChB,KAAK,cAAc,UAAY,IAEnC,KAAK,8BAA8BC,CAAI,EACvCC,GAAc,KAAK,aAAa,CACpC,CAEA,8BAA8BD,EAAM,CAChC,IAAME,EAAK,SAAS,cAAc,KAAK,EACvCA,EAAG,UAAYF,EAEf,IAAMG,EAAWD,EAAG,cAAc,YAAY,EAC1CC,IACAA,EAAS,OAAO,EAChB,KAAK,SAAS,UAAYA,EAAS,WAEvC,KAAK,SAAS,gBAAgB,SAAU,CAACA,CAAQ,EAEjD,OAAO,YAAY,KAAKD,CAAE,EAC1B,QAAWE,IAAS,CAAC,GAAGF,EAAG,QAAQ,EAC/B,KAAK,cAAc,YAAYE,CAAK,CAE5C,CAEA,mBAAmBC,EAAY,CAC3B,QAAWC,KAAO,KAAK,WAAY,CAC/B,IAAMC,EAAWD,EAAI,QAAQ,SAAWD,EACxCC,EAAI,aAAa,gBAAiBC,EAAW,OAAS,OAAO,CACjE,CACJ,CAEA,UAAW,CACP,KAAK,WAAW,EAChB,KAAK,cAAc,EACnB,KAAK,gBAAgB,EACrB,KAAK,cAAc,EACnB,KAAK,mBAAmB,KAAK,EAC7B,KAAK,aAAa,UAAU,IAAI,QAAQ,CAC5C,CAEA,iBAAkB,CACd,KAAK,YAAY,MAAQ,GACzB,KAAK,aAAa,gBAAgB,SAAU,EAAI,CACpD,CAEA,eAAgB,CACZ,KAAK,cAAc,UAAY,GAC/B,KAAK,yBAAyB,gBAAgB,QAAQ,CAC1D,CAEA,eAAgB,CACZC,GAAY,KAAK,aAAa,EAC9B,KAAK,KAAO,CAChB,CAEA,gBAAiB,CACb,KAAK,cAAc,EACnB,KAAK,YAAY,CACrB,CAEA,MAAM,mBAAmBpB,EAAO,CAC5B,IAAIqB,EAAQ,KAAK,MAAMrB,EAAM,OAAO,IAAI,EAClCsB,EAAeD,GAASA,EAAM,KAAO,KAAK,aAAa,IACtD,KAAK,IAAI,EAAI,KAAK,iBAAmB,IACtCE,EAAkBvB,EAAM,OAAO,UAAU,SAAS,UAAU,EAClE,CAAC,GAAG,KAAK,cAAc,iBAAiB,WAAW,CAAC,EAAE,QAAQc,GAAM,CAChEA,EAAG,UAAU,OAAO,UAAU,CAClC,CAAC,EAEG,CAACS,GAAmB,CAACD,GACrBtB,EAAM,OAAO,UAAU,IAAI,UAAU,EACrCqB,EAAQ,MAAM,KAAK,kBAAkBA,EAAM,EAAE,GACrCC,EAEDA,IACPD,EAAQ,KAAK,cAFb,KAAK,cAAc,EAKvB,KAAK,aAAa,UAAU,OAAO,SAAUE,CAAe,EAExDD,GAAc,KAAK,WACnB,KAAK,SAASD,CAAK,EACnB,KAAK,KAAK,GAGd,KAAK,aAAeA,EACpB,KAAK,iBAAmB,KAAK,IAAI,CACrC,CAEA,MAAM,kBAAkBG,EAASC,EAAgB,GAAO,CAC/CA,IACD,KAAK,cAAc,UAAY,IAGnC,IAAMd,EAASc,EAAgB,CAAC,OAAQ,EAAI,EAAI,CAAC,EAC3C,CAAC,KAAMC,CAAQ,EAAI,MAAM,OAAO,MAAM,IAAI,gBAAgBF,CAAO,GAAIb,CAAM,EACjF,KAAK,cAAc,UAAYe,EAC/B,KAAK,yBAAyB,aAAa,SAAU,EAAE,EACvD,OAAO,YAAY,KAAK,KAAK,aAAa,EAE1C,IAAMC,EAAc,KAAK,cAAc,cAAc,gCAAgC,EACrF,OAAO,KAAK,MAAMA,EAAY,IAAI,CACtC,CAEA,aAAc,CACVP,GAAY,KAAK,QAAQ,EACzB,KAAK,MAAQ,EACb,KAAK,YAAY,CACrB,CAEA,aAAc,CACV,OAAO,KAAK,SAAS,cAAc,QAAQ,GAAK,CAAC,KAAK,SAAS,aAAa,QAAQ,CACxF,CAEA,MAAM,kBAAkBI,EAAS,CAC7B,GAAI,CACA,IAAMI,EAAW,MAAM,OAAO,MAAM,IAAI,WAAWJ,CAAO,qBAAqB,EAC/E,OAAO,QAAQ,QAAQI,EAAS,IAAI,EACpC,KAAK,eAAe,CACxB,OAASC,EAAK,CACV,OAAO,QAAQ,kBAAkBA,CAAG,CACxC,CACJ,CAEJ,ECrSO,IAAMC,GAAN,cAA0BC,CAAU,CAEvC,OAAQ,CACJ,KAAK,UAAY,KAAK,MAAM,MAC5B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,aAAe,KAAK,MAAM,cAAgB,KAE/C,KAAK,aAAe,KAAK,MAAM,aAE/B,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,KAAK,YAAY,iBAAiB,QAAS,KAAK,MAAM,KAAK,IAAI,CAAC,EAE5D,KAAK,cACL,KAAK,aAAa,iBAAiB,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,EAG3E,KAAK,WAAW,iBAAiB,SAAU,KAAK,gBAAgB,KAAK,IAAI,CAAC,CAC9E,CAEA,iBAAkB,CACd,KAAK,WAAW,aAAa,WAAY,UAAU,EAC/C,KAAK,aACL,KAAK,YAAY,aAAa,WAAY,UAAU,EAGxD,QAAWC,KAAQ,KAAK,WAAW,MAC/B,KAAK,UAAU,IAAM,OAAO,IAAI,gBAAgBA,CAAI,EAExD,KAAK,UAAU,UAAU,OAAO,MAAM,CAC1C,CAEA,OAAQ,CACJ,KAAK,WAAW,MAAQ,GACxB,KAAK,UAAU,IAAM,KAAK,aAC1B,KAAK,WAAW,gBAAgB,UAAU,EACtC,KAAK,aACL,KAAK,YAAY,aAAa,WAAY,UAAU,EAExD,KAAK,UAAU,UAAU,OAAO,MAAM,CAC1C,CAEA,aAAc,CACV,KAAK,WAAW,MAAQ,GACxB,KAAK,UAAU,UAAU,IAAI,MAAM,EACnC,KAAK,YAAY,gBAAgB,UAAU,EAC3C,KAAK,WAAW,aAAa,WAAY,UAAU,CACvD,CAEJ,EClDO,IAAMC,GAAN,cAA8BC,CAAU,CAE3C,OAAQ,CACJ,KAAK,KAAO,KAAK,IACjB,KAAK,KAAO,KAAK,MAAM,KAEvB,KAAK,UAAY,KAAK,MAAM,KAC5B,KAAK,WAAa,KAAK,MAAM,MAC7B,KAAK,KAAO,KAAK,MAAM,KAEvB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,KAAK,KAAK,iBAAiB,QAASC,GAAS,CACrCA,EAAM,OAAO,QAAQ,mBAAmB,IAAM,MAC9C,KAAK,gBAAgBA,CAAK,CAElC,CAAC,EAED,KAAK,KAAK,iBAAiB,QAASA,GAAS,CACrCA,EAAM,OAAO,QAAQ,iBAAiB,IAAM,MAC5C,KAAK,mBAAmBA,CAAK,CAErC,CAAC,CACL,CAEA,gBAAgBA,EAAO,CACnB,IAAMC,EAAaD,EAAM,OAAO,QAAQ,mBAAmB,EAC3D,KAAK,UAAU,MAAQC,EAAW,aAAa,iBAAiB,EAChED,EAAM,eAAe,EACrB,KAAK,KAAK,OAAO,CACrB,CAEA,mBAAmBA,EAAO,CACtB,IAAME,EAAa,KAAK,WAAW,MACnC,KAAK,WAAW,MAASA,IAAe,MAAS,OAAS,MAC1DF,EAAM,eAAe,EACrB,KAAK,KAAK,OAAO,CACrB,CAEJ,EC7CO,IAAMG,GAAN,cAA6BC,CAAU,CAE1C,OAAQ,CACJ,KAAK,KAAO,KAAK,IAEjB,KAAK,OAAS,KAAK,MAAM,OACzB,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,qBAAuB,KAAK,MAAM,qBACvC,KAAK,sBAAwB,KAAK,MAAM,sBAExC,KAAK,QAAU,KAAK,MAAM,QAC1B,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,QAAU,KAAK,MAAM,QAC1B,KAAK,YAAc,KAAK,MAAM,YAE9B,GAAM,CAAC,iBAAAC,CAAgB,EAAI,KAAK,MAC1BC,EAAgBD,EAAiB,iBAAiB,wBAAwB,EAEhF,KAAK,OAAS,KACd,OAAO,gBAAgB,UAAU,EAAE,KAAKE,GAC7BA,EAAS,KAAK,CACjB,OAAQ,KAAK,OACb,UAAW,KAAK,KAChB,UAAW,KAAK,QAChB,QAAS,KAAK,MACd,UAAW,KAAK,aAAa,EAC7B,cAAe,MAAM,KAAKD,CAAa,EACvC,KAAM,CACF,kBAAmB,KAAK,sBACxB,iBAAkB,KAAK,oBAC3B,CACJ,CAAC,CACJ,EAAE,KAAKE,GAAU,CACd,KAAK,OAASA,EACd,KAAK,eAAe,EACpB,KAAK,iBAAiB,EACtB,KAAK,qBAAqB,EAC1B,KAAK,OAAO,QAAQ,gBAAgB,CACxC,CAAC,CACL,CAEA,kBAAmB,CACf,OAAO,QAAQ,WAAW,KAAK,KAAM,yBAA0B,CAC3D,WAAY,KAAK,OAAO,SAAS,YAAY,EAC7C,UAAW,KAAK,QAChB,aAAc,KAAK,OAAO,EAC9B,CAAC,CACL,CAEA,gBAAiB,CAEb,KAAK,KAAK,iBAAiB,QAASC,GAAS,CACzC,IAAMC,EAASD,EAAM,OAAO,QAAQ,qBAAqB,EACzD,GAAIC,IAAW,KAAM,OAErB,IAAMC,EAASD,EAAO,aAAa,aAAa,EAGhD,GAFIC,IAAW,eAAe,KAAK,OAAO,QAAQ,gBAAgB,EAC9DA,IAAW,cAAc,KAAK,OAAO,QAAQ,iBAAiB,EAC9DA,IAAW,kBAAoBF,EAAM,SAAWA,EAAM,SAAU,CAChE,KAAK,OAAO,QAAQ,iBAAiB,EACrC,MACJ,CACIE,IAAW,iBAAiB,KAAK,OAAO,QAAQ,aAAa,EAC7DA,IAAW,cAAc,KAAK,OAAO,QAAQ,WAAW,CAChE,CAAC,EAGD,KAAK,KAAK,iBAAiB,QAASF,GAAS,CACzC,IAAMG,EAAeH,EAAM,OAAO,QAAQ,uBAAuB,EACjE,GAAI,CAACG,EAAc,OAEnB,IAAMC,EAAwB,KAAK,KAAK,iBAAiB,uBAAuB,EAChF,QAAWC,KAAcD,EACrBC,EAAW,UAAU,OAAO,QAAQ,EAGxCF,EAAa,QAAQ,uBAAuB,EAAE,UAAU,IAAI,QAAQ,CACxE,CAAC,EAED,KAAK,kBAAkB,CAC3B,CAEA,mBAAoB,CAChB,KAAK,QAAQ,iBAAiB,cAAe,IAAM,CAC/C,IAAMG,EAAW,KAAK,KAAK,sBAAsB,EAC3CC,EAAeP,GAAS,CAC1B,IAAMQ,EAAOR,EAAM,MAAQM,EAAS,KAC9BG,EAAO,KAAK,IAAI,KAAK,IAAI,GAAI,KAAK,MAAOD,EAAOF,EAAS,MAAS,GAAG,CAAC,EAAG,EAAE,EACjF,KAAK,YAAY,MAAM,UAAY,GAAG,IAAMG,CAAI,IAChD,KAAK,OAAO,SAAS,IAAI,cAAeA,CAAI,CAChD,EACMC,EAAa,IAAM,CACrB,OAAO,oBAAoB,cAAeH,CAAY,EACtD,OAAO,oBAAoB,YAAaG,CAAU,EAClD,KAAK,QAAQ,MAAM,cAAgB,KACnC,SAAS,KAAK,MAAM,WAAa,IACrC,EAEA,KAAK,QAAQ,MAAM,cAAgB,OACnC,SAAS,KAAK,MAAM,WAAa,OACjC,OAAO,iBAAiB,cAAeH,CAAY,EACnD,OAAO,iBAAiB,YAAaG,CAAU,CACnD,CAAC,EACD,IAAMC,EAAe,KAAK,OAAO,SAAS,IAAI,aAAa,EACvDA,IACA,KAAK,YAAY,MAAM,UAAY,GAAG,IAAMA,CAAY,IAEhE,CAEA,sBAAuB,CAEnB,IAAMC,EADe,IAAI,IAAI,OAAO,QAAQ,EAAG,aAChB,IAAI,cAAc,EAC7CA,GACA,KAAK,OAAO,QAAQ,aAAaA,CAAU,CAEnD,CAMA,cAAe,CACX,IAAMC,EAAe,SAAS,cAAc,cAAc,EAC1D,OAAKA,GAIEA,EAAa,aAAa,YAAY,GAAK,EACtD,CAOA,YAAa,CACT,OAAO,KAAK,OAAO,QAAQ,WAAW,CAC1C,CAEJ,EC3IO,IAAMC,GAAN,cAA8BC,CAAU,CAE3C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,aAAe,KAAK,UAAU,cAAc,yBAAyB,EAEtE,KAAK,eACL,KAAK,aAAa,iBAAiB,SAAU,KAAK,mBAAmB,KAAK,IAAI,CAAC,EAC/E,KAAK,mBAAmB,EAEhC,CAEA,oBAAqB,CACjB,IAAMC,EAAY,KAAK,aAAa,QAAU,OACxCC,EAAgB,KAAK,UAAU,iBAAiB,sBAAsB,EAC5E,QAAWC,KAASD,EAChBC,EAAM,SAAWF,EAGrB,KAAK,eAAe,MAAM,QAAUA,EAAW,OAAS,OAC5D,CAEJ,ECvBO,IAAMG,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,KAAO,KAAK,MAAM,KACvB,KAAK,SAAW,KAAK,UAAU,cAAc,MAAM,EACnD,KAAK,SAAW,KAAK,MAAM,WAAa,OACxC,KAAK,YAAc,KAAK,MAAM,OAAS,OACvC,KAAK,UAAU,MAAM,QAAU,OAE/B,OAAO,QAAQ,OAAO,KAAK,KAAMC,GAAQ,CACrC,KAAK,KAAKA,CAAI,CAClB,CAAC,EACD,KAAK,UAAU,iBAAiB,QAAS,KAAK,KAAK,KAAK,IAAI,CAAC,EAEzD,KAAK,aACL,WAAW,IAAM,KAAK,KAAK,KAAK,SAAS,WAAW,EAAG,GAAG,EAG9D,KAAK,YAAc,KAAK,YAAY,KAAK,IAAI,CACjD,CAEA,KAAKC,EAAa,GAAI,CAQlB,GAPA,KAAK,UAAU,oBAAoB,gBAAiB,KAAK,WAAW,EACpE,KAAK,SAAS,YAAcA,EAC5B,KAAK,UAAU,MAAM,QAAU,OAC/B,WAAW,IAAM,CACb,KAAK,UAAU,UAAU,IAAI,SAAS,CAC1C,EAAG,CAAC,EAEA,KAAK,SAAU,CACf,IAAMC,EAAQD,EAAW,MAAM,GAAG,EAAE,OAC9BE,EAAa,KAAK,IAAI,IAAM,IAAQ,IAAMD,CAAM,EACtD,WAAW,KAAK,KAAK,KAAK,IAAI,EAAGC,CAAU,CAC/C,CACJ,CAEA,MAAO,CACH,KAAK,UAAU,UAAU,OAAO,SAAS,EACzC,KAAK,UAAU,iBAAiB,gBAAiB,KAAK,WAAW,CACrE,CAEA,aAAc,CACV,KAAK,UAAU,MAAM,QAAU,OAC/B,KAAK,UAAU,oBAAoB,gBAAiB,KAAK,WAAW,CACxE,CAEJ,EC9CO,IAAMC,GAAN,cAA4BC,CAAU,CAEzC,OAAQ,CACJ,KAAK,aAAe,KAAK,MAAM,OAC/B,KAAK,WAAa,KAAK,MAAM,KAC7B,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACbC,EAAS,KAAK,aAAc,IAAM,CAC9B,KAAK,MAAM,MAAQ,GACnB,KAAK,MAAM,UAAU,IAAI,QAAQ,EACjC,KAAK,aAAa,UAAU,IAAI,QAAQ,EACxC,KAAK,WAAW,UAAU,OAAO,QAAQ,CAC7C,CAAC,EAEDA,EAAS,KAAK,WAAY,IAAM,CAC5B,KAAK,MAAM,UAAU,OAAO,QAAQ,EACpC,KAAK,aAAa,UAAU,OAAO,QAAQ,EAC3C,KAAK,WAAW,UAAU,IAAI,QAAQ,CAC1C,CAAC,CACL,CAEJ,ECxBO,SAASC,GAASC,EAAQ,CAE7B,QAASC,EAAI,EAAGA,EAAI,EAAGA,IACnBD,EAAO,UAAU,IAAI,QAAQC,CAAC,GAAI,GAAI,CAAC,cAAe,GAAO,IAAIA,EAAI,CAAC,EAAE,CAAC,EAI7ED,EAAO,UAAU,IAAI,SAAU,GAAI,CAAC,cAAe,GAAO,GAAG,CAAC,EAC9DA,EAAO,UAAU,IAAI,SAAU,GAAI,CAAC,cAAe,GAAO,GAAG,CAAC,EAC9DA,EAAO,UAAU,IAAI,SAAU,GAAI,CAAC,cAAe,GAAO,YAAY,CAAC,EACvEA,EAAO,UAAU,IAAI,SAAU,GAAI,CAAC,cAAe,GAAO,YAAY,CAAC,EACvEA,EAAO,UAAU,IAAI,SAAU,GAAI,CAAC,aAAc,GAAO,KAAK,CAAC,EAC/DA,EAAO,UAAU,IAAI,SAAU,GAAI,CAAC,aAAc,GAAO,KAAK,CAAC,EAC/DA,EAAO,UAAU,IAAI,SAAU,GAAI,CAAC,cAAe,GAAO,MAAM,CAAC,EACjEA,EAAO,UAAU,IAAI,eAAgB,GAAI,CAAC,cAAe,GAAO,MAAM,CAAC,EACvEA,EAAO,UAAU,IAAI,SAAU,GAAI,mBAAmB,EACtDA,EAAO,UAAU,IAAI,SAAU,GAAI,qBAAqB,EAGxDA,EAAO,UAAU,IAAI,SAAU,GAAI,IAAM,CACrC,OAAO,QAAQ,KAAK,mBAAmB,CAC3C,CAAC,EAGDA,EAAO,UAAU,IAAI,UAAW,GAAI,IAAM,CACtC,OAAO,QAAQ,KAAK,kBAAkB,CAC1C,CAAC,EAGDA,EAAO,UAAU,IAAI,SAAU,GAAI,IAAM,CACrC,IAAME,EAAeF,EAAO,UAAU,QAAQ,EACxCG,EAAUD,EAAeA,EAAa,QAAQ,UAAU,EAAI,KAE5DE,EAAU,CAAC,OAAQ,UAAW,UAAW,QAAQ,EAIjDC,GAHqBD,EAAQ,UAAUE,GAClCH,GAAWA,EAAQ,UAAU,SAASG,CAAM,CACtD,EAC4C,GAAKF,EAAQ,OACpDG,EAAYH,EAAQC,CAAc,EAExCL,EAAO,UAAU,MAAM,UAAUO,CAAS,EAAE,CAChD,CAAC,EAGDP,EAAO,UAAU,IAAI,eAAgB,GAAI,IAAM,CAE3C,IAAMQ,EAAgB,OAAO,YAAY,MAAM,uBAAuB,EAChEC,EAAgBT,EAAO,UAAU,WAAW,CAAC,OAAQ,MAAM,CAAC,EAAE,KAAK,EACzEQ,EAAc,KAAKE,GAAU,CACrBV,EAAO,UAAU,YAAY,EAC7BA,EAAO,cAAcA,EAAO,IAAI,WAAW,IAAK,CAAC,KAAMU,EAAO,IAAI,EAAGV,EAAO,IAAI,OAAOU,EAAO,IAAI,CAAC,CAAC,EAEpGV,EAAO,UAAU,MAAM,OAAQ,CAAC,KAAMU,EAAO,IAAI,CAAC,EAGtDV,EAAO,UAAU,SAAS,EAAK,EAC/BA,EAAO,MAAM,CACjB,EAAG,CACC,aAAcS,EACd,eAAgB,0BAChB,YAAa,8BACb,iBAAkB,MACtB,CAAC,CACL,CAAC,CACL,CChEO,SAASE,GAAOC,EAAQ,CAE3B,OAAO,QAAQ,OAAO,kBAAmB,CAAC,CAAC,KAAAC,CAAI,IAAM,CACjDD,EAAO,WAAWC,CAAI,CAC1B,CAAC,EAGD,OAAO,QAAQ,OAAO,iBAAkB,CAAC,CAAC,KAAAA,CAAI,IAAM,CAChD,IAAMC,EAAUF,EAAO,WAAW,EAAIC,EACtCD,EAAO,WAAWE,CAAO,CAC7B,CAAC,EAGD,OAAO,QAAQ,OAAO,kBAAmB,CAAC,CAAC,KAAAD,CAAI,IAAM,CACjD,IAAMC,EAAUD,EAAOD,EAAO,WAAW,EACzCA,EAAO,WAAWE,CAAO,CAC7B,CAAC,EAGD,OAAO,QAAQ,OAAO,iBAAkB,CAAC,CAAC,KAAAD,CAAI,IAAM,CAChDD,EAAO,cAAcC,CAAI,CAC7B,CAAC,EAGD,OAAO,QAAQ,OAAO,gBAAiB,IAAM,CACrCD,EAAO,aACPA,EAAO,MAAM,CAErB,CAAC,CACL,CC5BA,SAASG,GAAaC,EAAQC,EAAU,CACpC,IAAMC,EAAUF,EAAO,IAAI,IAAI,mBAAmBC,CAAQ,EAAE,QAAQ,KAAM,KAAK,CAAC,EAC3EC,IAKLA,EAAQ,eAAe,EACvBF,EAAO,UAAU,OAAOE,EAAS,EAAI,EACrCF,EAAO,UAAU,SAAS,EAAK,EAC/BA,EAAO,MAAM,EACjB,CAOO,SAASG,GAAoBH,EAAQ,CAExC,IAAMC,EADe,IAAI,IAAI,OAAO,QAAQ,EAAG,aAClB,IAAI,YAAY,EACzCA,GACAF,GAAaC,EAAQC,CAAQ,CAErC,CC1BA,IAAIG,GACAC,GAEJ,SAASC,GAAeC,EAAM,CAC1B,OAAOA,GAAQ,CAAC,EAAEA,EAAK,aAAeA,EAAK,UAC/C,CAOA,eAAeC,GAAgBC,EAAMC,EAAQ,CACzC,GAAID,IAAS,MAAQA,EAAK,KAAK,QAAQ,OAAO,IAAM,EAChD,MAAM,IAAI,MAAM,mBAAmB,EAGvC,IAAME,EAAiBF,EAAK,MAAQ,SAAS,KAAK,IAAI,CAAC,OACjDG,EAAW,IAAI,SACrB,OAAAA,EAAS,OAAO,OAAQH,EAAME,CAAc,EAC5CC,EAAS,OAAO,cAAeF,CAAM,GAExB,MAAM,OAAO,MAAM,KAAK,OAAO,QAAQ,iBAAiB,EAAGE,CAAQ,GACpE,IAChB,CAQA,SAASC,GAAMC,EAAQC,EAASC,EAAO,CACnC,IAAMC,EAAY,IAAIC,GAAUF,EAAM,eAAiBA,EAAM,YAAY,EAGzE,GAAI,CAACC,EAAU,SAAS,GAAKA,EAAU,oBAAoB,EACvD,OAGJ,IAAME,EAASF,EAAU,UAAU,EACnC,QAAWG,KAAaD,EAAQ,CAC5B,IAAME,EAAK,SAAS,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,CAAC,CAAC,GACjDC,EAAe,OAAO,QAAQ,cAAc,EAClDN,EAAM,eAAe,EAErB,WAAW,IAAM,CACbF,EAAO,cAAc,gBAAgBQ,CAAY,SAASD,CAAE,QAAQ,EAEpEb,GAAgBY,EAAWL,EAAQ,MAAM,EAAE,KAAKQ,GAAQ,CACpD,IAAMC,EAAWD,EAAK,KAAK,QAAQ,KAAM,EAAE,EACrCE,EAAe,aAAaF,EAAK,OAAO,OAAO,UAAUC,CAAQ,OAEjEE,EAAQZ,EAAO,IAAI,OAAO,IAAK,CACjC,OAAQ,SACR,KAAMS,EAAK,GACf,EAAGE,CAAY,EAEfX,EAAO,IAAI,QAAQY,EAAOL,CAAE,CAChC,CAAC,EAAE,MAAMM,GAAO,CACZb,EAAO,IAAI,OAAOO,CAAE,EACpB,OAAO,QAAQ,MAAMM,GAAK,MAAM,SAAWZ,EAAQ,aAAa,oBAAoB,EACpF,QAAQ,MAAMY,CAAG,CACrB,CAAC,CACL,EAAG,EAAE,CACT,CACJ,CAKA,SAASC,GAAUd,EAAQ,CACvB,IAAMP,EAAOO,EAAO,UAAU,QAAQ,EAElCP,EAAK,WAAa,QAClBH,GAAOU,EAAO,IAAI,UAAUP,EAAM,UAAU,EAExC,CAACH,IAAQG,EAAK,WAAW,WAAa,KAAO,CAACD,GAAeC,EAAK,UAAU,IAC5EH,GAAOG,EAAK,aAKhBA,EAAK,aAAa,iBAAiB,GAAKA,EAAK,aAAa,iBAAiB,IAAM,UACjFF,GAAyBE,EAEjC,CAOA,SAASsB,GAAKf,EAAQC,EAASC,EAAO,CAClC,GAAM,CAAC,IAAAc,CAAG,EAAIhB,EACRiB,EAAM,OAAO,QAAQ,IAAI,WAAW,uBACtCf,EAAM,QACNA,EAAM,QACNF,EAAO,OAAO,CAClB,EAGMkB,EAAahB,EAAM,cAAgBA,EAAM,aAAa,QAAQ,oBAAoB,EACpFgB,IACAhB,EAAM,eAAe,EACrB,OAAO,MAAM,IAAI,cAAcgB,CAAU,EAAE,EAAE,KAAKT,GAAQ,CACtDT,EAAO,UAAU,OAAOiB,CAAG,EAC3BjB,EAAO,YAAY,SAAS,IAAM,CAC9BA,EAAO,YAAY,mBAAoB,GAAOS,EAAK,KAAK,IAAI,CAChE,CAAC,CACL,CAAC,GAIDO,EAAI,UAAUC,EAAI,eAAgB,UAAU,EAC5Cf,EAAM,eAAe,EACdZ,KACPY,EAAM,eAAe,EAErBF,EAAO,YAAY,SAAS,IAAM,CAC9BA,EAAO,UAAU,OAAOiB,CAAG,EAC3BjB,EAAO,UAAU,QAAQV,EAAI,EAC7B0B,EAAI,OAAO1B,EAAI,CACnB,CAAC,GAID,CAACY,EAAM,mBAAmB,GAAKX,KAC/BW,EAAM,eAAe,EACrBF,EAAO,YAAY,SAAS,IAAM,CAC9B,IAAMmB,EAAenB,EAAO,UAAU,QAAQ,EACxCoB,EAAQpB,EAAO,UAAU,OAAO,EAChCqB,EAAmBF,EAAa,QAAQ,UAAU,EACpDC,EAAM,YAAeA,EAAM,eAAe,OAAS,EACnDC,EAAiB,MAAM9B,EAAsB,EAE7C8B,EAAiB,OAAO9B,EAAsB,CAEtD,CAAC,GAIAW,EAAM,mBAAmB,GAC1BH,GAAMC,EAAQC,EAASC,CAAK,EAGhCZ,GAAO,IACX,CAMO,SAASgC,GAAsBtB,EAAQC,EAAS,CACnDD,EAAO,GAAG,YAAa,IAAMc,GAAUd,CAAM,CAAC,EAC9CA,EAAO,GAAG,OAAQE,GAASa,GAAKf,EAAQC,EAASC,CAAK,CAAC,EACvDF,EAAO,GAAG,QAASE,GAASH,GAAMC,EAAQC,EAASC,CAAK,CAAC,CAC7D,CC3JO,SAASqB,GAAkBC,EAAS,CAcvC,MAXgB,CACZ,YACA,SACA,2DACA,gDACA,+BAPmBA,EAAQ,gBAAkB,MAAQ,UAAY,GASjE,sDACA,uBACJ,EAEe,OAAOC,GAAO,EAAQA,CAAI,EAAE,KAAK,KAAK,CACzD,CAKA,SAASC,GAA6BC,EAAQ,CAC1CA,EAAO,GAAG,SAAS,sBAAsB,iBAAkB,CACvD,KAAM,cACN,QAAS,OACT,MAAO,6DACX,CAAC,EACDA,EAAO,GAAG,SAAS,sBAAsB,eAAgB,CACrD,KAAM,cACN,QAAS,OACT,MAAO,yBACX,CAAC,EACDA,EAAO,GAAG,SAAS,sBAAsB,iBAAkB,CACvD,KAAM,cACN,QAAS,OACT,MAAO,0CACX,CAAC,CACL,CAKA,SAASC,GAA2BD,EAAQ,CACxCA,EAAO,GAAG,SAAS,kBAAkB,qBAAsB,CACvD,UAAUE,EAAM,CACZ,OAAOA,EAAK,QAAQ,GAAG,IAAM,IACjC,EACA,SAAU,OACV,MAAO,OACP,MAAO,sBACX,CAAC,CACL,CAKA,SAASC,GAA4BH,EAAQ,CACzCA,EAAO,GAAG,SAAS,kBAAkB,sBAAuB,CACxD,UAAUE,EAAM,CACZ,OAAOA,EAAK,QAAQ,KAAK,IAAM,IACnC,EACA,SAAU,OACV,MAAO,OACP,MAAO,OACX,CAAC,CACL,CAKO,SAASE,GAA2BJ,EAAQ,CAC/CD,GAA6BC,CAAM,EACnCC,GAA2BD,CAAM,EACjCG,GAA4BH,CAAM,CACtC,CC7EA,IAAMK,GAAQ,CACV,sBAAuB,ocACvB,mBAAoB,ocACpB,4BAA6B,mRAC7B,6BAA8B,kRAC9B,yBAA0B,+QAC1B,yBAA0B,oRAC1B,MAAO,2MACP,qBAAsB,yaAC1B,EAKO,SAASC,GAAoBC,EAAQ,CACxC,OAAW,CAACC,EAAMC,CAAG,IAAK,OAAO,QAAQJ,EAAK,EAC1CE,EAAO,GAAG,SAAS,QAAQC,EAAMC,CAAG,CAE5C,CCbA,SAASC,GAAcC,EAAQ,CAC3BA,EAAO,WAAW,cAAc,KAAMC,GAAS,CAC3C,QAAWC,KAAQD,EACf,GAAIC,EAAK,QAAUA,EAAK,OAAO,OAAS,OAAQ,CAC5C,IAAMC,EAAU,OAAO,QAAQ,KAAK,KAAK,OAAO,OAAO,EACvDA,EAAQ,MAAQ;AAAA,EAChBD,EAAK,QAAQC,CAAO,CACxB,CAER,CAAC,CACL,CAQA,SAASC,GAAmBJ,EAAQ,CAChCA,EAAO,OAAO,cAAc,MAAOC,GAAS,CACxC,QAAWC,KAAQD,EAAO,CACtB,IAAMI,EAAKH,EAAK,KAAK,IAAI,GAAK,GACxBI,EAAYJ,EAAK,KAAK,OAAO,GAAK,IACpCG,IAAO,WAAaC,EAAU,SAAS,SAAS,IAChDJ,EAAK,OAAO,CAEpB,CACJ,CAAC,CACL,CAMO,SAASK,GAAaP,EAAQ,CACjCD,GAAcC,CAAM,EACpBI,GAAmBJ,CAAM,CAC7B,CC1CA,SAASQ,GAAgBC,EAAM,CAC3B,OAAOA,EAAK,QAAQ,YAAY,IAAM,YAC1C,CAQA,SAASC,GAAUC,EAAQC,EAAMC,EAAUC,EAAU,CAEjD,IAAMC,EAAa,OAAO,YAAY,MAAM,aAAa,EACnDC,EAAWL,EAAO,UAAU,YAAY,EAC9CI,EAAW,KAAKH,EAAMC,EAAU,CAACI,EAASC,IAAY,CAClDJ,EAASG,EAASC,CAAO,EACzBP,EAAO,MAAM,EACbA,EAAO,UAAU,eAAeK,CAAQ,CAC5C,EAAG,IAAM,CACLL,EAAO,MAAM,EACbA,EAAO,UAAU,eAAeK,CAAQ,CAC5C,CAAC,CACL,CAMA,SAASG,GAAsBR,EAAQS,EAAW,CAC9CV,GAAUC,EAAQS,EAAU,WAAW,EAAGA,EAAU,YAAY,EAAG,CAACH,EAASC,IAAY,CACrFE,EAAU,WAAWH,EAASC,CAAO,CACzC,CAAC,CACL,CAQA,SAASG,GAA6BV,EAAQ,CAC1C,IAAMW,EAAMX,EAAO,OAAO,EACpBY,EAAMD,EAAI,YAEhB,MAAME,UAAyBD,EAAI,WAAY,CAO3C,aAAc,CACV,MAAM,EAHVE,EAAA,cAAS,MAIL,KAAK,aAAa,CAAC,KAAM,MAAM,CAAC,EAEhC,IAAMC,EAAe,SAAS,KAAK,iBAAiB,mDAAmD,EACjGC,EAAe,MAAM,KAAKD,CAAY,EAAE,IAAIE,GAAWA,EAAQ,UAAU,EAAI,CAAC,EAE9EC,EAAc,SAAS,cAAc,KAAK,EAChDA,EAAY,MAAM,cAAgB,OAClCA,EAAY,gBAAkB,QAC9BA,EAAY,UAAU,IAAI,qBAAqB,EAC/CA,EAAY,UAAU,OAAO,YAAa,SAAS,gBAAgB,UAAU,SAAS,WAAW,CAAC,EAElG,KAAK,WAAW,OAAO,GAAGF,EAAcE,CAAW,CACvD,CAEA,aAAc,CACV,IAAMC,EAA2BC,IACTA,EAAQ,MAAM,GAAG,EAAE,OAAOC,GAAYA,EAAS,WAAW,WAAW,CAAC,EACtE,CAAC,GAAK,IAAI,QAAQ,YAAa,EAAE,EAGnDpB,EAAO,KAAK,cAAc,MAAM,EAChCqB,EAAM,KAAK,cAAc,KAAK,EACpC,OAAOH,EAAyBG,EAAI,SAAS,GAAMrB,GAAQkB,EAAyBlB,EAAK,SAAS,GAAM,EAC5G,CAEA,WAAWsB,EAASrB,EAAU,CACtB,KAAK,SACL,KAAK,OAAO,WAAWqB,CAAO,EAC9B,KAAK,OAAO,QAAQrB,EAAUqB,CAAO,GAGzC,IAAID,EAAM,KAAK,cAAc,KAAK,EAC7BA,IACDA,EAAMX,EAAI,cAAc,KAAK,EAC7B,KAAK,OAAOW,CAAG,GAEnBA,EAAI,UAAY,GAEhB,IAAMrB,EAAOU,EAAI,cAAc,MAAM,EACrCW,EAAI,OAAOrB,CAAI,EACfA,EAAK,UAAYsB,EACjBtB,EAAK,UAAY,YAAYC,CAAQ,EACzC,CAEA,YAAa,CACT,IAAMD,EAAO,KAAK,cAAc,MAAM,GAAK,KAAK,cAAc,KAAK,EAC7DuB,EAAS,SAAS,cAAc,KAAK,EAC3CA,EAAO,UAAYvB,EAAK,UAAU,QAAQ,UAAW,EAAE,EAEvD,IAAMwB,EAAMD,EAAO,iBAAiB,IAAI,EACxC,QAAWE,KAAMD,EACbC,EAAG,YAAY;AAAA,CAAI,EAGvB,OAAOF,EAAO,WAClB,CAEA,mBAAoB,CAChB,IAAMG,EAAgB,KAAK,IAAI,EAC/B,GAAI,KAAK,OACL,OAGJ,KAAK,kBAAkB,EACvB,IAAMJ,EAAU,KAAK,WAAW,EAE1BK,EADQL,EAAQ,MAAM;AAAA,CAAI,EAAE,OACV,KAAQ,GAAK,GACrC,KAAK,MAAM,OAAS,GAAGK,CAAM,KAE7B,IAAMC,EAAY,KAAK,WAAW,cAAc,sBAAsB,EAChEC,EAAeC,GAAQ,CACzB,KAAK,OAASA,EAAK,YAAYF,EAAW,KAAK,WAAYN,EAAS,KAAK,YAAY,CAAC,EACtF,WAAW,IAAM,CACb,KAAK,MAAM,OAAS,IACxB,EAAG,EAAE,CACT,EAEA,OAAO,gBAAgB,MAAM,EAAE,KAAKQ,GAAQ,CACxC,IAAMC,EAAW,KAAK,IAAI,EAAIL,EAAgB,GAAM,GAAK,EACzD,WAAW,IAAMG,EAAaC,CAAI,EAAGC,CAAO,CAChD,CAAC,CACL,CAEA,mBAAoB,CAChB,IAAMV,EAAM,KAAK,cAAc,KAAK,EACpC,GAAKA,EAEL,QAAWW,KAAYX,EAAI,WACnBW,EAAS,WAAa,SAAWA,EAAS,cAAgB,UAC1DA,EAAS,OAAO,CAG5B,CAEJ,CAEArB,EAAI,eAAe,OAAO,aAAcC,CAAgB,CAC5D,CAKA,SAASqB,GAASlC,EAAQ,CACtBA,EAAO,GAAG,SAAS,QAAQ,YAAa,ueAAue,EAE/gBA,EAAO,GAAG,SAAS,UAAU,aAAc,CACvC,QAAS,oBACT,KAAM,YACN,UAAW,CACPA,EAAO,YAAY,YAAY,CACnC,CACJ,CAAC,EAEDA,EAAO,GAAG,SAAS,UAAU,iBAAkB,CAC3C,QAAS,kBACT,KAAM,aACN,UAAW,CACPA,EAAO,YAAY,YAAY,CACnC,CACJ,CAAC,EAEDA,EAAO,WAAW,aAAc,IAAM,CAClC,IAAMmC,EAAenC,EAAO,UAAU,QAAQ,EACxCW,EAAMwB,EAAa,cACzB,GAAItC,GAAgBsC,CAAY,EAC5B3B,GAAsBR,EAAQmC,CAAY,MACvC,CACH,IAAMC,EAAcpC,EAAO,UAAU,WAAW,CAAC,OAAQ,MAAM,CAAC,EAChED,GAAUC,EAAQoC,EAAa,GAAI,CAAC9B,EAASC,IAAY,CACrD,IAAMe,EAAMX,EAAI,cAAc,KAAK,EAC7BV,EAAOU,EAAI,cAAc,MAAM,EACrCV,EAAK,UAAU,IAAI,YAAYM,CAAO,EAAE,EACxCN,EAAK,UAAYK,EACjBgB,EAAI,OAAOrB,CAAI,EAEfD,EAAO,cAAcsB,EAAI,SAAS,CACtC,CAAC,CACL,CACJ,CAAC,EAEDtB,EAAO,GAAG,WAAY,IAAM,CACxB,IAAMmC,EAAenC,EAAO,UAAU,QAAQ,EAC1CH,GAAgBsC,CAAY,GAC5B3B,GAAsBR,EAAQmC,CAAY,CAElD,CAAC,EAEDnC,EAAO,GAAG,UAAW,IAAM,CACvBA,EAAO,OAAO,cAAc,MAAOqC,GAAQ,CACvC,QAAWC,KAAMD,EAAM,CACnB,IAAME,EAAU,OAAO,QAAQ,KAAK,KAAK,OAAO,aAAc,CAC1D,gBAAiB,OACrB,CAAC,EAEKC,EAAYF,EAAG,KAAK,KAAK,EAC3BE,GACAD,EAAQ,KAAK,MAAOC,CAAS,EAGjC,IAAMC,EAAQH,EAAG,OAAO,MAAM,EAC9B,QAAWI,KAAQD,EACfC,EAAK,OAAO,EAEhBJ,EAAG,KAAK,QAAS,IAAI,EACrBA,EAAG,KAAKC,CAAO,CACnB,CACJ,CAAC,EAEDvC,EAAO,OAAO,cAAc,aAAcqC,GAAQ,CAC9C,QAAWC,KAAMD,EACbC,EAAG,KAAK,kBAAmB,OAAO,CAE1C,CAAC,EAEDtC,EAAO,WAAW,cAAc,aAAcqC,GAAQ,CAClD,QAAWC,KAAMD,EAAM,CACnB,IAAMG,EAAYF,EAAG,KAAK,KAAK,EAC3BE,GAAaF,EAAG,WAChBA,EAAG,WAAW,KAAK,MAAOE,CAAS,EAC5BF,EAAG,YACVA,EAAG,WAAW,KAAK,MAAO,IAAI,EAGlCA,EAAG,OAAO,CACd,CACJ,CAAC,CACL,CAAC,EAEDtC,EAAO,GAAG,SAAS,kBAAkB,aAAc,CAC/C,UAAU2C,EAAM,CACZ,OAAOA,EAAK,SAAS,YAAY,IAAM,YAC3C,EACA,MAAO,iBACP,SAAU,OACV,MAAO,MACX,CAAC,EAED3C,EAAO,GAAG,UAAW,IAAM,CACvBU,GAA6BV,CAAM,CACvC,CAAC,CACL,CAKO,SAAS4C,IAAY,CACxB,OAAOV,EACX,CCpQA,SAASW,GAAiBC,EAAS,CAC/B,OAAO,IAAI,QAAQ,CAACC,EAASC,IAAW,CAEpCF,EAAQ,WAAaA,EAAQ,UAAY,IAAMC,EAAQD,EAAQ,MAAM,EAErEA,EAAQ,QAAUA,EAAQ,QAAU,IAAME,EAAOF,EAAQ,KAAK,CAClE,CAAC,CACL,CACA,SAASG,GAAYC,EAAQC,EAAW,CACpC,IAAML,EAAU,UAAU,KAAKI,CAAM,EACrCJ,EAAQ,gBAAkB,IAAMA,EAAQ,OAAO,kBAAkBK,CAAS,EAC1E,IAAMC,EAAMP,GAAiBC,CAAO,EACpC,MAAO,CAACO,EAAQC,IAAaF,EAAI,KAAMG,GAAOD,EAASC,EAAG,YAAYJ,EAAWE,CAAM,EAAE,YAAYF,CAAS,CAAC,CAAC,CACpH,CACA,IAAIK,GACJ,SAASC,IAAkB,CACvB,OAAKD,KACDA,GAAsBP,GAAY,eAAgB,QAAQ,GAEvDO,EACX,CAOA,SAASE,GAAIC,EAAKC,EAAcH,GAAgB,EAAG,CAC/C,OAAOG,EAAY,WAAaC,GAAUhB,GAAiBgB,EAAM,IAAIF,CAAG,CAAC,CAAC,CAC9E,CAQA,SAASG,GAAIH,EAAKI,EAAOH,EAAcH,GAAgB,EAAG,CACtD,OAAOG,EAAY,YAAcC,IAC7BA,EAAM,IAAIE,EAAOJ,CAAG,EACbd,GAAiBgB,EAAM,WAAW,EAC5C,CACL,CAqDA,SAASG,GAAIC,EAAKC,EAAcC,GAAgB,EAAG,CAC/C,OAAOD,EAAY,YAAcE,IAC7BA,EAAM,OAAOH,CAAG,EACTI,GAAiBD,EAAM,WAAW,EAC5C,CACL,CCjGA,IAAIE,GAAS,KACTC,GACAC,GACAC,GACEC,GAAgB,oBAEtB,SAASC,GAAgBC,EAAM,CAC3BN,GAAO,cAAc,YAAY,KAAK,UAAUM,CAAI,EAAGL,EAAkB,CAC7E,CAEA,SAASM,GAAgBC,EAAS,CACxBC,GAAIL,GAAeI,EAAQ,IAAI,EACjCL,IACAA,GAAOK,EAAQ,IAAI,EAAE,KAAK,IAAM,CACtBE,GAAIN,EAAa,CAC3B,CAAC,CAET,CAEA,SAASO,GAAcH,EAAS,CAC5BH,GAAgB,CACZ,OAAQ,SAAU,OAAQ,SAAU,IAAKG,EAAQ,IAAK,KAAM,kBAChE,CAAC,CACL,CAEA,SAASI,IAAgB,CAChBV,IACLA,GAAO,EAAE,KAAKW,GAAO,CACjBR,GAAgB,CAAC,OAAQ,OAAQ,SAAU,EAAG,IAAAQ,CAAG,CAAC,CACtD,CAAC,CACL,CAEA,SAASC,IAAqB,CAC1B,IAAMC,EAAS,CAAC,EAChB,OAAO,QAAQ,WAAWf,GAAQ,2BAA4B,CAAC,OAAAe,CAAM,CAAC,EACtEV,GAAgB,CAAC,OAAQ,YAAa,OAAAU,CAAM,CAAC,CACjD,CAEA,SAASC,IAAiB,CAEtB,OAAO,oBAAoB,UAAWC,EAAW,EAC7CjB,IAAQ,SAAS,KAAK,YAAYA,EAAM,CAChD,CAMA,SAASiB,GAAYC,EAAO,CAExB,GADI,CAACA,EAAM,MAAQA,EAAM,KAAK,OAAS,GACnCA,EAAM,SAAWjB,GAAoB,OAEzC,IAAMO,EAAU,KAAK,MAAMU,EAAM,IAAI,EACjCV,EAAQ,QAAU,OAClBI,GAAc,EACPJ,EAAQ,QAAU,OACzBQ,GAAe,EACRR,EAAQ,QAAU,OACzBG,GAAcH,CAAO,EACdA,EAAQ,QAAU,SACzBD,GAAgBC,CAAO,EAChBA,EAAQ,QAAU,aACzBM,GAAmB,CAE3B,CAMA,eAAeK,IAAyB,CACpC,IAAMC,EAAY,MAAYC,GAAIjB,EAAa,EACzCkB,EAAW,SAAS,eAAe,wBAAwB,EAE5DA,GACD,QAAQ,MAAM,yCAAyC,EAGvDF,GAGgB,MADD,OAAO,YAAY,eAAeE,EAAU,gBAAgB,EAC9C,KAAK,IAE9BpB,GAAS,SAAYkB,EAGjC,CAWA,eAAsBG,GAAKC,EAAWC,EAAgBC,EAAgB,CAClExB,GAASuB,EACTtB,GAASuB,EAET,MAAMP,GAAuB,EAE7BnB,GAAS,SAAS,cAAc,QAAQ,EACxCA,GAAO,aAAa,cAAe,GAAG,EACtC,OAAO,iBAAiB,UAAWiB,EAAW,EAC9CjB,GAAO,aAAa,MAAOwB,CAAS,EACpCxB,GAAO,aAAa,QAAS,YAAY,EACzCA,GAAO,MAAM,gBAAkB,UAC/B,SAAS,KAAK,YAAYA,EAAM,EAChCC,GAAsB,IAAI,IAAIuB,CAAS,EAAG,MAC9C,CAEA,eAAsBG,GAAOC,EAAWC,EAAkB,CACtD,IAAMvB,EAAO,CACT,MAAOsB,EACP,YAAaC,CACjB,EAEA,OADa,MAAM,OAAO,MAAM,KAAK,OAAO,QAAQ,gBAAgB,EAAGvB,CAAI,GAC/D,IAChB,CAEO,SAASwB,IAAQ,CACpBd,GAAe,CACnB,CAOA,eAAsBe,GAAKC,EAAW,CAClC,GAAI,CAEA,MAAO,0BADM,MAAM,OAAO,MAAM,IAAI,OAAO,QAAQ,yBAAyBA,CAAS,EAAE,CAAC,GACnD,KAAK,OAAO,EACrD,OAASC,EAAO,CACZ,MAAIA,aAAiB,OAAO,MAAM,WAC9B,OAAO,QAAQ,kBAAkBA,CAAK,EAE1CH,GAAM,EACAG,CACV,CACJ,CC9IA,IAAIC,EAAa,KACbC,GAAc,KAKdC,GAAU,CAAC,EAEf,SAASC,GAAUC,EAAM,CACrB,OAAOA,EAAK,aAAa,gBAAgB,CAC7C,CAEA,SAASC,GAAmBC,EAAWC,EAAe,KAAM,CACxDP,EAAaM,EACbL,GAAcM,EAGO,OAAO,YAAY,MAAM,eAAe,EAChD,KAAKC,GAAS,CACvB,GAAID,EAAc,CACd,IAAME,EAAUF,EAAa,cAAc,KAAK,EAChDP,EAAW,YAAY,SAAS,IAAM,CAClCA,EAAW,IAAI,UAAUS,EAAS,MAAOD,EAAM,GAAG,EAClDR,EAAW,IAAI,UAAUO,EAAc,iBAAkBC,EAAM,EAAE,CACrE,CAAC,CACL,KAAO,CACH,IAAME,EAAU,wBAAwBF,EAAM,EAAE,uCAAuCA,EAAM,GAAG,WAChGR,EAAW,cAAcU,CAAO,CACpC,CACJ,EAAG,QAAQ,CACf,CAEA,eAAeC,GAAcC,EAAS,CAClC,IAAMC,EAAe,OAAO,QAAQ,cAAc,EAE5CC,EAAoBC,GAAS,CAC3BA,EAAM,SAAW,IACjB,OAAO,QAAQ,KAAK,QAASb,GAAQ,aAAa,qBAAqB,EAEvE,OAAO,QAAQ,KAAK,QAASA,GAAQ,aAAa,oBAAoB,EAE1E,QAAQ,MAAMa,CAAK,CACvB,EAGA,GAAId,GAAa,CACNe,GAAM,EACb,IAAMP,EAAUR,GAAY,cAAc,KAAK,EAC/C,GAAI,CACA,IAAMgB,EAAM,MAAaC,GAAON,EAASV,GAAQ,MAAM,EACvDF,EAAW,YAAY,SAAS,IAAM,CAClCA,EAAW,IAAI,UAAUS,EAAS,MAAOQ,EAAI,GAAG,EAChDjB,EAAW,IAAI,UAAUC,GAAa,iBAAkBgB,EAAI,EAAE,CAClE,CAAC,CACL,OAASE,EAAK,CACV,MAAAL,EAAkBK,CAAG,EACf,IAAI,MAAM,oCAAoCA,CAAG,EAAE,CAC7D,CACA,MACJ,CAEA,MAAMC,GAAK,CAAC,EAEZ,IAAMC,EAAK,WAAW,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,CAAC,CAAC,GACnDC,EAAS,gBAAgB,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,MAAM,CAAC,CAAC,GAClEtB,EAAW,cAAc,mDAAmDsB,CAAM,eAAeT,CAAY,SAASQ,CAAE,UAAU,EAC3HL,GAAM,EAEb,GAAI,CACA,IAAMC,EAAM,MAAaC,GAAON,EAASV,GAAQ,MAAM,EACvDF,EAAW,YAAY,SAAS,IAAM,CAClCA,EAAW,IAAI,UAAUqB,EAAI,MAAOJ,EAAI,GAAG,EAC3CjB,EAAW,IAAI,UAAUsB,EAAQ,iBAAkBL,EAAI,EAAE,CAC7D,CAAC,CACL,OAASE,EAAK,CACV,MAAAnB,EAAW,IAAI,OAAOsB,CAAM,EAC5BR,EAAkBK,CAAG,EACf,IAAI,MAAM,oCAAoCA,CAAG,EAAE,CAC7D,CACJ,CAEA,SAASI,IAAc,CACnB,GAAI,CAACtB,GACD,OAAO,QAAQ,QAAQ,EAAE,EAG7B,IAAMuB,EAAYvB,GAAY,aAAa,gBAAgB,EAC3D,OAAcwB,GAAKD,CAAS,CAChC,CAEA,SAASE,GAAkBpB,EAAWC,EAAe,KAAM,CACvDP,EAAaM,EACbL,GAAcM,EACPoB,GAAKzB,GAAQ,UAAWqB,GAAaZ,EAAa,CAC7D,CAKA,SAASiB,GAASC,EAAQ,CACtBA,EAAO,WAAW,SAAU,IAAM,CAC9B,IAAMtB,EAAesB,EAAO,UAAU,QAAQ,EAC9CH,GAAkBG,EAAQ1B,GAAUI,CAAY,EAAIA,EAAe,IAAI,CAC3E,CAAC,EAEDsB,EAAO,GAAG,SAAS,QAAQ,UAAW,qCAAqC3B,GAAQ,SAAW,OAAS,SAAS,4eAA4e,EAE5lB2B,EAAO,GAAG,SAAS,eAAe,SAAU,CACxC,QAAS,sBACT,KAAM,UACN,UAAW,CACPA,EAAO,YAAY,QAAQ,EAE3B,OAAO,SAAS,KAAK,cAAc,IAAI,MAAM,YAAa,CAAC,QAAS,EAAI,CAAC,CAAC,CAC9E,EACA,MAAMC,EAAU,CACZA,EAAS,CACL,CACI,KAAM,aACN,KAAM,kBACN,MAAO,iBACX,CACJ,CAAC,CACL,EACA,aAAaC,EAAKC,EAAO,CACrB,GAAIA,IAAU,kBAAmB,CAC7B,IAAMzB,EAAesB,EAAO,UAAU,QAAQ,EAC9CxB,GAAmBwB,EAAQ1B,GAAUI,CAAY,EAAIA,EAAe,IAAI,CAC5E,CACJ,CACJ,CAAC,EAEDsB,EAAO,GAAG,WAAY,IAAM,CACxB,IAAMtB,EAAesB,EAAO,UAAU,QAAQ,EACzC1B,GAAUI,CAAY,GAC3BmB,GAAkBG,EAAQtB,CAAY,CAC1C,CAAC,EAEDsB,EAAO,GAAG,aAAc,IAAM,CAC1B,IAAMI,EAAWJ,EAAO,IAAI,OAAO,4BAA4B,EAC1DI,EAAS,QAEdJ,EAAO,YAAY,SAAS,IAAM,CAC9B,QAAWK,KAAWD,EAClBC,EAAQ,aAAa,kBAAmB,OAAO,CAEvD,CAAC,CACL,CAAC,CACL,CAOO,SAASC,GAAUC,EAAiB,CACvC,OAAAlC,GAAUkC,EACHR,EACX,CC9JA,SAASS,GAASC,EAAQ,CACtBA,EAAO,WAAW,uBAAwB,IAAM,CAC5C,IAAMC,EAAS,SAAS,cAAc,IAAI,EACpCC,EAAQF,EAAO,UAAU,QAAQ,EACjC,CAAC,WAAAG,CAAU,EAAID,EACrBC,EAAW,aAAaF,EAAQC,CAAK,CACzC,CAAC,EAEDF,EAAO,GAAG,SAAS,UAAU,WAAY,CACrC,KAAM,kBACN,QAAS,yBACT,UAAW,CACPA,EAAO,YAAY,sBAAsB,CAC7C,CACJ,CAAC,CACL,CAKO,SAASI,IAAY,CACxB,OAAOL,EACX,CCtBA,SAASM,GAASC,EAAQ,CAEtBA,EAAO,GAAG,SAAS,UAAU,sBAAuB,CAChD,MAAO,eACP,KAAM,QACN,QAAS,eACT,UAAW,CAEc,OAAO,YAAY,MAAM,eAAe,EAChD,KAAKC,GAAS,CACvB,IAAMC,EAAWD,EAAM,QAAQ,SAAWA,EAAM,IAC5CE,EAAO,YAAYF,EAAM,GAAG,qBAChCE,GAAQ,aAAaD,CAAQ,UAAUD,EAAM,IAAI,KACjDE,GAAQ,OACRH,EAAO,YAAY,mBAAoB,GAAOG,CAAI,CACtD,EAAG,SAAS,CAChB,CACJ,CAAC,CACL,CAKO,SAASC,IAAY,CACxB,OAAOL,EACX,CCzBA,SAASM,GAASC,EAAQ,CACtB,IAAMC,EAAc,CAChB,MAAO,2BACP,IAAK,OAAO,QAAQ,eAAe,CACvC,EAEAD,EAAO,GAAG,SAAS,UAAU,QAAS,CAClC,KAAM,OACN,QAAS,mBACT,UAAW,CACP,OAAO,QAAQ,aAAa,cAAc,QAAQC,CAAW,CACjE,CACJ,CAAC,CACL,CAKO,SAASC,IAAY,CACxB,OAAOH,EACX,CCvBO,IAAMI,GAAoB,CAC7B,IACA,KACA,KACA,KACA,KACA,KACA,KACA,MACA,aACA,MACA,aACA,UACA,KACA,KACA,QACA,IACJ,ECZA,SAASC,GAAwBC,EAAQ,CACrC,OAAOA,EAAO,UAAU,QAAQ,EAAE,QAAQ,SAAS,CACvD,CAEA,SAASC,GAAWD,EAAQE,EAAgB,CACxC,IAAMC,EAAUJ,GAAwBC,CAAM,EACzCG,GAELH,EAAO,YAAY,SAAS,IAAM,CAC9B,IAAII,EAAUD,EAAQ,cAAc,SAAS,EACxCC,IACDA,EAAU,SAAS,cAAc,SAAS,EAC1CD,EAAQ,QAAQC,CAAO,GAE3BA,EAAQ,YAAcF,CAC1B,CAAC,CACL,CAKA,SAASG,GAAcL,EAAQ,CAC3B,MAAO,CACH,MAAO,yBACP,KAAM,CACF,KAAM,QACN,MAAO,CACH,CACI,KAAM,QACN,KAAM,UACN,MAAO,cACX,CACJ,CACJ,EACA,QAAS,CACL,CACI,KAAM,SACN,KAAM,QACV,EACA,CACI,KAAM,SACN,KAAM,OACN,QAAS,EACb,CACJ,EACA,SAASM,EAAK,CACV,GAAM,CAAC,QAAAF,CAAO,EAAIE,EAAI,QAAQ,EAC9BL,GAAWD,EAAQI,CAAO,EAC1BE,EAAI,MAAM,CACd,CACJ,CACJ,CAKA,SAASC,GAA0BC,EAAS,CACxC,IAAMJ,EAAUI,EAAQ,cAAc,SAAS,EAC/C,OAAKJ,EAGEA,EAAQ,YAFJ,EAGf,CAKA,SAASK,GAA0BT,EAAQ,CACvC,IAAMG,EAAUJ,GAAwBC,CAAM,EAC/BA,EAAO,cAAc,KAAKK,GAAcL,CAAM,CAAC,EACvD,QAAQ,CAAC,QAASO,GAA0BJ,CAAO,CAAC,CAAC,CAChE,CAKA,SAASO,GAAyBV,EAAQ,CACtC,IAAMG,EAAUH,EAAO,UAAU,QAAQ,EAAE,QAAQ,SAAS,EACtDW,EAAcX,EAAO,UAAU,YAAY,EAEjD,GAAIG,EAAS,CACT,IAAMS,EAAWT,EAAQ,iBAAiB,kDAAkD,EAE5FH,EAAO,YAAY,SAAS,IAAM,CAC9B,QAAWQ,KAAWI,EAClBT,EAAQ,WAAW,aAAaK,EAASL,CAAO,EAEpDA,EAAQ,OAAO,CACnB,CAAC,CACL,CAEAH,EAAO,MAAM,EACbA,EAAO,UAAU,eAAeW,CAAW,CAC/C,CAKA,SAASE,GAAsBC,EAAW,CACtCA,EAAU,KAAK,kBAAmB,IAAI,EACtC,IAAIC,EAAa,GACjB,QAAWC,KAASF,EAAU,SAAS,EAC/BE,EAAM,OAAS,aACfA,EAAM,OAAO,EACbD,EAAa,IAIjBA,GACAF,GAAsBC,CAAS,CAEvC,CAKA,SAASG,GAA+BH,EAAW,CAC/CD,GAAsBC,CAAS,EAE/BA,EAAU,KAAK,kBAAmB,OAAO,EACzC,IAAMI,EAAW,OAAO,QAAQ,KAAK,KAAK,OAAO,WAAY,CAAC,gBAAiB,MAAM,CAAC,EAClFC,EAAoB,KAExB,QAAWH,KAASF,EAAU,SAAS,EAAG,CACtC,GAAIE,EAAM,OAAS,UAAW,SACdI,GAAkB,SAASJ,EAAM,IAAI,GASjDE,EAAS,OAAOF,CAAK,EACrBG,EAAoB,OAPfA,IACDA,EAAoB,OAAO,QAAQ,KAAK,KAAK,OAAO,GAAG,EACvDD,EAAS,OAAOC,CAAiB,GAErCA,EAAkB,OAAOH,CAAK,EAKtC,CAEAF,EAAU,OAAOI,CAAQ,CAC7B,CAKA,SAASG,GAAoBrB,EAAQ,CACjCA,EAAO,OAAO,cAAc,UAAWsB,GAAQ,CAC3C,QAAWC,KAAMD,EACbL,GAA+BM,CAAE,CAEzC,CAAC,EAEDvB,EAAO,WAAW,cAAc,UAAWsB,GAAQ,CAC/C,QAAWC,KAAMD,EACbT,GAAsBU,CAAE,EACxBA,EAAG,KAAK,OAAQ,IAAI,CAE5B,CAAC,EAEDvB,EAAO,WAAW,cAAc,WAAYsB,GAAQ,CAChD,QAAWC,KAAMD,EACbC,EAAG,OAAO,CAElB,CAAC,CACL,CAKA,SAASC,GAASxB,EAAQ,CACtBA,EAAO,GAAG,SAAS,QAAQ,UAAW,6PAA6P,EACnSA,EAAO,GAAG,SAAS,QAAQ,aAAc,8XAA8X,EACvaA,EAAO,GAAG,SAAS,QAAQ,cAAe,6TAA6T,EAEvWA,EAAO,GAAG,SAAS,UAAU,UAAW,CACpC,KAAM,UACN,QAAS,2BACT,UAAW,CACPA,EAAO,YAAY,oBAAoB,CAC3C,CACJ,CAAC,EAEDA,EAAO,GAAG,SAAS,UAAU,gBAAiB,CAC1C,KAAM,qBACN,QAAS,SACT,UAAW,CACPU,GAAyBV,CAAM,CACnC,CACJ,CAAC,EAEDA,EAAO,GAAG,SAAS,UAAU,cAAe,CACxC,KAAM,cACN,QAAS,aACT,UAAW,CACPS,GAA0BT,CAAM,CACpC,CACJ,CAAC,EAEDA,EAAO,GAAG,WAAYyB,GAAS,CACvB,CAAC1B,GAAwBC,CAAM,GAAKyB,EAAM,OAAO,QAAQ,UAAU,GACvEhB,GAA0BT,CAAM,CACpC,CAAC,EAEDA,EAAO,GAAG,SAAS,UAAU,gBAAiB,CAC1C,KAAM,aACN,QAAS,qBACT,UAAW,CACSD,GAAwBC,CAAM,EACtC,gBAAgB,MAAM,EAC9BA,EAAO,MAAM,CACjB,CACJ,CAAC,EAEDA,EAAO,WAAW,qBAAsB,IAAM,CAC1C,IAAI0B,EAAU1B,EAAO,UAAU,WAAW,CAAC,OAAQ,MAAM,CAAC,EACpDG,EAAU,SAAS,cAAc,SAAS,EAC1CC,EAAU,SAAS,cAAc,SAAS,EAC1CuB,EAAK,WAAW,KAAK,IAAI,CAAC,GAChCxB,EAAQ,aAAa,UAAWwB,CAAE,EAClCxB,EAAQ,YAAYC,CAAO,EAEtBsB,IACDA,EAAU,eAGdvB,EAAQ,WAAauB,EACrB1B,EAAO,cAAcG,EAAQ,SAAS,EACtCH,EAAO,MAAM,EAEb,IAAM4B,EAAa5B,EAAO,IAAI,OAAO,aAAa2B,CAAE,IAAI,EAAE,CAAC,GAAK,KAChE,GAAIC,EAAY,CACZ,IAAMC,EAAaD,EAAW,cAAc,cAAc,EACtDC,GACAA,EAAW,MAAM,EAErBD,EAAW,gBAAgB,SAAS,CACxC,CACJ,CAAC,EAED5B,EAAO,GAAG,SAAS,kBAAkB,UAAW,CAC5C,UAAU8B,EAAM,CACZ,OAAOA,EAAK,SAAS,YAAY,IAAM,SAC3C,EACA,MAAO,0CACP,SAAU,OACV,MAAO,MACX,CAAC,EAED9B,EAAO,GAAG,UAAW,IAAM,CACvBqB,GAAoBrB,CAAM,CAC9B,CAAC,CACL,CAKO,SAAS+B,IAAY,CACxB,OAAOP,EACX,CCpQA,SAASQ,GAASC,EAAQ,CACtBA,EAAO,GAAG,SAAS,QAAQ,uBAAwB,00BAA00B,EAE73B,IAAMC,EAA2B,CAC7B,MAAO,oBACP,UAAUC,EAAM,CACZ,IAAMC,EAAUD,EAAK,SAAS,YAAY,IAAM,QAC1CE,EAAgBJ,EAAO,UAAU,QAAQ,EACzCK,EAAcD,EAAc,QAAQ,OAAO,EACjD,MAAI,CAACD,GAAW,CAACE,EACN,GAGMA,EAAY,cAAc,IAAI,EAC/B,SAASD,CAAa,CAC1C,EACA,SAAU,OACV,MAAO,MACX,EACAJ,EAAO,GAAG,SAAS,kBAAkB,6BAA8BC,CAAwB,EAE3FD,EAAO,WAAW,uBAAwB,IAAM,CAC5C,IAAMM,EAAQN,EAAO,IAAI,UAAUA,EAAO,UAAU,SAAS,EAAG,OAAO,EACvE,GAAI,CAACM,EACD,OAGJ,IAAMC,EAAgB,CAAC,QAAS,QAAS,QAAS,QAAQ,EACpDC,EAAS,CAACF,EAAO,GAAGA,EAAM,iBAAiBC,EAAc,IAAIE,GAAK,IAAIA,CAAC,GAAG,EAAE,KAAK,GAAG,CAAC,CAAC,EAC5F,QAAWP,KAAQM,EACf,QAAWE,KAAQH,EACfL,EAAK,gBAAgBQ,CAAI,CAGrC,CAAC,EAEDV,EAAO,WAAW,kBAAmB,IAAM,CACvC,IAAMM,EAAQN,EAAO,IAAI,UAAUA,EAAO,UAAU,SAAS,EAAG,OAAO,EACvE,GAAI,CAACM,EACD,OAGJ,IAAMK,EAAU,CAACL,EAAO,GAAGA,EAAM,iBAAiB,sCAAsC,CAAC,EACzF,QAAWJ,KAAQS,EACfT,EAAK,gBAAgB,OAAO,EAC5BA,EAAK,gBAAgB,QAAQ,EAC7BA,EAAK,MAAM,OAAS,KACpBA,EAAK,MAAM,MAAQ,IAE3B,CAAC,EAED,IAAMU,EAAY,IAAM,CACpB,IAAMC,EAAiBb,EAAO,GAAG,SAAS,OAAO,EAAE,QAEnDA,EAAO,GAAG,SAAS,cAAc,cAAe,CAC5C,GAAGa,EAAe,MAClB,MAAOC,GAAYA,EAAS,4GAA4G,CAC5I,CAAC,EAEDd,EAAO,GAAG,SAAS,YAAY,uBAAwB,CACnD,KAAM,uBACN,KAAM,yBACN,QAASa,EAAe,WAAW,QACnC,UAAW,CACPb,EAAO,YAAY,sBAAsB,CAC7C,CACJ,CAAC,EAEDA,EAAO,GAAG,SAAS,YAAY,kBAAmB,CAC9C,KAAM,SACN,KAAM,qBACN,QAASa,EAAe,WAAW,QACnC,UAAW,CACPb,EAAO,YAAY,iBAAiB,CACxC,CACJ,CAAC,EAEDA,EAAO,IAAI,UAAWY,CAAS,CACnC,EAEAZ,EAAO,GAAG,UAAWY,CAAS,CAClC,CAKO,SAASG,IAAY,CACxB,OAAOhB,EACX,CCvFA,SAASiB,GAAsBC,EAAS,CACpC,IAAMC,EAASD,EAAQ,QAAQ,IAAI,EACnC,OAAOC,GAAUA,EAAO,WAAW,WAAa,MAAQA,EAAO,UAAU,SAAS,gBAAgB,CACtG,CAOA,SAASC,GAAwBC,EAAOC,EAAWC,EAAQ,CACvD,IAAMC,EAASF,EAAU,sBAAsB,EAC1BD,EAAM,SAAWG,EAAO,OACtCH,EAAM,SAAWG,EAAO,MACxBH,EAAM,SAAWG,EAAO,KACxBH,EAAM,SAAWG,EAAO,QAI3BD,EAAO,YAAY,SAAS,IAAM,CAC1BD,EAAU,aAAa,SAAS,EAChCA,EAAU,gBAAgB,SAAS,EAEnCA,EAAU,aAAa,UAAW,SAAS,CAEnD,CAAC,CAET,CAKA,SAASG,GAAkBC,EAAM,CAE7BA,EAAK,KAAK,QAAS,gBAAgB,EAGnC,QAAWC,KAASD,EAAK,SAAS,EAC1BC,EAAM,OAAS,UACXA,EAAM,KAAK,SAAS,IAAM,WAC1BD,EAAK,KAAK,UAAW,SAAS,EAElCC,EAAM,OAAO,EAGzB,CAKA,SAASC,GAAsBF,EAAM,CAEjC,IAAMG,EAAYH,EAAK,KAAK,SAAS,IAAM,UAC3CA,EAAK,KAAK,UAAW,IAAI,EAEzB,IAAMI,EAAa,CAAC,KAAM,WAAY,SAAU,UAAU,EACtDD,IACAC,EAAW,QAAU,WAIzB,IAAMC,EAAW,OAAO,QAAQ,KAAK,KAAK,OAAO,QAASD,CAAU,EACpEC,EAAS,WAAa,GAElBL,EAAK,WACLA,EAAK,OAAOK,EAAUL,EAAK,WAAY,EAAI,EAE3CA,EAAK,OAAOK,CAAQ,CAE5B,CAKA,SAASC,GAAST,EAAQ,CAEtBA,EAAO,GAAG,SAAS,QAAQ,WAAY,mqBAAmqB,EAC1sBA,EAAO,GAAG,SAAS,gBAAgB,WAAY,CAC3C,QAAS,YACT,KAAM,WACN,OAAQ,GACR,SAASU,EAAK,CACNA,EAAI,SAAS,EACbV,EAAO,YAAY,YAAY,EAE/BA,EAAO,YAAY,sBAAuB,KAAM,CAC5C,uBAAwB,CACpB,MAAO,gBACX,EACA,kBAAmB,UACvB,CAAC,CAET,EACA,QAAQU,EAAK,CACTV,EAAO,GAAG,aAAcF,GAAS,CAC7B,IAAMa,EAAeb,EAAM,QAAQ,KAAKc,GAAMA,EAAG,WAAa,IAAI,EAC5DC,EAASF,GAAgBA,EAAa,UAAU,SAAS,gBAAgB,EAC/ED,EAAI,UAAU,EAAQG,CAAO,CACjC,CAAC,CACL,CACJ,CAAC,EAID,IAAMC,EAAyBd,EAAO,GAAG,SAAS,OAAO,EAAE,QAAQ,QACnEc,EAAuB,QAAU,SAA+BJ,EAAK,CACjEV,EAAO,GAAG,aAAcF,GAAS,CAC7B,IAAMiB,EAAajB,EAAM,QAAQ,KAAKc,GAAMA,EAAG,WAAa,IAAI,EAC1DI,EAAaD,GAAcA,EAAW,UAAU,SAAS,gBAAgB,EACzEE,EAAWF,GAAcA,EAAW,WAAW,WAAa,KAClEL,EAAI,UAAU,GAAQO,GAAY,CAACD,EAAW,CAClD,CAAC,CACL,EACAF,EAAuB,SAAW,UAAkC,CAI5DpB,GAAsBM,EAAO,UAAU,QAAQ,CAAC,GAChDA,EAAO,YAAY,oBAAqB,KAAM,CAC1C,uBAAwB,CAAC,MAAO,IAAI,CACxC,CAAC,EAGLA,EAAO,YAAY,sBAAuB,KAAM,CAC5C,uBAAwB,CAAC,MAAO,IAAI,CACxC,CAAC,CACL,EAEA,IAAMkB,EAAwBlB,EAAO,GAAG,SAAS,OAAO,EAAE,QAAQ,QAClEkB,EAAsB,SAAW,UAAuC,CACpElB,EAAO,YAAY,oBAAqB,KAAM,CAC1C,uBAAwB,CAAC,MAAO,IAAI,CACxC,CAAC,CACL,EAGAA,EAAO,GAAG,UAAW,IAAM,CACvBA,EAAO,OAAO,cAAc,KAAMmB,GAAS,CACvC,QAAWhB,KAAQgB,EACXhB,EAAK,WAAW,IAAI,QAAU,kBAC9BD,GAAkBC,CAAI,CAGlC,CAAC,EACDH,EAAO,WAAW,cAAc,KAAMmB,GAAS,CAC3C,QAAWhB,KAAQgB,EACXhB,EAAK,WAAW,IAAI,QAAU,kBAC9BE,GAAsBF,CAAI,CAGtC,CAAC,CACL,CAAC,EAGDH,EAAO,GAAG,QAASF,GAAS,CACxB,IAAMC,EAAYD,EAAM,OACpBC,EAAU,WAAa,MAAQA,EAAU,UAAU,SAAS,gBAAgB,IAC5EF,GAAwBC,EAAOC,EAAWC,CAAM,EAChDF,EAAM,eAAe,EAE7B,CAAC,CACL,CAKO,SAASsB,IAAY,CACxB,OAAOX,EACX,CCnKO,SAASY,GAA4BC,EAAQ,CAChD,SAASC,EAAwBC,EAAa,CAC1C,IAAMC,EAAcD,EAAY,cAAc,eAAe,EAC7D,GAAI,CAACC,EACD,OAGJ,IAAMC,EAAmB,CAAC,GAAGD,EAAY,UAAU,OAAO,CAAC,EAAE,OAAOE,GAAKA,EAAE,WAAW,QAAQ,CAAC,EACzFC,EAAsB,CAAC,GAAGJ,EAAY,UAAU,OAAO,CAAC,EAAE,OAAOG,GAAKA,EAAE,WAAW,QAAQ,CAAC,EAClGH,EAAY,UAAU,OAAO,GAAGI,CAAmB,EACnDJ,EAAY,UAAU,IAAI,GAAGE,CAAgB,CACjD,CAEAJ,EAAO,GAAG,aAAc,IAAM,CAC1B,IAAMO,EAAeP,EAAO,IAAI,OAAO,yBAAyB,EAChE,QAAWE,KAAeK,EACtBN,EAAwBC,CAAW,CAE3C,CAAC,EAEDF,EAAO,GAAG,cAAeQ,GAAS,CAC9B,IAAMC,EAAcD,EAAM,OAAO,WAAW,OAAO,EACnD,GAAI,CAACA,EAAM,MAAQ,CAACA,EAAM,KAAK,QAAQ,qBAAqB,EACxD,OAGJ,IAAME,EAAaF,EAAM,KAAK,cAAc,eAAe,EAC3D,GAAIC,GAAeC,EAAY,CAC3B,IAAMC,GAAaX,EAAO,UAAU,IAAIQ,EAAM,MAAM,EAAE,CAAC,GAAG,SAAW,CAAC,GAAG,CAAC,EACpEI,EAAQ,CAACF,EAAW,UAAU,SAASC,CAAS,EAGhDE,GADkBL,EAAM,KAAK,aAAa,kBAAkB,GAAK,IAAI,MAAM,GAAG,EACtC,OAAOH,GAAK,CAACA,EAAE,WAAW,QAAQ,CAAC,EAC7EO,GACAC,EAAuB,KAAKF,CAAS,EAGzC,IAAMG,EAAiBD,EAAuB,KAAK,GAAG,EACtDL,EAAM,KAAK,aAAa,mBAAoBM,CAAc,EAE1DJ,EAAW,aAAa,QAASI,CAAc,EAC/Cd,EAAO,UAAU,MAAMQ,EAAM,OAAQ,CAAC,EAAGE,CAAU,EACnDT,EAAwBO,EAAM,IAAI,CACtC,CACJ,CAAC,CACL,CAQA,SAASO,GAAsBC,EAAS,CACpC,IAAMC,EAAoBD,EAAQ,iBAAiB,kDAAkD,EACrG,QAAWE,KAASD,EAChBC,EAAM,gBAAgB,KAAK,EAC3BA,EAAM,MAAM,UAAY,KACxBA,EAAM,MAAM,UAAY,KAE5BF,EAAQ,MAAM,UAAY,KAC1BA,EAAQ,MAAM,UAAY,IAC9B,CASO,SAASG,GAA2BnB,EAAQ,CAE/C,IAAIoB,EAAgB,CAAC,EAErBpB,EAAO,GAAG,uBAAwBQ,GAAS,CACvCY,GAAiBZ,EAAM,OAAS,CAAC,GAAG,IAAIa,GAAQA,EAAK,GAAG,CAC5D,CAAC,EACDrB,EAAO,GAAG,sBAAuB,IAAM,CACnCoB,EAAgB,CAAC,CACrB,CAAC,EAMD,IAAME,EAAgB,CAAC,QAAS,QAAS,QAAS,QAAQ,EAC1DtB,EAAO,GAAG,eAAgB,IAAM,CAC5B,QAAWqB,KAAQD,EACf,QAAWG,KAAQD,EACfD,EAAK,gBAAgBE,CAAI,CAGrC,CAAC,EAKDvB,EAAO,GAAG,cAAeQ,GAAS,CAC9B,IAAMgB,EAAUhB,EAAM,QACtB,GAAIgB,IAAY,mBAAqBA,IAAY,kBAC7C,OAGJ,IAAMC,EAAMD,IAAY,kBAAoB,MAAQ,MACpD,QAAWH,KAAQD,EACfC,EAAK,aAAa,MAAOI,CAAG,EAC5BV,GAAsBM,CAAI,CAElC,CAAC,CACL,CASO,SAASK,GAA4B1B,EAAQ,CAChDA,EAAO,GAAG,cAAeQ,GAAS,CAC9B,IAAMgB,EAAUhB,EAAM,QACtB,GAAIgB,IAAY,mBAAqBA,IAAY,kBAC7C,OAGJ,IAAMG,EAAS3B,EAAO,UAAU,kBAAkB,EAClD,QAAW4B,KAASD,EAChBZ,GAAsBa,CAAK,CAEnC,CAAC,CACL,CCtHA,IAAMC,GAAe,CACjB,CAAC,MAAO,eAAgB,OAAQ,KAAM,QAAS,cAAc,EAC7D,CAAC,MAAO,gBAAiB,OAAQ,IAAI,EACrC,CAAC,MAAO,eAAgB,OAAQ,IAAI,EACpC,CAAC,MAAO,cAAe,OAAQ,IAAI,EACnC,CACI,MAAO,YAAa,OAAQ,IAAK,MAAO,GAAM,QAAS,EAC3D,EACA,CAAC,MAAO,aAAc,OAAQ,YAAY,EAC1C,CACI,MAAO,WACP,MAAO,CACH,CAAC,MAAO,cAAe,OAAQ,aAAa,EAC5C,CAAC,MAAO,UAAW,OAAQ,gBAAgB,EAC3C,CAAC,MAAO,UAAW,OAAQ,gBAAgB,EAC3C,CAAC,MAAO,SAAU,OAAQ,eAAe,CAC7C,CACJ,CACJ,EAEMC,GAAU,CACZ,UAAW,CAAC,SAAU,gEAAiE,QAAS,YAAY,EAC5G,YAAa,CAAC,SAAU,gEAAiE,QAAS,cAAc,EAChH,WAAY,CAAC,SAAU,gEAAiE,QAAS,aAAa,EAC9G,eAAgB,CAAC,MAAO,IAAK,MAAO,GAAM,WAAY,CAAC,MAAO,iBAAiB,CAAC,EAChF,YAAa,CAAC,MAAO,IAAK,MAAO,GAAM,WAAY,CAAC,MAAO,cAAc,CAAC,EAC1E,eAAgB,CAAC,MAAO,IAAK,MAAO,GAAM,WAAY,CAAC,MAAO,iBAAiB,CAAC,EAChF,cAAe,CAAC,MAAO,IAAK,MAAO,GAAM,WAAY,CAAC,MAAO,gBAAgB,CAAC,CAClF,EAEMC,GAAW,CACb,UAAW,GACX,UAAW,GACX,UAAW,GACX,UAAW,GACX,UAAW,GAEX,UAAW,GACX,UAAW,GACX,UAAW,GACX,UAAW,GACX,UAAW,GAEX,UAAW,GACX,UAAW,GACX,UAAW,GACX,UAAW,GACX,UAAW,GAEX,UAAW,GACX,UAAW,GACX,UAAW,GACX,UAAW,GACX,UAAW,GAEX,UAAW,GACX,UAAW,EACf,EAEA,SAASC,GAAmBC,EAAUC,EAAOC,EAAM,CAE/C,GAAIA,EAAK,WAAa,OAAQ,CAE1B,IAAMC,EAAW,OAAO,YAAY,MAAM,uBAAuB,EAC3DC,EAAgB,KAAK,UAAU,WAAW,CAAC,OAAQ,MAAM,CAAC,EAAE,KAAK,EACvED,EAAS,KAAKE,GAAU,CACpBL,EAASK,EAAO,KAAM,CAClB,KAAMA,EAAO,KACb,MAAOA,EAAO,IAClB,CAAC,CACL,EAAG,CACC,aAAcD,EACd,eAAgB,0BAChB,YAAa,8BACb,iBAAkB,MACtB,CAAC,CACL,CAEIF,EAAK,WAAa,SAGG,OAAO,YAAY,MAAM,eAAe,EAChD,KAAKI,GAAS,CACvBN,EAASM,EAAM,IAAK,CAAC,IAAKA,EAAM,IAAI,CAAC,CACzC,EAAG,SAAS,CAEpB,CAMA,SAASC,GAAcC,EAAS,CAC5B,IAAMC,EAAU,CACZ,QACA,QACA,OACA,WACA,aACA,OACA,WACA,WACA,QACA,aACA,QACA,eACA,QACA,UACA,WACA,iBACAD,EAAQ,gBAAkB,MAAQ,iBAAmB,EACzD,EAEA,cAAO,QAAQ,cAAc,IAAI,aAAcE,GAAoB,CAAC,EACpE,OAAO,QAAQ,cAAc,IAAI,WAAYA,GAAkB,CAAC,EAChE,OAAO,QAAQ,cAAc,IAAI,eAAgBA,GAAsB,CAAC,EACxE,OAAO,QAAQ,cAAc,IAAI,QAASA,GAAe,CAAC,EAC1D,OAAO,QAAQ,cAAc,IAAI,UAAWA,GAAiB,CAAC,EAC9D,OAAO,QAAQ,cAAc,IAAI,WAAYA,GAAkB,CAAC,EAChE,OAAO,QAAQ,cAAc,IAAI,iBAAkBA,GAAwB,CAAC,EAExEF,EAAQ,YACR,OAAO,QAAQ,cAAc,IAAI,SAAUE,GAAgBF,CAAO,CAAC,EACnEC,EAAQ,KAAK,QAAQ,GAGlBA,EAAQ,OAAOE,GAAU,EAAQA,CAAO,CACnD,CAOA,SAASC,GAAqBC,EAAW,CACrC,IAAMC,EAAmB,SAAS,KAAK,UAAU,MAAM;AAAA,CAAI,EACrDC,EAAiBD,EAAiB,UAAUE,GAAQA,EAAK,KAAK,IAAM,qCAAqC,EACzGC,EAAeH,EAAiB,UAAUE,GAAQA,EAAK,KAAK,IAAM,mCAAmC,EAC3G,GAAID,IAAmB,IAAME,IAAiB,GAC1C,OAGJ,IAAMC,EAAiBJ,EAAiB,MAAMC,EAAiB,EAAGE,CAAY,EAAE,KAAK;AAAA,CAAI,EACnFE,EAAKN,EAAU,cAAc,KAAK,EACxCM,EAAG,UAAYD,EAEfL,EAAU,KAAK,OAAO,GAAGM,EAAG,QAAQ,CACxC,CAMA,SAASC,GAAiBZ,EAAS,CAC/B,OAAO,SAAuBa,EAAQ,CAClC,SAASC,GAAe,CAChBd,EAAQ,UACRa,EAAO,gBAAgB,gBAAgB,UAAU,IAAI,WAAW,EAEpE,OAAO,QAAQ,KAAK,qBAAsB,EAAE,CAChD,CAEAA,EAAO,GAAG,oDAAqDC,CAAY,EAC3EC,GAAsBF,CAAM,EAC5BG,GAAsBH,EAAQb,CAAO,EAErCa,EAAO,GAAG,OAAQ,IAAM,CACpBC,EAAa,EACbG,GAAoBJ,CAAM,EAC1B,OAAO,OAASA,EAChBK,GAAkBL,CAAM,CAC5B,CAAC,EAEDA,EAAO,GAAG,UAAW,IAAM,CACvBM,GAAaN,CAAM,CACvB,CAAC,EAEDO,GAA4BP,CAAM,EAClCQ,GAA2BR,CAAM,EACjCS,GAA4BT,CAAM,EAGlC,OAAO,QAAQ,WAAWb,EAAQ,iBAAkB,wBAAyB,CAAC,OAAAa,CAAM,CAAC,EAGrFA,EAAO,GAAG,SAAS,UAAU,aAAc,CACvC,QAAS,cACT,KAAM,aACN,UAAW,CACPA,EAAO,YAAY,kBAAmB,GAAO,MAAM,CACvD,CACJ,CAAC,CACL,CACJ,CAKA,SAASU,GAAgBvB,EAAS,CAC9B,MAAO;AAAA;AAAA,kBAEOA,EAAQ,SAAW,OAAS,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAUjD,KAAK,EAAE,QAAQ;AAAA,EAAM,EAAE,CAC1B,CAMO,SAASwB,GAAexB,EAAS,CAEpC,cAAO,QAAQ,QAAQA,EAAQ,SAAUA,EAAQ,cAAc,EAMxD,CACH,MAAO,OACP,OAAQ,OACR,SAAU,eACV,aAAc,YAPF,SAAS,cAAc,6BAA6B,EAAE,aAAa,KAAK,EAAE,MAAM,WAAW,EAAE,CAAC,CAOzE,GACjC,YAAa,CACT,OAAO,QAAQ,kBAAkB,CACrC,EACA,SAAU,GACV,KAAMA,EAAQ,SAAW,iBAAmB,YAC5C,WAAY,eACZ,mBAAoB,GACpB,cAAe,GACf,SAAUA,EAAQ,SAClB,eAAgBA,EAAQ,cACxB,mBAAoB,GACpB,kBAAmB,OAAO,QAAQ,GAAG,EACrC,6BAA8B,GAC9B,oBAAqB,GACrB,UAAW,GACX,QAAS,GACT,kBAAmB,GACnB,wBAAyB,yFACzB,kBAAmB,GACnB,gBAAiB,sBACjB,eAAgB,CACZ,kDACA,gBACA,4BACA,eACA,mBACA,6DACJ,EAAE,KAAK,GAAG,EACV,QAASD,GAAcC,CAAO,EAC9B,YAAa,GACb,QAASyB,GAAkBzB,CAAO,EAClC,cAAeuB,GAAgBvB,CAAO,EACtC,cAAeZ,GACf,oBAAqB,GACrB,iBAAkB,GAClB,aAAc,GACd,QAAAC,GACA,mBAAoB,GACpB,oBAAqB,GACrB,kBAAmB,aACnB,UAAWC,GACX,qBAAsBC,GACtB,iBAAiBY,EAAQuB,EAAM,CAC3B,GAAM,CAAC,QAAAC,CAAO,EAAID,EACdC,EAAQ,QAAQ,mBAAmB,IAAM,KACzCD,EAAK,QAAU,GAEvB,EACA,uBAAuBb,EAAQ,CAC3BT,GAAqBS,EAAO,OAAO,CAAC,CACxC,EACA,MAAMA,EAAQ,CACVe,GAAoBf,CAAM,EAC1BgB,GAA2BhB,CAAM,EACjCD,GAAiBZ,CAAO,EAAEa,CAAM,CACpC,CACJ,CACJ,CAMO,SAASiB,GAAc9B,EAAS,CAEnC,OAAO,QAAQ,QAAQA,EAAQ,SAAUA,EAAQ,cAAc,EAG/D,IAAM+B,EAAU,SAAS,cAAc,6BAA6B,EAAE,aAAa,KAAK,EAAE,MAAM,WAAW,EAAE,CAAC,EAG9G,MAAO,CACH,MAAO,OACP,OAAQ,QACR,OAAQ/B,EAAQ,iBAChB,aAAc,YAAY+B,CAAO,GACjC,YAAa,CACT,OAAO,QAAQ,kBAAkB,CACrC,EACA,SAAU,GACV,KAAM/B,EAAQ,SAAW,iBAAmB,YAC5C,WAAY,gBACZ,mBAAoB,GACpB,cAAe,GACf,SAAUA,EAAQ,SAClB,eAAgBA,EAAQ,cACxB,mBAAoB,GACpB,kBAAmB,OAAO,QAAQ,GAAG,EACrC,6BAA8B,GAC9B,oBAAqB,GACrB,UAAW,GACX,QAAS,GACT,QAAS,sBACT,YAAa,GACb,QAAS,mCACT,cAAeuB,GAAgBvB,CAAO,EACtC,kBAAmB,OACnB,eAAgB,+CAChB,qBAAsBT,GACtB,uBAAuBsB,EAAQ,CAC3BT,GAAqBS,EAAO,OAAO,CAAC,EAEpCA,EAAO,gBAAgB,gBAAgB,UAAU,OAAO,YAAab,EAAQ,QAAQ,CACzF,CACJ,CACJ,CClWO,IAAMgC,GAAN,cAA0BC,CAAU,CAEvC,OAAQ,CAEJ,KAAK,UAAY,KAAK,MAAM,UAC5B,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,gBAAkB,KAAK,MAAM,gBAClC,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,YAAc,KAAK,MAAM,YAG9B,KAAK,cAAgB,KACrB,KAAK,gBAAkB,KAAK,MAAM,gBAClC,KAAK,qBAAuB,KAAK,MAAM,qBAGvC,KAAK,UAAY,KAAK,IACtB,KAAK,iBAAmB,KAAK,MAAM,iBACnC,KAAK,KAAO,KAAK,MAAM,KACvB,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,MAAQ,KAAK,MAAM,MAExB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACT,KAAK,aACL,KAAK,YAAY,iBAAiB,QAAS,IAAM,KAAK,MAAM,QAAS,CACjE,GAAI,KAAK,eACT,QAAS,KAAK,SAClB,CAAC,CAAC,EAGF,KAAK,aACL,KAAK,WAAW,iBAAiB,QAAS,KAAK,UAAU,KAAK,IAAI,CAAC,EACnE,KAAK,KAAK,iBAAiB,SAAU,KAAK,OAAO,KAAK,IAAI,CAAC,EAC3D,KAAK,WAAW,iBAAiB,QAAS,IAAM,KAAK,eAAe,EAAK,CAAC,GAG1E,KAAK,cACL,KAAK,aAAa,iBAAiB,QAAS,KAAK,OAAO,KAAK,IAAI,CAAC,CAE1E,CAEA,eAAeC,EAAM,CACjB,KAAK,iBAAiB,gBAAgB,SAAUA,CAAI,EACpD,KAAK,KAAK,gBAAgB,SAAU,CAACA,CAAI,CAC7C,CAEA,WAAY,CAGR,GAFA,KAAK,eAAe,EAAI,EAEpB,KAAK,cAAe,CACpB,KAAK,cAAc,MAAM,EACzB,MACJ,CAEA,IAAMC,EAASC,GAAc,CACzB,SAAU,KAAK,gBACf,iBAAkB,KAAK,MACvB,SAAU,SAAS,gBAAgB,UAAU,SAAS,WAAW,EACjE,cAAe,KAAK,qBACpB,aAAc,CAAC,EACf,eAAgB,OAAO,mBAC3B,CAAC,EAED,OAAO,QAAQ,KAAKD,CAAM,EAAE,KAAKE,GAAW,CACxC,KAAK,cAAgBA,EAAQ,CAAC,EAC9B,WAAW,IAAM,KAAK,cAAc,MAAM,EAAG,EAAE,CACnD,CAAC,CACL,CAEA,MAAM,OAAOC,EAAO,CAChBA,EAAM,eAAe,EACrB,IAAMC,EAAU,KAAK,YAAY,EACjC,KAAK,KAAK,gBAAgB,SAAU,EAAI,EAExC,IAAMC,EAAU,CACZ,KAAM,KAAK,cAAc,WAAW,EACpC,UAAW,KAAK,UAAY,IAChC,EAEA,GAAI,CACA,IAAMC,EAAO,MAAM,OAAO,MAAM,IAAI,YAAY,KAAK,SAAS,GAAID,CAAO,EACnEE,EAAaC,GAAUF,EAAK,IAAI,EACtC,KAAK,UAAU,YAAYC,CAAU,EACrC,OAAO,QAAQ,QAAQ,KAAK,WAAW,CAC3C,OAASE,EAAK,CACV,QAAQ,MAAMA,CAAG,EACjB,OAAO,QAAQ,qBAAqBA,CAAG,EACvC,KAAK,KAAK,gBAAgB,SAAU,EAAK,EACzCL,EAAQ,OAAO,CACnB,CACJ,CAEA,MAAM,QAAS,CACX,KAAK,YAAY,EAEjB,MAAM,OAAO,MAAM,OAAO,YAAY,KAAK,SAAS,EAAE,EACtD,KAAK,UAAU,QAAQ,iBAAiB,EAAE,OAAO,EACjD,OAAO,QAAQ,QAAQ,KAAK,WAAW,EACvC,KAAK,MAAM,QAAQ,CACvB,CAEA,aAAc,CACV,IAAMA,EAAUM,GAAW,EAC3B,OAAAN,EAAQ,UAAU,IAAI,MAAM,EAC5B,KAAK,UAAU,OAAOA,CAAO,EACtBA,CACX,CAEJ,EClHO,IAAMO,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CACJ,KAAK,KAAO,KAAK,IACjB,KAAK,OAAS,OAAO,KAAK,MAAM,MAAM,EAGtC,KAAK,UAAY,KAAK,MAAM,iBAC5B,KAAK,gBAAkB,KAAK,MAAM,gBAClC,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,mBAAqB,KAAK,MAAM,mBACrC,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,KAAO,KAAK,MAAM,KACvB,KAAK,UAAY,KAAK,MAAM,UAC5B,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,iBAAmB,KAAK,MAAM,iBACnC,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,oBAAsB,KAAK,MAAM,oBAGtC,KAAK,gBAAkB,KAAK,MAAM,gBAClC,KAAK,qBAAuB,KAAK,MAAM,qBACvC,KAAK,cAAgB,KAGrB,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,UAAY,KAAK,MAAM,UAG5B,KAAK,SAAW,KAChB,KAAK,cAAgB,KAAK,eAAe,aAAe,GAExD,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,KAAK,KAAK,iBAAiB,sBAAuB,IAAM,CACpD,KAAK,YAAY,EACjB,KAAK,SAAS,CAClB,CAAC,EAED,KAAK,KAAK,iBAAiB,qBAAsBC,GAAS,CACtD,KAAK,SAASA,EAAM,OAAO,GAAIA,EAAM,OAAO,OAAO,CACvD,CAAC,EAEG,KAAK,OACL,KAAK,oBAAoB,iBAAiB,QAAS,KAAK,cAAc,KAAK,IAAI,CAAC,EAChF,KAAK,eAAe,iBAAiB,QAAS,KAAK,SAAS,KAAK,IAAI,CAAC,EACtE,KAAK,iBAAiB,iBAAiB,QAAS,KAAK,SAAS,KAAK,IAAI,CAAC,EACxE,KAAK,KAAK,iBAAiB,SAAU,KAAK,YAAY,KAAK,IAAI,CAAC,EAExE,CAEA,YAAYA,EAAO,CACfA,EAAM,eAAe,EACrBA,EAAM,gBAAgB,EAEtB,IAAMC,EAAUC,GAAW,EAC3BD,EAAQ,UAAU,IAAI,MAAM,EAC5B,KAAK,KAAK,MAAMA,CAAO,EACvB,KAAK,KAAK,gBAAgB,SAAU,EAAI,EAExC,IAAME,EAAU,CACZ,KAAM,KAAK,cAAc,WAAW,EACpC,UAAW,KAAK,UAAY,IAChC,EAEA,OAAO,MAAM,KAAK,YAAY,KAAK,MAAM,GAAIA,CAAO,EAAE,KAAKC,GAAQ,CAC/D,IAAMC,EAAUC,GAAUF,EAAK,IAAI,EACnC,KAAK,cAAc,MAAMC,CAAO,EAChC,OAAO,QAAQ,QAAQ,KAAK,WAAW,EACvC,KAAK,SAAS,EACd,KAAK,YAAY,CACrB,CAAC,EAAE,MAAME,GAAO,CACZ,KAAK,KAAK,gBAAgB,SAAU,EAAK,EACzC,OAAO,QAAQ,qBAAqBA,CAAG,CAC3C,CAAC,EAED,KAAK,KAAK,gBAAgB,SAAU,EAAK,EACzCN,EAAQ,OAAO,CACnB,CAEA,aAAc,CACV,IAAMO,EAAQ,KAAK,gBAAgB,EACnC,KAAK,cAAc,YAAc,OAAO,aAAa,KAAK,UAAWA,EAAO,CAAC,MAAAA,CAAK,CAAC,CACvF,CAEA,WAAY,CACR,KAAK,aAAa,EAClB,KAAK,UAAU,MAAQ,GACvB,KAAK,SAAW,KAChB,KAAK,WAAW,gBAAgB,SAAU,EAAI,EAC9C,KAAK,UAAU,OAAO,KAAK,aAAa,CAC5C,CAEA,UAAW,CACP,KAAK,aAAa,EAClB,KAAK,cAAc,gBAAgB,SAAU,EAAK,EAClD,KAAK,mBAAmB,gBAAgB,SAAU,EAAI,EACtD,KAAK,cAAc,eAAe,CAAC,SAAU,SAAU,MAAO,SAAS,CAAC,EACxE,KAAK,WAAW,CACpB,CAEA,UAAW,CACP,KAAK,UAAU,EACf,KAAK,cAAc,gBAAgB,SAAU,EAAI,EAC7C,KAAK,gBAAgB,EAAI,EACzB,KAAK,KAAK,OAAO,KAAK,kBAAkB,EAExC,KAAK,gBAAgB,OAAO,KAAK,kBAAkB,EAEvD,KAAK,mBAAmB,gBAAgB,SAAU,EAAK,CAC3D,CAEA,YAAa,CACT,GAAI,KAAK,cAAe,CACpB,KAAK,cAAc,MAAM,EACzB,MACJ,CAEA,IAAMC,EAASC,GAAc,CACzB,SAAU,KAAK,gBACf,iBAAkB,KAAK,UACvB,SAAU,SAAS,gBAAgB,UAAU,SAAS,WAAW,EACjE,cAAe,KAAK,qBACpB,aAAc,CAAC,EACf,eAAgB,OAAO,mBAC3B,CAAC,EAED,OAAO,QAAQ,KAAKD,CAAM,EAAE,KAAKE,GAAW,CACxC,KAAK,cAAgBA,EAAQ,CAAC,EAC9B,WAAW,IAAM,KAAK,cAAc,MAAM,EAAG,EAAE,CACnD,CAAC,CACL,CAEA,cAAe,CACP,KAAK,gBACL,KAAK,cAAc,OAAO,EAC1B,KAAK,cAAgB,KAE7B,CAEA,iBAAkB,CACd,OAAO,KAAK,UAAU,iBAAiB,4BAA4B,EAAE,MACzE,CAEA,SAASC,EAAgBC,EAAgB,CACVA,EAAe,QAAQ,iBAAiB,EAAE,cAAc,0BAA0B,EAC1F,OAAO,KAAK,aAAa,EAC5C,KAAK,SAAS,EACd,KAAK,SAAWD,EAChB,KAAK,WAAW,gBAAgB,SAAU,EAAK,EAC/C,KAAK,cAAc,YAAc,KAAK,cAAc,QAAQ,OAAQ,KAAK,QAAQ,EACjF,KAAK,cAAc,KAAO,WAAW,KAAK,QAAQ,EACtD,CAEA,eAAgB,CACZ,KAAK,SAAW,KAChB,KAAK,WAAW,gBAAgB,SAAU,EAAI,EAC9C,KAAK,UAAU,OAAO,KAAK,aAAa,EACxC,KAAK,SAAS,CAClB,CAEJ,ECpKA,SAASE,GAAyBC,EAAWC,EAAiB,CACtDC,GAAQ,6BAA6BF,CAAS,KAAMG,GAAU,CAC9DA,EAAO,QAAQ,IAAI,EAAE,UAAU,OAAO,kBAAmBF,CAAe,CAC5E,CAAC,CACL,CAEA,SAASG,GAAwBC,EAAS,CACtC,QAAWC,KAASD,EAAS,CACzB,IAAME,EAAaD,EAAM,oBAAsB,EAC/CP,GAAyBO,EAAM,OAAO,GAAIC,CAAS,CACvD,CACJ,CAEA,SAASC,GAAeC,EAAU,CAE9B,IAAMC,EAAgB,CAClB,WAAY,kBACZ,UAAW,CACf,EACMC,EAAkB,IAAI,qBAAqBP,GAAyBM,CAAa,EAGvF,QAAWE,KAAWH,EAClBE,EAAgB,QAAQC,CAAO,CAEvC,CAEO,IAAMC,GAAN,cAA0BC,CAAU,CAEvC,OAAQ,CAQJ,GAPA,KAAK,UAAY,KAAK,IACtB,KAAK,OAAS,KAAK,MAAM,OAEzB,OAAO,gBAAgB,MAAM,EAAE,KAAKC,GAAQA,EAAK,UAAU,CAAC,EAC5D,KAAK,qBAAqB,EAGtB,OAAO,SAAS,KAAM,CACtB,IAAMC,EAAO,OAAO,SAAS,KAAK,QAAQ,OAAQ,GAAG,EAAE,UAAU,CAAC,EAClE,KAAK,SAASA,CAAI,CACtB,CAGA,IAAMC,EAAiB,SAAS,cAAc,mBAAmB,EAC7DA,GACIC,EAAaD,EAAgB,IAAK,QAAS,CAACE,EAAOC,IAAU,CAC7DD,EAAM,eAAe,EACrB,OAAO,YAAY,MAAM,YAAY,EAAE,YAAY,EACnD,IAAME,EAAYD,EAAM,aAAa,MAAM,EAAE,OAAO,CAAC,EACrD,KAAK,SAASC,CAAS,EACvB,OAAO,QAAQ,UAAU,KAAM,KAAM,IAAIA,CAAS,EAAE,CACxD,CAAC,CAET,CAEA,SAASL,EAAM,CACX,IAAMM,EAAS,SAAS,eAAeN,CAAI,EAO3C,GALId,GAAQ,mCAAoCqB,GAAQ,CACpDA,EAAK,gBAAgB,kBAAkB,EACvCA,EAAK,MAAM,gBAAkB,IACjC,CAAC,EAEGD,IAAW,KACXE,GAA0BF,CAAM,MAC7B,CACH,IAAMG,EAAeC,GAAS,0BAA2BV,CAAI,EACzDS,GACAD,GAA0BC,CAAQ,CAE1C,CACJ,CAEA,sBAAuB,CACnB,IAAME,EAAU,SAAS,cAAc,mBAAmB,EAGpDlB,EAAW,SAAS,cAAc,eAAe,EAAE,iBAAiB,wBAAwB,EAE9FA,EAAS,OAAS,GAAKkB,IAAY,MACnCnB,GAAeC,CAAQ,CAE/B,CAEJ,EChFO,SAASmB,GAAwBC,EAAW,CAC/C,IAAMC,EAAO,IAAI,KAAKD,EAAY,GAAI,EAChCE,EAAQD,EAAK,SAAS,EACtBE,EAAOF,EAAK,WAAW,EAC7B,MAAO,IAAIC,EAAQ,EAAI,GAAK,KAAOA,CAAK,KAAKC,EAAO,EAAI,GAAK,KAAOA,CAAI,EAC5E,CCRO,IAAMC,GAAN,cAAyBC,CAAU,CAEtC,OAAQ,CAEJ,KAAK,cAAgB,KAAK,MAAM,gBAAkB,OAClD,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,OAAS,OAAO,KAAK,MAAM,MAAM,EACtC,KAAK,WAAa,KAAK,MAAM,eAAiB,OAC9C,KAAK,gBAAkB,KAAK,MAAM,iBAAmB,GAGrD,KAAK,UAAY,KAAK,IACtB,KAAK,UAAY,KAAK,MAAM,eAAe,cAAc,OAAO,EAChE,KAAK,gBAAkB,KAAK,MAAM,UAClC,KAAK,mBAAqB,KAAK,MAAM,aACrC,KAAK,iBAAmB,KAAK,MAAM,iBACnC,KAAK,kBAAoB,KAAK,MAAM,YACpC,KAAK,gBAAkB,KAAK,MAAM,gBAClC,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,iBAAmB,KAAK,MAAM,iBACnC,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,iBAAmB,KAAK,MAAM,iBACnC,KAAK,oBAAsB,KAAK,UAAU,cAAgB,CAAC,EAC3D,KAAK,sBAAwB,KAAK,MAAM,aACxC,KAAK,2BAA6B,KAAK,MAAM,kBAG7C,KAAK,UAAY,KAAK,MAAM,UAC5B,KAAK,iBAAmB,KAAK,MAAM,iBACnC,KAAK,gBAAkB,KAAK,MAAM,gBAClC,KAAK,mBAAqB,KAAK,MAAM,mBACrC,KAAK,gBAAkB,KAAK,MAAM,gBAClC,KAAK,oBAAsB,KAAK,MAAM,oBACtC,KAAK,iBAAmB,KAAK,MAAM,iBAGnC,KAAK,SAAW,CACZ,SAAU,KACV,UAAW,IACX,KAAM,EACN,cAAe,EACnB,EACA,KAAK,mBAAqB,IAAI,IAE1B,KAAK,SAAW,GAAK,KAAK,eAC1B,OAAO,WAAW,IAAM,CACpB,KAAK,cAAc,CACvB,EAAG,GAAI,EAEX,KAAK,aAAa,UAAY,KAAK,UAEnC,KAAK,eAAe,EACpB,KAAK,gBAAgB,CACzB,CAEA,gBAAiB,CAEb,OAAO,QAAQ,OAAO,oBAAqB,KAAK,UAAU,KAAK,IAAI,CAAC,EACpE,OAAO,QAAQ,OAAO,mBAAoB,KAAK,SAAS,KAAK,IAAI,CAAC,EAGlE,IAAMC,EAAkB,IAAM,CAC1B,KAAK,SAAS,cAAgB,EAClC,EACA,OAAO,QAAQ,OAAO,qBAAsBA,CAAe,EAC3D,OAAO,QAAQ,OAAO,yBAA0BA,CAAe,EAG/D,KAAK,UAAU,iBAAiB,QAASA,CAAe,EAGxD,IAAMC,EAA2BC,GAAS,KAAK,uBAAuB,KAAK,IAAI,EAAG,IAAK,EAAK,EAC5F,KAAK,eAAe,iBAAiB,QAASD,CAAwB,EAGtEE,EAAS,KAAK,gBAAiB,KAAK,UAAU,KAAK,IAAI,CAAC,EACxDA,EAAS,KAAK,mBAAoB,KAAK,aAAa,KAAK,IAAI,CAAC,EAC9DA,EAAS,KAAK,kBAAmB,KAAK,YAAY,KAAK,IAAI,CAAC,EAG5DA,EAAS,KAAK,oBAAqB,KAAK,aAAa,KAAK,IAAI,CAAC,CACnE,CAEA,iBAAkB,CACd,GAAI,KAAK,gBAAiB,CACtB,KAAK,UAAU,OAAO,EACtB,MACJ,CAEA,OAAO,WAAW,IAAM,CACpB,OAAO,QAAQ,KAAK,gBAAiB,EAAE,CAC3C,EAAG,GAAG,CACV,CAEA,eAAgB,CACZ,KAAK,SAAS,SAAW,OAAO,YAAY,KAAK,YAAY,KAAK,IAAI,EAAG,KAAK,SAAS,SAAS,CACpG,CAEA,aAAc,CAEa,KAAK,IAAI,EAAI,KAAK,SAAS,KAAQ,KAAK,SAAS,UAAa,GAChE,CAAC,KAAK,SAAS,eAIpC,KAAK,UAAU,CACnB,CAEA,UAAW,CACP,KAAK,UAAU,QAAQ,MAAM,EAAE,OAAO,CAC1C,CAEA,MAAM,WAAY,CACd,IAAMC,EAAO,CAAC,KAAM,KAAK,UAAU,MAAM,KAAK,CAAC,EAEzCC,EAAgB,KAAK,mBAAmB,EAAE,WAAW,EAC3D,OAAO,OAAOD,EAAMC,CAAa,EAEjC,IAAIC,EAAU,GACd,GAAI,CACA,IAAMC,EAAO,MAAM,OAAO,MAAM,IAAI,cAAc,KAAK,MAAM,cAAeH,CAAI,EAC3E,KAAK,aACN,KAAK,iBAAiB,gBAAgB,SAAU,EAAK,EACrD,KAAK,gBAAgB,gBAAgB,SAAU,EAAK,GAGxD,KAAK,kBAAkB,GAAGG,EAAK,KAAK,OAAO,IAAUC,GAAwBD,EAAK,KAAK,SAAS,CAAC,EAAE,EACnG,KAAK,SAAS,KAAO,KAAK,IAAI,EAC1BA,EAAK,KAAK,SAAW,CAAC,KAAK,mBAAmB,IAAIA,EAAK,KAAK,OAAO,IACnE,OAAO,QAAQ,KAAK,UAAWA,EAAK,KAAK,OAAO,EAChD,KAAK,mBAAmB,IAAIA,EAAK,KAAK,OAAO,GAGjDD,EAAU,GACV,KAAK,SAAS,cAAgB,EAClC,MAAc,CAEV,GAAI,CACA,IAAMG,EAAU,mBAAoB,IAAI,KAAK,EAAG,YAAY,CAAC,GAC7D,OAAO,aAAa,QAAQA,EAAS,KAAK,UAAUL,CAAI,CAAC,CAC7D,OAASM,EAAO,CACZ,QAAQ,MAAMA,CAAK,CACvB,CAEA,OAAO,QAAQ,KAAK,QAAS,KAAK,gBAAgB,CACtD,CAEA,OAAOJ,CACX,CAEA,kBAAkBK,EAAM,CACpB,KAAK,aAAa,UAAYA,EAC9B,KAAK,iBAAiB,UAAU,IAAI,SAAS,EAC7C,OAAO,WAAW,IAAM,CACpB,KAAK,iBAAiB,UAAU,OAAO,SAAS,CACpD,EAAG,GAAI,CACX,CAEA,MAAM,aAAaC,EAAS,GAAM,CAC9B,IAAIC,EACJ,GAAI,CACAA,EAAW,MAAM,OAAO,MAAM,IAAI,cAAc,KAAK,MAAM,EAAE,CACjE,OAASC,EAAG,CACR,QAAQ,MAAMA,CAAC,EACf,MACJ,CAEI,KAAK,SAAS,UACd,OAAO,cAAc,KAAK,SAAS,QAAQ,EAG/C,KAAK,aAAa,UAAY,KAAK,gBACnC,KAAK,iBAAiB,gBAAgB,SAAU,EAAI,EACpD,OAAO,QAAQ,KAAK,kBAAmB,CACnC,KAAMD,EAAS,KAAK,KACpB,SAAUA,EAAS,KAAK,QAC5B,CAAC,EAED,KAAK,UAAU,MAAQA,EAAS,KAAK,KACrC,OAAO,WAAW,IAAM,CACpB,KAAK,cAAc,CACvB,EAAG,GAAI,EAEHD,GACA,OAAO,QAAQ,QAAQ,KAAK,kBAAkB,CAEtD,CAEA,MAAM,aAAc,CAIhB,GADkB,MADH,OAAO,YAAY,eAAe,KAAK,2BAA4B,gBAAgB,EACnE,KAAK,EAKpC,GAAI,CACA,IAAMG,EAAU,KAAK,aAAa,EAAK,EACjCC,EAAc,OAAO,MAAM,OAAO,+BAA+B,KAAK,MAAM,EAAE,EACpF,MAAM,QAAQ,IAAI,CAACD,EAASC,CAAW,CAAC,EACxC,OAAO,QAAQ,QAAQ,KAAK,eAAe,EAC3C,KAAK,gBAAgB,gBAAgB,SAAU,EAAI,CACvD,OAASC,EAAK,CACV,QAAQ,MAAMA,CAAG,EACjB,OAAO,QAAQ,MAAM,KAAK,mBAAmB,CACjD,CACJ,CAEA,wBAAyB,CACrB,IAAIC,EAAU,KAAK,eAAe,MAAM,KAAK,EACzCA,EAAQ,SAAW,EACnBA,EAAU,KAAK,iBACRA,EAAQ,OAAS,KACxBA,EAAU,GAAGA,EAAQ,MAAM,EAAG,EAAE,CAAC,OAErC,KAAK,iBAAiB,UAAYA,CACtC,CAEA,MAAM,aAAaC,EAAO,CACtBA,EAAM,eAAe,EAErB,IAAMC,EAAOD,EAAM,OAAO,QAAQ,GAAG,EAAE,KAEjCE,EAAS,OAAO,YAAY,eAAe,KAAK,sBAAuB,gBAAgB,EACvF,CAACC,EAAOC,CAAS,EAAI,MAAM,QAAQ,IAAI,CAAC,KAAK,UAAU,EAAGF,EAAO,KAAK,CAAC,CAAC,EAE1EC,GAASC,IACT,OAAO,SAAWH,EAE1B,CAKA,oBAAqB,CACjB,OAAO,OAAO,YAAY,MAAM,iBAAiB,GAAK,OAAO,YAAY,MAAM,gBAAgB,CACnG,CAEJ,ECjPA,SAASI,GAAWC,EAAMC,EAAM,CAC5BD,EAAK,gBAAgB,SAAU,CAACC,CAAI,CACxC,CAEO,IAAMC,GAAN,cAAyBC,CAAU,CAEtC,OAAQ,CACJ,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,QAAU,KAAK,MAAM,QAC1B,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,UAAY,KAAK,MAAM,gBAE5B,KAAK,iBAAmB,KAAK,MAAM,iBAEnC,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,KAAK,aAAa,iBAAiB,QAAS,KAAK,UAAU,KAAK,IAAI,CAAC,EACrE,KAAK,QAAQ,cAAc,iBAAiB,QAAS,KAAK,UAAU,KAAK,IAAI,CAAC,EAC9E,KAAK,QAAQ,iBAAiB,QAASC,GAAKA,EAAE,gBAAgB,CAAC,EAE/D,KAAK,YAAY,iBAAiB,QAAS,IAAM,CAC7C,KAAK,SAAS,GAAI,EAAE,CACxB,CAAC,CACL,CAEA,WAAY,CAEc,OAAO,YAAY,MAAM,uBAAuB,EACxD,KAAKC,GAAU,CACzB,KAAK,SAASA,EAAO,GAAIA,EAAO,IAAI,CACxC,EAAG,CACC,aAAc,GACd,eAAgB,KAAK,iBACrB,YAAa,OACb,iBAAkB,MACtB,CAAC,CACL,CAEA,SAASC,EAAOC,EAAM,CAClB,KAAK,MAAQD,EACb,KAAK,MAAM,MAAQA,EACnB,KAAK,YAAYC,CAAI,CACzB,CAEA,YAAYA,EAAM,CACd,IAAMC,EAAW,KAAK,OAAS,KAAK,QAAU,EAK9C,GAJAT,GAAW,KAAK,YAAaS,CAAQ,EACrCT,GAAW,KAAK,UAAWS,CAAQ,EACnCT,GAAW,KAAK,eAAgB,CAACS,CAAQ,EACzCT,GAAW,KAAK,QAASS,CAAQ,EAC7BA,EAAU,CACV,IAAMC,EAAK,KAAK,kBAAkB,EAClC,KAAK,QAAQ,YAAc,IAAIA,CAAE,KAAKF,CAAI,GAC1C,KAAK,QAAQ,KAAO,OAAO,QAAQ,SAASE,CAAE,EAAE,CACpD,CACJ,CAEA,mBAAoB,CAChB,OAAO,OAAO,KAAK,KAAK,CAC5B,CAEJ,EClEO,IAAMC,GAAN,cAA+BC,CAAU,CAE5C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,aAAe,KAAK,MAAM,cAAgB,QAC/C,KAAK,YAAc,KAAK,MAAM,aAAe,KAG7C,QAAWC,KAAkB,KAAK,UAAU,WAAa,CAAC,EACtDA,EAAc,iBAAiB,QAAS,KAAK,eAAe,KAAK,IAAI,CAAC,EAI1E,QAAWC,KAAkB,KAAK,UAAU,WAAa,CAAC,EACtDA,EAAc,iBAAiB,QAAS,KAAK,eAAe,KAAK,IAAI,CAAC,EAI1E,QAAWC,KAAkB,KAAK,UAAU,cAAgB,CAAC,EACzDA,EAAc,iBAAiB,QAAS,KAAK,kBAAkB,KAAK,IAAI,CAAC,CAEjF,CAEA,eAAeC,EAAO,CAClBA,EAAM,eAAe,EACrB,KAAK,mBAAmB,KAAK,SAAS,CAC1C,CAEA,eAAeA,EAAO,CAClBA,EAAM,eAAe,EACrB,KAAK,mBAAmBA,EAAM,OAAO,QAAQ,KAAK,WAAW,CAAC,CAClE,CAEA,kBAAkBA,EAAO,CACrBA,EAAM,eAAe,EAErB,IAAMC,EAAYD,EAAM,OAAO,QAAQ,KAAK,YAAY,EAClDE,EAAW,MAAM,KAAKD,EAAU,cAAc,QAAQ,EAAE,QAAQA,CAAS,EACzEE,EAAY,KAAK,UAAU,iBAAiB,KAAK,WAAW,EAC5DC,EAAiB,CAAC,EAExB,QAAWC,KAAOF,EAAW,CACzB,IAAMG,EAAaD,EAAI,SAASH,CAAQ,EACpCI,GACAF,EAAe,KAAK,GAAGE,EAAW,iBAAiB,sBAAsB,CAAC,CAElF,CACA,KAAK,gBAAgBF,CAAc,CACvC,CAEA,mBAAmBG,EAAS,CACxB,IAAMH,EAAiBG,EAAQ,iBAAiB,sBAAsB,EACtE,KAAK,gBAAgBH,CAAc,CACvC,CAEA,gBAAgBA,EAAgB,CAC5B,IAAMI,EAAeJ,EAAe,OAAS,EAAIA,EAAe,CAAC,EAAE,QAAU,GAC7E,QAAWK,KAAYL,EACnBK,EAAS,QAAU,CAACD,EACpBC,EAAS,cAAc,IAAI,MAAM,QAAQ,CAAC,CAElD,CAEJ,EC7DO,IAAMC,GAAN,cAAsBC,CAAU,CAEnC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,QAAU,KAAK,MAAM,QAC1B,KAAK,UAAY,KAAK,MAAM,UAC5B,KAAK,WAAa,KAAK,MAAM,WAC7B,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,kBAAoB,KAAK,MAAM,kBACpC,KAAK,YAAc,KAAK,UAAU,WAClC,KAAK,aAAe,KAAK,UAAU,YACnC,KAAK,OAAS,KAAK,MAAM,OAGzB,KAAK,QAAU,GACf,KAAK,YAAc,GAEnB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CAEb,KAAK,cAAc,iBAAiB,QAAS,IAAMC,GAAoB,KAAK,aAAa,KAAK,CAAC,EAC/F,KAAK,WAAW,iBAAiB,QAAS,IAAMA,GAAoB,KAAK,UAAU,KAAK,CAAC,EAGrFC,EAAS,CAAC,KAAK,aAAc,KAAK,SAAS,EAAGC,GAAS,CACvDA,EAAM,OAAO,OAAO,EACpBA,EAAM,gBAAgB,CAC1B,CAAC,EAGGC,GAAS,KAAK,QAAS,CAAC,QAAS,OAAO,EAAGD,GAAS,CACpDA,EAAM,gBAAgB,CAC1B,CAAC,EAGGC,GAAS,SAAS,KAAM,CAAC,QAAS,OAAO,EAAG,IAAM,CAC9C,CAAC,KAAK,SAAW,KAAK,aAC1B,KAAK,YAAY,CACrB,CAAC,EAGGC,GAAc,KAAK,QAAS,KAAK,YAAY,KAAK,IAAI,CAAC,EAG3D,IAAMC,EAAc,SAAS,cAAc,eAAe,EACtDF,GAASE,EAAa,CAAC,UAAW,OAAO,EAAGH,GAAS,CACrDA,EAAM,gBAAgB,EACtB,IAAMI,EAAWJ,EAAM,OAAO,QAAQ,eAAe,EACjDI,GAAY,OAAO,aAAa,EAAE,SAAS,EAAE,OAAS,GACtD,KAAK,oBAAoBA,EAAUJ,EAAM,MAAO,EAAK,CAE7D,CAAC,EAGGD,EAAS,KAAK,kBAAmB,KAAK,uBAAuB,KAAK,IAAI,CAAC,EAGvEA,EAAS,KAAK,YAAaC,GAAS,CACpC,QAAWK,KAAW,KAAK,aAAc,CACrC,IAAMC,EAAO,CAACD,EAAQ,SAASL,EAAM,MAAM,EAC3CK,EAAQ,gBAAgB,SAAU,CAACC,CAAI,CAC3C,CAEA,KAAK,YAAY,KAAKC,GAAKA,IAAMP,EAAM,MAAM,EAAE,MAAM,CACzD,CAAC,CACL,CAEA,aAAc,CACV,KAAK,QAAQ,MAAM,QAAU,KAC7B,KAAK,QAAU,EACnB,CAQA,oBAAoBQ,EAASC,EAAWC,EAAc,CAClD,KAAK,gBAAgBF,CAAO,EAE5B,KAAK,QAAQ,MAAM,QAAU,QAC7B,IAAMG,EAAeH,EAAQ,sBAAsB,EAC7CI,EAAgB,KAAK,QAAQ,sBAAsB,EAGnDC,EADU,KAAK,IAAI,KAAK,IAAIJ,EAAWE,EAAa,IAAI,EAAGA,EAAa,KAAK,EACxDC,EAAc,MAAQ,EAC3CE,EAAWH,EAAa,IAAMC,EAAc,OAAU,GAE5D,KAAK,QAAQ,MAAM,KAAO,GAAGC,CAAO,KACpC,KAAK,QAAQ,MAAM,IAAM,GAAGC,CAAO,KAEnC,KAAK,QAAU,GACf,KAAK,YAAc,GAEnB,WAAW,IAAM,CACb,KAAK,YAAc,EACvB,EAAG,GAAG,EAEN,IAAMC,EAAiB,IAAM,CACzB,KAAK,YAAY,EACjB,OAAO,oBAAoB,SAAUA,EAAgB,CAAC,QAAS,EAAI,CAAC,CACxE,EAEAP,EAAQ,cAAc,aAAa,KAAK,QAASA,CAAO,EACnDE,GACD,OAAO,iBAAiB,SAAUK,EAAgB,CAAC,QAAS,EAAI,CAAC,CAEzE,CAMA,gBAAgBP,EAAS,CACrB,IAAMQ,EAAY,OAAO,QAAQ,SAAS,KAAK,MAAM,IAAIR,EAAQ,EAAE,EAAE,EAC/DS,EAAa,MAAM,KAAK,MAAM,IAAIT,EAAQ,EAAE,KAElD,KAAK,UAAU,MAAQQ,EACvB,KAAK,aAAa,MAAQC,EAG1B,IAAMC,EAAa,KAAK,QAAQ,cAAc,eAAe,EAC7D,GAAIA,GAAcV,EAAS,CACvB,GAAM,CAAC,SAAAW,CAAQ,EAAID,EAAW,QACxBE,EAAYZ,EAAQ,GAGpBa,EAAeb,EAAQ,aAAeA,EAAQ,YAAY,UAAU,EAAG,EAAE,EAC/EU,EAAW,KAAO,GAAGC,CAAQ,eAAeC,CAAS,iBAAiB,mBAAmBC,CAAY,CAAC,EAC1G,CACJ,CAEA,wBAAyB,CACrB,IAAMC,EAAW,MAAM,KAAK,SAAS,iBAAiB,6BAA6B,CAAC,EACpF,QAAWjB,KAAWiB,EAClBjB,EAAQ,aAAa,WAAY,GAAG,EAGxCiB,EAAS,CAAC,EAAE,MAAM,EAEdC,GAAaD,EAAUtB,GAAS,CAChC,KAAK,oBAAoBA,EAAM,OAAQ,EAAG,EAAI,EAC9C,KAAK,QAAQ,MAAM,CACvB,CAAC,CACL,CAEJ,ECjJO,IAAMwB,GAAN,cAAoBC,CAAU,CAEjC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,YAAc,KAAK,UAAU,MAAQ,CAAC,EAE3C,KAAK,QAAU,KACf,KAAK,OAAS,KACd,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,IAAIC,EAAsB,KAC1B,KAAK,UAAU,iBAAiB,YAAaC,GAAS,CAClDD,EAAsBC,EAAM,MAChC,CAAC,EAED,KAAK,UAAU,iBAAiB,QAASA,GAAS,CAC1CA,EAAM,SAAW,KAAK,WAAaD,IAAwB,KAAK,WAChE,KAAK,KAAK,CAElB,CAAC,EAEDE,EAAS,KAAK,YAAa,IAAM,KAAK,KAAK,CAAC,CAChD,CAEA,KAAKC,EAAa,KAAM,CACpBC,GAAQ,KAAK,UAAW,IAAKD,CAAU,EACnC,KAAK,UACL,OAAO,oBAAoB,QAAS,KAAK,OAAO,EAChD,KAAK,QAAU,MAEf,KAAK,QACL,KAAK,OAAO,CAEpB,CAEA,KAAKA,EAAa,KAAME,EAAS,KAAM,CACnCC,GAAO,KAAK,UAAW,IAAKH,CAAU,EAEtC,KAAK,QAAUF,GAAS,CAChBA,EAAM,MAAQ,UACd,KAAK,KAAK,CAElB,EACA,OAAO,iBAAiB,QAAS,KAAK,OAAO,EAC7C,KAAK,OAASI,CAClB,CAEJ,ECxDO,IAAME,GAAN,cAAoCC,CAAU,CAEjD,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,KAAO,KAAK,MAAM,KACvB,KAAK,eAAiB,KAAK,MAAM,eACjC,KAAK,cAAgB,KAAK,MAAM,cAEhC,KAAK,UAAU,iBAAiB,cAAeC,GAAS,CAEpD,IAAMC,EADQD,EAAM,OAAO,UACA,2BAA8B,QAAU,OACnE,KAAK,iBAAiBC,CAAO,CACjC,CAAC,EAED,IAAMC,EAAgBF,GAAS,CAC3B,KAAK,0BAA0B,EAE3BA,EAAM,OAAO,KAAK,WAAW,mBAAmB,GAChD,KAAK,oBAAoBA,EAAM,MAAM,CAE7C,EACA,KAAK,UAAU,iBAAiB,SAAUE,CAAa,EACvD,KAAK,UAAU,iBAAiB,QAASA,CAAa,CAC1D,CAEA,iBAAiBD,EAAS,CACtB,KAAK,KAAOA,EACZ,IAAME,EAAUF,IAAY,OAE5B,SAAS,gBAAgB,UAAU,OAAO,YAAaE,CAAM,EAC7D,KAAK,0BAA0B,CACnC,CAEA,2BAA4B,CAExB,IAAMC,GADiB,KAAK,OAAS,OAAS,KAAK,cAAgB,KAAK,gBAC1C,iBAAiB,qBAAqB,EACpE,QAAWC,KAASD,EAAQ,CACxB,IAAME,EAAYD,EAAM,KAAK,MAAM,GAAG,EAChCE,EAAWD,EAAU,QAAQ,OAAO,EACtCE,EAAQF,EAAU,MAAM,EAAGC,CAAQ,EAAE,KAAK,GAAG,EAC7CC,IAAU,QACVA,EAAQ,WAGZ,IAAMC,EAAU,WAAWD,CAAK,GAChC,SAAS,KAAK,MAAM,YAAYC,EAASJ,EAAM,KAAK,CACxD,CACJ,CAMA,oBAAoBA,EAAO,CACvB,IAAMK,EAAYL,EAAM,KAAK,QAAQ,SAAU,cAAc,EACvDM,EAASN,EAAM,MACfO,EAAM,KAAK,SAASD,CAAM,EAC1BE,EAAc,QAAQ,CAACD,EAAI,EAAGA,EAAI,EAAGA,EAAI,EAAG,MAAM,EAAE,KAAK,GAAG,CAAC,IAE7DE,EAAkB,KAAK,UAAU,cAAc,eAAeJ,CAAS,mBAAmB,EAChGI,EAAgB,MAAQD,CAC5B,CAQA,SAASE,EAAK,CACV,IAAMC,EAAS,4CAA4C,KAAKD,CAAG,EACnE,MAAO,CACH,EAAGC,EAAS,SAASA,EAAO,CAAC,EAAG,EAAE,EAAI,EACtC,EAAGA,EAAS,SAASA,EAAO,CAAC,EAAG,EAAE,EAAI,EACtC,EAAGA,EAAS,SAASA,EAAO,CAAC,EAAG,EAAE,EAAI,CAC1C,CACJ,CAEJ,EC9EO,IAAMC,GAAN,cAAiCC,CAAU,CAE9C,OAAQ,CACJ,KAAK,WAAa,KAAK,MAAM,MAC7B,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,aAAe,KAAK,MAAM,QAC/B,KAAK,aAAe,KAAK,MAAM,QAE/B,KAAK,YAAY,iBAAiB,QAAS,IAAM,KAAK,SAAS,KAAK,YAAY,CAAC,EACjF,KAAK,cAAc,iBAAiB,QAAS,IAAM,KAAK,SAAS,KAAK,YAAY,CAAC,CACvF,CAEA,SAASC,EAAO,CACZ,KAAK,WAAW,MAAQA,EACxB,KAAK,WAAW,cAAc,IAAI,MAAM,SAAU,CAAC,QAAS,EAAI,CAAC,CAAC,CACtE,CAEJ,EClBO,IAAMC,GAAN,cAAqCC,CAAU,CAElD,OAAQ,CACJ,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,oBAAsB,KAAK,MAAM,oBAEtC,KAAK,YAAY,iBAAiB,SAAU,KAAK,4BAA4B,KAAK,IAAI,CAAC,EACvF,KAAK,4BAA4B,CACrC,CAEA,6BAA8B,CAC1B,IAAMC,EAAiB,KAAK,YAAY,QAAU,OAClD,KAAK,oBAAoB,MAAM,QAAWA,EAAiB,QAAU,MACzE,CAEJ,ECXA,IAAMC,GAAc,CAChB,QAAQC,EAAM,CACV,IAAMC,EAAOD,EAAK,WACZE,EAAQ,MAAM,KAAKD,EAAK,QAAQ,EAAE,QAAQD,CAAI,EAC9CG,EAAW,KAAK,IAAID,EAAQ,EAAG,CAAC,EACtCD,EAAK,aAAaD,EAAMC,EAAK,SAASE,CAAQ,GAAK,IAAI,CAC3D,EACA,UAAUH,EAAM,CACZ,IAAMC,EAAOD,EAAK,WACZE,EAAQ,MAAM,KAAKD,EAAK,QAAQ,EAAE,QAAQD,CAAI,EAC9CG,EAAW,KAAK,IAAID,EAAQ,EAAGD,EAAK,SAAS,MAAM,EACzDA,EAAK,aAAaD,EAAMC,EAAK,SAASE,CAAQ,GAAK,IAAI,CAC3D,EACA,OAAOH,EAAMI,EAAgBC,EAAc,CACvCA,EAAa,YAAYL,CAAI,CACjC,EACA,IAAIA,EAAMI,EAAgB,CACtBA,EAAe,YAAYJ,CAAI,CACnC,CACJ,EAEaM,GAAN,cAAwBC,CAAU,CAErC,OAAQ,CACJ,KAAK,KAAO,KAAK,IACjB,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,cAAgB,KAAK,MAAM,cAChC,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,gBAAkB,KAAK,MAAM,WAClC,KAAK,oBAAsB,KAAK,MAAM,oBAEtC,KAAK,SAAW,KAEhB,KAAK,aAAa,EAClB,KAAK,eAAe,CACxB,CAEA,cAAe,CACX,IAAMC,EAAc,KAAK,KAAK,iBAAiB,aAAa,EAC5D,QAAWC,KAAaD,EACpB,IAAIE,GAASD,EAAW,CACpB,MAAO,cACP,WAAY,2BACZ,OAAQ,UACR,UAAW,IACX,OAAQ,KAAK,SAAS,KAAK,IAAI,CACnC,CAAC,CAET,CAEA,gBAAiB,CACb,KAAK,KAAK,iBAAiB,QAASE,GAAS,CACzC,IAAMC,EAAiBD,EAAM,OAAO,QAAQ,sCAAsC,EAC9EC,GACA,KAAK,oBAAoBA,CAAc,CAE/C,CAAC,EAED,KAAK,gBAAgB,iBAAiB,QAAS,IAAM,CACjD,KAAK,kBAAkB,KAAK,gBAAgB,KAAK,CACrD,CAAC,EAED,KAAK,oBAAoB,iBAAiB,QAASD,GAAS,CACxD,IAAME,EAASF,EAAM,OAAO,QAAQ,mBAAmB,EACnDE,GACA,KAAK,eAAeA,EAAO,QAAQ,IAAI,CAE/C,CAAC,CACL,CAKA,kBAAkBC,EAAW,CAGpB,KAAK,YAAY,MAAM,SACxB,KAAK,YAAY,MAAM,OAAS,GAAG,KAAK,YAAY,sBAAsB,EAAE,MAAM,MAGtF,IAAMC,EAAQ,KAAK,YAAY,SACzBC,EAAcF,EAAU,KAAK,EAAE,YAAY,EAEjD,QAAWG,KAAUF,EAAO,CACxB,IAAMG,EAAO,CAACJ,GAAaG,EAAO,YAAY,YAAY,EAAE,SAASD,CAAW,EAChFC,EAAO,MAAM,QAAUC,EAAO,KAAO,MACzC,CACJ,CAMA,oBAAoBN,EAAgB,CAChC,IAAMO,EAAWP,EAAe,QAAQ,kBAAkB,EACpD,CAAC,OAAAQ,CAAM,EAAIR,EAAe,QAE1BS,EAAiBtB,GAAYqB,CAAM,EACzCC,EAAeF,EAAU,KAAK,cAAe,KAAK,WAAW,EAE7D,KAAK,SAAS,CAClB,CAEA,UAAW,CACP,IAAMG,EAAiB,MAAM,KAAK,KAAK,cAAc,iBAAiB,WAAW,CAAC,EAClF,KAAK,MAAM,MAAQA,EAAe,IAAIC,GAAQA,EAAK,aAAa,SAAS,CAAC,EAAE,KAAK,GAAG,CACxF,CAEA,eAAeC,EAAc,CACzB,IAAMT,EAAQ,MAAM,KAAK,KAAK,cAAc,QAAQ,EAC9CU,EAAUD,IAAiB,KAAK,SAEtCT,EAAM,KAAK,CAACW,EAAOC,IAAU,CACzB,IAAMC,EAAQF,EAAM,QAAQF,CAAY,EAAE,YAAY,EAChDK,EAAQF,EAAM,QAAQH,CAAY,EAAE,YAAY,EAEtD,OAAIC,EACOI,EAAM,cAAcD,CAAK,EAG7BA,EAAM,cAAcC,CAAK,CACpC,CAAC,EAED,QAAWC,KAAQf,EACf,KAAK,cAAc,OAAOe,CAAI,EAGlC,KAAK,SAAY,KAAK,WAAaN,EAAgB,KAAOA,EAC1D,KAAK,SAAS,CAClB,CAEJ,ECvIA,SAASO,GAAWC,EAAK,CACrB,IAAMC,EAAW,CAAC,EAClB,OAAW,CAACC,EAAKC,CAAK,IAAK,OAAO,QAAQH,CAAG,EACzCC,EAASE,CAAK,EAAID,EAEtB,OAAOD,CACX,CAEO,IAAMG,GAAN,cAAwBC,CAAU,CAErC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,QAAU,KAAK,MAAM,KAAK,MAAM,MAAM,EAC3C,KAAK,cAAgBN,GAAW,KAAK,OAAO,EAE5C,KAAK,aAAe,GAEpB,KAAK,UAAY,KAAK,UAAU,KAAK,IAAI,EACzC,KAAK,oBAAsB,KAE3B,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,OAAO,iBAAiB,UAAWO,GAAS,CACxC,GAAI,CAAAA,EAAM,OAAO,QAAQ,qCAAqC,EAI9D,IAAIA,EAAM,MAAQ,IAAK,CACf,KAAK,aACL,KAAK,UAAU,EAEf,KAAK,UAAU,EAEnB,MACJ,CAEA,KAAK,oBAAoBA,CAAK,EAClC,CAAC,CACL,CAKA,oBAAoBA,EAAO,CAOvB,IAAMC,EANO,CACTD,EAAM,QAAU,OAAS,GACzBA,EAAM,QAAU,MAAQ,GACxBA,EAAM,GACV,EAEmB,OAAOE,GAAK,EAAQA,CAAE,EAAE,KAAK,KAAK,EAE/CC,EAAa,KAAK,cAAcF,CAAK,EACvCE,GACmB,KAAK,YAAYA,CAAU,GAE1CH,EAAM,eAAe,CAGjC,CAQA,YAAYI,EAAI,CACZ,IAAMC,EAAK,KAAK,UAAU,cAAc,mBAAmBD,CAAE,IAAI,EACjE,OAAKC,EAIDA,EAAG,QAAQ,yBAAyB,GACpCA,EAAG,MAAM,EACF,IAGPA,EAAG,QAAQ,WAAW,GACtBA,EAAG,MAAM,EACF,IAGPA,EAAG,QAAQ,eAAe,GAC1BA,EAAG,MAAM,EACTA,EAAG,MAAM,EACF,KAGX,QAAQ,MAAM,kFAAmFA,CAAE,EAE5F,IArBI,EAsBf,CAEA,WAAY,CACR,IAAMC,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAU,IAAI,oBAAoB,EAC1C,KAAK,UAAU,OAAOA,CAAO,EAE7B,IAAMC,EAAc,KAAK,UAAU,iBAAiB,iBAAiB,EAC/DC,EAAe,IAAI,IACzB,QAAWC,KAAcF,EAAa,CAClC,IAAMH,EAAKK,EAAW,aAAa,eAAe,EAClD,GAAID,EAAa,IAAIJ,CAAE,EACnB,SAGJ,IAAMR,EAAM,KAAK,QAAQQ,CAAE,EAC3B,KAAK,cAAcK,EAAYb,EAAKU,CAAO,EAC3CE,EAAa,IAAIJ,CAAE,CACvB,CAEA,KAAK,oBAAsB,IAAI,gBAC/B,IAAMM,EAAS,KAAK,oBAAoB,OACxC,OAAO,iBAAiB,SAAU,KAAK,UAAW,CAAC,OAAAA,CAAM,CAAC,EAC1D,OAAO,iBAAiB,QAAS,KAAK,UAAW,CAAC,OAAAA,CAAM,CAAC,EACzD,OAAO,iBAAiB,OAAQ,KAAK,UAAW,CAAC,OAAAA,CAAM,CAAC,EACxD,OAAO,iBAAiB,QAAS,KAAK,UAAW,CAAC,OAAAA,CAAM,CAAC,EAEzD,KAAK,aAAe,EACxB,CAOA,cAAcC,EAAUf,EAAKU,EAAS,CAClC,IAAMM,EAAeD,EAAS,sBAAsB,EAE9CE,EAAQ,SAAS,cAAc,KAAK,EAC1CA,EAAM,UAAU,IAAI,eAAe,EACnCA,EAAM,YAAcjB,EAEpB,IAAMkB,EAAU,SAAS,cAAc,KAAK,EAC5CA,EAAQ,UAAU,IAAI,kBAAkB,EACxCA,EAAQ,MAAM,KAAO,GAAGF,EAAa,CAAC,KACtCE,EAAQ,MAAM,IAAM,GAAGF,EAAa,CAAC,KACrCE,EAAQ,MAAM,MAAQ,GAAGF,EAAa,KAAK,KAC3CE,EAAQ,MAAM,OAAS,GAAGF,EAAa,MAAM,KAE7CN,EAAQ,OAAOO,EAAOC,CAAO,EAE7B,IAAMC,EAAcF,EAAM,sBAAsB,EAEhDA,EAAM,MAAM,iBAAmB,GAAKD,EAAa,EAAIA,EAAa,OAAUG,EAAY,MAAQ,EAAG,KACnGF,EAAM,MAAM,gBAAkB,GAAID,EAAa,GAAKA,EAAa,OAASG,EAAY,QAAU,CAAE,IACtG,CAEA,WAAY,CACQ,KAAK,UAAU,cAAc,qBAAqB,EAC1D,OAAO,EACf,KAAK,qBAAqB,MAAM,EAChC,KAAK,aAAe,EACxB,CAEJ,EC1JA,IAAMC,GAAa,CAAC,UAAW,MAAO,QAAS,OAAQ,QAAS,IAAK,IAAK,MAAO,QAAQ,EAE5EC,GAAN,cAA4BC,CAAU,CAEzC,OAAQ,CACJ,KAAK,MAAQ,KAAK,IAElB,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,KAAK,kBAAoB,KAAK,kBAAkB,KAAK,IAAI,EAEzD,KAAK,MAAM,iBAAiB,QAAS,IAAM,CACvC,KAAK,uBAAuB,CAChC,CAAC,EAED,KAAK,MAAM,iBAAiB,OAAQ,IAAM,CACtC,KAAK,sBAAsB,CAC/B,CAAC,CACL,CAEA,wBAAyB,CACrB,KAAK,MAAM,iBAAiB,UAAW,KAAK,iBAAiB,CACjE,CAKA,kBAAkBC,EAAO,CACrB,GAAIH,GAAW,SAASG,EAAM,GAAG,EAC7B,OAGJ,IAAMC,EAAO,CACTD,EAAM,QAAU,OAAS,GACzBA,EAAM,QAAU,MAAQ,GACxBA,EAAM,GACV,EAEA,KAAK,MAAM,MAAQC,EAAK,OAAOC,GAAK,EAAQA,CAAE,EAAE,KAAK,KAAK,CAC9D,CAEA,uBAAwB,CACpB,KAAK,MAAM,oBAAoB,UAAW,KAAK,iBAAiB,CACpE,CAEJ,EC3CO,IAAMC,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,eAAiB,KAAK,MAAM,eAEjC,IAAMC,EAAW,IAAIC,GAAS,KAAK,UAAW,CAC1C,OAAQ,KAAK,eACb,UAAW,IACX,OAAQ,IAAM,CACV,KAAK,MAAM,OAAQ,CAAC,IAAKD,EAAS,QAAQ,CAAC,CAAC,CAChD,EACA,QAAQE,EAAkBC,EAAQ,CAC9B,IAAMC,EAAcD,EAAO,aAAa,mBAAmB,EAC3D,GAAIC,EAAa,CACb,IAAMC,EAAgB,KAAK,MAAMD,CAAW,EAC5C,OAAW,CAACE,EAAMC,CAAO,IAAK,OAAO,QAAQF,CAAa,EACtDH,EAAiB,QAAQI,EAAMC,CAAO,CAE9C,CACJ,EACA,cAAe,GACf,WAAY,GACZ,eAAgB,EACpB,CAAC,CACL,CAEJ,EC/BO,IAAMC,GAAN,cAA6BC,CAAU,CAE1C,OAAQ,CACJ,KAAK,OAAS,KAAK,MAAM,OAEzB,KAAK,IAAI,iBAAiB,SAAUC,GAAS,CACzC,GAAI,KAAK,QAAU,CAACA,EAAM,OAAO,QAAQ,KAAK,MAAM,EAChD,OAGJ,IAAMC,EAAO,KAAK,IAAI,QAAQ,MAAM,EAChCA,GACAA,EAAK,OAAO,CAEpB,CAAC,CACL,CAEJ,ECJO,IAAMC,GAAN,cAAmBC,CAAU,CAEhC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,QAAU,KAAK,UAAU,cAAc,kBAAkB,EAC9D,KAAK,KAAO,MAAM,KAAK,KAAK,QAAQ,iBAAiB,cAAc,CAAC,EACpE,KAAK,OAAS,MAAM,KAAK,KAAK,UAAU,iBAAiB,4DAA4D,CAAC,EACtH,KAAK,YAAc,KAAK,MAAM,YAAc,OAAO,KAAK,MAAM,WAAW,EAAI,IAC7E,KAAK,OAAS,KAEd,KAAK,UAAU,iBAAiB,QAASC,GAAS,CAC9C,IAAMC,EAAMD,EAAM,OAAO,QAAQ,cAAc,EAC3CC,GAAO,KAAK,KAAK,SAASA,CAAG,GAC7B,KAAK,KAAKA,EAAI,aAAa,eAAe,CAAC,CAEnD,CAAC,EAED,OAAO,iBAAiB,SAAU,KAAK,kBAAkB,KAAK,IAAI,EAAG,CACjE,QAAS,EACb,CAAC,EACD,KAAK,kBAAkB,CAC3B,CAEA,KAAKC,EAAW,CACZ,QAAWC,KAAS,KAAK,OACrBA,EAAM,gBAAgB,SAAUA,EAAM,KAAOD,CAAS,EAG1D,QAAWD,KAAO,KAAK,KAAM,CAEzB,IAAMG,EADaH,EAAI,aAAa,eAAe,IACnBC,EAChCD,EAAI,aAAa,gBAAiBG,EAAW,OAAS,OAAO,CACjE,CAEA,KAAK,MAAM,SAAU,CAAC,QAASF,CAAS,CAAC,CAC7C,CAEA,mBAAoB,CAChB,IAAMG,EAAS,OAAO,WAAa,KAAK,YACpCA,IAAW,KAAK,SAIhBA,EACA,KAAK,SAAS,EAEd,KAAK,WAAW,EAGpB,KAAK,OAASA,EAClB,CAEA,UAAW,CACP,IAAMC,EAAc,KAAK,OAAO,KAAKC,GAAK,CAACA,EAAE,aAAa,QAAQ,CAAC,GAAK,KAAK,OAAO,CAAC,EACrF,KAAK,KAAKD,EAAY,EAAE,EACxB,KAAK,QAAQ,gBAAgB,SAAU,EAAK,CAChD,CAEA,YAAa,CACT,QAAWH,KAAS,KAAK,OACrBA,EAAM,gBAAgB,QAAQ,EAElC,QAAWF,KAAO,KAAK,KACnBA,EAAI,aAAa,gBAAiB,OAAO,EAE7C,KAAK,QAAQ,gBAAgB,SAAU,EAAI,CAC/C,CAEJ,ECrFO,IAAMO,GAAN,cAAyBC,CAAU,CAEtC,OAAQ,CACJ,KAAK,qBAAuB,KAAK,MAAM,UACvC,KAAK,UAAY,KAAK,IACtB,KAAK,YAAc,KAAK,MAAM,YAE9B,KAAK,eAAe,CACxB,CAEA,gBAAiB,CACb,KAAK,UAAU,iBAAiB,QAASC,GAAS,CAE9C,IAAMC,EAAqB,OAAO,YAAY,eAAe,KAAK,qBAAsB,iBAAiB,EACrG,CAAC,KAAK,aAAa,GAAKD,EAAM,OAAO,OACrCC,EAAmB,IAAI,CAE/B,CAAC,CACL,CAEA,cAAe,CAGX,MADmB,CAAC,GADP,KAAK,UAAU,iBAAiB,KAAK,WAAW,CAClC,EAAE,KAAKC,GAAO,CAAC,GAAGA,EAAI,iBAAiB,OAAO,CAAC,EAAE,OAAOC,GAASA,EAAM,KAAK,EAAE,SAAW,CAAC,IAC/F,MAC1B,CAEJ,ECzBO,IAAMC,GAAN,cAA8BC,CAAU,CAE3C,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,KAAO,KAAK,MAAM,KAEvB,KAAK,YAAc,KAAK,MAAM,YAC9B,KAAK,aAAe,KAAK,MAAM,aAC/B,KAAK,aAAe,KAAK,MAAM,aAE/B,KAAK,eAAe,CACxB,CAEA,gBAAiB,CAETC,EAAa,KAAK,UAAW,oBAAqB,QAAS,KAAK,0BAA0B,KAAK,IAAI,CAAC,EAGpGA,EAAa,KAAK,UAAW,gBAAiB,QAAS,KAAK,sBAAsB,KAAK,IAAI,CAAC,EAG5FA,EAAa,KAAK,UAAW,yBAA0B,QAAS,KAAK,wBAAwB,KAAK,IAAI,CAAC,EAGvGA,EAAa,KAAK,UAAW,iBAAkB,YAAa,KAAK,4BAA4B,KAAK,IAAI,CAAC,EAG3G,KAAK,YAAY,iBAAiB,WAAYC,GAAS,CAC/CA,EAAM,MAAQ,UACdA,EAAM,eAAe,EACrB,KAAK,cAAc,EAE3B,CAAC,EAGD,KAAK,aAAa,iBAAiB,QAAS,IAAM,KAAK,cAAc,CAAC,EAGtE,KAAK,aAAa,iBAAiB,QAAS,IAAM,CAC9C,KAAK,YAAY,MAAQ,GACzB,KAAK,cAAc,CACvB,CAAC,CACL,CAEA,wBAAwBA,EAAOC,EAAc,CACzC,IAAMC,EAAaD,EAAa,QAAQ,eAAe,EAAE,aAAa,aAAa,EACnF,KAAK,eAAeC,EAAY,SAAS,CAC7C,CAEA,4BAA4BF,EAAOC,EAAc,CAC7C,IAAMC,EAAaD,EAAa,QAAQ,eAAe,EAAE,aAAa,aAAa,EACnFD,EAAM,aAAa,QAAQ,qBAAsBE,CAAU,EAC3DF,EAAM,aAAa,QAAQ,aAAcE,CAAU,CACvD,CAEA,0BAA0BF,EAAOG,EAAc,CAC3CH,EAAM,gBAAgB,EAEtB,IAAMI,EAASD,EAAa,aAAa,iBAAiB,EACpDD,EAAaC,EAAa,QAAQ,eAAe,EAAE,aAAa,aAAa,EACnF,KAAK,eAAeD,EAAYE,CAAM,CAC1C,CAEA,MAAM,eAAeF,EAAYE,EAAS,UAAW,CACjD,IAAMC,EAAO,MAAM,OAAO,MAAM,IAAI,cAAcH,CAAU,EAAE,EACxDI,EAAY,WAAWF,CAAM,GACnC,OAAO,QAAQ,KAAKE,EAAWD,EAAK,IAAI,CAC5C,CAEA,MAAM,sBAAsBL,EAAOO,EAAgB,CAC/CP,EAAM,eAAe,EACrB,IAAMQ,EAAgBD,EAAe,aAAa,MAAM,EAClDF,EAAO,MAAM,OAAO,MAAM,IAAIG,CAAa,EACjD,KAAK,KAAK,UAAYH,EAAK,IAC/B,CAEA,MAAM,eAAgB,CAClB,IAAMI,EAAa,KAAK,YAAY,MAC9BJ,EAAO,MAAM,OAAO,MAAM,IAAI,aAAc,CAC9C,OAAQI,CACZ,CAAC,EACD,KAAK,aAAa,MAAM,QAAUA,EAAa,QAAU,OACzD,KAAK,KAAK,UAAYJ,EAAK,IAC/B,CAEJ,ECtFO,IAAMK,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CACJ,KAAK,MAAQ,KAAK,IAAI,cAAc,oBAAoB,EACxD,KAAK,SAAW,KAAK,IAAI,cAAc,sBAAsB,EAE7D,KAAK,SAAS,iBAAiB,SAAU,KAAK,YAAY,KAAK,IAAI,CAAC,CACxE,CAEA,aAAc,CACV,KAAK,MAAM,MAAS,KAAK,SAAS,QAAU,OAAS,QAIrD,IAAMC,EAAc,IAAI,MAAM,QAAQ,EACtC,KAAK,MAAM,cAAcA,CAAW,CACxC,CAEJ,EClBO,IAAMC,GAAN,cAAwBC,CAAU,CAErC,OAAQ,CACJ,KAAK,UAAY,KAAK,MAAM,UAC5B,KAAK,KAAO,KAAK,UAAU,IAE3B,KAAK,eAAiB,OACtB,KAAK,UAAY,KACjB,KAAK,YAAc,CACf,QAAS,EACT,KAAM,CACV,EACA,KAAK,aAAe,UAGpB,KAAK,eAAiB,KAAK,eAAe,KAAK,IAAI,EAGnD,KAAK,aAAa,EAClB,OAAO,iBAAiB,SAAU,IAAM,CACpC,KAAK,aAAa,CACtB,EAAG,CAAC,QAAS,EAAI,CAAC,CACtB,CAEA,cAAe,CACX,IAAIC,EAAY,SACZ,OAAO,YAAc,MAAMA,EAAY,UACvC,OAAO,YAAc,OAAMA,EAAY,WACvCA,IAAc,KAAK,iBAEnB,KAAK,YACL,KAAK,UAAU,EACf,KAAK,UAAY,MAGjBA,IAAc,UACd,KAAK,aAAa,EACXA,IAAc,UACrB,KAAK,YAAY,EAGrB,KAAK,eAAiBA,EAC1B,CAEA,aAAc,CACV,QAAWC,KAAO,KAAK,KACnBA,EAAI,iBAAiB,QAAS,KAAK,cAAc,EAGrD,KAAK,UAAY,IAAM,CACnB,QAAWA,KAAO,KAAK,KACnBA,EAAI,oBAAoB,QAAS,KAAK,cAAc,CAE5D,CACJ,CAEA,cAAe,CAEf,CAMA,eAAeC,EAAO,CAClB,GAAM,CAAC,IAAAD,CAAG,EAAIC,EAAM,OAAO,QAC3B,KAAK,QAAQD,CAAG,CACpB,CAMA,aAAc,CACV,KAAK,QAAQ,UAAW,EAAK,CACjC,CAOA,QAAQE,EAASC,EAAS,GAAM,CAC5B,KAAK,YAAY,KAAK,YAAY,EAAI,SAAS,gBAAgB,UAG/D,QAAWH,KAAO,KAAK,KAAM,CACzB,IAAMI,EAAYJ,EAAI,QAAQ,MAAQE,EACtCF,EAAI,aAAa,gBAAiBI,EAAW,OAAS,OAAO,CACjE,CAGA,IAAMC,EAAYH,IAAY,OAI9B,GAHA,KAAK,UAAU,UAAU,OAAO,YAAaG,CAAQ,EAGjDF,EAAQ,CAER,IAAMG,EADa,SAAS,cAAc,QAAQ,EACd,sBAAsB,EAAE,OAC5D,SAAS,gBAAgB,UAAY,KAAK,YAAYJ,CAAO,GAAKI,EAClE,WAAW,IAAM,CACb,SAAS,gBAAgB,UAAY,KAAK,YAAYJ,CAAO,GAAKI,CACtE,EAAG,EAAE,CACT,CAEA,KAAK,aAAeJ,CACxB,CAEJ,EC3GO,IAAMK,GAAN,cAAyBC,CAAU,CAEtC,OAAQ,CACJ,KAAK,UAAY,KAAK,IACtB,KAAK,MAAQ,KAAK,MAAM,MACxB,KAAK,kBAAoB,KAAK,MAAM,SAEpCC,EAAa,KAAK,UAAW,yBAA0B,QAAS,KAAK,WAAW,KAAK,IAAI,CAAC,CAC9F,CAEA,WAAWC,EAAOC,EAAQ,CACtBD,EAAM,eAAe,EACrB,KAAK,MAAM,MAAQC,EAAO,aAAa,SAAS,EAChD,KAAK,kBAAkB,UAAYA,EAAO,UAC1C,KAAK,MAAM,cAAc,IAAI,MAAM,SAAU,CAAC,QAAS,EAAI,CAAC,CAAC,EAC7D,KAAK,KAAK,CACd,CAEA,MAAO,CAEc,OAAO,YAAY,eAAe,KAAK,UAAW,UAAU,EACpE,KAAK,CAClB,CAEJ,ECrBO,IAAMC,GAAN,cAA4BC,CAAU,CAEzC,OAAQ,CACJ,KAAK,WAAa,KAAK,IAAI,iBAAiB,wBAAwB,EACpE,KAAK,YAAc,KAAK,IAAI,cAAc,qCAAqC,EAE/E,KAAK,IAAI,iBAAiB,SAAUC,GAAS,CACrCA,EAAM,OAAO,SAAWA,EAAM,SAAW,KAAK,YAC9C,KAAK,yBAAyB,EACvBA,EAAM,OAAO,UACpB,KAAK,YAAY,QAAU,GAEnC,CAAC,CACL,CAEA,0BAA2B,CACvB,QAAWC,KAAY,KAAK,WACpBA,IAAa,KAAK,cAClBA,EAAS,QAAU,GAG/B,CAEJ,EC1BO,IAAMC,GAAN,cAA4BC,CAAU,CAEzC,OAAQ,CACJ,KAAK,KAAO,KAAK,IAEjB,KAAK,cAAgBC,GAAkB,CACnC,SAAU,KAAK,MAAM,SACrB,iBAAkB,KAAK,KACvB,SAAU,SAAS,gBAAgB,UAAU,SAAS,WAAW,EACjE,cAAe,KAAK,MAAM,cAC1B,UAAW,KAAK,aAAa,EAC7B,OAAQ,OAAO,KAAK,MAAM,MAAM,EAChC,aAAc,CACV,qBAAsB,KAAK,MAAM,qBACjC,sBAAuB,KAAK,MAAM,qBACtC,EACA,eAAgB,OAAO,mBAC3B,CAAC,EAED,OAAO,QAAQ,WAAW,KAAK,KAAM,2BAA4B,CAAC,OAAQ,KAAK,aAAa,CAAC,EAC7F,OAAO,QAAQ,KAAK,KAAK,aAAa,EAAE,KAAKC,GAAW,CACpD,KAAK,OAASA,EAAQ,CAAC,CAC3B,CAAC,CACL,CAEA,cAAe,CACX,IAAMC,EAAgB,SAAS,cAAc,cAAc,EAC3D,OAAIA,EACOA,EAAc,aAAa,YAAY,EAE3C,EACX,CAOA,YAAa,CACT,MAAO,CACH,KAAM,KAAK,OAAO,WAAW,CACjC,CACJ,CAEJ,EC5CO,IAAMC,GAAN,cAA2BC,CAAU,CAExC,OAAQ,CACJ,KAAK,KAAO,KAAK,IAEjB,IAAMC,EAASC,GAAc,CACzB,SAAU,KAAK,MAAM,SACrB,iBAAkB,KAAK,KACvB,SAAU,SAAS,gBAAgB,UAAU,SAAS,WAAW,EACjE,cAAe,KAAK,MAAM,cAC1B,aAAc,CAAC,EACf,eAAgB,OAAO,mBAC3B,CAAC,EAED,OAAO,QAAQ,KAAKD,CAAM,EAAE,KAAKE,GAAW,CACxC,KAAK,OAASA,EAAQ,CAAC,CAC3B,CAAC,CACL,CAEJ,ECdA,OAAO,QAAU,SAAiBC,EAAM,CACpC,IAAIC,EAAaD,EACbE,EAAW,SAAS,cAAc,uBAAuB,EAAE,aAAa,SAAS,EACrF,OAAIA,EAASA,EAAS,OAAS,CAAC,IAAM,MAAKA,EAAWA,EAAS,MAAM,EAAGA,EAAS,OAAS,CAAC,GACvFD,EAAW,CAAC,IAAM,MAAKA,EAAaA,EAAW,MAAM,CAAC,GACnD,GAAGC,CAAQ,IAAID,CAAU,EACpC,EAEA,OAAO,gBAAkB,SAAyBE,EAAY,CAC1D,IAAMC,EAAU,SAAS,cAAc,yCAAyC,EAAE,KAAK,MAAM,WAAW,EAAE,IAAI,EAE9G,OAAO,OADY,OAAO,QAAQ,QAAQD,CAAU,eAAeC,CAAO,EAAE,EAEhF,EAGA,OAAO,MAAQC,GACf,OAAO,QAAUC,GAIjB,IAAMC,GAAa,IAAIC,GACvB,OAAO,MAAQD,GAAW,IAAI,KAAKA,EAAU,EAC7C,OAAO,aAAeA,GAAW,UAAU,KAAKA,EAAU,EAC1D,OAAO,aAAeA,GAAW,YAAY,KAAKA,EAAU,EAGjDE,GAASC,EAAY,EAChC,OAAO,YAAcA,GACVC,GAAK",
  "names": ["events_exports", "__export", "emit", "emitPublic", "error", "listen", "showResponseError", "showValidationErrors", "success", "listeners", "stack", "eventName", "eventData", "listenersToRun", "listener", "callback", "targetElement", "event", "message", "responseErr", "http_exports", "__export", "HttpError", "createXMLHttpRequest", "performDelete", "get", "patch", "post", "put", "getResponseContent", "response", "subType", "content", "method", "url", "events", "csrfToken", "req", "eventName", "callback", "request", "options", "requestUrl", "urlObj", "paramName", "value", "requestOptions", "returnData", "dataRequest", "data", "params", "Translator", "translationMetaTags", "tag", "key", "value", "replacements", "text", "count", "translation", "splitText", "exactCountRegex", "rangeRegex", "result", "t", "exactMatches", "rangeMatches", "string", "replaceMatches", "updatedString", "match", "translations_default", "components_exports", "__export", "first", "firstOnElement", "get", "init", "register", "kebabToCamel", "kebab", "ucFirst", "word", "words", "camelToKebab", "camelStr", "str", "offset", "components", "componentModelMap", "elementComponentMap", "parseRefs", "name", "element", "refs", "manyRefs", "prefix", "selector", "refElems", "el", "refNames", "str", "kebabToCamel", "ref", "parseOpts", "componentName", "opts", "value", "optName", "initComponent", "ComponentModel", "instance", "allRefs", "e", "elComponents", "init", "parentElement", "componentElems", "componentNames", "register", "mapping", "keys", "key", "camelToKebab", "first", "get", "firstOnElement", "components_exports", "__export", "AddRemoveRows", "AjaxDeleteRow", "AjaxForm", "Attachments", "AttachmentsList", "AutoSubmit", "AutoSuggest", "BackToTop", "BookSort", "ChapterContents", "CodeEditor", "CodeHighlighter", "CodeTextarea", "Collapsible", "ConfirmDialog", "CustomCheckbox", "DetailsHighlighter", "Dropdown", "DropdownSearch", "Dropzone", "EditorToolbox", "EntityPermissions", "EntitySearch", "EntitySelector", "EntitySelectorPopup", "EventEmitSelect", "ExpandToggle", "GlobalSearch", "HeaderMobileToggle", "ImageManager", "ImagePicker", "ListSortControl", "MarkdownEditor", "NewUserPassword", "Notification", "OptionalInput", "PageComment", "PageComments", "PageDisplay", "PageEditor", "PagePicker", "PermissionsTable", "Pointer", "Popup", "SettingAppColorScheme", "SettingColorPicker", "SettingHomepageControl", "ShelfSort", "ShortcutInput", "Shortcuts", "SortableList", "SubmitOnChange", "Tabs", "TagManager", "TemplateManager", "ToggleSwitch", "TriLayout", "UserSelect", "WebhookEvents", "WysiwygEditor", "WysiwygInput", "elem", "tagName", "attrs", "children", "el", "key", "val", "child", "forEach", "selector", "callback", "elements", "element", "onEvents", "listenerElement", "events", "eventName", "onSelect", "event", "onKeyPress", "listener", "e", "onEnterPress", "onEscapePress", "onChildEvent", "childSelector", "matchingChild", "findText", "text", "showLoading", "getLoading", "wrap", "removeLoading", "loadingEls", "htmlToDom", "html", "debounce", "func", "waitMs", "immediate", "timeout", "args", "context", "later", "callNow", "scrollAndHighlightElement", "element", "parent", "highlight", "listener", "escapeHtml", "unsafe", "uniqueId", "S4", "wait", "timeMs", "res", "Component", "__publicField", "eventName", "data", "componentName", "event", "AddRemoveRows", "Component", "onChildEvent", "e", "clone", "rowId", "uniqueId", "randRowIdElems", "elem", "AjaxDeleteRow", "Component", "onSelect", "resp", "AjaxForm", "Component", "onEnterPress", "event", "button", "onSelect", "fd", "inputs", "input", "formData", "resp", "err", "Attachments", "Component", "reloadListBound", "event", "insertContent", "contentTypes", "section", "sectionMap", "name", "elem", "resp", "idOrder", "id", "showLoading", "AttachmentsList", "Component", "isExpectedKey", "event", "link", "_keydownHandler", "keydownHandler_fn", "_getFocusable", "getFocusable_fn", "KeyboardNavigationHandler", "container", "onEscape", "onEnter", "__privateAdd", "__privateMethod", "element", "focusable", "newIndex", "event", "selector", "ajaxCache", "AutoSuggest", "Component", "KeyboardNavigationHandler", "event", "selectionValue", "onChildEvent", "el", "value", "nameFilter", "search", "toShow", "val", "params", "cacheKey", "resp", "suggestions", "escapeHtml", "button", "AutoSubmit", "Component", "BackToTop", "Component", "scrollTopPos", "targetTop", "scrollElem", "duration", "start", "scrollStart", "setPos", "percentComplete", "target", "ownKeys", "object", "enumerableOnly", "keys", "symbols", "sym", "_objectSpread2", "target", "i", "source", "key", "_defineProperty", "_typeof", "obj", "value", "_extends", "_objectWithoutPropertiesLoose", "excluded", "sourceKeys", "_objectWithoutProperties", "sourceSymbolKeys", "_toConsumableArray", "arr", "_arrayWithoutHoles", "_iterableToArray", "_unsupportedIterableToArray", "_nonIterableSpread", "_arrayLikeToArray", "iter", "o", "minLen", "n", "len", "arr2", "version", "userAgent", "pattern", "IE11OrLess", "Edge", "FireFox", "Safari", "IOS", "ChromeForAndroid", "captureMode", "on", "el", "event", "fn", "off", "matches", "selector", "getParentOrHost", "closest", "ctx", "includeCTX", "R_SPACE", "toggleClass", "name", "state", "className", "css", "prop", "val", "style", "matrix", "selfOnly", "appliedTransforms", "transform", "matrixFn", "find", "tagName", "iterator", "list", "getWindowScrollingElement", "scrollingElement", "getRect", "relativeToContainingBlock", "relativeToNonStaticParent", "undoScale", "container", "elRect", "top", "left", "bottom", "right", "height", "width", "containerRect", "elMatrix", "scaleX", "scaleY", "isScrolledPast", "elSide", "parentSide", "parent", "getParentAutoScrollElement", "elSideVal", "parentSideVal", "visible", "getChild", "childNum", "options", "includeDragEl", "currentChild", "children", "Sortable", "lastChild", "last", "index", "getRelativeScrollOffset", "offsetLeft", "offsetTop", "winScroller", "indexOfObject", "includeSelf", "elem", "gotSelf", "elemCSS", "extend", "dst", "src", "isRectEqual", "rect1", "rect2", "_throttleTimeout", "throttle", "callback", "ms", "args", "_this", "cancelThrottle", "scrollBy", "x", "y", "clone", "Polymer", "$", "setRect", "rect", "unsetRect", "getChildContainingRectFromElement", "ghostEl", "child", "_rect$left", "_rect$top", "_rect$right", "_rect$bottom", "childRect", "expando", "AnimationStateManager", "animationStates", "animationCallbackId", "fromRect", "childMatrix", "animating", "animationTime", "time", "toRect", "prevFromRect", "prevToRect", "animatingRect", "targetMatrix", "calculateRealTime", "currentRect", "duration", "translateX", "translateY", "repaint", "plugins", "defaults", "PluginManager", "plugin", "option", "p", "eventName", "sortable", "evt", "eventNameGlobal", "pluginName", "initialized", "modified", "eventProperties", "modifiedValue", "dispatchEvent", "_ref", "rootEl", "targetEl", "cloneEl", "toEl", "fromEl", "oldIndex", "newIndex", "oldDraggableIndex", "newDraggableIndex", "originalEvent", "putSortable", "extraEventProperties", "onName", "allEventProperties", "_excluded", "pluginEvent", "data", "dragEl", "parentEl", "nextEl", "lastDownEl", "cloneHidden", "moved", "_hideGhostForTarget", "_unhideGhostForTarget", "_dispatchEvent", "info", "activeGroup", "awaitingDragStarted", "ignoreNextClick", "sortables", "tapEvt", "touchEvt", "lastDx", "lastDy", "tapDistanceLeft", "tapDistanceTop", "lastTarget", "lastDirection", "pastFirstInvertThresh", "isCircumstantialInvert", "targetMoveDistance", "ghostRelativeParent", "ghostRelativeParentInitialScroll", "_silent", "savedInputChecked", "documentExists", "PositionGhostAbsolutely", "CSSFloatProperty", "supportDraggable", "supportCssPointerEvents", "_detectDirection", "elCSS", "elWidth", "child1", "child2", "firstChildCSS", "secondChildCSS", "firstChildWidth", "secondChildWidth", "touchingSideChild2", "_dragElInRowColumn", "dragRect", "targetRect", "vertical", "dragElS1Opp", "dragElS2Opp", "dragElOppLength", "targetS1Opp", "targetS2Opp", "targetOppLength", "_detectNearestEmptySortable", "ret", "threshold", "insideHorizontally", "insideVertically", "_prepareGroup", "toFn", "pull", "to", "from", "sameGroup", "otherGroup", "group", "originalGroup", "nearestEmptyInsertDetectEvent", "nearest", "_checkOutsideTargetEl", "dataTransfer", "preventOnFilter", "type", "touch", "originalTarget", "filter", "_saveInputCheckedState", "criteria", "ownerDocument", "dragStartFn", "_disableDraggable", "e", "_nextTick", "fallback", "inserted", "fallbackTolerance", "fallbackOffset", "ghostMatrix", "relativeScrollOffset", "dx", "dy", "cssMatrix", "revert", "activeSortable", "isOwner", "canSort", "fromSortable", "completedFired", "dragOverEvent", "extra", "completed", "after", "_onMove", "changed", "capture", "insertion", "elLastChild", "_ghostIsLast", "_ghostIsFirst", "firstChild", "direction", "targetBeforeFirstSwap", "differentLevel", "differentRowCol", "side1", "scrolledPastTop", "scrollBefore", "_getSwapDirection", "sibling", "dragIndex", "nextSibling", "moveVector", "_unsilent", "_cancelNextTick", "_globalDragOver", "order", "_generateId", "useAnimation", "items", "id", "store", "willInsertAfter", "onMoveFn", "retVal", "firstElRect", "childContainingRect", "spacer", "lastElRect", "swapThreshold", "invertedSwapThreshold", "invertSwap", "isLastTarget", "mouseOnAxis", "targetLength", "targetS1", "targetS2", "invert", "_getInsertDirection", "str", "sum", "root", "inputs", "idx", "element", "_len", "_key", "autoScrolls", "scrollEl", "scrollRootEl", "scrolling", "lastAutoScrollX", "lastAutoScrollY", "touchEvt$1", "pointerElemChangedInterval", "AutoScrollPlugin", "AutoScroll", "_ref2", "clearPointerElemChangedInterval", "clearAutoScrolls", "autoScroll", "ogElemScroller", "newElem", "isFallback", "sens", "speed", "scrollThisInstance", "scrollCustomFn", "layersOut", "currentParent", "canScrollX", "canScrollY", "scrollWidth", "scrollHeight", "scrollPosX", "scrollPosY", "vx", "vy", "scrollOffsetY", "scrollOffsetX", "drop", "dispatchSortableEvent", "hideGhostForTarget", "unhideGhostForTarget", "toSortable", "Revert", "_ref3", "Remove", "_ref4", "parentSortable", "multiDragElements", "multiDragClones", "lastMultiDragSelect", "multiDragSortable", "initialFolding", "folding", "dragStarted", "dragEl$1", "clonesFromRect", "clonesHidden", "MultiDragPlugin", "MultiDrag", "sortable", "fn", "on", "dataTransfer", "dragEl", "data", "multiDragElement", "i", "_ref", "dragged", "_ref2", "cancel", "clone", "toggleClass", "_ref3", "rootEl", "dispatchSortableEvent", "insertMultiDragClones", "_ref4", "cloneNowShown", "css", "_ref5", "_this", "cloneNowHidden", "_ref6", "index", "a", "b", "_ref7", "_this2", "dragRect", "getRect", "setRect", "unsetRect", "removeMultiDragElements", "_ref8", "target", "completed", "_ref9", "fromSortable", "insertMultiDragElements", "_ref10", "isOwner", "insertion", "activeSortable", "parentEl", "putSortable", "options", "dragRectAbsolute", "clonesHiddenBefore", "_ref11", "_extends", "dragMatrix", "matrix", "_ref12", "evt", "oldIndex", "toSortable", "children", "dispatchEvent", "lastIndex", "currentIndex", "n", "expando", "multiDragIndex", "rect", "update", "off", "closest", "el", "_this3", "oldIndicies", "newIndicies", "newIndex", "_toConsumableArray", "key", "clonesInserted", "elementsInserted", "Sortable", "AutoScrollPlugin", "Remove", "Revert", "sortable_esm_default", "sortOperations", "a", "b", "aName", "bName", "aTime", "aType", "bType", "moveActions", "elem", "parent", "book", "topLevel", "topItems", "index", "item", "BookSort", "Component", "sortable_esm_default", "MultiDragPlugin", "initialSortBox", "event", "action", "sortItem", "lastSort", "reverse", "reversibleTypes", "sortButton", "sortLists", "sort", "sortFunction", "list", "child", "sortedItem", "entityInfo", "entitySortItemUrl", "resp", "newBookContainer", "htmlToDom", "bookContainer", "sortElems", "bookGroupConfig", "chapterGroupConfig", "toList", "fromList", "draggedElem", "sortElem", "nestedChapters", "chapter", "pageMap", "entityMap", "lists", "bookId", "directChildren", "i", "childElem", "type", "parentChapter", "childId", "subPages", "parentItem", "parentBook", "functions", "moveButton", "items", "animateStylesCleanupMap", "animateStyles", "element", "styles", "animTime", "onComplete", "styleNames", "style", "cleanup", "cleanupExistingElementAnimation", "fadeIn", "fadeOut", "slideUp", "currentHeight", "computedStyles", "currentPaddingTop", "currentPaddingBottom", "animStyles", "slideDown", "targetHeight", "targetPaddingTop", "targetPaddingBottom", "transitionHeight", "startHeight", "initialComputedStyles", "startPaddingTop", "startPaddingBottom", "ChapterContents", "Component", "slideDown", "slideUp", "event", "CodeEditor", "Component", "__publicField", "event", "onSelect", "language", "onEnterPress", "onChildEvent", "elem", "historyTime", "button", "isFavorite", "sortedParents", "a", "b", "aFav", "bFav", "parent", "code", "saveCallback", "cancelCallback", "Code", "inputLang", "link", "lang", "isMatch", "historyKeys", "key", "localTime", "lastHistoryKey", "historyString", "CodeHighlighter", "Component", "container", "Code", "CodeTextarea", "Component", "mode", "Collapsible", "Component", "slideDown", "slideUp", "ConfirmDialog", "Component", "onSelect", "res", "result", "CustomCheckbox", "Component", "event", "checked", "DetailsHighlighter", "Component", "Code", "Dropdown", "Component", "event", "menuOriginalRect", "heightOffset", "toggleHeight", "dropUpwards", "containerRect", "maxHeight", "clickEvent", "input", "showEvent", "dropdown", "keyboardNavHandler", "KeyboardNavigationHandler", "onSelect", "DropdownSearch", "Component", "debounce", "input", "searchTerm", "listItems", "listItem", "match", "resp", "animate", "transitionHeight", "err", "joiner", "show", "Clipboard", "clipboardData", "rtfData", "types", "images", "type", "item", "imageFiles", "f", "files", "copyTextToClipboard", "text", "tempInput", "Dropzone", "Component", "active", "onSelect", "depth", "reset", "event", "files", "Clipboard", "file", "input", "elem", "zoneElem", "overlay", "dom", "status", "progress", "dismiss", "component", "upload", "percentComplete", "message", "removeLoading", "formData", "req", "content", "data", "evt", "percent", "image", "imageWrap", "getLoading", "EditorToolbox", "Component", "event", "button", "name", "isOpen", "tabName", "openToolbox", "contentEl", "EntityPermissions", "Component", "event", "inherit", "permissions", "permission", "button", "roleId", "option", "resp", "row", "htmlToDom", "roleName", "EntitySearch", "Component", "e", "onSelect", "term", "url", "resp", "EntitySelector", "Component", "options", "lastSearch", "event", "onChildEvent", "form", "forward", "items", "selectedIndex", "newItem", "resp", "query", "searchTerm", "url", "now", "answer", "listItem", "item", "isDblClick", "type", "id", "isSelected", "link", "name", "data", "selected", "selectedElem", "EntitySelectorPopup", "Component", "callback", "searchOptions", "entity", "EventEmitSelect", "Component", "onSelect", "ExpandToggle", "Component", "elemToToggle", "slideDown", "slideUp", "event", "matchingElems", "match", "isOpen", "GlobalSearch", "Component", "updateSuggestionsDebounced", "debounce", "value", "KeyboardNavigationHandler", "search", "results", "resultDom", "htmlToDom", "HeaderMobileToggle", "Component", "event", "ImageManager", "Component", "onSelect", "e", "event", "onChildEvent", "_", "button", "scrollZone", "scrollEvents", "secondAgo", "d", "callback", "type", "hideUploads", "params", "html", "removeLoading", "el", "loadMore", "child", "filterName", "tab", "selected", "showLoading", "image", "isDblClick", "alreadySelected", "imageId", "requestDelete", "formHtml", "imageDataEl", "response", "err", "ImagePicker", "Component", "file", "ListSortControl", "Component", "event", "sortOption", "currentDir", "MarkdownEditor", "Component", "settingContainer", "settingInputs", "markdown", "editor", "event", "button", "action", "toolbarLabel", "currentActiveSections", "activeElem", "wrapRect", "moveListener", "xRel", "xPct", "upListener", "widthSetting", "scrollText", "drawioAttrEl", "NewUserPassword", "Component", "inviting", "passwordBoxes", "input", "Notification", "Component", "text", "textToShow", "words", "timeToShow", "OptionalInput", "Component", "onSelect", "register", "editor", "i", "selectedNode", "callout", "formats", "newFormatIndex", "format", "newFormat", "selectorPopup", "selectionText", "entity", "listen", "editor", "html", "content", "scrollToText", "editor", "scrollId", "element", "scrollToQueryString", "wrap", "draggedContentEditable", "hasTextContent", "node", "uploadImageFile", "file", "pageId", "remoteFilename", "formData", "paste", "editor", "options", "event", "clipboard", "Clipboard", "images", "imageFile", "id", "loadingImage", "resp", "safeName", "newImageHtml", "newEl", "err", "dragStart", "drop", "dom", "rng", "templateId", "selectedNode", "range", "selectedNodeRoot", "listenForDragAndPaste", "getPrimaryToolbar", "options", "row", "registerPrimaryToolbarGroups", "editor", "registerLinkContextToolbar", "node", "registerImageContextToolbar", "registerAdditionalToolbars", "icons", "registerCustomIcons", "editor", "name", "svg", "setupBrFilter", "editor", "nodes", "node", "newline", "setupPointerFilter", "id", "nodeClass", "setupFilters", "elemIsCodeBlock", "elem", "showPopup", "editor", "code", "language", "callback", "codeEditor", "bookMark", "newCode", "newLang", "showPopupForCodeBlock", "codeBlock", "defineCodeBlockCustomElement", "doc", "win", "CodeBlockElement", "__publicField", "stylesToCopy", "copiedStyles", "styleEl", "cmContainer", "getLanguageFromClassList", "classes", "cssClass", "pre", "content", "tempEl", "brs", "br", "connectedTime", "height", "container", "renderEditor", "Code", "timeout", "preChild", "register", "selectedNode", "textContent", "elms", "el", "wrapper", "direction", "spans", "span", "node", "getPlugin", "promisifyRequest", "request", "resolve", "reject", "createStore", "dbName", "storeName", "dbp", "txMode", "callback", "db", "defaultGetStoreFunc", "defaultGetStore", "get", "key", "customStore", "store", "set", "value", "del", "key", "customStore", "defaultGetStore", "store", "promisifyRequest", "iFrame", "lastApprovedOrigin", "onInit", "onSave", "saveBackupKey", "drawPostMessage", "data", "drawEventExport", "message", "set", "del", "drawEventSave", "drawEventInit", "xml", "drawEventConfigure", "config", "drawEventClose", "drawReceive", "event", "attemptRestoreIfExists", "backupVal", "get", "dialogEl", "show", "drawioUrl", "onInitCallback", "onSaveCallback", "upload", "imageData", "pageUploadedToId", "close", "load", "drawingId", "error", "pageEditor", "currentNode", "options", "isDrawing", "node", "showDrawingManager", "mceEditor", "selectedNode", "image", "imgElem", "imgHTML", "updateContent", "pngData", "loadingImage", "handleUploadError", "error", "close", "img", "upload", "err", "wait", "id", "wrapId", "drawingInit", "drawingId", "load", "showDrawingEditor", "show", "register", "editor", "callback", "api", "value", "drawings", "drawing", "getPlugin", "providedOptions", "register", "editor", "hrElem", "cNode", "parentNode", "getPlugin", "register", "editor", "image", "imageUrl", "html", "getPlugin", "register", "editor", "aboutDialog", "getPlugin", "blockElementTypes", "getSelectedDetailsBlock", "editor", "setSummary", "summaryContent", "details", "summary", "detailsDialog", "api", "getSummaryTextFromDetails", "element", "showDetailLabelEditWindow", "unwrapDetailsInSelection", "selectionBm", "elements", "unwrapDetailsEditable", "detailsEl", "madeUnwrap", "child", "ensureDetailsWrappedInEditable", "rootWrap", "previousBlockWrap", "blockElementTypes", "setupElementFilters", "elms", "el", "register", "event", "content", "id", "domDetails", "firstChild", "node", "getPlugin", "register", "editor", "tableFirstRowContextSpec", "elem", "isTable", "selectionNode", "parentTable", "table", "attrsToRemove", "styled", "a", "attr", "targets", "onPreInit", "exitingButtons", "callback", "getPlugin", "elementWithinTaskList", "element", "listEl", "handleTaskListItemClick", "event", "clickedEl", "editor", "bounds", "parseTaskListNode", "node", "child", "serializeTaskListNode", "isChecked", "inputAttrs", "checkbox", "register", "api", "parentListEl", "el", "inList", "existingBullListButton", "parentList", "inTaskList", "inUlList", "existingNumListButton", "nodes", "getPlugin", "handleEmbedAlignmentChanges", "editor", "updateClassesForPreview", "previewElem", "mediaTarget", "alignmentClasses", "c", "previewAlignClasses", "previewElems", "event", "isAlignment", "realTarget", "className", "toAdd", "wrapperClassesFiltered", "classesToApply", "cleanElementDirection", "element", "directionChildren", "child", "handleTableCellRangeEvents", "selectedCells", "cell", "attrsToRemove", "attr", "command", "dir", "handleTextDirectionCleaning", "blocks", "block", "styleFormats", "formats", "colorMap", "filePickerCallback", "callback", "value", "meta", "selector", "selectionText", "entity", "image", "gatherPlugins", "options", "plugins", "getPlugin", "plugin", "addCustomHeadContent", "editorDoc", "headContentLines", "startLineIndex", "line", "endLineIndex", "customHeadHtml", "el", "getSetupCallback", "editor", "editorChange", "listen", "listenForDragAndPaste", "scrollToQueryString", "register", "setupFilters", "handleEmbedAlignmentChanges", "handleTableCellRangeEvents", "handleTextDirectionCleaning", "getContentStyle", "buildForEditor", "getPrimaryToolbar", "args", "content", "registerCustomIcons", "registerAdditionalToolbars", "buildForInput", "version", "PageComment", "Component", "show", "config", "buildForInput", "editors", "event", "loading", "reqData", "resp", "newComment", "htmlToDom", "err", "getLoading", "PageComments", "Component", "event", "loading", "getLoading", "reqData", "resp", "newElem", "htmlToDom", "err", "count", "config", "buildForInput", "editors", "commentLocalId", "commentElement", "toggleAnchorHighlighting", "elementId", "shouldHighlight", "forEach", "anchor", "headingVisibilityChange", "entries", "entry", "isVisible", "addNavObserver", "headings", "intersectOpts", "pageNavObserver", "heading", "PageDisplay", "Component", "Code", "text", "sidebarPageNav", "onChildEvent", "event", "child", "contentId", "idElem", "elem", "scrollAndHighlightElement", "textElem", "findText", "pageNav", "utcTimeStampToLocalTime", "timestamp", "date", "hours", "mins", "PageEditor", "Component", "onContentChange", "updateChangelogDebounced", "debounce", "onSelect", "data", "editorContent", "didSave", "resp", "utcTimeStampToLocalTime", "saveKey", "lsErr", "text", "notify", "response", "e", "discard", "draftDelete", "err", "summary", "event", "link", "dialog", "saved", "confirmed", "toggleElem", "elem", "show", "PagePicker", "Component", "e", "entity", "value", "name", "hasValue", "id", "PermissionsTable", "Component", "toggleAllElem", "toggleRowElem", "toggleColElem", "event", "tableCell", "colIndex", "tableRows", "inputsToToggle", "row", "targetCell", "domElem", "currentState", "checkbox", "Pointer", "Component", "copyTextToClipboard", "onSelect", "event", "onEvents", "onEscapePress", "pageContent", "targetEl", "section", "show", "b", "element", "xPosition", "keyboardMode", "targetBounds", "pointerBounds", "xOffset", "yOffset", "scrollListener", "permaLink", "includeTag", "editAnchor", "editHref", "elementId", "queryContent", "sections", "onEnterPress", "Popup", "Component", "lastMouseDownTarget", "event", "onSelect", "onComplete", "fadeOut", "onHide", "fadeIn", "SettingAppColorScheme", "Component", "event", "newMode", "onInputChange", "isDark", "inputs", "input", "splitName", "colorPos", "cssId", "varName", "lightName", "hexVal", "rgb", "rgbLightVal", "lightColorInput", "hex", "result", "SettingColorPicker", "Component", "value", "SettingHomepageControl", "Component", "showPagePicker", "itemActions", "item", "list", "index", "newIndex", "shelfBooksList", "allBooksList", "ShelfSort", "Component", "scrollBoxes", "scrollBox", "sortable_esm_default", "event", "sortItemAction", "button", "filterVal", "books", "lowerFilter", "bookEl", "show", "sortItem", "action", "actionFunction", "shelfBookElems", "elem", "sortProperty", "reverse", "bookA", "bookB", "aProp", "bProp", "book", "reverseMap", "map", "reversed", "key", "value", "Shortcuts", "Component", "event", "combo", "s", "shortcutId", "id", "el", "wrapper", "shortcutEls", "displayedIds", "shortcutEl", "signal", "targetEl", "targetBounds", "label", "linkage", "labelBounds", "ignoreKeys", "ShortcutInput", "Component", "event", "keys", "s", "SortableList", "Component", "sortable", "sortable_esm_default", "dataTransferItem", "dragEl", "jsonContent", "contentByType", "type", "content", "SubmitOnChange", "Component", "event", "form", "Tabs", "Component", "event", "tab", "sectionId", "panel", "selected", "active", "panelToShow", "p", "TagManager", "Component", "event", "addRemoveComponent", "row", "input", "TemplateManager", "Component", "onChildEvent", "event", "templateItem", "templateId", "actionButton", "action", "resp", "eventName", "paginationLink", "paginationUrl", "searchTerm", "ToggleSwitch", "Component", "changeEvent", "TriLayout", "Component", "newLayout", "tab", "event", "tabName", "scroll", "isActive", "showInfo", "defaultScrollTop", "UserSelect", "Component", "onChildEvent", "event", "userEl", "WebhookEvents", "Component", "event", "checkbox", "WysiwygEditor", "Component", "buildForEditor", "editors", "drawioUrlElem", "WysiwygInput", "Component", "config", "buildForInput", "editors", "path", "targetPath", "basePath", "moduleName", "version", "http_exports", "events_exports", "translator", "translations_default", "register", "components_exports", "init"]
}
